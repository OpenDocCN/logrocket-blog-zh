<html>
<head>
<title>Using React Uploady to upload files - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用 React Uploady 上传文件</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/using-react-uploady-to-upload-files/#0001-01-01">https://blog.logrocket.com/using-react-uploady-to-upload-files/#0001-01-01</a></blockquote><div><article class="article-post">
<p>创建应用程序时，能够上传文件是一项基本要求。上传文件意味着来自客户端的用户应该能够上传文件到服务器。有许多方法可以实现这一点，因为每个文件系统都有自己的实现。</p>
<p>在本文中，我们将通过构建一个文件上传系统来看看 React 中的文件上传。</p>
<h2>什么是反应上传？</h2>
<p>根据其官方<a href="https://github.com/rpldy/react-uploady" target="_blank" rel="noopener">文档，</a> React-Uploady 是一个轻量级库，它使开发人员只需几行代码就可以构建客户端的文件上传功能。</p>
<p>本质上，它是一个专注于 React 应用程序的现代文件上传组件和钩子的库。它也是一个所有文件上传功能的一体化商店，比如文件上传进度、上传按钮和上传增强器。</p>
<h2>先决条件</h2>
<p>对于本文，您需要:</p>
<ul>
<li><a href="https://nodejs.org/en/download/" target="_blank" rel="noopener"> Node.js </a>和 NPM 安装在你的机器上</li>
<li>JavaScript 的基础知识以及<a href="https://reactjs.org/" target="_blank" rel="noopener"> React.js </a>如何工作</li>
</ul>
<p>首先，安装官方 React 应用脚手架工具，<code><a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener">create-react-app</a></code>:</p>
<pre>npm install -g create-react-app
</pre>
<p>您可以通过运行<code>create-react-app</code>来验证安装。这将要求您指定目录名。</p>
<h2>React Uploady 是如何工作的？</h2>
<p>React uploady 背后的想法是，它应该易于使用，也可以定制。为了实现这一点，React Uploady 为事件和特性提供了组件和挂钩。利用这一点，我们将建立一个简单的上传系统。</p>
<h2>react 上传入门</h2>
<p>我们将使用<code>create-react-app</code>来启动我们的项目。<code>create-react-app</code>是一个由脸书和社区维护的开源工具，帮助开发者在很短的时间内启动一个<code>react</code>项目。</p>
<p>要使用<code>create-react-app</code>样板文件创建一个新项目，请在您喜欢的终端中运行这个命令:</p>
<pre>create-react-app react-uploady 
</pre>
<p>名称<code>react-uploady</code>被用作这个项目的项目名称，但是它可以替换为您选择使用的任何名称。</p>
<p>接下来，切换到项目目录，通过运行以下命令启动开发服务器:</p>
<pre>cd react-uploady &amp;&amp; npm start 
</pre>
<p>该命令打开一个浏览器选项卡，呈现默认的样板应用程序。</p>
<h2>建立我们的上传系统</h2>
<p>React Uploady 包含像<code>UploadButton</code>这样的钩子和组件，它处理上传按钮，甚至还有一个<code>Upload Preview</code>来预览我们的文件上传。</p>
<p>为了开始使用我们的系统，让我们首先使用我们的终端安装以下软件包:</p>
<pre>npm i @rpldy/upload-button @rpldy/uploady rc-progress
</pre>
<p>在上面的代码中，我们安装了:</p>
<ul>
<li>这是一个来自 React Uploady 的组件，用于我们的上传按钮</li>
<li>这是 React 上传库的主包</li>
<li>这是一个显示文件上传进度的包</li>
</ul>
<p>接下来，让我们为我们的系统创建一个<code>Header</code>组件。为此，在我们的<code>src</code>文件夹中创建一个名为<code>Header.js</code>的新文件。请注意，文件名可以是您想要的任何名称。</p>
<p>接下来，我们创建一个如下所示的功能组件。</p>
<pre>import React from "react";

export default function App() {
  return (
    &lt;div&gt;
      &lt;h1&gt;File upload with React Uploady&lt;/h1&gt;
    &lt;/div&gt;
  );
}
</pre>
<p>这里，我们创建了一个带有<code>h1</code>标签的功能组件，标签上写着“使用 React Uploady 上传文件”</p>
<p>接下来，让我们在下面的<code>App</code>组件中渲染<code>Header</code>组件。</p>
<pre>import React from "react";

export default function App() {
  return (
      &lt;div className="App"&gt;
        &lt;Header /&gt;
      &lt;/div&gt;
      );
  }     
</pre>
<p>我们在<code>App</code>组件中呈现了<code>Header</code>组件，我们应该在浏览器中看到类似下图的结果。</p>
<p><img data-attachment-id="31372" data-permalink="https://blog.logrocket.com/using-react-uploady-to-upload-files/file-upload-react-uploady-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png" data-orig-size="622,327" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="File upload with React Uploady example" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example-300x158.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png" decoding="async" class="aligncenter size-full wp-image-31372 jetpack-lazy-image" src="../Images/5b5a32cbeef5c8d3744918d101a8cfe1.png" alt="File Upload With React Uploady Example" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png 622w, https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example-300x158.png 300w" data-lazy-sizes="(max-width: 622px) 100vw, 622px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31372" data-permalink="https://blog.logrocket.com/using-react-uploady-to-upload-files/file-upload-react-uploady-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png" data-orig-size="622,327" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="File upload with React Uploady example" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example-300x158.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31372" src="../Images/5b5a32cbeef5c8d3744918d101a8cfe1.png" alt="File Upload With React Uploady Example" srcset="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png 622w, https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example-300x158.png 300w" sizes="(max-width: 622px) 100vw, 622px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-example.png"/></noscript>
<p>接下来，让我们在我们的<code>App.js</code>组件中构建我们的上传系统，并构建一个简单的类似的上传。为此，我们需要导入我们的包，从<code>upload-button</code>包中呈现我们的上传按钮，并用<code>Uploady</code>组件包装我们的应用程序:</p>
<pre>import React, { useState } from "react";
import Header from "./Header";
import "./App.css";

import { Line } from "rc-progress";
import Uploady, { useItemProgressListener } from "@rpldy/uploady";
import UploadButton from "@rpldy/upload-button";
import { createMockSender } from "@rpldy/sender";
</pre>
<p>在上面的代码中，我们从<code>rc-progress</code>包中导入了<code>Line</code>风格的文件上传。接下来，我们从<code>@rpldy/uploady</code>导入上传和进度监听器，然后从<code>@rpldy/upload-button</code>导入上传按钮。</p>
<p>我们还从<code>@rpldy/sender</code>导入了一个模拟发送器，用于替换真实的发送器进行测试。</p>
<p>接下来，让我们构建我们的文件上传进程，首先为它构建一个状态，并在我们的应用程序中将其呈现为一个组件。</p>
<pre>const UploadProgress = () =&gt; {
  const [progress, setProgess] = useState(0);

  const progressData = useItemProgressListener();

  if (progressData &amp;&amp; progressData.completed &gt; progress) {
    setProgess(() =&gt; progressData.completed);
  }
</pre>
<p>在上面的代码中，我们创建了一个名为<code>UploadProgress</code>的函数。然后我们使用<code>setState</code>钩子将<code>progress</code>初始化为初始状态，并将其设置为初始状态 0。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自 LogRocket 的精彩文章:</h3>

<hr/></div>
<p>之后，我们将<code>progressData</code>变量设置为<code>useItemProgressListener</code>，这是从 React Uploady 获得的。在第六行，使用一个<code>if</code>语句，我们说如果<code>progressData</code>大于进度，那么将进度设置为“进度数据完成”</p>
<p>为了完成文件上传的进度条，让我们返回进度条的行并设置它的样式:</p>
<pre> return (
    progressData &amp;&amp; (
      &lt;Line
        style={{ height: "10px", marginTop: "20px" }}
        strokeWidth={2}
        strokeColor={progress === 100 ? "#00a626" : "#2db7f5"}
        percent={progress}
      /&gt;
    )
  );
};
</pre>
<p>这里，我们使用从<code>rc-progress</code>导入的<code>Line</code>组件。注意我们添加了高度和边距顶部，我们还添加了<code>2</code>作为笔画的宽度。</p>
<p>使用一个开关操作符，我们为进度条加载和完成添加了颜色。最后，我们将进度条的百分比设置为进度。</p>
<p>为了完成我们的应用程序，让我们在我们的应用程序上渲染所有这些，看看它在我们的浏览器上是什么样子。</p>
<pre>export default function App() {
  return (
    &lt;Uploady
      destination={{ url: "http://server.com" }}
      enhancer={mockEnhancer}
    &gt;
      &lt;div className="App"&gt;
        &lt;Header /&gt;
        &lt;UploadButton /&gt;
        &lt;UploadProgress /&gt;
      &lt;/div&gt;
    &lt;/Uploady&gt;
  );
}
</pre>
<p>在上面的代码中，我们使用<code>Uploady</code>组件包装了<code>App</code>组件，并为我们的文件上传设置了一个目的地。因为这是为了测试，我们可以设置一个虚拟服务器作为我们的目的地。</p>
<p>然后我们呈现了<code>Header</code>组件、<code>UploadButton</code>和<code>UploadProgress</code>，我们之前已经将它们初始化为一个函数。我们的应用程序应该如下图所示。</p>
<p><img data-attachment-id="31371" data-permalink="https://blog.logrocket.com/using-react-uploady-to-upload-files/react-uploady-no-styling/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png" data-orig-size="683,216" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React Uploady text with no styling" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling-300x95.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png" decoding="async" class="aligncenter size-full wp-image-31371 jetpack-lazy-image" src="../Images/826672c8e231465e26ab096485f4a11f.png" alt="React Uploady Text Without Styling" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png 683w, https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling-300x95.png 300w" data-lazy-sizes="(max-width: 683px) 100vw, 683px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31371" data-permalink="https://blog.logrocket.com/using-react-uploady-to-upload-files/react-uploady-no-styling/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png" data-orig-size="683,216" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React Uploady text with no styling" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling-300x95.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31371" src="../Images/826672c8e231465e26ab096485f4a11f.png" alt="React Uploady Text Without Styling" srcset="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png 683w, https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling-300x95.png 300w" sizes="(max-width: 683px) 100vw, 683px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/react-uploady-no-styling.png"/></noscript>
<p>我们的申请快完成了。</p>
<p>为了完成它，让我们为我们的上传系统添加样式和增强器。增强器是可以增强上传器实例的功能。使用它们，我们可以为我们的文件上传添加自定义功能。让我们现在就开始吧:</p>
<pre>const mockEnhancer = (uploader) =&gt; {
  const mockSender = createMockSender({ delay: 1500 });
  uploader.update({ send: mockSender.send });
  return uploader;
};
</pre>
<p>在上面的代码中，我们创建了一个函数<code>mockEnhancer</code>，它将 uploader 作为一个方法。在其中，我们初始化了从<code>@rpldy/sender</code>导入的 mocksender 方法。然后，我们添加了 1.5 秒的延迟，并返回上传者。这样做是为了模仿实际的发送和上传。</p>
<p>让我们在下面添加样式，然后看看我们的应用程序的最终面貌。</p>
<pre>.App {
  font-family: arial, sans-serif;
  text-align: center;
  margin-top: 20px;
}
body {
  background: #5c6e91;
  color: #eeeded;
}
button {
  height: 60px;
  width: 200px;
  font-size: 22px;
  background-color: #8f384d;
  color: #eeeded;
  text-transform: uppercase;
  cursor: pointer;
}
</pre>
<p>下面是我们最后一个应用的视频，一个带 React Uploady 的文件上传系统:</p>
<p><img data-attachment-id="31370" data-permalink="https://blog.logrocket.com/using-react-uploady-to-upload-files/file-upload-react-uploady/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady.gif" data-orig-size="600,338" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="File upload in React Uploady" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-300x169.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady.gif" decoding="async" class="aligncenter size-full wp-image-31370 jetpack-lazy-image" src="../Images/568a086baadd267b06781bd2716d1773.png" alt="File Upload in React Uploady" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31370" data-permalink="https://blog.logrocket.com/using-react-uploady-to-upload-files/file-upload-react-uploady/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady.gif" data-orig-size="600,338" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="File upload in React Uploady" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady-300x169.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31370" src="../Images/568a086baadd267b06781bd2716d1773.png" alt="File Upload in React Uploady" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/file-upload-react-uploady.gif"/></noscript>
<h2>结论</h2>
<p>在这篇文章中，我们学习了 React Uploady 以及如何使用它来构建一个简单的文件上传系统。我们还看到了如何使用 ES6 JavaScript 为我们的文件上传编写逻辑。</p>
<p>你可以在 LogRocket 上阅读更多 React 文章，在这里查看 React Uploady <a href="https://github.com/rpldy/react-uploady" target="_blank" rel="noopener">的官方文档。代码和应用程序的工作版本可以在</a><a href="https://codesandbox.io/s/react-uploady-f05jb?file=/src/App.js:72-91" target="_blank" rel="noopener">这里</a>找到。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用 LogRocket 消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款 React analytics 解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket 告诉您 React 应用程序中实际影响用户的最具影响力的 bug 和 UX 问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS 异常、前端性能指标和用户交互。然后，LogRocket 使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的 React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试 LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>
  
</div>    
</body>
</html>