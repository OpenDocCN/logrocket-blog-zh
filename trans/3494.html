<html>
<head>
<title>A guide to automated testing in Vue with Cypress </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用Cypress的Vue自动化测试指南</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/#0001-01-01">https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/#0001-01-01</a></blockquote><div><article class="article-post">
<p>对于任何代码库来说，测试都是绝对必要的，它可以帮助你在用户之前发现难以发现的错误，并作为你的代码应该如何工作的文档。随着项目的增长和变得越来越复杂，拥有完整的文档和无错误的代码库对于UX和应用程序的安全性变得越来越重要。</p>
<p>如果你使用Vue，Cypress是测试你的应用程序的最好工具之一。在本文中，我们将学习如何用Cypress测试单个Vue组件。</p>
<p>要跟随本教程，您需要:</p>
<ul>
<li>文本编辑器</li>
<li>本地安装的Node.js</li>
<li>HTML、CSS、JavaScript、Vue和Cypress的工作知识</li>
</ul>
<p>请记住，本教程使用的是<a href="https://blog.logrocket.com/provide-inject-vue-js-3-composition-api/"> Vue 3和组合API </a>。</p>
<p><em>向前跳转:</em></p>

<h2 id="component-tests-vs-e2e-tests">组件测试与E2E测试</h2>
<p>端到端(E2E)测试的目标是以与最终用户相同的方式体验您的整个应用程序，确保它按预期工作。虽然组件测试使用相同的一般思想，但它侧重于将前端的每个组件作为一个独立的部分进行测试，而不考虑组件与其他组件的协同工作情况。因此，即使您的所有组件测试都通过了，也不能保证您的应用程序整体上工作正常。</p>
<p>那么，为什么要费心进行组件测试呢？编写组件测试更快，需要更少的设置和基础设施。如果您正在构建一个库，组件测试是非常宝贵的，因为单独测试每个组件要明智得多。测试应用程序时，修复组件内部的问题会更容易，而在E2E测试中，由于组件的范围较小，这些问题可能很难查明。理想情况下，您的项目应该混合了组件测试和E2E测试。</p>
<h2 id="why-cypress">为什么是柏树？</h2>
<p>Vue文档<a href="https://vuejs.org/guide/scaling-up/testing.html#component-testing">推荐Cypress来测试组件</a>，这些组件的行为取决于渲染风格。此外，Cypress是免费的、开源的，并且易于设置和安装。Cypress测试易于读写，并且它有非常<a href="https://docs.cypress.io/">全面的文档</a>。</p>
<h2 id="testing-vue-components-cypress">用Cypress测试Vue组件</h2>
<p>首先，我们将学习如何将Cypress添加到我们的Vue项目中，然后我们将为Cypress组件编写测试。在本教程中，我们将测试一个简单的模态，如下图所示:</p>
<p><img data-attachment-id="137767" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/testing-simple-vue-modal-cypress/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png" data-orig-size="730,313" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="testing-simple-vue-modal-cypress" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress-300x129.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png" decoding="async" class="aligncenter wp-image-137767 size-full jetpack-lazy-image" src="../Images/f0d7a6ffce22630de3498e1be659206e.png" alt="Testing Simple Vue Modal Cypress" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress-300x129.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137767" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/testing-simple-vue-modal-cypress/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png" data-orig-size="730,313" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="testing-simple-vue-modal-cypress" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress-300x129.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png" decoding="async" loading="lazy" class="aligncenter wp-image-137767 size-full" src="../Images/f0d7a6ffce22630de3498e1be659206e.png" alt="Testing Simple Vue Modal Cypress" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress-300x129.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/testing-simple-vue-modal-cypress.png"/></noscript>
<h3 id="project-setup">项目设置</h3>
<p>首先，打开您的终端并导航到您希望项目所在的目录。接下来，在您的终端中运行以下命令来<a href="https://blog.logrocket.com/vite-3-vs-create-react-app-comparison-migration-guide/">用Vue和Vite </a>创建一个应用程序:</p>
<pre class="language-bash hljs">npm init <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3c4a49597c505d48594f48">[email protected]</a>
</pre>
<p>该命令将提示您回答一系列问题；用下面显示的配置回答这些问题:</p>
<p><img data-attachment-id="137770" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/vue-cypress-project-configuration/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png" data-orig-size="619,188" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vue-cypress-project-configuration" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration-300x91.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png" decoding="async" class="aligncenter wp-image-137770 size-full jetpack-lazy-image" src="../Images/d67d69ef5eb8079d59f1d8abbb922302.png" alt="Vue Cypress Project Configuration" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png 619w, https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration-300x91.png 300w" data-lazy-sizes="(max-width: 619px) 100vw, 619px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137770" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/vue-cypress-project-configuration/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png" data-orig-size="619,188" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vue-cypress-project-configuration" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration-300x91.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png" decoding="async" loading="lazy" class="aligncenter wp-image-137770 size-full" src="../Images/d67d69ef5eb8079d59f1d8abbb922302.png" alt="Vue Cypress Project Configuration" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png 619w, https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration-300x91.png 300w" sizes="(max-width: 619px) 100vw, 619px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/vue-cypress-project-configuration.png"/></noscript>
<p>现在，您应该有一个名为<code>first-component-test</code>的新目录。运行以下命令:</p>
<pre class="language-bash hljs">cd first-component-test
npm install
npm run dev
</pre>
<p>上面的代码将为您切换目录，安装必要的依赖项，然后为您的应用程序启动一个开发服务器。现在，<code>first-component-test</code>目录应该具有以下结构:</p>
<p><img data-attachment-id="137783" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/first-component-test-folder-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png" data-orig-size="303,551" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="first-component-test-folder-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure-165x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png" decoding="async" class="aligncenter wp-image-137783 size-full jetpack-lazy-image" src="../Images/6e60f570dd672b1b742000ad39355bc8.png" alt="First Component Test Folder Structure" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png 303w, https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure-165x300.png 165w" data-lazy-sizes="(max-width: 303px) 100vw, 303px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137783" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/first-component-test-folder-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png" data-orig-size="303,551" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="first-component-test-folder-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure-165x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png" decoding="async" loading="lazy" class="aligncenter wp-image-137783 size-full" src="../Images/6e60f570dd672b1b742000ad39355bc8.png" alt="First Component Test Folder Structure" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png 303w, https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure-165x300.png 165w" sizes="(max-width: 303px) 100vw, 303px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/first-component-test-folder-structure.png"/></noscript>
<p>让我们从这个项目中删除一些不必要的文件。进入<code>cypress/support/component.js</code>并删除以下行:</p>
<pre class="language-javascript hljs">import '@/assets/main.css'
</pre>
<p>删除<code>src/assets</code>和<code>src/components/icons</code>文件夹。删除<code>src/components</code>中的所有<code>.vue</code>文件，并在<code>src/components</code>中创建一个名为<code>Modal.vue</code>的文件。</p>
<p>用以下代码替换<code>src/App.vue</code>的内容:</p>
<pre class="language-javascript hljs">&lt;script setup&gt;
import Modal from "./components/Modal.vue"
&lt;/script&gt;

&lt;template&gt;
  &lt;Modal /&gt;
&lt;/template&gt;
</pre>
<p>最后，删除<code>src/main.js</code>中的以下一行:</p>
<pre class="language-javascript hljs">import './assets/main.css'
</pre>
<p>有了这个，你就可以走了！</p>
<h3 id="building-component">构建组件</h3>
<p>由于本教程的重点是测试，并且这个模型是一个简单的组件，我们不会在它的代码上花太多时间。将以下代码添加到<code>src/components/Modal.vue</code>中:</p>
<pre class="language-javascript hljs">&lt;template&gt;
  &lt;button
      @click="open = true; $emit('modalOpened')"
      data-cy="open-button"
  &gt;
      Open Modal
  &lt;/button&gt;

  &lt;Teleport to="body"&gt;
    &lt;div v-show="open" class="modal" data-cy="modal-body"&gt;
      &lt;div class="content"
           data-cy="modal-content"
           :style="{backgroundColor: contentColor}"
      &gt;
        &lt;div data-cy="default-slot"&gt;
          &lt;slot&gt;
            &lt;p&gt;Hello from the modal!&lt;/p&gt;
          &lt;/slot&gt;
        &lt;/div&gt;
        &lt;div data-cy="extra-slot"&gt;
          &lt;slot name="extra"&gt;&lt;/slot&gt;
        &lt;/div&gt;
        &lt;button @click="open = false; $emit('modalClosed')" data-cy="close-modal"&gt;Close&lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/Teleport&gt;
&lt;/template&gt;
&lt;script setup&gt;
import {ref} from "vue";
const open = ref(false);
const props  = defineProps({
  color: String
})
const contentColor = props.color ? props.color : "white"
defineEmits(['modalOpened', 'modalClosed'])
&lt;/script&gt;
&lt;style scoped&gt;
.modal {
  position: fixed;
  height: 100%;
  top: 0;
  left: 0;
  right: 0;
  background-color: rgba(0,0,0, 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal &gt; .content {
  width: fit-content;
  padding: 2rem;
}
&lt;/style&gt;
</pre>
<p>上面的代码包含打开模态的按钮的模板和模态主体本身，一个关闭按钮和几个槽。它还包含控制打开和关闭模态的逻辑、让模态接受名为<code>color</code>的属性的逻辑、当模态打开和关闭时发出事件的逻辑，以及少量的样式。</p>
<h3 id="writing-the-tests">编写测试</h3>
<p>接下来，您将编写一组测试来检查模态是否正常工作。首先在您的<code>src/components/__tests__</code>文件夹中创建一个名为<code>modal.cy.js</code>的新文件。然后，将下面的代码添加到<code>modal.cy.js</code>中:</p>
<pre class="language-javascript hljs">import Modal from "../Modal.vue"

describe("Modal component tests", () =&gt; {
    const modalBodySelector = '[data-cy="modal-body"]'
    const modalContentSelector = '[data-cy="modal-content"]'
    const openButtonSelector = '[data-cy="open-button"]'
    const closeButtonSelector = '[data-cy="close-modal"]'
})
</pre>
<p>上面的代码导入了您的<code>Modal</code>组件，并创建了针对模态模板部分的选择器。</p>
<h4 id="testing-modal-renders">测试模态呈现的</h4>
<p>我们将编写的第一个测试检查模态的打开和关闭以及它的结构是否完整。在最后一个<code>const</code>语句后的<code>describe</code>块中编写以下代码:</p>
<pre class="language-javascript hljs">it ("opens and closes correctly", () =&gt; {
        cy.mount(Modal)
        cy.get(modalBodySelector).should("not.be.visible")
        cy.get(openButtonSelector).should("have.text", " Open Modal ").click()
        cy.get(modalBodySelector).should("be.visible")
        cy.get(modalContentSelector)
            .should("be.visible")
            .should("have.css", "background-color", "rgb(255, 255, 255)")
        cy.get(closeButtonSelector).click()
        cy.get(modalBodySelector).should("not.be.visible")
})
</pre>
<p>测试从挂载<code>Modal</code>组件开始，创建它，并使用<code>cy.mount</code> <span>命令、</span> <span>命令将它附加到DOM，这是Cypress在设置时添加的自定义命令</span> <span>，允许您挂载单个组件。</span></p>
<p>其余的测试是标准的柏树。它确保模式的主体不可见，并且“打开”按钮存在并且具有正确的文本。接下来，它单击“打开”按钮，确保模式体可见，并且其内容具有正确的背景色，白色。然后单击“关闭”按钮，检查模态实体是否再次不可见。</p>
<p>现在，您可以运行您的测试。打开一个新的终端窗口，运行以下命令来启动Cypress测试运行程序:</p>
<pre class="language-bash hljs">npm run test:unit
</pre>
<p>在对话框中，选择您喜欢的浏览器，然后点击<code>modal.cy.js</code>运行您的测试。您应该会看到它通过，如下图所示:</p>
<p><img data-attachment-id="137781" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/selecr-browser-run-cypress-test/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png" data-orig-size="730,318" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="select-browser-run-cypress-test" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test-300x131.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png" decoding="async" class="aligncenter wp-image-137781 size-full jetpack-lazy-image" src="../Images/5bbb63c2e0e632f7b161b1fc530ee90a.png" alt="Select Browser Run Cypress Test" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test-300x131.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137781" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/selecr-browser-run-cypress-test/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png" data-orig-size="730,318" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="select-browser-run-cypress-test" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test-300x131.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png" decoding="async" loading="lazy" class="aligncenter wp-image-137781 size-full" src="../Images/5bbb63c2e0e632f7b161b1fc530ee90a.png" alt="Select Browser Run Cypress Test" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test-300x131.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/selecr-browser-run-cypress-test.png"/></noscript>
<p>现在Cypress已经打开了，只要您对<code>modal.cy.js</code>做了更改，测试就会重新运行。</p>
<h4 id="testing-prop">测试道具</h4>
<p>接下来，我们将编写一个测试来检查当<code>color</code> prop向modal传递一个值时，modal的背景颜色是否与该值匹配。在前一个<code>it</code>块后添加以下代码:</p>
<pre class="language-javascript hljs"> it ("changes color in response to props", () =&gt; {
        cy.mount(Modal, { props: {color: 'red'} })
        cy.get(openButtonSelector).click()
        cy.get(modalContentSelector)
            .should("be.visible")
            .and("have.css", "background-color", "rgb(255, 0, 0)")
})
</pre>
<p>就像第一个测试一样，第一步是安装组件。但是在这里，我们正在做一些新的事情。我们传递给<code>cy.mount</code>一个属性为<code>props</code>的<code>options</code>对象。属性允许你将道具传递给你挂载的组件。在这个测试中，我们将传入名为<code>color</code>的道具，其值为<code>red</code>。</p>
<p>挂载后，测试打开模态，然后检查背景颜色是否与您传入的道具相同。如果您再次打开Cypress，您应该看到新的测试通过了，并且模态的背景现在是红色的:</p>
<p><img data-attachment-id="137776" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/test-modal-background-color/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png" data-orig-size="730,200" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="test-modal-background-color" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color-300x82.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png" decoding="async" class="aligncenter wp-image-137776 size-full jetpack-lazy-image" src="../Images/4ab85dc42e1e3eade23a944ad33551d2.png" alt="Test Modal Background Color" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color-300x82.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137776" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/test-modal-background-color/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png" data-orig-size="730,200" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="test-modal-background-color" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color-300x82.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png" decoding="async" loading="lazy" class="aligncenter wp-image-137776 size-full" src="../Images/4ab85dc42e1e3eade23a944ad33551d2.png" alt="Test Modal Background Color" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color-300x82.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/test-modal-background-color.png"/></noscript>
<h4 id="testing-emitted-events">测试发出的事件</h4>
<p>现在，我们将编写一个测试来确保modal在打开和关闭时发出事件。在最后一个<code>it</code>块后添加以下代码:</p>
<pre class="language-javascript hljs">it ("fires the right event when the modal opens", () =&gt; {
        const openSpy = cy.spy().as('openSpy')
        cy.mount(Modal, { props: {onModalOpened: openSpy} })
        cy.get(openButtonSelector).click()
        cy.get('@openSpy').should("have.been.called")
})

it ("fires the right event when the modal closes", () =&gt; {
        const closeSpy = cy.spy().as('closeSpy')
        cy.mount(Modal, { props: {onModalClosed: closeSpy} })
        cy.get(openButtonSelector).click()
        cy.get(closeButtonSelector).click()
        cy.get('@closeSpy').should("have.been.called")
})
</pre>
<p>第一个测试从创建一个Cypress spy开始，它是一个函数包装器，允许您跟踪它包装的函数何时被调用，然后将其别名化为<code>openSpy</code>。您为间谍设置了别名，这样Cypress就可以使用它的别名进行调试。</p>
<p>创建一个间谍后，测试装载<code>Modal</code>并将<code>openSpy</code>分配给<code>modalOpened</code>事件。因此，每当<code>modalOpened</code>发生火灾时，<code>openSpy</code>就会被召唤。然后它打开模态并断言实际调用了<code>openSpy</code>。第二个测试遵循一个类似的过程，使用一个别名为<code>closeSpy</code>的间谍和<code>modalClosed</code>事件。</p>
<h4 id="testing-slots">测试插槽</h4>
<p>我们将编写一个最终的测试来确保你的模态的插槽正常工作。在最后一个<code>it</code>块后添加以下代码:</p>
<pre class="language-javascript hljs">it ("renders the correct content when given slots", () =&gt; {
        const slots = {
            default: () =&gt; 'Some default content',
            extra: () =&gt; 'Some extra text',
        }
        cy.mount(Modal, { slots })
        cy.get(openButtonSelector).click()
        cy.get("[data-cy='default-slot']")
            .should('not.have.text', 'Hello from the modal!')
            .and('have.text', 'Some default content')
        cy.get("[data-cy='extra-slot']")
            .and('have.text', 'Some extra text',)
})
</pre>
<p>测试从创建一个具有两个属性<code>default</code>和<code>extra</code>的<code>slots</code>对象开始。每个属性的值是一个返回文本值的函数，属性的名称对应于您正在测试的插槽的名称。</p>
<p>接下来，测试装载<code>Modal</code>并向<code>cy.mount</code>传递一个<code>options</code>对象，就像之前一样。然而，这一次，不是拥有一个<code>props</code>属性，而是将您的<code>slots</code>作为<code>slots</code>属性的值进行传递。接下来，测试打开了这个模型，检查这个模型是否没有默认的文本，并确保它包含了您在插槽中传递的文本。</p>
<p>如果您打开Cypress，您现在应该看到modal具有正确的文本内容:</p>
<p><img data-attachment-id="137774" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/cypress-modal-correct-text-content/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png" data-orig-size="730,211" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cypress-modal-correct-text-content" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content-300x87.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png" decoding="async" class="aligncenter wp-image-137774 size-full jetpack-lazy-image" src="../Images/016b3196a241db3626cc54aa8539c616.png" alt="Cypress Modal Correct Text Content" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content-300x87.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137774" data-permalink="https://blog.logrocket.com/a-guide-to-automated-testing-in-vue-with-cypress/attachment/cypress-modal-correct-text-content/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png" data-orig-size="730,211" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cypress-modal-correct-text-content" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content-300x87.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png" decoding="async" loading="lazy" class="aligncenter wp-image-137774 size-full" src="../Images/016b3196a241db3626cc54aa8539c616.png" alt="Cypress Modal Correct Text Content" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content-300x87.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/cypress-modal-correct-text-content.png"/></noscript>
<h2 id="conclusion">结论</h2>
<p>在本文中，我们了解了组件测试与E2E测试的不同之处，为什么应该使用Cypress进行组件测试，以及如何使用Cypress测试Vue组件的基础知识。如果你想了解更多关于在Cypress中测试Vue组件的信息，请查看文档。感谢阅读，祝测试愉快！</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>