<html>
<head>
<title>Getting started with Deno and Fresh - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Deno和Fresh - LogRocket博客入门</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/getting-started-deno-fresh/#0001-01-01">https://blog.logrocket.com/getting-started-deno-fresh/#0001-01-01</a></blockquote><div><article class="article-post">
<p>时不时地，人们熟知的技术会出现新的竞争者。当然，Node.js也会出现这种情况。最有希望的例子之一是Deno，老实说，它似乎是正确的。</p>
<p>在本文中，我们将讨论Deno是什么，将其与Node.js进行比较，并使用Deno和Fresh构建一个示例web应用程序。web应用程序将包含REST API和web UI的设计。我们将描述一些新鲜的机制和一个(穷人)的数据库解决方案，创建一个前端，并展示工作的应用程序。</p>
<p>这个演示示例在GitHub 上可用<a href="https://github.com/rosdec/deno_fresh_heroes" target="_blank" rel="noopener">，其灵感来自于《英雄之旅</a>的角度<a href="https://angular.io/tutorial" target="_blank" rel="noopener">示例。</a></p>

<h2 id="what-deno">什么是德诺？</h2>
<p>Deno是一个TypeScript和WebAssembly运行时，它为Node的一些老问题提供了革命性的方法。Deno的开发特别开始克服Node的一些限制，这些限制是由其设计师Ryan Dahl确定的，并在他2018年的关于Node.js的<a href="https://youtu.be/M3BM9TB-8yA" target="_blank" rel="noopener"> 10件我后悔的事情中进行了描述。</a></p>
<p>Ryan使用Rust (Node是用C++编写的)从零开始构建Deno。Deno使用谷歌的V8 JavaScript引擎，类似Node。</p>
<h3 id="comparing-deno-node-js">比较Deno和Node.js</h3>
<p><a href="https://blog.logrocket.com/what-is-deno/" target="_blank" rel="noopener">很明显，这两种产品有共同的词根和相似的名字</a>——你注意到“Deno”只是字母混在一起的“Node”吗？Deno也可以表示“破坏节点”</p>
<p>由于Deno原生执行TypeScript代码，比较Node和Deno有点不公平。最好将使用ts-node模块的Node与Deno进行比较，以实现类似的功能。另一方面，node和ts-node将需要更多时间来安装和传输模块(在Node中执行<code>.ts</code>到<code>.js</code>)。</p>
<p>Deno模块被设计成没有外部依赖，打破了著名的<a href="https://npm.github.io/how-npm-works-docs/theory-and-design/dependency-hell.html" target="_blank" rel="noopener">依赖地狱</a>。作为一个例子，<a href="https://npm.anvaka.com/#/view/2d/%2540angular%252Fcli" target="_blank" rel="noopener">这个工具</a>帮助我们了解对于一个使用漂亮标准技术的项目，我们需要在我们的<code>node_modules</code>目录中下载多少包。</p>
<p>Node和Deno的另一个显著区别是Deno不使用npm生态系统。在Deno中，依赖关系只是通过寻址存放我们希望包含在代码库中的类型脚本文件的存储库来处理。</p>
<p>这两个生态系统之间还有很多其他微妙的差异，你可以在这个堆栈溢出回答中读到<a href="https://stackoverflow.com/questions/53428120/deno-vs-ts-node-whats-the-difference" target="_blank" rel="noopener">。</a></p>
<h2 id="what-fresh">什么是新鲜？</h2>
<p>Deno提供的其他标准库中，我们有<a href="https://fresh.deno.dev/" target="_blank" rel="noopener"> Fresh </a>。</p>
<p>Fresh是一个全栈的现代web框架，旨在与其他广泛使用的web框架(如Angular、Next.js等)相媲美。它提供了基于文件系统的路由(类似于Next.js ),并有一个模板引擎，允许我们快速组装web应用程序ui。</p>
<p>根据我们需要的组件类型，Fresh使用<a href="https://github.com/preactjs/preac" target="_blank" rel="noopener"> Preact </a>在服务器和客户机上呈现页面。</p>
<p>网页是由互动的孤岛组成的。对于这些孤岛，渲染(及其背后的逻辑)是在浏览器中执行的。这实现了最大的交互性，而我们的web应用程序的其余组件都呈现在服务器上。只有最简单的HTML被传送到浏览器。</p>
<h2 id="comparing-node-deno-based-architectures">比较基于节点和基于Deno的架构</h2>
<p id="gdcalert1"><img data-attachment-id="130234" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/node-deno-comparison/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png" data-orig-size="576,334" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="node-deno-comparison" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison-300x174.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png" decoding="async" class="aligncenter size-full wp-image-130234 jetpack-lazy-image" src="../Images/cc12318e3e84915a5f2fadd2c4549877.png" alt="Node Deno Comparison Matrix" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png 576w, https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison-300x174.png 300w" data-lazy-sizes="(max-width: 576px) 100vw, 576px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130234" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/node-deno-comparison/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png" data-orig-size="576,334" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="node-deno-comparison" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison-300x174.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130234" src="../Images/cc12318e3e84915a5f2fadd2c4549877.png" alt="Node Deno Comparison Matrix" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png 576w, https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison-300x174.png 300w" sizes="(max-width: 576px) 100vw, 576px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/node-deno-comparison.png"/></noscript>
<p>上图显示了Node、Deno、ts-node、Angular和Fresh之间的架构比较，以获得更好的上下文。请注意，这有更多的层次，甚至在浏览器上运行的代码和在服务器上运行的代码之间的区别也可能是模糊的。这纯粹是比较不同组件的简化版本。</p>
<h2 id="building-simple-web-app-fresh">使用Fresh构建简单的web应用程序</h2>
<p>在接下来的几节中，我们将分析来自这个库的<a href="https://github.com/rosdec/deno_fresh_heroes" target="_blank" rel="noopener">代码。架构上，代码由三部分组成:一个REST API，一些数据，前端(MVC有人吗？).</a></p>
<p>该项目以<code>deno task start</code>开始，我们可以导航到<a href="http://localhost:8000" target="_blank" rel="noopener"> <code>http://localhost:8000</code> </a>来查看示例应用程序。</p>
<p id="gdcalert2"><img data-attachment-id="130238" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/tour-heroes-sample-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png" data-orig-size="712,278" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="tour-heroes-sample-app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app-300x117.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png" decoding="async" class="aligncenter size-full wp-image-130238 jetpack-lazy-image" src="../Images/647617fc920da3f39469a30df91ca477.png" alt="Tour Of Heroes Sample App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png 712w, https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app-300x117.png 300w" data-lazy-sizes="(max-width: 712px) 100vw, 712px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130238" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/tour-heroes-sample-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png" data-orig-size="712,278" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="tour-heroes-sample-app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app-300x117.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130238" src="../Images/647617fc920da3f39469a30df91ca477.png" alt="Tour Of Heroes Sample App" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png 712w, https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app-300x117.png 300w" sizes="(max-width: 712px) 100vw, 712px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/tour-heroes-sample-app.png"/></noscript>
<p>UI其实并不重要，它只是足够好地解释Deno和Fresh中的一些有趣的点。用户界面也允许我们添加英雄到我们的列表中，并在列表中滚动。当新英雄加入时，列表会动态更新。</p>
<p id="gdcalert3"><img data-attachment-id="130240" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/heroes-ui-list/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png" data-orig-size="332,392" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="heroes-ui-list" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list-254x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png" decoding="async" class="aligncenter size-full wp-image-130240 jetpack-lazy-image" src="../Images/9aba40a1c30753db00eb5a79da6a66ba.png" alt="Heroes UI List" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png 332w, https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list-254x300.png 254w" data-lazy-sizes="(max-width: 332px) 100vw, 332px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130240" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/heroes-ui-list/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png" data-orig-size="332,392" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="heroes-ui-list" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list-254x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130240" src="../Images/9aba40a1c30753db00eb5a79da6a66ba.png" alt="Heroes UI List" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png 332w, https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list-254x300.png 254w" sizes="(max-width: 332px) 100vw, 332px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-ui-list.png"/></noscript>
<h2 id="understanding-rest-api">了解REST API</h2>
<p>如上所述，REST API由两个文件提供(<code>/routes/heroes.ts</code>和<code>/routes/heroes/[id].tsx</code>)。我们可以比较下表中的功能差异:</p>
<table>
<tbody>
<tr>
<td><strong>功能描述</strong></td>
<td><strong>请求类型</strong></td>
<td><strong>实施地点</strong></td>
</tr>
<tr>
<td>获取数据库中所有英雄的名单</td>
<td>得到</td>
<td rowspan="2"><code>/routes/heroes.ts</code></td>
</tr>
<tr>
<td>创建一个新的英雄，名字在请求体中传递</td>
<td>邮政</td>
</tr>
<tr>
<td>获取特定英雄的详细信息</td>
<td>得到</td>
<td rowspan="3"><code>/routes/heroes/[id].tsx</code></td>
</tr>
<tr>
<td>更新给定英雄的详细信息</td>
<td>放</td>
</tr>
<tr>
<td>删除给定的英雄</td>
<td>倒三角形</td>
</tr>
</tbody>
</table>
<p>您可能会问，使用两个不同的文件来实现相似的功能是否有什么原因。有，有！</p>
<p>例如，这两个get可以接受也可以不接受查询参数。如果没有指定查询参数，调用该方法将返回整个英雄列表。通过为<code>id</code>参数指定一个值(即主角的<code>id</code>，GET方法将只返回单个对象。</p>
<p>在同一个文件中可能有相同的逻辑。然而，为了清楚起见，我将它们分成两个文件，以显示Fresh中动态路由的机制。</p>
<p>文件名<code>/heroes/[id].tsx</code>看起来有点怪。这是因为它代表了不仅仅匹配单个静态路径，而是基于一个模式匹配一大堆不同路径的可能性。这是借用了Next.js的机制。</p>
<p>这样，我们就有了一个代码来服务所有匹配<code><a href="http://localhost:8000/heroes/:id" rel="nofollow">http://localhost:8000/heroes/:id</a></code>模式的URL。</p>
<p id="gdcalert4"><img data-attachment-id="130242" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/heroes-id-name-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png" data-orig-size="372,95" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="heroes-id-name" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1-300x77.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png" decoding="async" class="aligncenter size-full wp-image-130242 jetpack-lazy-image" src="../Images/150513bbce2478598b179a58b672e6e2.png" alt="Heroes Id And Name Listed" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png 372w, https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1-300x77.png 300w" data-lazy-sizes="(max-width: 372px) 100vw, 372px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130242" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/heroes-id-name-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png" data-orig-size="372,95" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="heroes-id-name" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1-300x77.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130242" src="../Images/150513bbce2478598b179a58b672e6e2.png" alt="Heroes Id And Name Listed" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png 372w, https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1-300x77.png 300w" sizes="(max-width: 372px) 100vw, 372px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/heroes-id-name-1.png"/></noscript>
<p>当我们没有用<a href="https://localhost:8000/heroes" target="_blank" rel="noopener"> <code>http://localhost:8000/heroes</code> </a>指定一个参数时，我们会得到当前存档中的英雄的完整列表。这个特定的URL在文件<code>/routes/heroes.ts</code>中被路由。</p>
<p>在存储库中，我们还可以找到包含所有请求的<code>deno.postman_collection.json</code>文件。每个请求中都有一个示例，用于测试REST API，而不需要编写代码(该文件是Postman格式的，但是很容易理解)。</p>
<p>为了保持UI简单，并不是REST API的每个函数都绑定到一个按钮。在我们的例子中，我们希望有一个完整的REST API来提供完整的例子。</p>
<h2 id="setting-up-database">设置数据库</h2>
<p>为了使这个项目尽可能简单，我们采用了最简单的方法来保存数据:用一个数组作为全局变量。</p>
<p>这意味着一旦重启应用程序，我们将丢失数据的状态。对象hero的接口和对象的全局数组在<code>/data</code>目录中。没有什么特别令人兴奋的讨论，但是一般来说，这应该是初始化到一个适当数据库的连接的地方。</p>
<h2 id="creating-frontend">创建我们的前端</h2>
<p>我们项目最重要的部分是前端！它由文件<code>index.tsx</code>(将实际使用<code>islands</code>目录下的岛中的组件)和<code>[serverparam].tsx</code>实现。</p>
<p>首先，我们来讨论一下<code>[serverparam].tsx</code>文件。</p>
<p>从名字中，我们可以猜测它将提供一个动态路由。在URL的路径部分成为参数<code>serverparam</code>之后，所有的东西都被传递。</p>
<p>代码本身一点也不复杂——它只是打印一些字符串。代码在服务器上执行，只有最终的HTML返回给客户端:</p>
<pre class="language-typescript hljs">  return (
    &lt;div&gt;
      Hello {capitalizeFirstLetter(props.params.serverparam)}!&lt;br /&gt;
      The server time is: {new Date().toDateString()}&lt;br/&gt;
      The server platform is: {platform() }
    &lt;/div&gt;
  );
</pre>
<p>要测试它，只需进入<a href="http://localhost:8000/rosario" target="_blank" rel="noopener"> <code>http://localhost:8000/rosario</code> </a>并接收消息:</p>
<p id="gdcalert5"><img data-attachment-id="130244" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/receive-message/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png" data-orig-size="377,172" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="receive-message" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message-300x137.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png" decoding="async" class="aligncenter size-full wp-image-130244 jetpack-lazy-image" src="../Images/156f80a1244b77925566a1903c4550c4.png" alt="Receive Message Time And Server Platform" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png 377w, https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message-300x137.png 300w" data-lazy-sizes="(max-width: 377px) 100vw, 377px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130244" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/receive-message/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png" data-orig-size="377,172" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="receive-message" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message-300x137.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130244" src="../Images/156f80a1244b77925566a1903c4550c4.png" alt="Receive Message Time And Server Platform" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png 377w, https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message-300x137.png 300w" sizes="(max-width: 377px) 100vw, 377px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/receive-message.png"/></noscript>
<p>这个页面呈现在服务器上的证据是，通过从另一台装有另一个操作系统的计算机上导航到同一个页面，它将产生完全相同的字符串(特别是关于服务器操作系统的字符串)。</p>
<p id="gdcalert6"><img data-attachment-id="130246" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/page-rendered-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png" data-orig-size="385,144" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="page-rendered-server" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server-300x112.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png" decoding="async" class="aligncenter size-full wp-image-130246 jetpack-lazy-image" src="../Images/46afe3cb269d367042b9c817719fa7fb.png" alt="Message On Different Page With Rendered Server" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png 385w, https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server-300x112.png 300w" data-lazy-sizes="(max-width: 385px) 100vw, 385px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130246" data-permalink="https://blog.logrocket.com/getting-started-deno-fresh/attachment/page-rendered-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png" data-orig-size="385,144" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="page-rendered-server" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server-300x112.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130246" src="../Images/46afe3cb269d367042b9c817719fa7fb.png" alt="Message On Different Page With Rendered Server" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png 385w, https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server-300x112.png 300w" sizes="(max-width: 385px) 100vw, 385px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/page-rendered-server.png"/></noscript>
<p>上图显示了我家庭网络中一台Linux机器的确切输出。</p>
<p>现在让我们把注意力集中在应用程序的主界面<code>index.tsx</code>文件上。它使用REST API和数据。正如所料，代码非常简单:</p>
<pre class="language-typescript hljs">  export default function Home() {
    return (
      &lt;div class={tw`p-4 mx-auto max-w-screen-md`}&gt;
        &lt;h1 class={tw`text(3xl blue-500)`}&gt;Tour of Heroes&lt;/h1&gt;
        &lt;HeroesScroller start={1} /&gt;
        &lt;br/&gt;
        &lt;Create&gt;&lt;/Create&gt;
      &lt;/div&gt;
    );
  }
</pre>
<p>源代码是<code>.tsx</code>，所以它将在需要的地方使用混合了HTML的TypeScript语法。</p>
<p>在上面的片段中，我们可以看到,<code>index.tsx</code>文件的主要结果是组合了一个标题和两个组件:<code>HeroesScroller</code>(它也接受一个参数)和另一个名为<code>Create</code>的组件。</p>
<p>在讨论岛屿的概念之前，请注意样式如何使用<code>twind</code>。当我们使用以下命令在Fresh中创建新项目时，这是默认使用的:</p>
<pre class="language-shell hljs">  &gt; deno run -A -r https://fresh.deno.dev NameOfTheProject
</pre>
<p>现在该谈谈岛屿了。这是在浏览器上实际执行的代码。项目中有一个名为<code>/island</code>的特殊目录，该目录中的文件被不同地处理。我们可以通过运行项目看到这一点:</p>
<pre class="language-shell hljs">  &gt; deno task start
  Task start deno run -A --watch=static/,routes/ dev.ts
  Watcher Process started.
  The manifest has been generated for 4 routes and 2 islands.
  Server listening on http://0.0.0.0:8000
</pre>
<p>我们可以看到，Fresh已经扫描了根目录并找到了四个路径:<code>index</code>文件、我们上面讨论的REST API的两个文件和<code>[serverparam].tsx</code>文件。连同这些文件，它还发现了两个岛屿(<code>/islands</code>目录中的文件)。</p>
<p>选择“岛”这个名字是为了强调我们想要在浏览器中实现和运行的交互性实际上是如何被隔离在这些特定的文件中的。从技术的角度来说，我们写在<code>islands</code>目录下的一个文件中的TypeScript，被当场transpiled成JavaScript在浏览器中执行。</p>
<p>在官方文档中，这被称为“在客户机上对岛进行再水化”。总的来说，它对发展有着巨大的影响。</p>
<h2>结论</h2>
<p>Deno和Fresh的结合是开始享受中小型web应用程序项目开发的一个非常好的机会。</p>
<p>npm及其(臃肿的)生态系统的缺乏，连同整个开发过程中的速度，是一个明显的证据。</p>
<p>另一个巨大的好处是选择性地将TypeScript转换成JavaScript。在交互性这个岛上，这是一股清新的空气(你看到双关语了吧？)在开发生命周期中。</p>
<p>Deno模块利用了开发人员社区的丰富经验。他们可以真正无所畏惧地使用它们。最后，新模块由Deno核心团队审查，这在某种程度上是质量的保证。</p><div class="code-block code-block-4">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket会告诉您应用程序中实际影响用户的最具影响力的bug和UX问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket自动聚合客户端错误、JS异常、前端性能指标和用户交互。然后LogRocket使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试LogRocket】。</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>