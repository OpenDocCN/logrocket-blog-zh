<html>
<head>
<title>TypeScript mixins: Examples and use cases - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>TypeScript mixins:示例和用例</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/typescript-mixins-examples-and-use-cases/#0001-01-01">https://blog.logrocket.com/typescript-mixins-examples-and-use-cases/#0001-01-01</a></blockquote><div><article class="article-post">
<p>我在 TypeScript 方面经历的一个挑战是一次只能继承或扩展一个类的限制。您可以通过使用<a href="https://www.typescriptlang.org/docs/handbook/mixins.html">TypeScript</a><a href="https://www.typescriptlang.org/docs/handbook/mixins.html">m</a><a href="https://www.typescriptlang.org/docs/handbook/mixins.html">ixins</a>来改进多类继承，从而规避这种约束，尤其是在更复杂的架构中。</p>
<p>在本教程中，我们将学习更多关于 mixin 的一般知识，探索 TypeScript mixins，并浏览一个典型的 mixin 用例。</p>
<p>以下是我们将要介绍的内容:</p>

<p>要学习本教程，您应该具备:</p>

<p>我使用了<a href="http://playcode.io/"> playcode.io </a>来编写示例程序。</p>
<h2 id="whataremixins">什么是混合蛋白？</h2>
<p>Mixins 是特殊的类，它包含可以被其他类使用的方法组合。Mixins 促进代码的可重用性，并帮助您避免与多重继承相关的限制。</p>
<p>即使属性和实例化参数是在编译时定义的，mixins 也可以将方法的定义和绑定推迟到运行时。</p>
<h2 id="creatingmixinswithtypescript">使用 TypeScript 创建 mixins</h2>
<p>为了创建 mixin，我们将利用 TypeScript 的两个方面:接口类扩展和声明合并。</p>
<p>不出所料，接口类扩展用于扩展 TypeScript 中的多个类。声明合并是指 TypeScript 将两个或多个同名声明合并在一起的过程。如果接口具有相同的名称，它们也可以合并到类和其他构造中。</p>
<p>下面是一个声明合并的例子:</p>
<pre>    interface Car {
      steering: number;
      tyre: number;
    }
    interface Car {
      exhaustOutlet: number;
    }
    // contains properties from both Car interfaces
    const BMW: Car = {
        steering: 1,
        tyre: 4,
        exhaustOutlet: 2
    };
</pre>
<p>既然我们已经理解了这两个 TypeScript 特性，我们就可以开始了。</p>
<p>首先，我们需要创建一个将应用 mixins 的基类:</p>
<pre>class Block {
    name = "";
    length = 0;
    breadth = 0;
    height = 0;
    constructor(name: string, length: number, breadth: number, height: number, ) {
        this.name = name;
        this.length = length;
        this.breadth = breadth;
        this.height = height;
    }
}
</pre>
<p>接下来，创建基类将扩展到的类:</p>
<pre>class Moulder {
  moulding = true;
  done = false
  mould() {
    this.moulding = false;
    this.done = true;
  }
}
class Stacker {
  stacking = true;
  done = false
  stack() {
    this.stacking = false;
    this.done = true;
  }
}
</pre>
<p>创建一个接口，合并与基类同名的预期类(<code>Block</code>):</p>
<pre>interface Block extends Moulder, Stacker {}
</pre>
<p>新接口的定义名称与我们之前创建的类<code>Block</code>完全相同。这是至关重要的，因为这个接口同时扩展了<code>Moulder</code>和<code>Stacker</code>类。这意味着接口将把它们的方法定义合并到一个构造(接口)中，同时合并到同名的类定义中。</p>
<p>由于声明合并，<code>Block</code>类将与<code>Block</code>接口合并。</p>
<h3>创建一个函数</h3>
<p>为了创建一个函数来连接两个或多个类声明，我们将使用<a href="https://www.typescriptlang.org/docs/handbook/mixins.html">官方类型脚本手册</a>中提供的函数:</p>
<pre>function applyMixins(derivedCtor: any, constructors: any[]) {
  constructors.forEach((baseCtor) =&gt; {
    Object.getOwnPropertyNames(baseCtor.prototype).forEach((name) =&gt; {
      Object.defineProperty(
        derivedCtor.prototype,
        name,
        Object.getOwnPropertyDescriptor(baseCtor.prototype, name) ||
          Object.create(null)
      );
    });
  });
}
</pre>
<p>前面的函数遍历<code>Moulder</code>和<code>Stacker</code>类，然后遍历其属性列表，并将这些属性定义到<code>Block</code>类中。本质上，我们手动将所有方法和属性从<code>Moulder</code>和<code>Stacker</code>类链接到<code>Block</code>类中。</p>
<p>若要继续，请按如下方式执行前面的函数，然后查看下面的示例:</p>
<pre>applyMixins(Block, [Moulder, Stacker]);
</pre>
<h3>TypeScript 混合示例</h3>
<pre>let cube = new Block("cube", 4, 4, 4);
cube.mould();
cube.stack();
console.log(cube.length, cube.breadth, cube.height, cube.name, cube.moulding, cube.stacking);
</pre>
<p>这里，我们将<code>cube</code>分配给基类<code>Block</code>的实例。现在<code>Block</code>实例可以分别从<code>Moulder</code>和<code>Stacker</code>类直接访问<code>mould()</code>和<code>stack()</code>方法。</p>
<p>虽然有其他方法可以创建 TypeScript Mixins，但这是优化程度最高的模式，因为它较少依赖编译器，而更多地依赖代码库来确保运行时和类型系统保持同步。</p>
<h2 id="commonusecasesfortypescriptmixins">类型脚本混合的常见用例</h2>
<p>让我们回顾一下您可能会遇到或可能想要考虑的一些 TypeScript 混合用例。</p>
<h3>处理多个类扩展</h3>
<p>除非在接口中引入 mixin，否则 TypeScript 类不能同时扩展几个类。</p>
<p>考虑下面的片段:</p>
<pre>class Moulder {
  moulding = true;
  done = false
  mould() {
    this.moulding = false;
    this.done = true;
  }
}
class Stacker {
  stacking = true;
  done = false
  stack() {
    this.stacking = false;
    this.done = true;
  }
}
class Block extends Moulder, Stacker{
 constructor() {
    super()
 }
}
</pre>
<p>在这个例子中，<code>Block</code>类试图在不引入 mixins 概念的情况下同时扩展两个类。如果您将这个代码片段添加到在线编辑器(<a href="http://playcode.io/"> playcode.io </a>)中，您将得到以下错误:</p>
<figure id="attachment_41004" aria-describedby="caption-attachment-41004" class="wp-caption aligncenter"><img data-attachment-id="41004" data-permalink="https://blog.logrocket.com/typescript-mixins-examples-and-use-cases/typescript-multipls-class-extension-error/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png" data-orig-size="730,411" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="typescript-multiple-class-extension-error" data-image-description="" data-image-caption="&lt;p&gt;TypeScript multiple class extension error&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error-300x169.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png" decoding="async" class="wp-image-41004 size-full jetpack-lazy-image" src="../Images/92ae66f4f59e99978db937f81c6b29f4.png" alt="TypeScript Multiple Class Extension Error" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error-300x169.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="41004" data-permalink="https://blog.logrocket.com/typescript-mixins-examples-and-use-cases/typescript-multipls-class-extension-error/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png" data-orig-size="730,411" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="typescript-multiple-class-extension-error" data-image-description="" data-image-caption="&lt;p&gt;TypeScript multiple class extension error&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error-300x169.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png" decoding="async" loading="lazy" class="wp-image-41004 size-full" src="../Images/92ae66f4f59e99978db937f81c6b29f4.png" alt="TypeScript Multiple Class Extension Error" srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error-300x169.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/typescript-multipls-class-extension-error.png"/></noscript><figcaption id="caption-attachment-41004" class="wp-caption-text">TypeScript multiple class extension error</figcaption></figure>
<p>此时，解决这一限制的唯一方法是引入 TypeScript mixins。</p>
<h2 id="conclusion">结论</h2>
<p>当构建复杂程度可能会增加的应用程序时，TypeScript mixins 就派上了用场。当构建具有复杂体系结构的 TypeScript 应用程序时，您会希望同时扩展多个类。有了 mixins，你可以克服多重继承带来的限制。</p><div class="code-block code-block-21">
<div class="blog-plug inline-plug typescript-plug"><h2><a class="signup" href="https://lp.logrocket.com/blg/typescript-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>:全面了解您的网络和移动应用</h2>
<a href="https://lp.logrocket.com/blg/typescript-signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p>LogRocket 是一个前端应用程序监控解决方案，可以让您回放问题，就像问题发生在您自己的浏览器中一样。LogRocket 不需要猜测错误发生的原因，也不需要向用户询问截图和日志转储，而是让您重放会话以快速了解哪里出错了。它可以与任何应用程序完美配合，不管是什么框架，并且有插件可以记录来自 Redux、Vuex 和@ngrx/store 的额外上下文。</p>
<p>除了记录 Redux 操作和状态，LogRocket 还记录控制台日志、JavaScript 错误、堆栈跟踪、带有头+正文的网络请求/响应、浏览器元数据和自定义日志。它还使用 DOM 来记录页面上的 HTML 和 CSS，甚至为最复杂的单页面和移动应用程序重新创建像素级完美视频。</p>
<a class="signup" href="https://lp.logrocket.com/blg/typescript-signup" target="_blank" rel="noopener noreferrer">Try it for free</a><p>.</p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>