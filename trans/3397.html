<html>
<head>
<title>Improving Next.js app performance with BlurHash - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用BlurHash - LogRocket博客提高Next.js应用程序性能</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/#0001-01-01">https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/#0001-01-01</a></blockquote><div><article class="article-post">
<p>Next.js是一个灵活的React框架，可以用来构建快速的web应用程序。我们可以使用Next.js配置快速创建、开发和发布产品，而无需花费数天时间构建应用程序。我们还可以<a href="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/">使用Next.js构建服务器端渲染</a>和使用React的静态web应用程序。</p>
<p>但是，快速构建web应用程序和创建快速加载的web应用程序是两码事。</p>
<p>web应用程序加载到客户端所需的时间取决于在第一次初始加载时向客户端提供应用程序代码、样式和数据所需的时间。例如，如果服务器需要在第一次初始加载期间发送额外的资产，如图像，应用程序的性能就会下降。</p>
<p>多项研究表明，网站页面加载速度与用户体验和转化率之间存在正相关关系。有许多方法可以优化或提高Next.js应用程序的性能，以实现更快的加载时间。</p>
<p>例如，您可以使用服务器端呈现在服务器端呈现web页面的初始HTML，然后再将其提交给浏览器，使用Next.js内置的缓存功能来缓存经常使用的内容，删除未使用的依赖项(这会增加最终应用程序包的大小和加载时间)，或者使用延迟加载或占位符图像来优化图像。</p>
<p>在本文中，我们将关注这些优化策略之一:使用图像占位符进行图像优化。具体来说，我们将演示如何使用<a href="https://github.com/woltapp/blurhash/blob/master/Algorithm.md" target="_blank" rel="noopener"> BlurHash </a>算法创建图像占位符。</p>
<p><em>向前跳转:</em></p>

<h2 id="what-is-an-image-placeholder">什么是图像占位符？</h2>
<p>应用程序中有太多图像或者图像非常大且加载缓慢会对页面速度和用户体验产生负面影响。事实上，图像可能是影响应用速度的最重要因素之一。</p>
<p>我们可以使用占位符来代替减少应用程序中图像的数量，从而减少初始加载时图像文件的数量。</p>
<p>图像占位符是一个虚拟图像，浏览器最初可以加载它来表示实际的图像，直到下载了真正的图像。占位符可以提高页面速度，因为与它们所代表的实际图像相比，它们的文件非常小。图像占位符也可以防止网页布局发生变化。</p>
<p>占位符可以是图像的缩略图、一个空的灰色框、一个带有边框或背景色的<code>img</code>元素，甚至是图像的尺寸(如果固定的话)或图像的alt文本。然而，这些选项中没有一个是漂亮的，它们都会让你的网页看起来很无聊。</p>
<p>现在，让我们考虑占位符的另一个选项。</p>
<h2 id="what-is-blurhash">什么是BlurHash？</h2>
<p>为了使图像占位符在视觉上更吸引人，我们可以使用<a href="https://blurha.sh/" target="_blank" rel="noopener"> BlurHash </a>方法来创建图像的模糊版本，从而产生视觉上更吸引人的设计。</p>
<p>这个过程包括产生一串编码图像失真版本的字符；创建的字符数量取决于图像的质量。</p>
<p><img data-attachment-id="133746" data-permalink="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/attachment/blurhash-process/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png" data-orig-size="730,190" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="BlurHash process" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process-300x78.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png" decoding="async" class="aligncenter size-full wp-image-133746 jetpack-lazy-image" src="../Images/0cc14031d32ff7f801429915ebff14e1.png" alt="BlurHash Process" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process-300x78.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="133746" data-permalink="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/attachment/blurhash-process/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png" data-orig-size="730,190" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="BlurHash process" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process-300x78.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-133746" src="../Images/0cc14031d32ff7f801429915ebff14e1.png" alt="BlurHash Process" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process-300x78.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/blurhash-process.png"/></noscript>
<p>BlurHash字符串足够小，您不需要检索和下载图像文件；相反，你可以把它直接放到你网站的HTML中，然后解码成模糊的图片。</p>
<p>使用此BlurHash字符串作为图像占位符会使您的网页在视觉上更具吸引力，还会降低页面速度或网页的初始负载。</p>
<h2 id="how-does-blurhash-work">BlurHash是如何工作的？</h2>
<p><a href="https://github.com/woltapp/blurhash/blob/master/Algorithm.md" target="_blank" rel="noopener"> BlurHash算法</a>分析图像并生成一个字符串作为图像的占位符。这个过程通常在服务的后端完成，图像URL存储在这里，所以您可以将BlurHash字符串与图像URL放在一起。BlurHash字符串和图像URL一起发送给客户端。</p>
<p>BlurHash字符串足够短，可以快速适应您喜欢的任何数据类型。例如，很容易将其作为一个字段包含在JSON对象中。</p>
<p>要在通过网络加载实际图片时显示BlurHash占位符图像，您的客户端首先获取BlurHash字符串并将其解码为图像，同时在后台加载其全尺寸版本。</p>
<pre class="language-javascript hljs">{
    src: "https://i.ibb.co/5MMtXQQ/masahiro-miyagi-t-Hz-Ai-Axe-GBo-unsplash.jpg",
    blurhash: “L44-*2%456X8~Xxv9aoepJS$RPxE”
}</pre>
<h2 id="how-much-does-blurhash-impact-page-speed">BlurHash对页面速度的影响有多大？</h2>
<p>BlurHash对页面速度的影响程度因多种因素而异。但是这里有一个例子说明了BlurHash如何积极地影响页面的初始加载。</p>
<p>我用<a href="https://pagespeed.web.dev/" target="_blank" rel="noopener"> Google PageSpeed Insights </a>测试了一个网页的两个版本的页面速度。第一个版本有一个没有占位符的图像。第二个版本有相同的图像，带有一个BlurHash占位符。</p>
<p><img data-attachment-id="133749" data-permalink="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/attachment/no-placeholder/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png" data-orig-size="730,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="No placeholder" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder-300x180.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png" decoding="async" class="aligncenter size-full wp-image-133749 jetpack-lazy-image" src="../Images/9a4537fea8a2326f7cf11644d7c099db.png" alt="No Placeholder" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder-300x180.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="133749" data-permalink="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/attachment/no-placeholder/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png" data-orig-size="730,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="No placeholder" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder-300x180.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-133749" src="../Images/9a4537fea8a2326f7cf11644d7c099db.png" alt="No Placeholder" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder-300x180.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/no-placeholder.png"/></noscript>
<p>页面的第一个版本有一个没有占位符的图像，速度指数为0.9秒</p>
<p><img data-attachment-id="133751" data-permalink="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/attachment/placeholder/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png" data-orig-size="730,444" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Placeholder" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder-300x182.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png" decoding="async" class="aligncenter size-full wp-image-133751 jetpack-lazy-image" src="../Images/42ee695bba0184b6ad8a895bdd43085a.png" alt="Placeholder" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder-300x182.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="133751" data-permalink="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/attachment/placeholder/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png" data-orig-size="730,444" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Placeholder" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder-300x182.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-133751" src="../Images/42ee695bba0184b6ad8a895bdd43085a.png" alt="Placeholder" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder-300x182.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/placeholder.png"/></noscript>
<p>该页面的第二个版本有一个带有BlurHash占位符的图像，速度指数为0.2秒。</p>
<h2 id="how-do-you-implement-blurhash-in-a-nextjs-app">如何在下一个？JS app？</h2>
<p>默认情况下，Next.js自动为任何静态图像生成BlurHash字符串(即从<code>../some/src/</code>导入横幅)，对其进行解码，并将其用作图像占位符。但是，如果您的图像是动态的(例如，存储在您的数据库、后端或云中)，您必须提供数据URL作为图像的占位符。</p>
<h3 id="generating-blurhash-placeholders-for-static-images">为静态图像生成BlurHash占位符</h3>
<p>对于Next.js应用程序中的静态图像，您可以使用<code>Image </code>组件上的<code>placeholder</code>属性并给它一个<code>blur</code>值来生成BlurHash占位符，如下所示:</p>
<pre class="language-javascript hljs">import Image from "next/image";
import image from "../public/masahiro-miyagi-xk0YHAn3dzk-unsplash.jpg";

…

&lt;Image
   src={image}
   alt="masahiro-miyagi-xk0-YHAn3dzk-unsplash"
   placeholder="blur"
   layout="fill"
/&gt;</pre>
<h3 id="generating-blurhash-placeholders-for-dynamic-images">为动态图像生成BlurHash占位符</h3>
<p>对于Next.js应用程序中的动态图像，除了<code>placeholder</code>属性，还必须使用<code>blurDataUrl </code>属性。该属性接受图像的数据URL。</p>
<pre class="language-javascript hljs">import Image from "next/image";

…

const images = [
  {
    src: "https://i.ibb.co/5MMtXQQ/masahiro-miyagi-t-Hz-Ai-Axe-GBo-unsplash.jpg",
    blurUrl: "mokjmin2kl/9j/4AAQSk…"
  }
]

&lt;Image
    src={images[0].src}
    alt={images[0].src}
    placeholder="blur"
    blurDataURL={images[0].blurUrl}
    layout="fill"
/&gt;</pre>
<h3 id="converting-base83-data-url-to-base64-data-url">将Base83数据URL转换为Base64数据URL</h3>
<p>需要注意的是，如果直接在Next.js中使用BlurHash网站上生成的数据URL用于动态图片，是不行的。这是因为Next.js只接受Base64编码的图像作为数据URL，而BlurHash将图像编码为Base83。还没有为Next.js创建BlurHash实现(在这里查看BlurHash实现的<a href="https://github.com/woltapp/blurhash#implementations" target="_blank" rel="noopener">列表</a>)。</p>
<p>根据我的研究，我找不到任何Next.js包可以帮助我从BlurHash的Base83数据URL转换到Base64数据URL，或者任何适用于动态图像的Next.js实现。我发现的几个包，比如最近发布的<a href="https://www.npmjs.com/package/use-next-blurhash" target="_blank" rel="noopener"> use-next-blurhash </a>和<a href="https://plaiceholder.co/" target="_blank" rel="noopener">plaiceholder.co</a>，都不能与Next.js一起用于动态存储的图像。</p>
<p>然而，有一个由Jimmy Chion创建的<a href="https://blurred.dev/" target="_blank" rel="noopener"> Next.js Image blurDataURL生成器</a>，它生成图像的BlurHash和Base64数据URL。你可以<a href="https://github.com/cjimmy/blurhash-js" target="_blank" rel="noopener">在GitHub </a>上派生回购，并将其实现到你的项目中。</p>
<p>我将使用本文中的网站版本来生成数据URLs流程是这样的:</p>
<ol>
<li>访问<a href="https://blurred.dev/" target="_blank" rel="noopener">furted . dev</a></li>
<li>上传图像</li>
<li>操作BlurHash算法的设置和数据URL格式，以获取这两个URL</li>
</ol>
<p>您还会注意到，与图像的大小相比，数据URL的大小有多小。</p>
<p>使用一个小版本的图片来生成URL，因为图片的细节在BluHash生成时会丢失。图像的缩略图是理想的选择。</p>
<p><img data-attachment-id="133753" data-permalink="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/attachment/input-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png" data-orig-size="730,552" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Input output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output-300x227.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png" decoding="async" class="aligncenter size-full wp-image-133753 jetpack-lazy-image" src="../Images/0e5f15bdb7ad1ef76f6ee8867ee53682.png" alt="Input Output" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/input-output-300x227.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="133753" data-permalink="https://blog.logrocket.com/improving-nextjs-app-performance-blurhash/attachment/input-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png" data-orig-size="730,552" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Input output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output-300x227.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-133753" src="../Images/0e5f15bdb7ad1ef76f6ee8867ee53682.png" alt="Input Output" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/input-output-300x227.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/input-output.png"/></noscript>
<h3 id="adding-the-blurhash-url-to-a-nextjs-app">将BlurHash URL添加到Next.js应用程序</h3>
<p>现在，让我们使用Next.js应用程序中的URL。</p>
<p>我们将使用以下命令创建Next.js应用程序:</p>
<pre class="language-javascript hljs">yarn create next-app blurdataurl-in-nextjs
</pre>
<p>接下来，我们将对<strong> <code>index.js</code> </strong>文件进行更改，并在<code>styles</code>文件夹中创建一个<strong> <code>Home.module.css</code> </strong>文件。</p>
<pre class="language-javascript hljs">//index.js
import Image from "next/image";
import styles from "../styles/Home.module.css";
import image from "../public/masahiro-miyagi-xk0YHAn3dzk-unsplash.jpg";
import images from "../public/images";

export default function Home() {
  return (
    &lt;div className={styles.container}&gt;
      &lt;main className={styles.body}&gt;
        &lt;h1&gt;Using BlurDataUrl in Next.js&lt;/h1&gt;
        &lt;section className={styles.section}&gt;
          &lt;figure&gt;
            &lt;div className={styles.imageWrapper}&gt;
              &lt;Image
                src={image}
                alt="masahiro-miyagi-xk0-YHAn3dzk-unsplash"
                layout="fill"
              /&gt;
            &lt;/div&gt;
            &lt;figcaption className={styles.imageCaption}&gt;
              Image 1 is stored locally and does not use a placeholder.
            &lt;/figcaption&gt;
          &lt;/figure&gt;

          &lt;figure&gt;
            &lt;div className={styles.imageWrapper}&gt;
              &lt;Image
                src={image}
                alt="masahiro-miyagi-xk0-YHAn3dzk-unsplash"
                placeholder="blur"
                layout="fill"
              /&gt;
            &lt;/div&gt;
            &lt;figcaption className={styles.imageCaption}&gt;
              Image 2 is stored locally and uses a placeholder.
            &lt;/figcaption&gt;
          &lt;/figure&gt;

          &lt;figure&gt;
            &lt;div className={styles.imageWrapper}&gt;
              &lt;Image src={images[0].src} alt={image.scr} layout="fill" /&gt;
            &lt;/div&gt;
            &lt;figcaption className={styles.imageCaption}&gt;
              Image 3 is stored remotely but does not use a placeholder.
            &lt;/figcaption&gt;
          &lt;/figure&gt;

          {images.map((image, index) =&gt; (
            &lt;figure key={index}&gt;
              &lt;div className={styles.imageWrapper}&gt;
                &lt;Image
                  className={styles.image}
                  src={image.src}
                  alt={image.src}
                  placeholder="blur"
                  blurDataURL={image.blurUrl}
                  layout="fill"
                /&gt;
              &lt;/div&gt;
              &lt;figcaption className={styles.imageCaption}&gt;
                Image {index + 4} is stored remotely and uses a placeholder.
              &lt;/figcaption&gt;
            &lt;/figure&gt;
          ))}
        &lt;/section&gt;
      &lt;/main&gt;
    &lt;/div&gt;
  );
}</pre>
<pre class="language-css hljs">//Home.module.css
.body {
  padding: 20px;
  text-align: center;
}
.section {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  justify-content: center;
  gap: 10px;
}
.imageWrapper {
  position: relative;
  width: 200px;
  height: 150px;
}
.imageCaption {
  margin-top: 5px;
  width: 200px;
}

@media screen and (max-width: 500px) {
  .imageWrapper {
    position: relative;
    width: 300px;
    height: 225px;
  }
  .imageCaption {
    width: 300px;
  }
}</pre>
<p>第一个和第三个<code>figure</code>元素包含本地和远程存储的图像，但没有占位符。</p>
<p>第二个<code>figure </code>元素有一个本地存储的图像和一个占位符。</p>
<p>相比之下，第四个<code>figure</code>元素映射通过一个image对象数据数组，该数组模拟我们将从后端获得的数据。我们将把模拟数据存储在<code>images.js</code>文件内的<code>public</code>文件夹中。你可以<a href="https://github.com/Timonwa/Using-blurDataUrl-in-NextJs" target="_blank" rel="noopener">访问GitHub </a>上的模拟数据。</p>
<pre class="language-javascript hljs">//images.js
const images = [
  {
    src: "https://i.ibb.co/5MMtXQQ/masahiro-miyagi-t-Hz-Ai-Axe-GBo-unsplash.jpg",
    blurUrl:
      "data:image/jpeg;base64,/9j/4AAQSkZJRg….",
  },
  {
    src: "https://i.ibb.co/2kWYRTr/masahiro-miyagi-Lfoh1h1azok-unsplash.jpg",
    blurUrl:
      "data:image/jpeg;base64,/9j/4AAQSkZJRgAB…",
  },
];
export default images;</pre>
<p>现在，在您的终端中运行<code>yarn dev</code>，这样您就可以在浏览器中查看应用程序。</p>

<p>如您所见，在浏览器下载和加载实际图像之前，本地和远程图像的占位符几乎会立即加载。</p>
<h2>结论</h2>
<p>在本文中，我们演示了如何使用BlurHash为Next.js应用程序生成占位符图像。这种策略可以产生视觉上令人愉悦的网页，通过确保页面内容保持其位置来防止布局变化，并提高应用程序的页面加载速度。反过来，这提高了我们的Next.js应用程序的性能。</p><div class="code-block code-block-30">
<div class="blog-plug inline-plug next-plug"><h2><a href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank"> LogRocket </a>:全面了解生产Next.js应用</h2><p>调试下一个应用程序可能会很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪状态、自动显示JavaScript错误、跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" data-lazy-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/></noscript></a><a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a><p>LogRocket 就像是网络和移动应用的DVR，记录下你的Next.js应用上发生的一切。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。LogRocket还可以监控应用程序的性能，报告客户端CPU负载、客户端内存使用等指标。</p><p>LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p><p>让您调试Next.js应用的方式现代化— <a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>
 
</div>    
</body>
</html>