<html>
<head>
<title>Recursive components in React: A real-world example </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>React中的递归组件:一个真实的例子</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/recursive-components-react-real-world-example/#0001-01-01">https://blog.logrocket.com/recursive-components-react-real-world-example/#0001-01-01</a></blockquote><div><article class="article-post">
<p>有没有在<a href="https://blog.logrocket.com/tag/react/"> React </a>中使用过递归组件？我有。我和他们的第一次经历让我对前端项目有了全新的认识。因此，我认为写一篇关于React中使用递归组件的真实示例的文章是一个好主意，可以帮助人们更加熟悉使用递归组件。</p>
<p>在本文中，我们将探索React中递归组件的细节以及它们在实际应用程序中的用法。我们将在React中查看递归和非递归组件的示例，并评估它们的模块性、可读性和可维护性。之后，我们将构建一个真实世界的递归组件，一个类似于VS代码的嵌套文件浏览器。</p>
<p><em>向前跳转:</em></p>

<h2 id="what-recursion-react">React中的递归组件是什么？</h2>
<p>递归是在函数内部重复调用函数，直到满足基本条件(基本情况)。每次递归函数调用自己时，它都需要一个新的参数。例如，下面的<code>factorial</code>函数通过用不同的参数重复调用自身来工作，直到满足一个基本条件:</p>
<pre class="language-javascript hljs">function factorial(num) {
    if (num &lt;= 1) { // base condition
        return 1;
    }
    return num * factorial(num - 1); // function calling itself with new input value.
}
console.log(factorial(6)); // 720 
</pre>
<p>现在我们已经为理解递归组件打下了基础，让我们在React中看看它们。您可能知道，React组件是函数。当一个React组件用不同的道具重复地在其内部渲染，直到满足一个基本条件，它被称为递归组件。</p>
<p>递归组件是独一无二的，因为它可以调用自身并帮助呈现深度嵌套的数据。这些组件不限于简单地在UI上呈现父数据；他们还呈现父母的<a href="https://blog.logrocket.com/deep-dive-iterating-context-children-react/">孩子的数据</a>，直到达到深度限制。在这些组件中，孩子们可以通过<a href="https://blog.logrocket.com/the-beginners-guide-to-mastering-react-props-3f6f01fd7099/">传递道具</a>来设定。</p>
<p>让我们看一个React中递归组件的简单例子:</p>
<pre class="language-javascript hljs">import React from "react";

const RecursiveComponent = ({children}) =&gt; {
  return (
    &lt;div&gt;
      {children.length &gt; 0 &amp;&amp; &lt;RecursiveComponent children={children} /&gt;}
    &lt;/div&gt;
  );
};

export default RecursiveComponent;
</pre>
<p>如果你对这个概念在现实世界中的应用感到好奇，你可以在<a href="https://www.reddit.com/"> Reddit </a>和类似于<a href="https://code.visualstudio.com/"> VS Code </a>的文件浏览器中看到它们的作用。</p>
<p>现在您已经对递归组件有了基本的了解，我们将探索它们的用途并构建一个真实的例子。</p>
<h2 id="recursive-components-react-different-loops">React中的递归与循环有何不同？</h2>
<p>你可能想知道循环和递归之间的关键区别。在这一节中，我们将看看这些差异。与循环相比，递归包括调用一个调用自身的函数，而循环需要不断调用相同的代码，直到满足特定的条件。</p>
<p>对于循环，我们必须首先定义控制变量，然后才能在循环的任何迭代中使用它。例如，当我们创建<code>for loop</code>来遍历一个数组时，我们必须声明一个计数器变量<code>let i=0</code>，来跟踪迭代的次数。这允许我们在遍历数组时使用计数器变量。否则，我们将无法在需要的时候使用它，我们将需要<code>increment</code>或<code>decrement</code>这些控制变量来避免无限循环。</p>
<p>另一方面，在使用递归时，我们不必声明任何变量来执行递归操作。这是因为递归运算不依赖于变量，只需要一个基条件就可以停止调用函数。</p>
<ul>
<li>可返回性:对于循环，我们不能返回任何东西。然而，当我们使用递归时，我们可以从函数中返回值</li>
<li>可读性和模块化:通过递归，代码变得更加可读和模块化。然而，使用循环会使代码更长</li>
</ul>
<h2 id="why-when-use-recursive-components-react">为什么以及何时在React中使用递归组件</h2>
<p>在React中，组件是构建用户界面的主要构件。它们很棒，因为它们帮助我们从整体上思考我们的应用程序，并从更容易推理的更小的代码块中构建它。</p>
<p>你可能会想，“为什么我们要制作递归组件？”在React中使用递归组件的主要原因是它们使代码<a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">变得干燥</a>，更具可读性，并且模块化。</p>
<p>解决了这个问题之后，让我们把重点放在理解React中何时使用递归组件上。最常见的情况是数据嵌套了几层。</p>
<p>假设我们有一个对象数组，每个对象都有一个<code>children</code>键对应另一个对象数组。该数组的每个对象部分都有一个对应于另一个对象数组的<code>children</code>键。同样，这些对象可以包含更多的子数组。</p>
<p>此类数据的一个示例如下:</p>
<pre class="language-javascript hljs">export const data = [
  {
    isFolder: true,
    name: "public",
    children: [
      {
        isFolder: false,
        name: "index.html",
      },
    ],
  },
  {
    isFolder: true,
    name: "src",
    children: [
      {
        isFolder: true,
        name: "components",
        children: [
          {
            isFolder: true,
            name: "home",
            children: [
              {
                isFolder: false,
                name: "Home.js",
              },
            ],
          },
        ],
      },
      {
        isFolder: false,
        name: "App.js",
      },
    ],
  },
];
</pre>
<p>正如您所看到的，上面的数据有许多嵌套的子数组。这些嵌套的条目可以更深，但是为了解释清楚，我只保留了四层。</p>
<p>在这种情况下使用循环并不是一个好的选择，因为它需要编写大量的嵌套循环来遍历每一层数据。这使得你的代码更大，更难阅读。此外，如果我们不确定我们的数据有多深，使用循环遍历所有嵌套的数据是一个挑战。所以，在这种情况下，最好用递归。</p>
<h2 id="build-nested-file-explorer-using-standard-react-components">使用标准React组件构建嵌套文件资源管理器</h2>
<p>在本节中，我们将使用标准的React组件构建一个嵌套的文件资源管理器应用程序。在本教程的下一部分，我们将通过使用递归组件来构建相同的React应用程序。</p>
<p>首先，在<code>src</code>文件夹中新建一个React app和一个<code>data</code>文件夹。然后，在<code>data</code>中创建<code>data.js</code>，并将“<a href="#why-when-use-recursive-components-react">为什么以及何时在React </a>中使用递归组件”一节中的数据复制并粘贴到后面的。</p>
<p>现在，用下面的代码替换<code>App.js</code>文件的代码:</p>
<pre class="language-javascript hljs">import React from "react";
import { data } from "./data/data";

const NonRecursiveComponent = ({ data }) =&gt; {
  return &lt;div&gt;Non Recursive Component&lt;/div&gt;;
};

const App = () =&gt; {
  return (
    &lt;div style={{ margin: "8px" }}&gt;
      &lt;NonRecursiveComponent data={data} /&gt;
    &lt;/div&gt;
  );
};
export default App;
</pre>
<p>我们在上面的代码中创建了一个<code>NonRecursiveComponent</code>,然后<a href="https://blog.logrocket.com/react-conditional-rendering-9-methods/">在<code>App</code>组件中呈现它</a>。然后，我们将<code>data</code>道具从<code>App</code>传递到<code>NonRecursiveComponent</code>。</p>
<p>现在，让我们开始在UI上呈现数据。在<code>NonRecursiveComponent</code>中，用以下代码替换现有代码:</p>
<pre class="language-javascript hljs">const NonRecursiveComponent = ({ data }) =&gt; {
  return (
    &lt;div&gt;
      {data.map((parent) =&gt; {
        return (
          &lt;div key={parent.name}&gt;
            &lt;span&gt;{parent.name}&lt;/span&gt;
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>上面的代码将呈现所有的<code>parent</code>(第一级)数据，并在UI上显示出来:</p>
<p><img data-attachment-id="140062" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/recursive-component-react-rendered/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png" data-orig-size="730,144" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Rendered recursive component in React" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered-300x59.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png" decoding="async" class="aligncenter size-full wp-image-140062 jetpack-lazy-image" src="../Images/c7545da0bb7b274af5615d65bcd8d7df.png" alt="Rendered Recursive Component in React " data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered-300x59.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="140062" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/recursive-component-react-rendered/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png" data-orig-size="730,144" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Rendered recursive component in React" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered-300x59.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-140062" src="../Images/c7545da0bb7b274af5615d65bcd8d7df.png" alt="Rendered Recursive Component in React " srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered-300x59.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-rendered.png"/></noscript>
<p>现在，让我们通过使用第二个<code>return</code>语句中的<code>map</code>方法来呈现<code>children</code>。您的代码应该如下所示:</p>
<pre class="language-javascript hljs">const NonRecursiveComponent = ({ data }) =&gt; {
  return (
    &lt;div&gt;
      {data.map((parent) =&gt; {
        return (
          &lt;div key={parent.name}&gt;
            &lt;span&gt;{parent.name}&lt;/span&gt;
            {parent.children.map((child) =&gt; { // rendering children of the parent
              return (
                &lt;div key={child.name} style={{ paddingLeft: "20px" }}&gt;
                  &lt;span&gt;{child.name}&lt;/span&gt;
                &lt;/div&gt;
              );
            })}
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>从那里，您应该可以在UI上看到<code>parent</code>的所有<code>children</code>:</p>
<p><img data-attachment-id="140064" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/react-recursive-coponent-children-ui/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png" data-orig-size="730,201" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Children in React recursive component UI" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png" decoding="async" class="aligncenter size-full wp-image-140064 jetpack-lazy-image" src="../Images/158fc39a1ca0fa37ac53032499404ca2.png" alt="Children in React Recursive Component UI" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui-300x83.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="140064" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/react-recursive-coponent-children-ui/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png" data-orig-size="730,201" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Children in React recursive component UI" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-140064" src="../Images/158fc39a1ca0fa37ac53032499404ca2.png" alt="Children in React Recursive Component UI" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui-300x83.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-coponent-children-ui.png"/></noscript>
<p>我们来渲染一下<code>grandchildren</code>。因此，要做到这一点，我们需要做我们为<code>children</code>做的同样的事情。您的代码应该如下所示:</p>
<pre class="language-javascript hljs">const NonRecursiveComponent = ({ data }) =&gt; {
  return (
    &lt;div&gt;
      {data.map((parent) =&gt; { // rendering parent data
        return (
          &lt;div key={parent.name}&gt;
            &lt;span&gt;{parent.name}&lt;/span&gt;
            {parent.children.map((child) =&gt; { // rendering children of the parent
              return (
                &lt;div key={child.name} style={{ paddingLeft: "20px" }}&gt;
                  &lt;span&gt;{child.name}&lt;/span&gt;
                  {child.children &amp;&amp; // rendering grandchildren of the parent
                    child.children.map((grandChild) =&gt; {
                      return ( 
                        &lt;div key={grandChild.name} style={{ paddingLeft: "20px" }}&gt;
                          &lt;span&gt;{grandChild.name}&lt;/span&gt;
                        &lt;/div&gt;
                      );
                    })}
                &lt;/div&gt;
              );
            })}
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>您应该会在UI上看到类似这样的内容:</p>
<p><img data-attachment-id="140066" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/recursive-component-react-grandchildren/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png" data-orig-size="730,211" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Grandchildren in the recursive components in React" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren-300x87.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png" decoding="async" class="aligncenter size-full wp-image-140066 jetpack-lazy-image" src="../Images/1bdbb8c5d1e57ad4af7f1a53907813fc.png" alt="Grandchildren in the Recursive Components in React" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren-300x87.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="140066" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/recursive-component-react-grandchildren/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png" data-orig-size="730,211" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Grandchildren in the recursive components in React" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren-300x87.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-140066" src="../Images/1bdbb8c5d1e57ad4af7f1a53907813fc.png" alt="Grandchildren in the Recursive Components in React" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren-300x87.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursive-component-react-grandchildren.png"/></noscript>
<p>现在，我们需要做的最后一件事是在UI上呈现<code>great-grandchildren</code>。我们需要做和渲染<code>children</code>和<code>grandchildren</code>一样的事情。完成此操作后，您的代码应该如下所示:</p>
<pre class="language-javascript hljs">const NonRecursiveComponent = ({ data }) =&gt; {
  return (
    &lt;div&gt;
      {data.map((parent) =&gt; { // rendering parent data
        return (
          &lt;div key={parent.name}&gt;
            &lt;span&gt;{parent.name}&lt;/span&gt;
            {parent.children.map((child) =&gt; { // rendering children of the parent
              return (
                &lt;div key={child.name} style={{ paddingLeft: "20px" }}&gt;
                  &lt;span&gt;{child.name}&lt;/span&gt;
                  {child.children &amp;&amp; // rendering grandchildren of the parent
                    child.children.map((grandChild) =&gt; {
                      return (
                        &lt;div
                          key={grandChild.name}
                          style={{ paddingLeft: "20px" }}
                        &gt;
                          &lt;span&gt;{grandChild.name}&lt;/span&gt;
                          {grandChild.children &amp;&amp; // rendering great-grandchildren
                            grandChild.children.map((greatGrandChild) =&gt; {
                              return (
                                &lt;div
                                  key={greatGrandChild.name}
                                  style={{ paddingLeft: "20px" }}
                                &gt;
                                  &lt;span&gt;{greatGrandChild.name}&lt;/span&gt;
                                &lt;/div&gt;
                              );
                            })}
                        &lt;/div&gt;
                      );
                    })}
                &lt;/div&gt;
              );
            })}
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>您的用户界面应该如下所示:</p>
<p><img data-attachment-id="140068" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/react-recursive-components-file/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png" data-orig-size="730,248" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React recursive components file" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file-300x102.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png" decoding="async" class="aligncenter size-full wp-image-140068 jetpack-lazy-image" src="../Images/5e8d2f6f7d058cd67509de2cffe74b81.png" alt="React Recursive Components File" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file-300x102.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="140068" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/react-recursive-components-file/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png" data-orig-size="730,248" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React recursive components file" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file-300x102.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-140068" src="../Images/5e8d2f6f7d058cd67509de2cffe74b81.png" alt="React Recursive Components File" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file-300x102.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-recursive-components-file.png"/></noscript>
<p>到目前为止，我们已经使用常规的React组件构建了一个基本的嵌套文件浏览器组件。然而，如您所见，<code>NonRecursiveComponent</code>代码似乎在为每个嵌套层次的数据重复自己。随着数据嵌套层次的增加，这些代码变得越来越长，使得理解和维护变得更加困难。</p>
<p>那么，我们如何解决这个问题呢？在下一节中，我们将看看React中的递归组件如何提供帮助。</p>
<h2 id="using-recursive-components-react-build-nested-file-explorer">使用React中的递归组件构建嵌套文件资源管理器</h2>
<p>在这一节中，我们将使用递归组件构建相同的嵌套文件浏览器，并为嵌套文件和文件夹实现一个<code>show/hide</code>功能。</p>
<p>让我们从在<code>App.js</code>文件中创建一个新的<code>RecursiveComponent</code>开始。然后，把<code>App</code>中渲染的<code>NonRecursiveComponent</code>换成<code>RecursiveComponent</code>。</p>
<p>您的代码应该如下所示:</p>
<pre class="language-javascript hljs">const RecursiveComponent = ({ data }) =&gt; {
  return (
    &lt;div style={{ paddingLeft: "20px" }}&gt;
      Recursive Component
    &lt;/div&gt;
  );
};

const App = () =&gt; {
  return (
    &lt;div style={{ margin: "8px" }}&gt;
      &lt;RecursiveComponent data={data} /&gt;
    &lt;/div&gt;
  );
};
</pre>
<p>现在，让我们在UI上呈现所有的<code>parent</code>数据:</p>
<pre class="language-javascript hljs">const RecursiveComponent = ({ data }) =&gt; {
  return (
    &lt;div style={{ paddingLeft: "20px" }}&gt;
      {data.map((parent) =&gt; {
        return (
          &lt;div key={parent.name}&gt;
            &lt;span&gt;{parent.name}&lt;/span&gt;
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>接下来，让我们使用递归来呈现所有嵌套的文件和文件夹数据。为此，我们需要做两件事:首先，用不同的<code>data</code>道具从内部渲染<code>RecursiveComponent</code>。第二，我们需要一个基本条件来停止渲染<code>RecursiveComponent</code>。</p>
<p>在我们的例子中，基本条件是当<code>children</code>的长度为零或者它们不存在时，此时我们不会调用<code>RecursiveComponent</code>。</p>
<p>您的代码应该如下所示:</p>
<pre class="language-javascript hljs">const RecursiveComponent = ({ data }) =&gt; {
  return (
    &lt;div style={{ paddingLeft: "20px" }}&gt;
      {data.map((parent) =&gt; {
        return (
          &lt;div key={parent.name}&gt;
            &lt;span&gt;{parent.name}&lt;/span&gt;
            {/* Base Condition and Rendering recursive component from inside itself */}
            &lt;div&gt;
              {parent.children &amp;&amp; &lt;RecursiveComponent data={parent.children} /&gt;}
            &lt;/div&gt;
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>您的用户界面应该如下所示:</p>
<p><img data-attachment-id="140070" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/recursion-react-components-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png" data-orig-size="730,224" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Real-world example of React recursive components" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output-300x92.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png" decoding="async" class="aligncenter size-full wp-image-140070 jetpack-lazy-image" src="../Images/7896eb524a8bfa780e8b5eea2091e1ea.png" alt="Real-World Example of React Recursive Components" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output-300x92.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="140070" data-permalink="https://blog.logrocket.com/recursive-components-react-real-world-example/attachment/recursion-react-components-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png" data-orig-size="730,224" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Real-world example of React recursive components" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output-300x92.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-140070" src="../Images/7896eb524a8bfa780e8b5eea2091e1ea.png" alt="Real-World Example of React Recursive Components" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output-300x92.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/recursion-react-components-output.png"/></noscript>
<p>😮惊喜！通过几行代码，我们获得了相同的输出。这就是React中递归的神奇之处。</p>
<p>现在，让我们对嵌套的文件和文件夹实现<code>show/hide</code>。在开始之前，我们需要对代码进行一些修改。首先，我们需要在数据中有条件地使用<code>isFolder</code>键，将<code>button</code>标签用于文件夹名称，将<code>span</code>标签用于文件名称。我们这样做是因为我们只将<code>onClick</code>事件添加到文件夹中，而不是添加到文件中，以显示或隐藏特定文件夹中的所有文件和文件夹。</p>
<p>更新后的代码应该如下所示:</p>
<pre class="language-javascript hljs">const RecursiveComponent = ({ data }) =&gt; {
  return (
    &lt;div style={{ paddingLeft: "20px" }}&gt;
      {data.map((parent) =&gt; {
        return (
          &lt;div key={parent.name}&gt;
            {/* rendering folders */}
            {parent.isFolder &amp;&amp; &lt;button&gt;{parent.name}&lt;/button&gt;}
            {/* rendering files */}
            {!parent.isFolder &amp;&amp; &lt;span&gt;{parent.name}&lt;/span&gt;}
            &lt;div&gt;
              {parent.children &amp;&amp; &lt;RecursiveComponent data={parent.children} /&gt;}
            &lt;/div&gt;
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>现在，让我们通过使用<code>RecursiveComponent</code>中的<a href="https://blog.logrocket.com/react-hooks-cheat-sheet-unlock-solutions-to-common-problems-af4caf699e70/"> <code>useState</code>钩子</a>创建一个状态来实现<code>show/hide</code>，如下所示:</p>
<pre class="language-javascript hljs">import { useState } from "react";

const RecursiveComponent = ({ data }) =&gt; {
  const [showNested, setShowNested] = useState({});
  // ...
  // rest of the code
  // ...
};
</pre>
<p>这个<code>showNested</code>状态变量将像这样存储所有打开的文件夹:</p>
<pre class="language-javascript hljs">{
  public: true, // if the folder is opened, set it equal to true
  src: false // if the folder is not opened, set it equal to false
}
</pre>
<p>现在，创建一个函数来处理<code>show/hide</code>:</p>
<pre class="language-javascript hljs">const RecursiveComponent = ({ data }) =&gt; {
  const [showNested, setShowNested] = useState({});

  // handle show/hide functionality
  const toggleNested = (name) =&gt; {
    setShowNested({ ...showNested, [name]: !showNested[name] });
  };
  // ...
  // rest of the code
  // ...
};
</pre>
<p><code>toggleNested</code>函数接受文件夹的名称作为参数，然后使用<code>setShowNested</code>函数更新<code>showNested</code>中该文件夹的值。这使它从<code>false</code>变为<code>true</code>，反之亦然。</p>
<p>现在，让我们给<code>button</code>添加一个<code>onClick</code>事件来调用<code>toggleNested</code>。然后，当用户单击任何一个<strong>文件夹</strong>时，将文件夹的名称作为参数传递，如下所示:</p>
<pre class="language-javascript hljs">const RecursiveComponent = ({ data }) =&gt; {
  // ...
  // Rest of the code
  return (
    &lt;div style={{ paddingLeft: "20px" }}&gt;
      {data.map((parent) =&gt; {
        return (
          &lt;div key={parent.name}&gt;
            {parent.isFolder &amp;&amp; (
              &lt;button onClick={() =&gt; toggleNested(parent.name)}&gt;
                {parent.name}
              &lt;/button&gt;
            )}
            // ...
            // Rest of the code
            // ...
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>最后一步是更新<code>display</code> <a href="https://blog.logrocket.com/tag/css/"> CSS属性</a>，我们将把它添加到<code>div</code>中，包装<code>RecursiveComponent</code>中的<code>RecursiveComponent</code>。当用户选择<strong>文件夹</strong>时，我们将更新<code>showNested</code>对象，将文件夹名作为<code>key</code>添加到该对象中。我们还将它的值设置为<code>true</code>，并添加一个检查来查看文件夹名称是否出现在<code>showNested</code>中。</p>
<p>然后，我们将把<code>display</code>设置为<code>block</code>。否则，我们将把它设置为<code>none</code>来隐藏嵌套的文件和文件夹:</p>
<pre class="language-javascript hljs">const RecursiveComponent = ({ data }) =&gt; {
  // ...
  // Rest of the code
  return (
    &lt;div style={{ paddingLeft: "20px" }}&gt;
      {data.map((parent) =&gt; {
        return (
          &lt;div key={parent.name}&gt;
            // ...
            // Rest of the code
            // ...

            // Updating the display property using the showNested state
            &lt;div style={{ display: !showNested[parent.name] &amp;&amp; "none" }}&gt;
              {parent.children &amp;&amp; &lt;RecursiveComponent data={parent.children} /&gt;}
            &lt;/div&gt;
          &lt;/div&gt;
        );
      })}
    &lt;/div&gt;
  );
};
</pre>
<p>希望您能够切换所有的目录。至此，这个博客就完成了！</p>
<h2>结论</h2>
<p>在本文中，您了解了React中的递归组件，如何构建它们，以及为什么我们可能会使用它们。此外，我用一个真实的例子展示了递归与循环的不同之处。希望您学到了一些对您的下一个React项目有用的新东西。</p>
<p>我希望你喜欢这篇文章，感谢你花时间阅读它。如果你在阅读这篇文章时有任何问题，或者有进一步的疑问，请在评论区告诉我。如果你喜欢我在这里做的事情，并想帮助我继续做下去，别忘了点击分享按钮。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>