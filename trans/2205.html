<html>
<head>
<title>Manage Node.js versions using asdf - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用 asdf - LogRocket 博客管理 Node.js 版本</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/manage-node-js-versions-using-asdf/#0001-01-01">https://blog.logrocket.com/manage-node-js-versions-using-asdf/#0001-01-01</a></blockquote><div><article class="article-post">
<p>当一次处理几个项目时，您可能需要使用不同版本的编程语言。这导致卸载和重新安装每种语言的正确版本，浪费了大量时间。</p>
<p>幸运的是，使用节点版本管理器、Ruby 的 rbenv 或 Python 的 pyenv 等版本管理器，可以很容易地在不同版本之间进行切换。</p>
<p>这些都是很大的帮助，但是现在您需要为您的多语言项目管理和安装多个工具，这可能很麻烦。相反，您可以使用<a href="https://github.com/asdf-vm/asdf" target="_blank" rel="noopener"> asdf </a>来管理多个运行时版本，通过一个 CLI 工具管理您正在使用的所有语言版本。</p>
<p>Asdf 是一个可扩展的版本管理器，它同时支持多种语言，比如 Ruby、Node.js、Elixir、Erlang、Python 等等。您可以在全局和每个目录的语言版本之间切换。</p>
<p>在本文中，我们将学习使用 asdf 和 Node 所需的一切，包括如何在本地机器上设置和更新 asdf，以及安装、更新和删除 Node 插件。</p>
<h2>入门指南</h2>
<p>要开始使用 asdf，我们需要安装一些依赖项，比如<code>coreutils</code>、<code>curl</code>和<code>git</code>。Asdf 使用这些依赖项来安装不同的语言。</p>
<p>执行以下命令安装 asdf:</p>
<pre class="language-bash hljs"> 
brew install coreutils curl git  # on macOS with Homebrew

sudo apt install curl git        # on Linux
</pre>
<p>Asdf 文档建议从 git repo 克隆，如下所示:</p>
<pre class="language-bash hljs">git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.8.1
</pre>
<p>要安装 asdf，请将其添加到您的 shell 中。您可以在<a href="https://asdf-vm.com/guide/getting-started.html#_3-install-asdf" target="_blank" rel="noopener">文档中查看其他安装方法。</a>我将使用“痛击&amp;家酿(macOS)”的方法。</p>
<p>将<code>asdf.sh</code>添加到您的<code>~/.bash_profile</code>中，如下所示:</p>
<pre class="language-bash hljs">echo -e "\\n. $(brew --prefix asdf)/libexec/asdf.sh" &gt;&gt; ~/.bash_profile
</pre>
<p>然后，设置 bash 完成:</p>
<pre class="language-bash hljs">echo -e "\\n. $(brew --prefix asdf)/etc/bash_completion.d/asdf.bash" &gt;&gt; ~/.bash_profile
</pre>
<p>你可以这样看你的<code>~/.bash_profile</code>:</p>
<pre class="language-bash hljs">cat ~/.bash_profile
</pre>
<p>Asdf 也支持<code>Zsh</code>和<code>Fish</code>外壳。</p>
<p>现在，关闭终端，并启动一个新的终端。让我们通过在命令行中键入<code>asdf</code>来确保 asdf 已安装。</p>
<h2>安装 Node.js 插件</h2>
<p>在 asdf 中，每种语言都由一个<a href="https://github.com/asdf-vm/asdf-plugins" target="_blank" rel="noopener">插件</a>支持。他们有上百个插件，但是如果你没有看到你需要的，你也可以自己创建。</p>
<p>插件不仅仅包括语言；asdf 也支持数据库。</p>
<p>使用以下命令安装插件:</p>
<pre class="language-bash hljs">asdf plugin add &lt;name&gt; 
</pre>
<p>在安装节点插件之前，我们首先要安装<a href="https://www.gnupg.org/" target="_blank" rel="noopener"> GnuPG </a>来验证包的真实性。每个插件都有不同的要求，你可以在每个插件的 GitHub repo 上找到<a href="https://github.com/asdf-vm/asdf-plugins#:~:text=have%20previously%20set.-,Plugin%20List,-Language" target="_blank" rel="noopener">。</a></p>
<p>对于 Mac，我们可以通过自制程序安装 GnuPG:</p>
<pre class="language-bash hljs">brew install gpg
</pre>
<p>安装 GnuPG 后，通过运行以下命令安装节点插件:</p>
<pre class="language-bash hljs">asdf plugin add nodejs https://github.com/asdf-vm/asdf-nodejs.git
</pre>
<p>安装后，您可以看到已安装插件的列表，如下所示:</p>
<pre class="language-bash hljs">asdf plugin list
</pre>
<h2>安装编程语言版本</h2>
<p>Asdf 列出了每种编程语言的所有可用版本；在撰写本文时，我们总共可以安装 604 个版本的 Node。</p>
<p>您可以使用以下内容查看节点版本列表:</p>
<pre class="language-bash hljs">asdf list all nodejs | wc -l   # prints 604
</pre>
<p>要安装特定版本的节点，请运行:</p>
<pre class="language-bash hljs">asdf install nodejs 14.17.6
</pre>
<p>如果在安装某个版本的 Node 时遇到一些错误，请尝试以下命令:</p>
<pre class="language-bash hljs">asdf reshim nodejs
</pre>
<p>你可能会在这里得到一个关于<code>reshim</code>的错误。如果不运行<code>reshim</code>命令，npm 包将不会出现在您的路径中:</p>
<pre class="language-bash hljs">Unknown command: `asdf reshim nodejs 14.17.6`
/usr/local/Cellar/asdf/0.8.1_1/libexec/bin/asdf: line 82: /Users/&lt;your-username&gt;/.asdf/lib/commands/command-help.bash: No such file or directory
</pre>
<p>您可以通过运行以下命令来查看您安装了哪些版本:</p>
<pre class="language-bash hljs">asdf list all nodejs
</pre>
<p>要安装最新版本的 Node，请运行:</p>
<pre class="language-bash hljs">asdf install nodejs latest
</pre>
<p>我们还可以安装以给定字符串开头的最新节点版本:</p>
<pre class="language-bash hljs"># asdf install &lt;name&gt; latest:&lt;version&gt;
asdf install nodejs latest:16
</pre>
<h2>设置版本</h2>
<p>可以在三个级别上设置编程语言版本:全局、在当前 shell 中或本地。</p>
<h3>全球的</h3>
<p>您可以设置 Node 的默认全局版本，这样它将在任何新的 shell 中保持不变。这将在<code>Home</code>目录下的<code>.tool_versions</code>文件中添加或更新一行。</p>
<p>要设置节点的全局或默认版本，请运行:</p>
<pre class="language-bash hljs"># asdf global &lt;name&gt; &lt;version&gt; [&lt;version&gt;...]
asdf global nodejs 14.17.6
asdf global nodejs latest
</pre>
<p>现在，您可以用<code>asdf current</code>命令验证 asdf 的当前版本。在我的例子中，它显示的是 16.9.0 的最新节点版本:</p>
<pre class="language-bash hljs">(base) ➜  ~ asdf current
nodejs          16.9.0          /Users/&lt;username&gt;/.tool-versions
</pre>
<p>如果没有为工具执行列出版本，这将返回一个错误。使用这个命令，我们可以从当前目录中看到工具和版本解析，或者看不到。</p>
<p>全局默认值在<code>$HOME/.tool-versions</code>中管理。您可以通过运行以下命令来查看其内容:</p>
<pre class="language-bash hljs">cat $HOME/.tool-versions
</pre>
<p>我已经将全局节点版本设置为最新，我可以通过运行以下命令来验证:</p>
<pre class="language-bash hljs">(base) ➜  ~ node -v
v16.9.0 
</pre>
<h3>壳</h3>
<p>如果希望仅在当前 shell 中使用节点版本，请运行以下命令:</p>
<pre class="language-bash hljs"># asdf shell &lt;name&gt; &lt;version&gt; [&lt;version&gt;...]
asdf shell nodejs 14.17.6
asdf shell nodejs latest
</pre>
<p>此版本的 Node 将仅在当前 shell 会话中运行，因此当您关闭会话时，此版本将不可用。</p>
<p>在幕后，<code>shell</code>将版本设置为一个名为<code>ASDF_${LANG}_VERSION</code>的环境变量，仅用于当前 shell 会话:</p>
<pre class="language-bash hljs">ASDF_NODEJS_VERSION=14.17.6 node --version
</pre>
<h3>当地的</h3>
<p>您也可以基于单个项目运行特定版本的 Node，方法是在本地设置版本:</p>
<pre class="language-bash hljs">asdf local &lt;name&gt; &lt;version&gt; [&lt;version&gt;...]
asdf local nodejs 14.17.6
asdf local nodejs latest
</pre>
<p><code>local</code>将版本写入<code>$PWD/.tool-versions</code>。</p>
<p>您可以通过运行<code>node -v</code>来验证本地和 shell 环境的节点版本。</p>
<p>要基于单个项目设置一个本地版本，首先安装您想用<code>asdf install nodejs </code>使用的版本并运行<code>asdf local nodejs </code>。这将使用您选择的节点版本创建一个<code>.tool-versions</code>文件。</p>
<h3>卸载一个版本</h3>
<p>要卸载某个版本，请使用以下命令:</p>
<pre class="language-bash hljs"># asdf uninstall &lt;name&gt; &lt;version&gt;
asdf uninstall nodejs 14.17.6
asdf uninstall nodejs latest
</pre>
<h2>传统支持</h2>
<p>在团队中采用新的版本管理器需要时间，这就是 asdf 让您回退到遗留版本文件的原因。如果你愿意，你仍然可以使用你喜欢的版本管理器<a href="https://blog.logrocket.com/switching-between-node-versions-during-development/" target="_blank" rel="noopener">，比如<code>nvm</code> </a>。</p>
<p>要启用遗留支持，只需在主目录(<code>$HOME/.asdfrc</code>)中添加一个<code>.asdfrc</code>文件，并添加以下配置设置:</p>
<pre class="language-bash hljs">legacy_version_file = yes  # .asdfrc file
</pre>
<p>通过将遗留版本文件设置为<code>yes</code>，asdf 将能够读取其他版本管理器文件，如<code>.nvmrc</code>、<code>.node-versions</code>或<code>.ruby-versions</code>。</p>
<h2>更新插件</h2>
<p>在某些时候，你可能需要更新插件。您可以通过运行以下命令来实现:</p>
<pre class="language-bash hljs">asdf plugin update --all
</pre>
<p>到目前为止，我们一直依赖 asdf 来管理多个开发环境。要跟上<code>asdf</code>版本，运行以下命令:</p>
<pre class="language-bash hljs">asdf update       # via git
brew upgrade asdf # via homebrew
</pre>
<p>如果你想卸载 asdf，你可以跟随<a href="https://asdf-vm.com/manage/core.html#uninstall" target="_blank" rel="noopener">文档</a>。</p>
<h2>结论</h2>
<p>Asdf 对于通晓多种语言的程序员来说是一个很好的工具。它实现了无忧安装和多语言版本之间的轻松切换，节省了真正重要的时间-不要忘记阅读 asdf 的<a href="https://github.com/asdf-vm/asdf#:~:text=our%20helpful%20community-,Ballad%20of%20asdf,-Once%20upon%20a" target="_blank" rel="noopener">歌谣！</a></p>
<p>现在，您可以安装任意多的语言。除了使用许多不同的包管理器，您可以让 asdf 尝试去管理它们。</p>
<p>你呢？你用 asdf 吗？你的体验如何？</p><div class="code-block code-block-23">
<div class="blog-plug inline-plug node-plug"><h2>200 只<img src="../Images/61167b9d027ca73ed5aaf59a9ec31267.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png"/> <noscript> <img data-lazy-fallback="1" src="../Images/61167b9d027ca73ed5aaf59a9ec31267.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png"/> </noscript>显示器出现故障，生产中网络请求缓慢</h2><p>部署基于节点的 web 应用程序或网站是容易的部分。确保您的节点实例继续为您的应用程序提供资源是事情变得更加困难的地方。如果您对确保对后端或第三方服务的请求成功感兴趣，</p><a href="https://lp.logrocket.com/blg/node-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer"><img src="../Images/cae72fd2a54c5f02a6398c4867894844.png" alt="LogRocket Network Request Monitoring" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png"/><noscript><img data-lazy-fallback="1" src="../Images/cae72fd2a54c5f02a6398c4867894844.png" alt="LogRocket Network Request Monitoring" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png"/></noscript></a><a href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的 DVR，记录下用户与你的应用程序交互时发生的一切。您可以汇总并报告有问题的网络请求，以快速了解根本原因，而不是猜测问题发生的原因。</p><p>LogRocket 检测您的应用程序以记录基线性能计时，如页面加载时间、到达第一个字节的时间、慢速网络请求，还记录 Redux、NgRx 和 Vuex 操作/状态。</p><a class="signup" href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a><p>. </p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>