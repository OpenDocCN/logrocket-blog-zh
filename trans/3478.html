<html>
<head>
<title>Smooth animations with React Native Reanimated 3 - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>React Native reactive 3-log rocket博客的平滑动画</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/#0001-01-01">https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/#0001-01-01</a></blockquote><div><article class="article-post">
<h2>什么是React Native reactived，什么时候应该使用它？</h2>
<p>你有没有做过一个app，给你的朋友或者客户看，他们抱怨说“感觉不流畅”？也许他们建议添加流体动画，但你不是一个动画师。</p>
<p>现在，你的应用程序看起来像这样紧张不安:</p>
<p><img data-attachment-id="137191" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/jittery-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app.gif" data-orig-size="429,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Jittery app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app-294x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app.gif" decoding="async" class="aligncenter size-full wp-image-137191 jetpack-lazy-image" src="../Images/351193fb64aab419d25c95f5c9d7a83c.png" alt="Jittery App" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137191" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/jittery-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app.gif" data-orig-size="429,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Jittery app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app-294x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-137191" src="../Images/351193fb64aab419d25c95f5c9d7a83c.png" alt="Jittery App" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/jittery-app.gif"/></noscript>
<p>但是你想让它看起来像这样:</p>
<p><img data-attachment-id="137195" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/smoother-animation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation.gif" data-orig-size="429,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Smoother animation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation-294x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation.gif" decoding="async" class="aligncenter size-full wp-image-137195 jetpack-lazy-image" src="../Images/4d94a40e655534ee31488a93ed19e505.png" alt="Smoother Animation" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137195" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/smoother-animation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation.gif" data-orig-size="429,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Smoother animation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation-294x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-137195" src="../Images/4d94a40e655534ee31488a93ed19e505.png" alt="Smoother Animation" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/smoother-animation.gif"/></noscript>
<p>毫无疑问，动画增强了应用程序的用户体验。然而，在实际实现它们时，我们必须执行以下步骤:</p>
<ul>
<li>编写复杂的JavaScript代码来创建过渡</li>
<li>建立自定义的数学逻辑，使我们的动画有一个更流畅的运动</li>
<li>确保我们的动画与<a href="https://reactnative.dev/architecture/fabric-renderer" target="_blank" rel="noopener"> Fabric </a>兼容。这带来了性能和安全性的升级</li>
<li>或者，彻底测试您的项目，检查您的动画是否在所有平台上都是稳定的</li>
</ul>
<p>虽然这是解决这个问题的一种方法，但是有一个小问题:开发动画需要大量的技能和时间。这是小团队最头疼的问题。</p>
<p>这就是React Native Reanimated的用武之地。它是一个开源的React原生库(在GitHub 上大约有<a href="https://github.com/software-mansion/react-native-reanimated" target="_blank" rel="noopener"> 6.5k颗星)，允许开发者实现动画。</a></p>
<p>最近，开发团队<a href="https://blog.swmansion.com/announcing-reanimated-3-16167428c5f7" target="_blank" rel="noopener">发布了版本3 </a>，带来了重大改进。在本文中，我们将介绍React Native Reanimated中的新特性。</p>
<p>以下是我们今天要学的内容:</p>

<h2 id="new-features-in-react-native-reanimated">React Native reactived中的新功能</h2>
<p>据开发人员称，大部分功能都是在引擎盖下的变化。</p>
<h3 id="shifting-to-fabric">转向织物</h3>
<p>从版本3开始，Reanimated现在在引擎盖下使用Fabric架构。这带来了巨大的安全和性能升级。因此，这意味着你的应用程序是安全和快捷的。</p>
<p>对于不太了解面料的人来说，我们先简单介绍一下基本面和历史。</p>
<p>早在2018年，脸书就开始为React原生库开发新的渲染器<a href="https://reactnative.dev/blog/2022/03/15/an-update-on-the-new-architecture-rollout" target="_blank" rel="noopener">，名为Fabric。在旧流程中，React通过一系列跨桥步骤处理所有UI操作。我们可以通过下图对此进行解释:</a></p>
<figure id="attachment_137197" aria-describedby="caption-attachment-137197" class="wp-caption aligncenter"><img data-attachment-id="137197" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/react-ui-process/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png" data-orig-size="730,486" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React UI process" data-image-description="" data-image-caption="&lt;p&gt;Source: Lorenzo Sciandra&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png" decoding="async" class="size-full wp-image-137197 jetpack-lazy-image" src="../Images/09cc7b66952f0f0acf09ea65df3f8cd2.png" alt="React UI Process" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process-300x200.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="137197" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/react-ui-process/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png" data-orig-size="730,486" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React UI process" data-image-description="" data-image-caption="&lt;p&gt;Source: Lorenzo Sciandra&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png" decoding="async" loading="lazy" class="size-full wp-image-137197" src="../Images/09cc7b66952f0f0acf09ea65df3f8cd2.png" alt="React UI Process" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process-300x200.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-ui-process.png"/></noscript><figcaption id="caption-attachment-137197" class="wp-caption-text">Source: <a href="https://formidable.com/blog/2019/lean-core-part-4/" target="_blank" rel="noopener">Lorenzo Sciandra</a></figcaption></figure>
<p>如图所示，有四个部分:</p>
<ul>
<li><strong> React code </strong>:这是开发人员编写的代码</li>
<li><strong> JavaScript翻译层</strong>:这个组件将React代码翻译成JavaScript</li>
<li><strong>桥</strong>:当编译器翻译完所有代码后，桥将JavaScript代码翻译成本机(主机操作系统)特定的指令</li>
<li><strong>本机</strong>:在设备上运行的本机平台代码</li>
</ul>
<p>虽然这种方法如预期的那样工作，但是有一个主要缺陷:JavaScript和本地组件通过桥由异步JSON消息进行通信。有时，网桥传输消息很慢，从而导致性能问题。</p>
<p>为了解决这个问题，脸书构建了一个名为Fabric的新渲染器。它包含许多好处，其中包括:</p>
<ul>
<li>增强了主机和React视图之间的互操作性:这意味着编译器现在可以以同步的方式呈现UI组件。以前，React会异步呈现小部件。结果，这导致了渲染错误</li>
<li><strong>与<a href="https://reactjs.org/blog/2019/11/06/building-great-user-experiences-with-concurrent-mode-and-suspense.html" target="_blank" rel="noopener">React suspension</a></strong>的集成:这使得数据获取过程更加容易和健壮。</li>
<li><strong>类型安全保证</strong>:在幕后，库使用代码生成来检查JavaScript组件和主机平台代码之间的不匹配。因此，这提高了稳定性，减少了运行时出错的机会</li>
<li>更快的启动速度:React现在可以比以前更快的渲染主机组件。这可以通过延迟初始化来实现</li>
</ul>
<p>在本文的后面，我们将介绍如何迁移我们的代码库以使用Fabric架构。</p>
<h3 id="ending-support-for-reanimated-1">结束对复活1的支持</h3>
<p>该团队已经移除了对已弃用的Reanimated 1 API的支持。这样做的原因是将Fabric移植到旧的API意味着太多的工作。因此，这意味着使用遗留版本的项目将无法在最新版本的Reanimated上运行。</p>
<p>如果您的应用程序依赖于传统API，您可以采取以下步骤:</p>
<ul>
<li>替换使用旧版本的依赖项</li>
<li>升级依赖项。这样，您也可以提高应用程序的性能和安全性</li>
<li>将代码重构为新的API。因此，您的代码将会更加清晰易读</li>
</ul>
<h3 id="building-for-android">为Android构建</h3>
<p>从Reanimated 3开始，这个库将不会为Android提供预构建的二进制文件。这意味着开发人员需要在构建他们的应用程序之前预装Android NDK。然而，在大多数情况下，这不是一个问题，因为Android Studio已经捆绑了NDK。</p>
<p><img data-attachment-id="137199" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/bundle-in-android-studio/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png" data-orig-size="730,373" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Bundle in Android Studio" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio-300x153.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png" decoding="async" class="aligncenter size-full wp-image-137199 jetpack-lazy-image" src="../Images/ae0a09a1118e81c721494981fc0a0284.png" alt="Bundle in Android Studio" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio-300x153.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137199" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/bundle-in-android-studio/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png" data-orig-size="730,373" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Bundle in Android Studio" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio-300x153.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-137199" src="../Images/ae0a09a1118e81c721494981fc0a0284.png" alt="Bundle in Android Studio" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio-300x153.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/bundle-in-android-studio.png"/></noscript>
<p>此外，值得注意的是，开发人员必须从源代码编译动画的C++代码。我们将在迁移过程中详细介绍这一点。</p>
<h2 id="migrating-to-reanimated-v3">迁移到重新激活的v3</h2>
<h3 id="project-setup">项目设置</h3>
<p>首先，初始化一个空白的React本地项目，如下所示:</p>
<pre class="language-bash hljs">npx react-native init reactAnimatedNew #initialize the project
cd reactAnimatedNew #navigate into project directory
</pre>
<p>接下来，安装react-native-reanimated的最新版本:</p>
<pre class="language-bash hljs">npm install <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1c6e797d7f6831727d68756a79316e797d7275717d6879785c72796468">[email protected]</a>
#make sure that '@next is appended, otherwise NPM will install version 2!
</pre>
<p>完成后，现在让我们告诉React我们想要使用Fabric渲染器，而不是它的遗留对应物。</p>
<h3 id="switching-to-fabric">切换到结构</h3>
<p>在这一部分，我们将介绍如何在我们的项目中集成Fabric。</p>
<p>要构建Android，首先导航到<code>android/gradle.properties</code>。在这里，找到<code>newArchEnabled</code>属性并将其设置为<code>true</code>:</p>
<pre>#in android/gradle.properties:
newArchEnabled=true
</pre>
<p>我们已经指示编译器为Android启用Fabric。<br/>对于iOS，在您的终端中运行以下命令:</p>
<pre class="language-bash hljs">cd ios
#change the flag that enables/disables Fabric:
RCT_NEW_ARCH_ENABLED=1 bundle exec pod install 
</pre>
<p>让我们看看是否一切正常！要构建您的项目，请运行以下终端命令:</p>
<pre class="language-bash hljs">npx react-native run-android
#in a new terminal window:
npx react-native start
</pre>
<p>需要注意的一点是，与以前的版本不同，这个库将从源代码编译Hermes。这意味着我们项目的构建时间将会增加。</p>
<p><img data-attachment-id="137201" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/react-native-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png" data-orig-size="315,540" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React Native dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard-175x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png" decoding="async" class="aligncenter size-full wp-image-137201 jetpack-lazy-image" src="../Images/882efac4ce169a3b49bd54a87c703b5c.png" alt="React Native Dashboard" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png 315w, https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard-175x300.png 175w" data-lazy-sizes="(max-width: 315px) 100vw, 315px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137201" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/react-native-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png" data-orig-size="315,540" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React Native dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard-175x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-137201" src="../Images/882efac4ce169a3b49bd54a87c703b5c.png" alt="React Native Dashboard" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png 315w, https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard-175x300.png 175w" sizes="(max-width: 315px) 100vw, 315px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/react-native-dashboard.png"/></noscript>
<h3 id="creating-an-animation">创建动画</h3>
<p>现在我们已经使用Fabric构建了我们的项目，让我们构建一个简单的动画。</p>
<p>为此，创建一个名为<code>AnimatedRenderer.js</code>的文件。这里，从编写以下代码开始:</p>
<pre class="language-javascript hljs">import Animated, {
  useSharedValue,
  useAnimatedStyle,
  withSpring,
} from "react-native-reanimated";
import { Button, View, Text } from "react-native";
export default function AnimationRenderer() {
  const height = useSharedValue(20); //this value is shared between worker threads
  const animatedStyles = useAnimatedStyle(() =&gt; {
    return {
      height: height.value, //change the height property of the component
    };
    return (
      &lt;View&gt;
        &lt;Animated.View style={[{backgroundColor: 'blue'}, animatedStyles]}&gt;
          &lt;Text&gt; This text space will expand&lt;/Text&gt;
        &lt;/Animated.View&gt;
    {/* When clicked, increment the shared value*/}
    {/* this will increase the height of the component.*/}    
      &lt;Button
          onPress={() =&gt; (height.value = height.value + 1)}
          title="Increase" //when clicked, increment 'height'
        /&gt;
      &lt;/View&gt;
    );
  });
}
</pre>
<p>从这段代码中可以得出一些推论:</p>
<ul>
<li>我们创建了一个偏移量变量，它是<code>useSharedValue</code>钩子的一个实例。这让我们能够建立生动的价值观</li>
<li>随后，我们使用<code>useAnimatedStyles</code>钩子告诉React我们想要制作高度属性的动画</li>
<li>最后，出于动画的目的，我们将我们的<code>animatedStyles</code>变量附加到我们的<code>Animated.View</code>组件上</li>
</ul>
<p>最后一步，我们剩下的就是将自定义组件呈现到UI上。为此，修改您的<code>App.js</code>文件，如下所示:</p>
<pre class="language-javascript hljs">//App.js
import React from "react";
import { SafeAreaView } from "react-native";
import AnimationRenderer from "./AnimationRenderer";
export default function App() {
  return (
    &lt;SafeAreaView style={backgroundStyle}&gt;
      &lt;AnimationRenderer /&gt; {/*render our custom component to the DOM */}
    &lt;/SafeAreaView&gt;
  );
}
</pre>
<p><img data-attachment-id="137203" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/text-space-increase/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase.gif" data-orig-size="429,886" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Text space increase" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase-145x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase.gif" decoding="async" class="aligncenter size-full wp-image-137203 jetpack-lazy-image" src="../Images/bcd69547577aabc3076d87d9300bc9d6.png" alt="Text Space Increase" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137203" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/text-space-increase/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase.gif" data-orig-size="429,886" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Text space increase" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase-145x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-137203" src="../Images/bcd69547577aabc3076d87d9300bc9d6.png" alt="Text Space Increase" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-increase.gif"/></noscript>
<p>注意我们的动画是抖动的。为了平滑它，我们可以使用<code>withSpring</code>方法:</p>
<pre class="language-javascript hljs">//AnimationRenderer.js:
&lt;Button
  onPress={() =&gt; (offset.value = withSpring(offset.value + 10))}
  title="Increase"
/&gt;;
</pre>
<p>这会产生更流畅的动画:</p>
<p><img data-attachment-id="137205" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/text-space-expand/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand.gif" data-orig-size="429,886" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Text space expand" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand-145x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand.gif" decoding="async" class="aligncenter size-full wp-image-137205 jetpack-lazy-image" src="../Images/d58c9bfe969a5cd822356d8f6af33cc5.png" alt="Text Space Expand" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137205" data-permalink="https://blog.logrocket.com/smooth-animations-react-native-reanimated-3/attachment/text-space-expand/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand.gif" data-orig-size="429,886" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Text space expand" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand-145x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-137205" src="../Images/d58c9bfe969a5cd822356d8f6af33cc5.png" alt="Text Space Expand" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/text-space-expand.gif"/></noscript>
<h2 id="conclusion">结论</h2>
<p>重新激活的库有以下选择:</p>

<p>尽管它们更容易使用，但Reanimated允许通过<a href="https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/worklets" target="_blank" rel="noopener"> worklets </a>进行更细粒度的控制和性能。此外，借助Fabric支持，该库带来了更高的安全性和快速性。当谈到个人项目时，Reanimated一直是我的武器库的一部分。</p>
<p>非常感谢您的阅读！</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现React原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款React原生监控解决方案，可帮助您即时重现问题、确定bug的优先级并了解React原生应用的性能。</p><p>LogRocket还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的React原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>