<html>
<head>
<title>Using Google Places autocomplete components in React Native - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在React Native - LogRocket博客中使用Google Places自动完成组件</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/google-places-autocomplete-components-react-native/#0001-01-01">https://blog.logrocket.com/google-places-autocomplete-components-react-native/#0001-01-01</a></blockquote><div><article class="article-post">
<p>谷歌为访问其地图服务提供了大量API，其中之一是<a href="https://developers.google.com/maps/documentation/places/web-service/overview" target="_blank" rel="noreferrer noopener"> Places API </a>。Places API主要为您提供使用HTTP请求的位置信息。你可以得到你需要的关于当地地址、城镇、城市、地区、餐馆或任何其他地方的所有信息，包括它的坐标。</p>
<p>Places API包含了大量的特性，比如返回与搜索字符串相关的地点列表，提供一个地点的照片等等。它最常用和最需要的特性之一是自动完成服务。</p>
<p>使用autocomplete服务，Google可以通过API自动填写被搜索地点的地址或名称。因此，例如，当您的用户键入他们想要点餐的餐馆名称时，您可以根据他们键入的内容向他们提供建议。</p>
<p>在本文中，我们将了解如何在React Native中使用自动完成服务。然而，我们不必直接使用位置API，因为<a href="https://www.npmjs.com/package/react-native-google-places-autocomplete" target="_blank" rel="noreferrer noopener">一个名为</a> <code><a href="https://www.npmjs.com/package/react-native-google-places-autocomplete" target="_blank" rel="noreferrer noopener">react-native-google-places-autocomplete</a></code>的React本地包可以为我们处理这些。</p>
<p>因此，让我们看看如何在React原生项目中使用<code>react-native-google-places-autocomplete</code>包，以及它的一些关键功能，以及如何定制它以适应我们的项目。我们将涵盖:</p>

<h2 id="setting-up-google-places-api">设置Google Places API</h2>
<p><code>react-native-google-places-autocomplete</code>包只是一个访问位置API的媒介。如果不首先设置一个Google Cloud项目来使用Places API，它将无法工作。所以，让我来告诉你如何用四个步骤来做到这一点:</p>
<ol>
<li>创建项目</li>
<li>启用计费</li>
<li>启用必需的API</li>
<li>创建API密钥</li>
</ol>
<p>让我们从创建一个谷歌云项目开始。</p>
<h3 id="creating-google-cloud-project">创建谷歌云项目</h3>
<p>没有谷歌云项目，我们无法使用任何谷歌API服务。前往<a href="https://console.cloud.google.com" target="_blank" rel="noreferrer noopener">谷歌云控制台</a>并注册，如果你还没有。</p>
<p><img data-attachment-id="130514" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img1-google-cloud-console-landing-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png" data-orig-size="730,336" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Google-Cloud-Console-landing-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page-300x138.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png" decoding="async" class="aligncenter size-full wp-image-130514 jetpack-lazy-image" src="../Images/a427b7f4804ca20a7f39d2a373405a9c.png" alt="Google Cloud Console Landing Page With Welcome Message" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page-300x138.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130514" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img1-google-cloud-console-landing-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png" data-orig-size="730,336" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Google-Cloud-Console-landing-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page-300x138.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130514" src="../Images/a427b7f4804ca20a7f39d2a373405a9c.png" alt="Google Cloud Console Landing Page With Welcome Message" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page-300x138.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img1-Google-Cloud-Console-landing-page.png"/></noscript>
<p>您将进入上图所示的页面。如果您以前没有创建过项目，请点按“创建或选择项目”按钮。会立即弹出一个模态。点击右上角的“新建项目”。</p>
<p>将加载一个新页面，要求您输入项目的名称和位置——“位置”意味着项目应该属于哪个组织。您可以将位置保留为“无组织”,只需输入项目的名称。</p>
<p>最后，单击“创建”来创建项目。然后，您可以选择项目或访问<a href="https://console.cloud.google.com/cloud-resource-manager" target="_blank" rel="noreferrer noopener">项目页面</a>查看您的项目列表。</p>
<h3 id="enabling-billing-google-places-api">为Google Places API启用计费</h3>
<p>Google Places API不是永远免费的。谷歌使用的是<a href="https://developers.google.com/maps/documentation/places/web-service/usage-and-billing" target="_blank" rel="noreferrer noopener">现收现付定价模式</a>。但是每个月你的前两个请求都是免费的。</p>
<p>谷歌强制要求你在使用Places API之前<a href="https://console.cloud.google.com/projectselector2/billing/enable" target="_blank" rel="noreferrer noopener">为你的项目启用计费</a>。</p>
<p>前往<a href="https://console.cloud.google.com/projectselector2/billing/enable" target="_blank" rel="noreferrer noopener">计费页面</a>，选择您想要启用计费的项目。将弹出一个模式，如果您还没有，只需点击“创建计费帐户”。</p>
<p>按照谷歌官方指南创建一个付费账户。</p>
<h3 id="enabling-required-apis">启用必需的API</h3>
<p>您只需要启用Places API和Geocoding API来使用<code>react-native-google-places-autocomplete</code>包。让我们接下来做那件事。</p>
<p>打开您的<a href="https://console.cloud.google.com/apis/dashboard" target="_blank" rel="noreferrer noopener">项目仪表板</a>，它应该是这样的:</p>
<p><img data-attachment-id="130517" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img2-google-cloud-console-project-dashboard-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png" data-orig-size="730,327" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Google-Cloud-Console-project-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard-300x134.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png" decoding="async" class="aligncenter size-full wp-image-130517 jetpack-lazy-image" src="../Images/ca8d810ac5768456c2b53c96a070746d.png" alt="Google Cloud Console Project Dashboard With Thirty-Day View And No Data Shown" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard-300x134.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130517" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img2-google-cloud-console-project-dashboard-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png" data-orig-size="730,327" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Google-Cloud-Console-project-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard-300x134.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130517" src="../Images/ca8d810ac5768456c2b53c96a070746d.png" alt="Google Cloud Console Project Dashboard With Thirty-Day View And No Data Shown" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard-300x134.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img2-Google-Cloud-Console-project-dashboard.png"/></noscript>
<p>如果它看起来不像上面的图片，确保侧边栏的“启用APIs &amp;服务”被选中。接下来点击导航栏上的“启用API和服务”。它会将您带到API库页面:</p>
<p><img data-attachment-id="130520" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img3-api-library-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png" data-orig-size="730,336" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="API-Library-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page-300x138.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png" decoding="async" class="aligncenter size-full wp-image-130520 jetpack-lazy-image" src="../Images/9605ee56e398226da475f0ee24db8f11.png" alt="Google Cloud Console Api Library Page With Welcome Message And Search Bar" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page-300x138.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130520" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img3-api-library-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png" data-orig-size="730,336" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="API-Library-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page-300x138.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130520" src="../Images/9605ee56e398226da475f0ee24db8f11.png" alt="Google Cloud Console Api Library Page With Welcome Message And Search Bar" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page-300x138.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img3-API-Library-page.png"/></noscript>
<p>搜索“Places API”并单击结果。下一页包含关于Places API的信息，包括价格信息和为您的项目启用API的按钮。点击“启用”按钮，就可以了。</p>
<p>如果您尚未为项目启用计费，当您尝试启用地点API时，系统会提示您这样做。</p>
<p>之后，返回到<a href="https://console.cloud.google.com/apis/library" target="_blank" rel="noreferrer noopener"> API库页面</a>并启用地理编码API。</p>
<h3 id="creating-api-key">创建API密钥</h3>
<p>这是我们使用该软件包之前必须采取的最后一步。转到您的<a href="https://console.cloud.google.com/apis/dashboard" target="_blank" rel="noreferrer noopener">API仪表板</a>。在左侧栏，选择“凭证”选项。</p>
<p><img data-attachment-id="130522" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img4-apis-dashboard-credentials-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png" data-orig-size="730,336" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="APIs-dashboard-Credentials-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page-300x138.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png" decoding="async" class="aligncenter size-full wp-image-130522 jetpack-lazy-image" src="../Images/8dded088c66d36f64f98b6ab514742ca.png" alt="Google Cloud Console Apis And Services Dashboard With Credentials Selected From Left Sidebar Menu And Reminder Message To Configure Oauth Consent Screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page-300x138.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130522" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img4-apis-dashboard-credentials-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png" data-orig-size="730,336" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="APIs-dashboard-Credentials-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page-300x138.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130522" src="../Images/8dded088c66d36f64f98b6ab514742ca.png" alt="Google Cloud Console Apis And Services Dashboard With Credentials Selected From Left Sidebar Menu And Reminder Message To Configure Oauth Consent Screen" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page-300x138.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img4-APIs-dashboard-Credentials-page.png"/></noscript>
<p>点击顶部导航栏的“创建凭证”，然后选择“API密钥”这将为您的项目创建一个API密钥。使用这个API密钥，您只能访问您已经启用的API。复制API密钥并将其存储在安全的地方。</p>
<p>您可能会注意到API键旁边有一个警告图标。重要的是你要注意它。谷歌建议你<a href="https://cloud.google.com/api-keys/docs/add-restrictions-api-keys" target="_blank" rel="noreferrer noopener">将你的API密匙</a>仅限于你的应用程序。否则，如果你不能保密你的API密匙，这个API密匙对其他任何应用程序或网站都是无用的。</p>
<p>这主要用于生产目的。因为我们只打算测试<code>react-native-google-places-autocomplete</code>包的特性，所以没有必要限制这个键。</p>
<h2 id="using-react-native-google-places-autocomplete">使用<code>react-native-google-places-autocomplete</code></h2>
<p>npm包提供了使用Google Places自动完成服务的可定制组件。</p>
<p>它还使用<a href="https://developers.google.com/maps/documentation/places/web-service/details" target="_blank" rel="noreferrer noopener"> Places Details </a>服务来提供关于搜索地点的更多细节，包括用户评论和坐标，以及用于将可读地址转换为几何坐标的<a href="https://developers.google.com/maps/documentation/geocoding/overview" target="_blank" rel="noreferrer noopener">地理编码API </a>，反之亦然。</p>
<p>要跟随本文并查看这个包的工作情况，请设置一个React原生项目。</p>
<h3 id="setting-up-react-native-project">设置React本地项目</h3>
<p>对于我们的React Native项目示例，我们将为美食家创建一个查找就餐地点的应用程序。我们不会经历构建应用程序的每一步，因为本文的主要焦点是展示一些如何使用<code>react-native-google-places-autocomplete</code>包的例子。</p>
<p>前往您的终端，运行以下命令:</p>
<pre class="language-bash hljs">npx react-native init Foodies</pre>
<p>如果在使用上面的命令创建React本地项目时遇到了<code><a href="https://stackoverflow.com/questions/72768245/typeerror-cli-init-is-not-a-function-for-react-native" target="_blank" rel="noreferrer noopener">TypeError: cli.init is not a function</a></code>问题，卸载全局<code>react-native-cli</code>和<code>react-native</code>。现在只重装全局<code>react-native</code>。</p>
<p>现在让我们安装依赖项。我们现在只需要一个依赖项:包<code>react-native-google-places-autocomplete</code>。</p>
<pre class="language-bash hljs">npm install react-native-google-places-autocomplete</pre>
<p>该包提供了一个组件，其中包含了我们在应用程序中使用和定制Places API所需的一切。让我们看一个基本的例子:</p>
<pre class="language-javascript hljs">import {GooglePlacesAutocomplete} from 'react-native-google-places-autocomplete';
import {apiKey} from './config'; // your google cloud api key

const App = () =&gt; {
  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        query={{key: apiKey}}
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};</pre>
<p>让我们回顾一下上面例子中的一些重要部分。</p>
<p><code>GooglePlacesAutocomplete</code>是用户输入地名的文本输入表单。当用户输入时，一个基于用户输入内容的建议地点的模型将作为下拉菜单出现。</p>
<p>查询属性是唯一必需的属性；没有它的key属性，autocomplete包将不能使用Places API。您需要导入您的API密钥并在这里使用它。此外，不要忘记在您的云项目上启用计费，以使用地点和地理编码API。</p>
<p>将敏感信息存储在React原生项目中并不安全。让我们讨论一下如何保护您的API密钥。</p>
<h3 id="securing-api-key">保护您的API密钥</h3>
<p>非常重要的一点是，不要将API键存储在React原生项目中。任何拥有你的应用捆绑包的人都可以访问你的API密匙，所以这不是一个安全的存储方法。</p>
<p>您可以通过使用服务器存储您的API密钥来解决这个问题。这样，当用户打开应用程序时，您只需向服务器请求获取API密钥。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>还有一些措施来保护服务器中的API密钥。<a href="https://www.youtube.com/watch?v=ZGymN8aFsv4&amp;t=1384s" target="_blank" rel="noreferrer noopener"> Brad Traversy关于保护API密钥的视频</a>演示了如何做到这一点。</p>
<h3 id="handling-responses-google-places-api">处理来自Google Places API的响应</h3>
<p>来自Google Places API的第一组响应是自动完成建议。<code>react-native-google-places-autocomplete</code>包处理这组响应，所以我们不必担心它们。</p>
<p>但是，用户事件还会触发其他响应。例如，当按下建议的地址时，用户的输入不会返回任何更多的建议(即未找到地点)。这些回复必须由我们来处理。</p>
<p>同样，autocomplete包通过提供事件道具来处理这些响应，为我们完成了困难的部分。让我们来看一个例子:</p>
<pre class="language-javascript hljs">const App = () =&gt; {
  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        query={{key: apiKey}}
        fetchDetails={true}
        onPress={(data, details = null) =&gt; console.log(data, details)}
        onFail={error =&gt; console.log(error)}
        onNotFound={() =&gt; console.log('no results')}
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};</pre>
<p>这些引入的新道具——<code>onPress</code>、<code>onFail</code>和<code>onNotFound</code>——至关重要。当像这样使用Places API的包时，您可以使用这些道具来回答如下问题:</p>
<ul>
<li>当用户点击一个建议时会发生什么？</li>
<li>当搜索字符串没有结果时会发生什么？</li>
<li>当从API获取数据失败时会发生什么？</li>
</ul>
<p>autocomplete包提供了用props回答这些问题的方法。由我们来用自定义函数处理响应。好吧，让我们一个接一个地解决这些问题。</p>
<h4>当用户点击一个建议时会发生什么？</h4>
<p>当用户点击一个建议时，关于所选地点的信息将作为参数传入函数，然后传入<code>onPress</code> prop。上例中的两个参数——<code>data</code>和<code>details</code>——都构成了关于地点的信息。</p>
<p><code>data</code>参数返回关于地点的基本信息对象，如描述或地址名称、国家、城市和其他细节。</p>
<p>如果<code>fetchDetails</code>属性是<code>false</code>，那么<code>details</code>参数将返回与数据对象相同的对象。</p>
<p>默认情况下，<code>fetchDetails</code>属性设置为<code>false</code>，但是当设置为<code>true</code>时，<code>details</code>参数给出了包括几何图形在内的更详细的位置信息。谷歌在他们的文档中提供了一个<a href="https://developers.google.com/maps/documentation/places/web-service/details#PlaceDetailsResponses" target="_blank" rel="noreferrer noopener">完整地点细节回复</a>的例子。</p>
<h4>当搜索字符串没有结果时会发生什么？</h4>
<p>很有可能用户有时会键入一个搜索字符串，但没有收到任何结果。使用<code>onNotFound</code>道具，我们可以在整个项目中创造出没有结果的意识。然后，在您的应用程序中，您可以根据这个响应来处理它应该如何显示，或者应该或不应该发生什么。</p>
<p>例如，我们可以禁用所有其他功能(比如继续订购食物的下一步)并显示一条自定义消息，指示没有结果。</p>
<p>或者，如果您只想提醒用户，而不想对应用程序中其他地方缺少结果做任何特殊处理，您可以使用<code><a href="https://reactnative.dev/docs/flatlist#listemptycomponent" target="_blank" rel="noreferrer noopener">FlatList listEmptyComponent</a></code> prop在没有找到结果时提醒用户。</p>
<p>您可以通过传入组件或元素来实现这一点，如下所示:</p>
<pre class="language-javascript hljs">const App = () =&gt; {
  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        onPress={(data, details = null) =&gt; console.log(data, details)}
        query={{key: apiKey}}
        fetchDetails={true}
        onFail={error =&gt; console.log(error)}
        onNotFound={() =&gt; console.log('no results')}
        listEmptyComponent={() =&gt; (
          &lt;View style={{flex: 1}}&gt;
            &lt;Text&gt;No results were found&lt;/Text&gt;
          &lt;/View&gt;
        )}
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};</pre>
<p>由于上面的代码，如果用户输入没有结果的内容，文本“No results found”将显示在搜索栏下。</p>
<p><img data-attachment-id="130524" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img5-foodie-app-no-results-found/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found.gif" data-orig-size="389,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Foodie-app-no-results-found" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found-160x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found.gif" decoding="async" class="aligncenter size-full wp-image-130524 jetpack-lazy-image" src="../Images/76d9e7b7647f38faf99790fb4604e032.png" alt="Foodie App Frontend Shown With Cursor Shown Typing In Search Bar For Unknown Place And Message Displayed Saying No Results Were Found" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130524" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img5-foodie-app-no-results-found/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found.gif" data-orig-size="389,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Foodie-app-no-results-found" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found-160x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130524" src="../Images/76d9e7b7647f38faf99790fb4604e032.png" alt="Foodie App Frontend Shown With Cursor Shown Typing In Search Bar For Unknown Place And Message Displayed Saying No Results Were Found" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img5-Foodie-app-no-results-found.gif"/></noscript>
<h4>当从API获取数据失败时会发生什么？</h4>
<p>从Places API获取数据有时也很可能导致错误。例如，Places API可能会抛出自己的错误，因为您的Google Cloud项目或账单地址存在配置问题。</p>
<p>无论是使用地点API还是地理编码API，当API出错时,<code>onFail</code>属性都会返回一个错误。</p>
<p>您可能会遇到的一个非常常见的问题是，当您的项目没有启用计费时，或者在进行必要的计费时出现其他问题。</p>
<h3 id="searching-predefined-places">使用预定义的地点进行搜索</h3>
<p>您可以使用用户最喜欢或最常去的地方作为<code>GooglePlacesAutocomplete</code>组件的预定义地点。</p>
<p>预定义的地点包含一个带有该地点信息的地址。您可以选择向用户显示您想要的地址或任何名称。</p>
<p>如果使用预定义的位置，当用户聚焦于文本输入来搜索地址时，预定义的选项将作为自动完成建议弹出。</p>
<p>下面介绍如何将<code>Dominos Pizza</code>和<code>Chicken Republic</code>两个位置设置为<code>favorite</code>类型的预定义位置:</p>
<pre class="language-javascript hljs">const App = () =&gt; {
  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        onPress={(data, details = null) =&gt; console.log(data, details)}
        query={{key: apiKey}}
        fetchDetails={true}
        onFail={error =&gt; console.log(error)}
        onNotFound={() =&gt; console.log('no results')}
        predefinedPlaces={[
          {
            type: 'favorite',
            description: 'Dominos Pizza',
            geometry: {location: {lat: 48.8152937, lng: 2.4597668}},
          },
          {
            type: 'favorite',
            description: 'Chicken Republic',
            geometry: {location: {lat: 48.8496818, lng: 2.2940881}},
          },
        ]}
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};</pre>
<p>在上面的代码中，描述是将向用户显示的名称。当选择任何预定义选项时，您为该地点创建的对象将返回该地点的<code>data</code>和<code>details</code>参数。</p>
<p>对象不仅限于类型、描述和几何图形。你可以添加更多关于这个地方的信息。</p>
<p>由于上面的代码，您应该看到这些<code>favorite</code>预定义的位置甚至在用户开始输入之前就作为建议出现了。请参见下面的结果:</p>
<p><img data-attachment-id="130526" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img6-foodie-app-saved-places-dominos-pizza-chicken-republic/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic.gif" data-orig-size="392,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic-161x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic.gif" decoding="async" class="aligncenter size-full wp-image-130526 jetpack-lazy-image" src="../Images/8ee2bda3983bc9e1d6ccd45671747d5f.png" alt="Foodie App Frontend Shown With Cursor Clicking Into Search Bar, Where Two Saved Places (Dominos Pizza and Chicken Republic) Showing Up Immediately, And Cursor Clicking On Dominos Pizza" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130526" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img6-foodie-app-saved-places-dominos-pizza-chicken-republic/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic.gif" data-orig-size="392,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic-161x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130526" src="../Images/8ee2bda3983bc9e1d6ccd45671747d5f.png" alt="Foodie App Frontend Shown With Cursor Clicking Into Search Bar, Where Two Saved Places (Dominos Pizza and Chicken Republic) Showing Up Immediately, And Cursor Clicking On Dominos Pizza" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img6-Foodie-app-saved-places-Dominos-Pizza-Chicken-Republic.gif"/></noscript>
<h3 id="using-custom-text-input-component">使用自定义文本输入组件</h3>
<p>默认情况下，<code>react-native-google-places-autocomplete</code>包使用<a href="https://blog.logrocket.com/complete-guide-textinput-react-native/" target="_blank" rel="noreferrer noopener"> React Native的</a> <code><a href="https://blog.logrocket.com/complete-guide-textinput-react-native/" target="_blank" rel="noreferrer noopener">TextInput</a></code>组件进行文本输入。然而，您不会被包的选择所束缚</p>
<p>有了<code>textInputProps</code>道具，你可以使用自己选择的任何定制组件，比如来自<a href="https://blog.logrocket.com/using-react-native-elements-a-cross-platform-ui-toolkit/" target="_blank" rel="noreferrer noopener">的<code>Input</code>React Native Elements</a>。</p>
<pre class="language-javascript hljs">import {GooglePlacesAutocomplete} from 'react-native-google-places-autocomplete';
import {apiKey} from './config'; // your google cloud api key
import {Input} from '@rneui/themed';

const App = () =&gt; {
  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        onPress={(data, details = null) =&gt; console.log(data, details)}
        query={{key: apiKey}}
        fetchDetails={true}
        onFail={error =&gt; console.log(error)}
        onNotFound={() =&gt; console.log('no results')}
        textInputProps={{
          InputComp: Input,
        }}
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};</pre>
<p><code>textInputProps</code>是文本输入组件的所有道具的一个对象。所以如果你用的是React Native的<code>TextInput</code>，你可以在这里使用它特有的道具。例如:</p>
<pre class="language-javascript hljs">const App = () =&gt; {
  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        onPress={(data, details = null) =&gt; console.log(data, details)}
        query={{key: apiKey}}
        fetchDetails={true}
        onFail={error =&gt; console.log(error)}
        onNotFound={() =&gt; console.log('no results')}
        textInputProps={{
          autoFocus: true,
          blurOnSubmit: false,
        }}
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};;</pre>
<p>上面在textInputProps中使用的道具都是针对<a href="https://blog.logrocket.com/complete-guide-textinput-react-native/" target="_blank" rel="noreferrer noopener"> React Native的</a> <code><a href="https://blog.logrocket.com/complete-guide-textinput-react-native/" target="_blank" rel="noreferrer noopener">TextInput</a></code>的。当您使用第三方库时，也会发生同样的事情。</p>
<h3 id="styling-googleplacesautocomplete-component">设计您的<code>GooglePlacesAutocomplete</code>组件</h3>
<p><code>GooglePlacesAutocomplete</code>组件的<a href="https://github.com/FaridSafi/react-native-google-places-autocomplete#default-styles" target="_blank" rel="noreferrer noopener">默认样式</a>样式良好，所以它们可能对你的应用足够了。</p>
<p>不过，您可以添加默认样式，使它们适合您的应用程序。您还可以完全摆脱默认样式，从头开始完全自定义样式。</p>
<p><code>GooglePlacesAutocomplete</code>组件有一个styles属性，用于设置所有组件的样式，从文本输入到下拉列表。让我们来看看它的实际应用:</p>
<pre class="language-javascript hljs">const App = () =&gt; {
  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        onPress={(data, details = null) =&gt; console.log(data, details)}
        query={{key: apiKey}}
        fetchDetails={true}
        onFail={error =&gt; console.log(error)}
        onNotFound={() =&gt; console.log('no results')}
        styles={{
          container: {
            flex: 0,
          },
          description: {
            color: '#000',
            fontSize: 16,
          },
          predefinedPlacesDescription: {
            color: '#3caf50',
          },
        }}
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};</pre>
<p><code>styles</code> prop是一个使用React Native的标准样式属性和值的对象。使用<code>styles</code>属性，您可以对组成<code>GooglePlacesAutocomplete</code>组件的不同部分进行样式化。</p>
<p>这些部分——比如文本输入、下拉容器、每个下拉元素等等——是<code>GooglePlacesAutocomplete</code>组件的子元素。例如，文本输入的样式如下所示:</p>
<pre class="language-javascript hljs">styles={
  textInput: {
   borderColor: 'orange',
   fontSize: 20
 }
}</pre>
<p>您应该尝试根据每个部分或属性的类型来设计它们的样式。例如，组件的容器是一个视图组件，因此应该将其样式化为视图组件。以下是所有<a href="https://github.com/FaridSafi/react-native-google-places-autocomplete#styling" target="_blank" rel="noreferrer noopener">部分/属性及其元素类型</a>的列表</p>
<h3 id="limiting-results-one-country">将结果局限于一个国家</h3>
<p>可以将<code>react-native-google-places-autocomplete</code>建议中显示的搜索结果限制在一个国家。因此，只有在特定国家符合用户搜索字符串的地方才会弹出。</p>
<p>使用查询属性中的component属性指定一个国家，如下所示:</p>
<pre class="language-javascript hljs">query={{key: apiKey, components: 'country:us'}}</pre>
<p><code>country:us</code>值仅仅表示美国。使用的是国名的缩写，而不是完整的名称。这里是受支持国家的<a href="https://developers.google.com/maps/coverage" target="_blank" rel="noreferrer noopener">列表。</a></p>
<p>使用query prop，您还可以用不同的语言提供结果。默认语言是英语，但是使用language属性，您可以在其ISO 639-1 代码中指定不同的<a href="https://en.wikipedia.org/wiki/ISO_639-1" target="_blank" rel="noreferrer noopener">语言。</a></p>
<pre class="language-javascript hljs">query={{key: apiKey, components: 'country:us', language: 'it'}}</pre>
<p>在上面的代码中，我们将<code>language</code>属性设置为<code>it</code>。这将提供意大利语的结果。如果您想提供其他语言的搜索结果，请查看<a href="https://developers.google.com/maps/faq#languagesupport" target="_blank" rel="noreferrer noopener">支持的语言及其代码列表</a>。</p>
<p>现在，如果用户开始搜索，搜索结果将以意大利语显示，并且只显示美国境内的选项。</p>
<p><img data-attachment-id="130528" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img7-foodie-app-search-results-italian-united-states/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png" data-orig-size="392,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Foodie-app-search-results-Italian-United-States" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States-161x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png" decoding="async" class="aligncenter size-full wp-image-130528 jetpack-lazy-image" src="../Images/dc5fe96ba044bf2847ff75e7d3e46eb6.png" alt="Foodie App Frontend With Partially Typed Search Phrase San In Search Bar And Dropdown Results Shown In Italian Located In United States" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png 392w, https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States-161x300.png 161w" data-lazy-sizes="(max-width: 392px) 100vw, 392px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="130528" data-permalink="https://blog.logrocket.com/google-places-autocomplete-components-react-native/attachment/img7-foodie-app-search-results-italian-united-states/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png" data-orig-size="392,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Foodie-app-search-results-Italian-United-States" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States-161x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-130528" src="../Images/dc5fe96ba044bf2847ff75e7d3e46eb6.png" alt="Foodie App Frontend With Partially Typed Search Phrase San In Search Bar And Dropdown Results Shown In Italian Located In United States" srcset="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png 392w, https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States-161x300.png 161w" sizes="(max-width: 392px) 100vw, 392px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/09/img7-Foodie-app-search-results-Italian-United-States.png"/></noscript>
<h3 id="fetching-input-value">提取输入值</h3>
<p><code>react-native-google-places-autocomplete</code>包提供的方法之一是<code>getAddressText</code>。该方法返回用户文本输入的值。</p>
<p>这种方法有很多用例。例如，当搜索未知地点时，以特殊方式显示用户的输入，或者如果搜索时出现错误，则重用用户的最后输入。</p>
<p>要使用该包提供的任何方法，我们首先必须使用React refs 引用<code>GooglePlacesAutocomplete</code>组件<a href="https://blog.logrocket.com/complete-guide-react-refs/" target="_blank" rel="noreferrer noopener">，就像这样:</a></p>
<pre class="language-javascript hljs">const App = () =&gt; {
  const placesRef = useRef();

  const getAddress = () =&gt; {
    console.log(placesRef.current?.getAddressText());
  };

  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        onPress={(data, details = null) =&gt; console.log(data, details)}
        query={{key: apiKey}}
        fetchDetails={true}
        onFail={error =&gt; console.log(error)}
        onNotFound={() =&gt; console.log('no results')}
        ref={placesRef}
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};</pre>
<p>其他有用的方法有:</p>
<ul>
<li><code>setAddressText</code>:改变文本输入的值</li>
<li><code>clear</code>:清除文本输入</li>
<li><code>isFocused</code>:如果文本输入被聚焦，返回true，否则返回false。</li>
<li><code>getCurrentLocation</code>:根据当前位置查询附近的地点。</li>
</ul>
<p>接下来我们来探讨一下如何使用<code>getCurrentLocation</code>。</p>
<h3 id="fetching-current-location">获取当前位置</h3>
<p><code>getCurrentLocation</code>方法根据用户的当前位置查询附近的地方。然而，这不是该软件包提供的唯一定位功能；它还可以获取用户的当前位置，就像获取一个地方的信息一样。</p>
<p>该软件包使用地理定位服务来查找用户的位置，并将其作为自动完成建议的一部分。选中时，将返回用户当前位置的详细信息。</p>
<p>为此，我们必须将<code>currentLocation</code>属性设置为<code>true</code>:</p>
<pre class="language-javascript hljs">const App = () =&gt; {
  return (
    &lt;SafeAreaView&gt;
      &lt;GooglePlacesAutocomplete
        placeholder="Type a place"
        onPress={(data, details = null) =&gt; console.log(data, details)}
        query={{key: apiKey}}
        fetchDetails={true}
        onFail={error =&gt; console.log(error)}
        onNotFound={() =&gt; console.log('no results')}
        currentLocation={true}
        currentLocationLabel="Your location!" // add a simple label
      /&gt;
    &lt;/SafeAreaView&gt;
  );
};</pre>
<p>这并不是一个全功能应用程序的全部设置。你还必须<a href="https://blog.logrocket.com/react-native-geolocation-a-complete-tutorial" target="_blank" rel="noreferrer noopener">安装一个类似<code><a href="https://www.npmjs.com/package/react-native-geolocation-service" target="_blank" rel="noreferrer noopener">react-native-geolocation-service</a></code>的地理定位服务提供商</a>。</p>
<p>此外，你需要要求你的用户<a href="https://www.npmjs.com/package/@react-native-community/geolocation" target="_blank" rel="noreferrer noopener">授予位置许可</a>来使用任何带有<code>react-native-google-places-autocomplete</code>的位置服务。然而，这些具体的步骤超出了本文的范围，本文主要关注的是<code>react-native-google-places-autocomplete</code>包。</p>
<h3>结论</h3>
<p>在本文中，我们看了如何为<code>react-native-google-places-autocomplete</code>包建立一个Google cloud项目。我们还通过这个包的道具和方法查看了大量的功能。</p>
<p>例如，我们研究了处理响应、保护API密钥、设计<code>GooglePlacesAutocomplete</code>组件的样式、将结果限制在一个国家、用不同的语言显示结果、使用像<code>getAddressText</code>这样的方法、使用自定义文本输入组件等等。</p>
<p>现在，该方案并不局限于我们在此列出的内容。你可以找到更多的<a href="https://github.com/FaridSafi/react-native-google-places-autocomplete#props" target="_blank" rel="noreferrer noopener">道具和方法</a>来帮助定制这个包，以适应你希望Google Places API在你的应用中的使用方式。</p>
<p>我希望你玩得开心。请在评论区告诉我你的想法。感谢您的阅读，祝您黑客生涯愉快。</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现React原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款React原生监控解决方案，可帮助您即时重现问题、确定bug的优先级并了解React原生应用的性能。</p><p>LogRocket还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的React原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>