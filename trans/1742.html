<html>
<head>
<title>Implementing React Native biometric authentication with Expo - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用 Expo - LogRocket 博客实现 React 原生生物认证</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/#0001-01-01">https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/#0001-01-01</a></blockquote><div><article class="article-post">
<p><strong> <em>编者的</em> </strong> <strong> <em>注</em> </strong> : <em>本 React 原生生物识别认证教程最后更新于 2022 年 2 月 11 日；更新了所有过时信息，并添加了使用<code>react-native-biometrics</code> 的</em> <em> <a href="#Using-react-native-biometrics">新章节。</a></em></p>
<p>在这个生物认证教程中，我们将向您展示如何在一个基本的 React Native 和 Expo 应用程序中使用 face ID 和 touch ID 来认证用户。</p>
<p>我们将使用 Expo SDK，<code>expo-local-authentication</code>，在我们的应用中实现生物认证。这使用平台 API 来访问设备硬件，因此没有机会从设备泄漏任何私人信息。</p>
<p>有了这个 SDK，我们将在 React 本地应用中实现面部识别和指纹扫描的本地身份验证。</p>
<p>在本教程的整个过程中，我们将涵盖:</p>

<p>我们开始吧！</p>
<h2 id="what-is-biometric-authentication">什么是生物认证？</h2>
<p>生物认证是一种多因素认证(MFA ),它利用从设备用户的生物特征(如面部特征、声音识别和指纹)中获得的数据来保护个人信息和敏感资产。</p>
<p>所有类型的移动应用程序都使用本地生物认证。生物认证最大的优点是它完全在用户的设备中执行，因此没有将敏感数据泄露给第三方 API 的风险。</p>
<p>除了验证用户身份，生物识别还可以作为传统登录方法(如电子邮件/密码)的附加安全层。</p>
<h2 id="implementing-biometric-authentication-expo-app">在 Expo 应用程序中实现生物认证</h2>
<p>为了开始我们的教程，让我们回顾一下在世博会应用中安装、导入和设置生物认证<a href="https://blog.logrocket.com/?post_type=post&amp;s=expo&amp;orderby=relevance&amp;order=DESC&amp;post_type=post">的步骤。我们从一个<code>expo-local-authentication</code>例子开始。</a></p>
<h3 id="Installing-expo-local-authentication">安装<code>expo-local-authentication</code></h3>
<p>首先，运行下面的命令来安装<code><a href="https://docs.expo.io/versions/v40.0.0/sdk/local-authentication/">expo-local-authentication</a></code> <a href="https://docs.expo.io/versions/v40.0.0/sdk/local-authentication/">库</a>:</p>
<pre class="language-bash hljs">// with yarn
yarn add expo-local-authentication


// with npm
npm install expo-local-authentication
</pre>
<p>接下来，通过将下面一行添加到要实现生物特征身份验证的 JavaScript 或 TypeScript 文件来导入包:</p>
<pre class="language-bash hljs">import * as LocalAuthentication from 'expo-local-authentication'
</pre>
<h3 id="Checking-device-compatibility">检查设备兼容性</h3>
<p>首先要检查设备硬件是否支持生物识别。我们将在页面挂载时使用我们刚刚导入的 Expo <code>LocalAuthentication</code>包提供的<code>hasHardwareAsync</code>方法:</p>
<pre class="language-javascript hljs">// wherever the useState is located 
const [isBiometricSupported, setIsBiometricSupported] = React.useState(false);

// Check if hardware supports biometrics
  useEffect(() =&gt; {
    (async () =&gt; {
      const compatible = await LocalAuthentication.hasHardwareAsync();
      setIsBiometricSupported(compatible);
    })();
  });

// In our JSX we conditionally render a text to see inform users if their device supports
 &lt;Text&gt; {isBiometricSupported ? 'Your device is compatible with Biometrics' 
    : 'Face or Fingerprint scanner is available on this device'}
        &lt;/Text&gt;
</pre>
<p><code>hasHardwareAsync</code>方法返回一个解析为布尔值<code>hasHardwareAsync(): Promise&lt;boolean&gt;</code>的承诺，表示用户的设备是否支持生物识别。</p>
<p>对于用户设备上没有生物识别支持的情况，您应该考虑启用替代方法(如密码)来鉴定用户。</p>
<h3 id="Checking-biometric-records">检查生物特征记录</h3>
<p>为了检查生物特征是否保存在用户的设备上，我们将使用<code>isEnrolledAsync</code>方法。该方法返回一个解析为布尔值的承诺，<code>isEnrolledAsync(): Promise&lt;boolean&gt;</code>:</p>
<pre class="language-javascript hljs">const handleBiometricAuth = async () =&gt; {
    const savedBiometrics = await LocalAuthentication.isEnrolledAsync();
      if (!savedBiometrics)
      return Alert.alert(
        'Biometric record not found',
        'Please verify your identity with your password',
        'OK',
        () =&gt; fallBackToDefaultAuth()
      );
}
</pre>
<p>请注意，当用户设备上没有面部识别或指纹功能的记录时，我们如何将应用程序设置为备用身份验证方法。</p>
<h2 id="How-biometric-authenticaition-works">生物认证的工作原理</h2>
<p>为了通过指纹扫描或 touch ID/face ID 实际验证用户，我们将使用<code>LocalAuthentication.authenticateAsync</code>方法。这将返回一个解析为包含<code>success</code>的对象的承诺，该对象可以是<code>true</code>或<code>false</code>。</p>
<p>下面是一个当<code>success</code>为<code>false</code>时返回的有效载荷的例子:</p>
<pre class="language-javascript hljs">Object {
    "error": "lockout",
    "message": "Too many attempts. Try again later.",
    "success": false,
  },
</pre>
<p><code>authenticateAsync</code>接受类型为<code>LocalAuthenticationOptions</code>的选项作为参数。以下是这些选项接受的内容:</p>
<pre class="language-javascript hljs">LocalAuthenticationOptions = {
    promptMessage?: string; 
    cancelLabel?: string;
    disableDeviceFallback?: boolean;
    fallbackLabel?: string;
  }
</pre>
<h3 id="promptmessage"><code>promptMessage</code></h3>
<p><code>promptMessage</code>是一条显示在 touch ID 或 face ID 提示旁边的消息:</p>
<p><img data-attachment-id="94842" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/prompt-message-shown-biometric-id-prompt/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg" data-orig-size="730,408" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Prompt message shown biometric ID prompt" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt-300x168.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg" decoding="async" class="aligncenter size-full wp-image-94842 jetpack-lazy-image" src="../Images/9cba45e47c0b7338768762c7a27a7671.png" alt="Prompt Message Shown Along Biometric ID Prompt" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt-300x168.jpeg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="94842" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/prompt-message-shown-biometric-id-prompt/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg" data-orig-size="730,408" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Prompt message shown biometric ID prompt" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt-300x168.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-94842" src="../Images/9cba45e47c0b7338768762c7a27a7671.png" alt="Prompt Message Shown Along Biometric ID Prompt" srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt-300x168.jpeg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Prompt-Message-Shown-Biometric-ID-Prompt.jpeg"/></noscript>
<h3 id="cancellabel"><code>cancelLabel</code></h3>
<p><code>cancelLabel</code>允许您自定义关闭生物识别提示的默认<code>Cancel</code>标签。注意默认的<code>Cancel</code>是如何变成<code>Close biometrics prompt</code>的。</p>
<p>为了在一些 Android 设备上工作，您可能需要将<code>disableDeviceFallback</code>设置为<code>true</code>。</p>
<p><img data-attachment-id="94844" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/cancel-label-customize-default-prompt-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg" data-orig-size="730,388" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Cancel label customize default prompt" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt-300x159.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg" decoding="async" class="aligncenter size-full wp-image-94844 jetpack-lazy-image" src="../Images/75f35e92cb89b516b974a97b31a7438c.png" alt="Cancel Label Customize Default Prompt" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt-300x159.jpeg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="94844" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/cancel-label-customize-default-prompt-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg" data-orig-size="730,388" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Cancel label customize default prompt" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt-300x159.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-94844" src="../Images/75f35e92cb89b516b974a97b31a7438c.png" alt="Cancel Label Customize Default Prompt" srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt-300x159.jpeg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Cancel-Label-Customize-Default-Prompt.jpeg"/></noscript>
<h3 id="disableDeviceFallback"><code>disableDeviceFallback</code></h3>
<p><code>disableDeviceFallback</code>让您能够决定在多次尝试面部识别或指纹识别后，应用程序是否应该使用设备密码来验证用户。该选项默认设置为<code>false</code>。</p>
<p>您可能需要将<code>disableDeviceFallback</code>选项设置为<code>true</code>，以便您的用户能够访问面部识别生物识别 API。</p>
<h3 id="fallbackLabel"><code>fallbackLabel</code></h3>
<p><code>fallbackLabel</code>允许您自定义默认密码标签。只有当<code>disableDeviceFallback</code>是<code>false</code>时才需要这个选项。</p>
<p>这里有一个如何使用<code>authenticateAsync</code>方法的例子:</p>
<pre class="language-javascript hljs">const handleBiometricAuth = async () =&gt; {  
  const biometricAuth = await LocalAuthentication.authenticateAsync({
        promptMessage: 'Login with Biometrics',
        disableDeviceFallback: true,
      });
}
</pre>
<h3 id="permissions">许可</h3>
<p>在 Android 设备上，权限是自动添加的。在 iOS 上，你需要将<code>infoPlist.NSFaceIDUsageDescription</code>添加到 Expo 应用程序的<code>app.json</code>文件中。</p>
<p>您必须将<code>NSFaceIDUsageDescription</code>放在 app.json 文件中的<code>ios.infoPlist.NSFaceIDUsageDescription</code>下。该值可能如下所示:</p>
<pre class="language-javascript hljs">APP_NAME needs to use Face ID / Touch ID to authenticate you
</pre>
<p><code>NSFaceIDUsageDescription</code>是一条消息，告诉用户为什么应用程序要求使用 face ID 进行身份验证。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自 LogRocket 的精彩文章:</h3>

<hr/></div>
<h2 id="How-implement-biometric-authentication-react-native">如何在 React Native 中实现生物认证？</h2>
<p>要在一个基本的 React 本地应用程序中使用这个包，安装<code><a href="https://docs.expo.io/bare/installing-unimodules/">react-native-unimodules</a></code>，它使您能够在 React 本地应用程序中使用 Expo 模块。</p>
<p>一旦您成功地安装了 React Native unimodule，您就可以像我们在 Expo 中那样实现本地认证了。</p>
<h3 id="permissions-react-native">React Native 中的权限</h3>
<p>对于 iOS，您需要将<code>NSFaceIDUsageDescription</code>添加到您的<code>info.plist</code>文件中:</p>
<pre class="language-javascript hljs">// info.plist
&lt;key&gt;NSFaceIDUsageDescription&lt;/key&gt;
&lt;string&gt;$(PRODUCT_NAME) Authentication with TouchId or FaceID&lt;/string&gt;
</pre>
<p>如果您的应用程序使用访问 face ID 的 API，则需要此项。</p>
<p>对于 Android，您需要将以下代码行添加到您的<code>AndroidManifest.xml</code>文件中:</p>
<pre class="language-javascript hljs">&lt;uses-permission android:name="android.permission.USE_BIOMETRIC" /&gt;
&lt;uses-permission android:name="android.permission.USE_FINGERPRINT" /&gt;
</pre>
<h2 id="using-react-native-biometrics">使用<code>react-native-biometrics</code></h2>
<p><a href="https://www.npmjs.com/package/react-native-biometrics"> <code>react-native-biometrics</code> </a>是一种更安全的生物认证处理方式，因为它同时使用了基于事件和基于结果的生物认证方法。</p>
<p>这意味着它不仅仅依靠从用户设备返回的一个<code>boolean</code>来完成像<code>react-native-touch-id</code>和<code>expo-local-authentication</code>这样的认证流程。</p>
<p>成功后，生物测定 API 检索密钥并将其返回给 React 本机应用程序；我们的应用程序现在可以将密钥发送到服务器进行身份验证，并在成功验证密钥后，授予用户对应用程序受保护部分的权限。</p>
<p>要将这个库集成到我们的 React 原生 app 中，创建一个裸露的 React 原生 app；如果您已有 React 本地应用，您可以跳过这一步:</p>
<pre class="language-bash hljs">npx react-native init NameOfYourApp
</pre>
<p>然后，在应用程序的根目录下运行以下命令来启动服务器:</p>
<pre class="language-bash hljs">npx react-native start
</pre>
<p>接下来，运行以下命令在 Android emulator 上启动应用程序:</p>
<pre class="language-bash hljs">npx react-native run-android
</pre>
<p>你应该让应用程序运行，如下图所示。如果你遇到错误，React Native 团队有一个关于如何设置开发环境的<a href="https://reactnative.dev/docs/environment-setup">指南</a>。</p>
<p><img data-attachment-id="94846" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/react-native-development-environment/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png" data-orig-size="345,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React Native development environment" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment-142x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png" decoding="async" class="aligncenter size-full wp-image-94846 jetpack-lazy-image" src="../Images/b75629264a7762d117ebf35418914394.png" alt="React Native Development Environment Welcome Screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png 345w, https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment-142x300.png 142w" data-lazy-sizes="(max-width: 345px) 100vw, 345px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="94846" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/react-native-development-environment/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png" data-orig-size="345,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React Native development environment" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment-142x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-94846" src="../Images/b75629264a7762d117ebf35418914394.png" alt="React Native Development Environment Welcome Screen" srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png 345w, https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment-142x300.png 142w" sizes="(max-width: 345px) 100vw, 345px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/React-Native-development-environment.png"/></noscript>
<p>让我们将这个包集成到我们的应用程序中。首先，在应用程序的根级别运行以下命令来安装它:</p>
<pre class="language-bash hljs">yarn add react-native-biometrics
#or
npm install react-native-biometrics
</pre>
<p>现在我们已经安装了它，让我们来看几个可用的方法。</p>
<h3 id="issensoravailable"><code>isSensorAvailable()</code></h3>
<p><code>isSensorAvailable()</code>方法检测用户设备中的生物识别支持是否可用。它返回一个解析为以下对象的<code>Promise</code>:</p>
<pre class="language-javascript hljs">interface IsSensorAvailableResult {
    available: boolean;
    biometryType?: 'TouchID' | 'FaceID' | 'Biometrics';
    error?: string;
}
</pre>
<p>让我们检查一下 Android 设备是否支持生物识别:</p>
<pre class="language-bash hljs">import ReactNativeBiometrics from 'react-native-biometrics';
&lt;</pre>
<p>这里，我们检查设备是否有生物特征记录，然后通过调用<code>ReactNativeBiometrics.Biometrics</code>方法检查可用的生物特征支持的类型:</p>
<pre class="language-javascript hljs"> const isBiometricSupport = async () =&gt; {
    let {available, biometryType} =
      await ReactNativeBiometrics.isSensorAvailable();
    if (available &amp;&amp; biometryType === ReactNativeBiometrics.Biometrics) {
      console.log('Biometrics is supported', biometryType);
    }
  };
  useEffect(() =&gt; {
    isBiometricSupport();
  }, []);
</pre>
<p>如果设备上有任何生物识别方法记录，如 face ID 或 touch ID，此方法将返回 true。</p>
<p>如果您想具体了解用户设备中可用的生物特征记录，请使用以下代码片段:</p>
<pre class="language-javascript hljs">  const isBiometricSupport = async () =&gt; {
    let {available, biometryType} =
      await ReactNativeBiometrics.isSensorAvailable();
    if (available &amp;&amp; biometryType === ReactNativeBiometrics.TouchID) {
      console.log('TouchID is supported', biometryType);
    } else if (available &amp;&amp; biometryType === ReactNativeBiometrics.FaceID) {
      console.log('FaceID is supported', biometryType);
    } else if (available &amp;&amp; biometryType === ReactNativeBiometrics.Biometrics) {
      console.log('Biometrics is supported', biometryType);
    } else {
      console.log('Biometrics not supported', biometryType);
    }
  };
  useEffect(() =&gt; {
    isBiometricSupport();
  }, []);
</pre>
<p>这将检查设备是否分别具有<code>TouchID</code>和<code>FaceID</code>。</p>
<p>请注意，<code>ReactNativeBiometrics.TouchID</code>和<code>ReactNativeBiometrics.FaceID</code>只在 iOS 上有效。对于安卓设备，使用<code>ReactNativeBiometrics.Biometrics</code>。</p>
<p>要对此进行测试，请检查控制台，看看有哪些日志记录。如果您在 Android 模拟器上运行，您需要在设备上注册生物识别。</p>
<p>为此，请转到<strong>设置</strong> &gt; <strong>安全</strong> &gt; <strong>指纹</strong>，然后添加图案或 pin，并在您的终端上运行以下命令来注册指纹。</p>
<p><img data-attachment-id="94849" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/enrolling-fingerprint/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png" data-orig-size="383,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Enrolling fingerprint" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint-157x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png" decoding="async" class="aligncenter size-full wp-image-94849 jetpack-lazy-image" src="../Images/8d78d3556d6c9a4194975c8749f13985.png" alt="Enrolling Fingerprint In React Native Development Environment" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png 383w, https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint-157x300.png 157w" data-lazy-sizes="(max-width: 383px) 100vw, 383px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="94849" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/enrolling-fingerprint/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png" data-orig-size="383,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Enrolling fingerprint" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint-157x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-94849" src="../Images/8d78d3556d6c9a4194975c8749f13985.png" alt="Enrolling Fingerprint In React Native Development Environment" srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png 383w, https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint-157x300.png 157w" sizes="(max-width: 383px) 100vw, 383px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Enrolling-fingerprint.png"/></noscript><br/>
<img decoding="async" src="../Images/2d15d29d8b23e01314df1c54cac9f5d9.png" alt="" data-lazy-src="/static/img/pixel.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/static/img/pixel.gif"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/2d15d29d8b23e01314df1c54cac9f5d9.png" alt="" data-original-src="https://blog.logrocket.com/static/img/pixel.gif"/></noscript>
<p>进入指纹屏幕后，多次运行以下命令来注册指纹:</p>
<pre class="language-javascript hljs">adb -e emu finger touch &lt;finger_id&gt;
Example: adb -e emu finger touch 5355aw3455
</pre>
<h3 id="simpleprompt"><code>simplePrompt()</code></h3>
<p><code>simplePrompt()</code>方法接受一个<code>promptMessage</code>和<code>cancelButtonText</code>参数，这些参数显示提示消息并取消您想要显示给用户的文本。它返回一个解析成功的<code>Promise</code>，一个布尔值和一个选项错误，如果出现错误，则返回一个字符串:</p>
<pre class="language-javascript hljs">  const isBiometricSupport = async () =&gt; {
    let {success, error} = await ReactNativeBiometrics.simplePrompt({
      promptMessage: 'Sign in with Touch ID',
      cancelButtonText: 'Close',
    });
    console.log({success, error});
  };
</pre>
<p>前面的代码将产生以下结果:</p>
<p><img data-attachment-id="94851" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/touch-id-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png" data-orig-size="730,565" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Touch ID screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen-300x232.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png" decoding="async" class="aligncenter size-full wp-image-94851 jetpack-lazy-image" src="../Images/f7179d494a39cd20c6df5b2dcc0365de.png" alt="Touch ID Screen With Fingerprint In Middle" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen-300x232.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="94851" data-permalink="https://blog.logrocket.com/implementing-react-native-biometric-authentication-expo/touch-id-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png" data-orig-size="730,565" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Touch ID screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen-300x232.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-94851" src="../Images/f7179d494a39cd20c6df5b2dcc0365de.png" alt="Touch ID Screen With Fingerprint In Middle" srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen-300x232.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/Touch-ID-screen.png"/></noscript>
<h2>结论</h2>
<p>本地认证有许多用例，我希望本教程能让您在 Expo 和 React 原生应用中更容易地实现指纹(touch ID)和面部识别(face ID)生物认证。</p>
<p>本教程中使用的完整代码可以在 GitHub <a href="https://github.com/ejirocodes/React-Native-Local-Authentication-using-Biometrics">这里</a>和<a href="https://github.com/ejirocodes/React_Native_Biometrics">这里</a>获得</p>
<p>请随意发表评论，让我知道你对这篇文章的看法。你也可以在<a href="https://twitter.com/ejirocodes"> Twitter </a>和<a href="https://github.com/ejirocodes"> GitHub </a>找到我。感谢您的阅读！</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现 React 原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款 React 原生监控解决方案，可帮助您即时重现问题、确定 bug 的优先级并了解 React 原生应用的性能。</p><p>LogRocket 还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket 的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的 React 原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用 LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>