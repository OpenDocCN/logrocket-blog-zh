<html>
<head>
<title>Using Firebase Emulator Suite and React for local-first development - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用 Firebase 仿真器套件和 React 进行本地开发</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/#0001-01-01">https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/#0001-01-01</a></blockquote><div><article class="article-post">
<h2>什么是 Firebase 模拟器？</h2>
<p><a href="https://firebase.google.com/docs/emulator-suite" target="_blank" rel="noopener"> Firebase Emulator </a>套件支持本地优先的开发工作流，这不仅非常适合原型开发，而且比直接与 Firebase 控制台通信更快，更安全，因为您的开发环境是完全隔离的(让您有机会测试边缘情况，而不用担心损坏或删除您的生产数据)，并且更便宜。</p>
<p>不管有多少开发人员在一个项目中工作，所有与 Firebase 的交互都是本地的。</p>
<h2>先决条件</h2>
<p>要使用本指南，您需要:</p>

<h2>如何将 Firebase 模拟器与 React 集成</h2>
<p>首先，使用<code>$ yarn create react-app todo &amp;&amp; cd my-app</code>创建一个<code>react-app</code>，并通过运行<code>$ yarn global add firebase-tools</code>来全局安装<code>firebase-tools</code>。跑<code>$ firebase login</code>认证自己。</p>
<p>要创建一个 Firebase 项目，运行<code>$ firebase projects:create</code>并输入一个惟一的 ID。您可以将您的 ID 存储在变量<code>$ fbid=your-unique-id-here</code>(可以用作<code>$fbid</code>)中。)</p>
<p>接下来，通过运行<code>$ firebase apps:create --project $fbid web my-app</code>在项目中创建一个 Firebase web 应用程序。</p>
<p>在 react 应用程序目录的根目录下，通过运行<code>$ firebase init firestore --project $fbid</code>来启用<a href="https://firebase.google.com/docs/firestore" target="_blank" rel="noopener"> Firestore </a>，这将出错并显示一个链接来启用 Firebase 控制台中的功能。这样做之后，重新运行<code>$ firebase init firestore --project $fbid</code>，这将创建几个文件。</p>
<p>做完这些，现在运行<code>$ firebase init emulators --project $fbid</code>并选择<code>Authentication</code>和<code>Firestore</code>仿真器。接受每个模拟器的默认端口，确保启用模拟器 UI，并下载模拟器。(同样，<a href="https://www.java.com/en/download/" target="_blank" rel="noopener"> Java </a>必须安装在您的系统上才能运行模拟器。)</p>
<p>将以下内容附加到您的<code>.gitignore</code>:</p>
<pre>firebase-debug.log*
firestore-debug.log*
ui-debug.log*
</pre>
<p>然后安装<code>firebase</code>作为依赖项。</p>
<pre>$ yarn add firebase
</pre>
<p>初始化 Firebase 项目和应用程序后，通过运行<code>$ firebase apps:sdkconfig --project $fbid &gt; src/firebase.js</code>将应用程序的配置放在<code>src/firebase.js</code>中，并编辑文件，如下所示:</p>
<pre>// src/firebase.js

import firebase from 'firebase/app';
import 'firebase/auth';
import 'firebase/firestore';

// TODO: Use a configuration object
firebase.initializeApp({
  projectId: '',
  appId: '',
  databaseURL: '',
  storageBucket: '',
  locationId: '',
  apiKey: '',
  authDomain: '',
  messagingSenderId: '',
});

const db = firebase.firestore();
const auth = firebase.auth;

// eslint-disable-next-line no-restricted-globals
if (location.hostname === 'localhost') {
  db.useEmulator('localhost', 8080);
  auth().useEmulator('http://localhost:9099/', { disableWarnings: true });
}

export default firebase;
export { db, auth };
</pre>
<p>值得注意的是，我们检查我们是否在<code>localhost</code>上，这包括<code>development</code>和<code>test</code>环境，并告诉<code>firebase.auth()</code>和<code>firebase.firestore()</code>到<code>useEmulator</code>。</p>
<p>在<code>auth</code> <code>useEmulator</code>调用中，我们禁用警告，警告您不要使用任何真实的凭据(例如，您的 Google 凭据)，因为您的应用程序和仿真器之间的数据是通过未加密的 HTTP 传输的。</p>
<h2>运行 Firebase 模拟器</h2>
<p>在两个独立的 shells 中，运行<code>$ yarn start</code>和<code>$ firebase emulators:start</code>。在<code><a href="http://localhost:4000/firestore" rel="nofollow">http://localhost:4000/firestore</a></code>打开 Firestore 模拟器 UI，应该是这样的:</p>
<p><img data-attachment-id="33076" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/firebase-emulator-suite-firestore-emulator/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Firebase Emulator suite in Firestore Emulator" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png" decoding="async" class="aligncenter size-full wp-image-33076 jetpack-lazy-image" src="../Images/ac24e43fbbaf53600c33ef99fd3473b6.png" alt="Firebase Emulator Suite in Firestore Emulator" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator-300x168.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="33076" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/firebase-emulator-suite-firestore-emulator/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Firebase Emulator suite in Firestore Emulator" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-33076" src="../Images/ac24e43fbbaf53600c33ef99fd3473b6.png" alt="Firebase Emulator Suite in Firestore Emulator" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator-300x168.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/firebase-emulator-suite-firestore-emulator.png"/></noscript>
<p>或者，您可以添加 npm 脚本<code>"emulators": "firebase emulators:start"</code>并使用<code>$ yarn emulators</code>来启动模拟器。</p>
<h2>模拟火风暴</h2>
<p>在<code>src/App.js</code>中，导入<code>db</code>并将一些数据写入 Firestore 仿真器:</p>
<pre>// src/App.js
import React from "react";
import { db } from "./firebase";

function App() {
  db.doc("hello/world").set({ hello: "world" });
  return &lt;div /&gt;;
}

export default App;
</pre>
<p><code>Firestore</code>选项卡现在应该有我们设置的数据了。如果没有，刷新页面或导航到标签页。</p>
<p><img data-attachment-id="33077" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/firestore-emulator-with-written-data/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Firestore Emulator with written data" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png" decoding="async" class="aligncenter size-full wp-image-33077 jetpack-lazy-image" src="../Images/b6b8f22ca1469e3d3d30f0ad1b722499.png" alt="Firestore Emulator With Written Data" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data-300x168.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="33077" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/firestore-emulator-with-written-data/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Firestore Emulator with written data" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-33077" src="../Images/b6b8f22ca1469e3d3d30f0ad1b722499.png" alt="Firestore Emulator With Written Data" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data-300x168.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/firestore-emulator-with-written-data.png"/></noscript>
<p>要从 Firestore Emulator 读取数据，请先在 UI 中输入数据。</p>
<p><img data-attachment-id="33075" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/writing-firestore-database-data-in-firestore-emulator/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator.gif" data-orig-size="730,418" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Writing Firestore Database data in Firestore Emulator UI" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator-300x172.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator.gif" decoding="async" class="aligncenter size-full wp-image-33075 jetpack-lazy-image" src="../Images/aae51f76ac6b6c71d369b03140ee1cca.png" alt="Writing Firestore Database Data in Firestore Emulator UI" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="33075" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/writing-firestore-database-data-in-firestore-emulator/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator.gif" data-orig-size="730,418" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Writing Firestore Database data in Firestore Emulator UI" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator-300x172.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-33075" src="../Images/aae51f76ac6b6c71d369b03140ee1cca.png" alt="Writing Firestore Database Data in Firestore Emulator UI" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/writing-firestore-database-data-in-firestore-emulator.gif"/></noscript>
<pre>// src/App.js

import React from 'react';
import { db } from './firebase';

function App() {
  const [data, setData] = React.useState();
  React.useEffect(() =&gt; {
    db.doc('people/me')
      .get()
      .then((data) =&gt; setData(data.data()));
  }, []);

  return &lt;p&gt;{data?.hungry ? "I'm hungry" : "I'm full"}!&lt;/p&gt;;
}

export default App;
</pre>
<p>快速提示:您可以运行任何 Firestore 方法，并直接从开发工具与您的本地 Firestore 实例进行交互。</p>
<h2>从实时数据库模拟器 UI 导入和导出数据</h2>
<p>默认情况下，写入仿真数据库的数据不会在会话之间持续，但是您可以从实时数据库仿真器 UI 手动导出和导入数据，或者更改您的<code>emulators</code> npm 脚本来自动执行此操作:</p>
<pre>  "emulators": "firebase emulators:start --import=data --export-on-exit",
</pre>
<p>这将创建一个可以添加到<code>.gitignore</code>的<code>data</code>目录。值得注意的是，在当前的<code>firebase-tools</code>(版本<code>9.0.1</code>)中，认证模拟器不支持自动导入/导出。</p>
<p>但是，这个特性已经被<a href="https://github.com/firebase/firebase-tools/pull/2955" target="_blank" rel="noopener">合并到上游</a>中，所以不需要很长时间就可以在会话之间持久化用户。如果你需要这个特性并且迫不及待，看看这个<a href="https://github.com/firebase/firebase-tools/issues/2749" target="_blank" rel="noopener">问题</a>中的一系列解决方法。</p>
<h2>在 Firebase 中模拟身份验证</h2>
<p>要开始使用身份验证模拟器，请确保 Firebase 模拟器正在运行，并使用您想要的任何提供程序实现身份验证逻辑。我将使用带有弹出窗口的 Google 身份验证提供程序:</p>
<pre>import React from 'react';
import { auth } from './firebase';

function Login() {
  const login = async () =&gt; {
    const provider = new auth.GoogleAuthProvider();
    try {
      await auth().signInWithPopup(provider);
    } catch (e) {}
  };
  return &lt;button onClick={login}&gt;login&lt;/button&gt;;
}

export default Login;
</pre>
<p>点击<code>login</code>按钮会将我们重定向到一个登录页面，该页面可能有先前创建的用户:</p>
<p><img data-attachment-id="33078" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/authentication-emulator-sign-in-google/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Authentication Emulator Sign-in on Google" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png" decoding="async" class="aligncenter size-full wp-image-33078 jetpack-lazy-image" src="../Images/9f8e0b4266282f849e7ffb247006ac1f.png" alt="Authentication Emulator Sign-in on Google" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google-300x168.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="33078" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/authentication-emulator-sign-in-google/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Authentication Emulator Sign-in on Google" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-33078" src="../Images/9f8e0b4266282f849e7ffb247006ac1f.png" alt="Authentication Emulator Sign-in on Google" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google-300x168.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-emulator-sign-in-google.png"/></noscript>
<p>同样，强烈建议您不要输入任何真实的凭据。任何新创建的用户都将出现在<strong>认证</strong>选项卡中:</p>
<p><img data-attachment-id="33080" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/authentication-eumulator-google-account/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Authentication Emulator with Google Account" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png" decoding="async" class="aligncenter size-full wp-image-33080 jetpack-lazy-image" src="../Images/9f171cff778f088e4064c0f09f03eaad.png" alt="Authentication Emulator With Google Account" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account-300x168.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="33080" data-permalink="https://blog.logrocket.com/using-firebase-emulator-suite-and-react-for-local-first-development/authentication-eumulator-google-account/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Authentication Emulator with Google Account" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-33080" src="../Images/9f171cff778f088e4064c0f09f03eaad.png" alt="Authentication Emulator With Google Account" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account-300x168.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/authentication-eumulator-google-account.png"/></noscript>
<p>您可以通过两种方式检索用户。成功登录后，将用户设置为<code>auth().currentUser</code>:</p>
<pre>try {
  await auth().signInWithPopup(provider);
  const user = await auth().currentUser;
  setUser(user);
} catch(e) {}
</pre>
<p>或者监听一个<code>useEffect</code>钩子内的认证变化:</p>
<pre>React.useEffect(() =&gt; {
  return auth().onAuthStateChanged((user) =&gt; {
    if (user) {
      setUser(user);
    } else {
      setUser(null);
    }
  });
}, []);
</pre>
<p>无论哪种方式，身份验证都是模拟的，不会通过提供者创建实际用户。注意，我们不需要在 Firebase 控制台中启用 Google provider。但是，您必须在部署之前这样做。</p>
<h2>结论</h2>
<p>在本文中，您了解了如何使用命令行设置 Firebase 项目，以及如何使用 Firebase Emulator 对本地优先的工作流进行仿真 Firestore 和 Firebase 身份验证。感谢阅读。</p>
<div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产 React 应用</h2><p>调试 React 应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪 Redux 状态、自动显示 JavaScript 错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的 web 和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket 不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux 中间件包为您的用户会话增加了一层额外的可见性。LogRocket 记录 Redux 存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试 React 应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>