<html>
<head>
<title>The guide to adding Google login to your React app - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>将Google登录添加到React应用的指南</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/guide-adding-google-login-react-app/#0001-01-01">https://blog.logrocket.com/guide-adding-google-login-react-app/#0001-01-01</a></blockquote><div><article class="article-post">
<p>有时候，我们只想使用一个应用程序，却没有耐心先用我们的电子邮件和密码注册和登录。我们也可能只是想尝试一下应用程序，而不想为此创建一个新帐户。</p>
<p>同时，应用程序的所有者需要知道他们的应用程序有多少用户，并且希望得到关于谁在使用应用程序以及如何使用的反馈。为了获得这些统计数据，他们需要用户注册他们的电子邮件。</p>
<p>这两种情况让用户和应用程序所有者都有点尴尬。这就是谷歌登录功能发挥重要作用的地方。</p>
<p>由于谷歌是世界上最受欢迎的电子邮件平台，允许用户使用谷歌登录你的React应用程序消除了用户和应用程序所有者之间的摩擦。用户几乎可以立即开始使用应用程序，而不必创建一个全新的帐户。</p>
<p>在本文中，我们将了解Google登录是如何工作的，以及如何使用名为<code>@react-oauth/google</code>的新Google身份服务SDK将其添加到React应用程序中。</p>
<p><em>向前跳转:</em></p>

<p>要学习本教程，您应该在本地计算机上安装React，并熟悉如何使用它。如果您已经安装了React，那么您应该已经安装了Node.js、npm和Yarn。</p>
<h2 id="installing-required-package-add-google-login-react-app">安装将Google登录添加到React应用程序所需的包</h2>
<p>要使用谷歌登录，我们需要安装<a href="https://www.npmjs.com/package/@react-oauth/google"> <code>@react-oauth/google</code> </a>包。这是谷歌新的身份服务SDK它允许我们将Google登录功能集成到React应用程序中。此外，<code>@react-oauth/google</code>允许我们获得快速安全地访问所有Google APIs所需的访问令牌。</p>
<p>但是，在我们安装并开始将Google登录整合到React应用程序之前，我们首先需要获得一个Google客户端ID。</p>
<h2 id="acquiring-google-client-id-project">为您的项目获取一个Google客户端ID</h2>
<p>客户端ID是与帮助客户端和服务器进行OAuth 2.0认证的应用程序相关联的唯一标识符。</p>
<p>要从谷歌获取客户端ID，请转到您的<a href="https://console.cloud.google.com/">谷歌云控制台</a>并创建一个新项目。对于本文，我将该项目命名为“Google登录”，但是您可以随意命名:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/db57c61ecff8eb073544b65cee0398b9.png" alt="Google Cloud Console With Prompt To Select A Project, Option To Create New Project, Search Bar For Projects And Folders, And Selected Google Sign In Project Under Recent Tab." data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img1-New-Google-Cloud-Console-project.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img1-New-Google-Cloud-Console-project.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/db57c61ecff8eb073544b65cee0398b9.png" alt="Google Cloud Console With Prompt To Select A Project, Option To Create New Project, Search Bar For Projects And Folders, And Selected Google Sign In Project Under Recent Tab." data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img1-New-Google-Cloud-Console-project.png"/></noscript>
<p>创建一个项目后，单击项目名称，您将看到一个类似下图的仪表板。您当前的项目名称应该显示在仪表板的左上角，Google Cloud徽标旁边:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/0c51f973546578968e9973fd11a16efb.png" alt="Google Cloud Console Project Dashboard With Current Project Name Shown At Top Left And Left Side Menu For Apis And Services" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img2-Google-Cloud-Console-project-dashboard.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img2-Google-Cloud-Console-project-dashboard.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/0c51f973546578968e9973fd11a16efb.png" alt="Google Cloud Console Project Dashboard With Current Project Name Shown At Top Left And Left Side Menu For Apis And Services" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img2-Google-Cloud-Console-project-dashboard.png"/></noscript>
<p>现在，让我们回顾一下在创建您的凭据之前如何配置您的同意屏幕。</p>
<h2 id="configuring-google-login-consent-screen-react-app">为React应用程序配置Google登录许可屏幕</h2>
<p>同意屏幕，顾名思义，是提示用户使用外部或第三方库登录的同意页面。这一步提醒用户，他们正在离开你的应用程序的根页面，并允许访问第三方页面。</p>
<p>简而言之，当您使用OAuth 2.0进行授权时，您的应用程序会请求用户授权来自Google帐户的一个或多个访问范围。访问范围包括您的应用程序允许访问的任何信息或活动，或在用户帐户上进行的任何活动。</p>
<p>您的应用程序向用户显示的Google登录许可屏幕可能包括对您的项目、其政策和请求的访问范围的简要描述。</p>
<p>一个简单的同意页面可能如下所示:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/21dac77876ffc9567f5dab5353d5cfbe.png" alt="Simple Google Login Consent Page With Prompt To Choose An Account To Continue To App And Author's Account Shown As Option" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img3-Simple-Google-login-consent-page-example.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img3-Simple-Google-login-consent-page-example.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/21dac77876ffc9567f5dab5353d5cfbe.png" alt="Simple Google Login Consent Page With Prompt To Choose An Account To Continue To App And Author's Account Shown As Option" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img3-Simple-Google-login-consent-page-example.png"/></noscript>
<p>要为React应用程序配置Google同意页面，请转到Google Cloud控制台左侧菜单中的“OAuth同意屏幕”选项卡。</p>
<p>进入该选项卡后，选择外部——这实际上是唯一可以选择的选项，除非您使用的是经过Google验证的组织或应用程序——并单击<strong>创建</strong>按钮创建您的同意屏幕:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/3803d521e7cb9e5ebad6e7533e227e35.png" alt="Google Cloud Console Project Dashboard With Oauth Consent Screen Options Displayed And External User Type Selected" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img4-Google-Cloud-Console-project-create-OAuth-consent-screen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img4-Google-Cloud-Console-project-create-OAuth-consent-screen.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/3803d521e7cb9e5ebad6e7533e227e35.png" alt="Google Cloud Console Project Dashboard With Oauth Consent Screen Options Displayed And External User Type Selected" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img4-Google-Cloud-Console-project-create-OAuth-consent-screen.png"/></noscript>
<p>接下来，在同一个选项卡中，为您的应用程序选择一个名称和一个电子邮件地址，以便在项目发生任何更改时获得通知。您可以暂时将其他需求和选项保留为空。如果您已经准备好了详细信息，您可以根据需要在此步骤中添加它们:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/095ceecde78e4be57d581ea4cfe3469a.png" alt="Google Cloud Console Project Oauth Consent Screen Registration With App Information Sections Including App Name And User Support Email Filled In" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img5-Google-Cloud-Console-project-OAuth-consent-screen-registration.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img5-Google-Cloud-Console-project-OAuth-consent-screen-registration.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/095ceecde78e4be57d581ea4cfe3469a.png" alt="Google Cloud Console Project Oauth Consent Screen Registration With App Information Sections Including App Name And User Support Email Filled In" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img5-Google-Cloud-Console-project-OAuth-consent-screen-registration.png"/></noscript>
<p>您也可以暂时跳过其余的注册部分。只需在每个部分向下滚动，点击<strong>保存并继续</strong>，直到完成后返回仪表板。</p>
<h2 id="creating-web-client-id">创建您的web客户端ID</h2>
<p>接下来，在左侧菜单中，单击<strong>凭证</strong>选项卡，转到您可以创建web客户端ID的页面。</p>
<p>在这个页面上，点击页面顶部的<strong>创建凭证</strong>，然后选择<strong> OAuth客户端ID </strong>选项:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/3b86a93de6f8c610779af355b93a3fff.png" alt="Google Cloud Console Dashboard With Credentials Option Selected In Left Side Menu And Dropdown Menu From Create Credentials Button With Option To Create Oauth Client ID." data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img6-Steps-to-create-OAuth-client-ID.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img6-Steps-to-create-OAuth-client-ID.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/3b86a93de6f8c610779af355b93a3fff.png" alt="Google Cloud Console Dashboard With Credentials Option Selected In Left Side Menu And Dropdown Menu From Create Credentials Button With Option To Create Oauth Client ID." data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img6-Steps-to-create-OAuth-client-ID.png"/></noscript>
<p>系统将提示您选择应用程序类型，如下所示。如果您正在为React应用程序执行这些步骤，请选择<strong> Web应用程序</strong>(因为我们在Web上使用Google客户端ID):</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/4514b0ddd58d7a40703a5304f94f7534.png" alt="Step To Create Oauth Client Id Prompting Selection Of Application Type" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img7-OAuth-client-ID-application-type-prompt.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img7-OAuth-client-ID-application-type-prompt.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/4514b0ddd58d7a40703a5304f94f7534.png" alt="Step To Create Oauth Client Id Prompting Selection Of Application Type" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img7-OAuth-client-ID-application-type-prompt.png"/></noscript>
<p>如果您将它集成到React Native、Flutter或Swift应用程序中，您可以为这两个操作系统分别选择Android或iOS选项。</p>
<p>接下来，我们将为我们的客户端ID选择一个名称。这个名称只是用来记录或定义我们正在创建的特定ID。例如，如果我们正在创建web、iOS和Android ID，我们可以在它们的命名约定中包括“Web ID”、“Android ID”、“iOS ID”等等，以区分它们。</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/eaf071c5c42976bcbc9a2e1659a52f9d.png" alt="Prompt To Add Oauth Client Id Name Within Google Cloud Console Dashboard" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img8-OAuth-client-ID-name-prompt.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img8-OAuth-client-ID-name-prompt.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/eaf071c5c42976bcbc9a2e1659a52f9d.png" alt="Prompt To Add Oauth Client Id Name Within Google Cloud Console Dashboard" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img8-OAuth-client-ID-name-prompt.png"/></noscript>
<p>接下来，我们还将添加两种类型的URL:授权的JavaScript源和授权的重定向URL。</p>
<p>授权的JavaScript源URL是您的应用程序发起登录的URL；例如，对于React开发人员来说是localhost和localhost:3000，如果您已经托管了您的应用程序，则是您的托管URL。</p>
<p>授权重定向URL是登录成功后Google将用户重定向到的链接。例如，您可能希望将用户带回到您的原始链接，或者可能将用户重定向到另一个链接。无论哪种方式，你都必须在这里包含网址。</p>
<p>对于授权的JavaScript源和授权的重定向URL，添加本地主机URL:<a href="http://localhost:3000/">http://localhost:3000</a>和<a href="http://localhost" rel="nofollow"> http://localhost </a>，像这样:</p>
<p><img data-attachment-id="158330" data-permalink="https://blog.logrocket.com/guide-adding-google-login-react-app/attachment/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png" data-orig-size="720,312" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Google Cloud Console authorized origins URL authorized redirect URL" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url-300x130.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png" decoding="async" class="aligncenter wp-image-158330 size-full jetpack-lazy-image" src="../Images/b97333a7cb9e61b42f67d2de63813c8e.png" alt="Google Cloud Console Authorized Origins URL Authorized Redirect URL" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png 720w, https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url-300x130.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="158330" data-permalink="https://blog.logrocket.com/guide-adding-google-login-react-app/attachment/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png" data-orig-size="720,312" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Google Cloud Console authorized origins URL authorized redirect URL" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url-300x130.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png" decoding="async" loading="lazy" class="aligncenter wp-image-158330 size-full" src="../Images/b97333a7cb9e61b42f67d2de63813c8e.png" alt="Google Cloud Console Authorized Origins URL Authorized Redirect URL" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png 720w, https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url-300x130.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/google-cloud-console-add-authorized-javascript-origins-url-authorized-redirect-url.png"/></noscript>
<p>最后，点击<strong>创建</strong>按钮来创建您的web客户端ID。您将被带回到主页，在那里您将看到您新创建的凭据。单击复制图标复制您的新web客户端ID:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/dd3a0a90bebd90c5f0fdc3e5efaed2c2.png" alt="Google Cloud Console Project Dashboard Homepage With Api Keys, Oauth 2.0 Client Ids, And Service Accounts Information" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img9-Google-Cloud-Console-project-dashboard-with-newly-created-web-client-ID.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img9-Google-Cloud-Console-project-dashboard-with-newly-created-web-client-ID.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/dd3a0a90bebd90c5f0fdc3e5efaed2c2.png" alt="Google Cloud Console Project Dashboard Homepage With Api Keys, Oauth 2.0 Client Ids, And Service Accounts Information" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img9-Google-Cloud-Console-project-dashboard-with-newly-created-web-client-ID.png"/></noscript>
<p>现在我们已经成功创建了web客户端ID，让我们进入React应用程序，安装它，然后集成Google登录。</p>
<h2 id="putting-together-react-google-login">将所有这些与<code>@react-oauth/google</code>放在一起</h2>
<p>要使用Google登录包，我们首先需要安装它。运行以下任一命令来安装该软件包:</p>
<pre class="language-bash hljs">//Npm
npm install @react-oauth/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="187f77777f747d5874796c7d6b6c">[email protected]</a>

//Yarn
yarn add @react-oauth/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f3949c9c949f96b39f9287968087">[email protected]</a>
</pre>
<p>安装后，我们将使用GoogleOAuthProvider包装我们的应用程序，然后提供我们的Google web客户端ID。这是为了让我们的整个React应用程序可以访问一次Google Auth Provider。</p>
<p>在我们的<code>index.js</code>文件中，我们将这样包装应用程序；</p>
<pre class="language-javascript hljs">/*index.js*/

import React from 'react';
import ReactDOM from 'react-dom';
import { GoogleOAuthProvider } from '@react-oauth/google';
import App from './App';

ReactDOM.render(
    &lt;GoogleOAuthProvider clientId="386932037035-k8v833noqjk7m4***********.apps.googleusercontent.com"&gt;
        &lt;React.StrictMode&gt;
            &lt;App /&gt;
        &lt;/React.StrictMode&gt;
    &lt;/GoogleOAuthProvider&gt;,
    document.getElementById('root')
);
</pre>
<p>就像React中的每个安装包一样，我们必须首先导入模块，然后才能使用它。所以在你的React应用里面，转到<code>App.js</code>文件，复制下面的代码；</p>
<pre class="language-javascript hljs">/*App.js*/

import React from 'react';
import { GoogleLogin } from '@react-oauth/google';

function App() {
    const responseMessage = (response) =&gt; {
        console.log(response);
    };
    const errorMessage = (error) =&gt; {
        console.log(error);
    };
    return (
        &lt;div&gt;
            &lt;h2&gt;React Google Login&lt;/h2&gt;
            &lt;br /&gt;
            &lt;br /&gt;
            &lt;GoogleLogin onSuccess={responseMessage} onError={errorMessage} /&gt;
        &lt;/div&gt;
    )
}
export default App;
</pre>
<p>上面的代码是展示如何使用Google登录的一个非常简单的方法。我们从<code>@react-oauth/google</code>导入了<code>GoogleLogin</code>模块，并在我们的组件中调用它。接下来，我们创建了两个函数，如果登录成功，控制台将记录一个响应，如果登录不成功，控制台将记录一个错误。</p>
<p>您也可以将两个函数合并成一个函数，并使用条件来呈现它。</p>
<p>下面是我们在浏览器中测试上述代码时的样子:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/ed7e77b4ca27077a91e2159fc49298a0.png" alt="Image showing our Google login button in the UI" data-lazy-src="https://paper-attachments.dropboxusercontent.com/s_539982D1065121B2EB547F08AC98EBCA83D2A16057D36D5AB08FA8BF671A1998_1674431516953_googlgllglglg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://paper-attachments.dropboxusercontent.com/s_539982D1065121B2EB547F08AC98EBCA83D2A16057D36D5AB08FA8BF671A1998_1674431516953_googlgllglglg.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/ed7e77b4ca27077a91e2159fc49298a0.png" alt="Image showing our Google login button in the UI" data-original-src="https://paper-attachments.dropboxusercontent.com/s_539982D1065121B2EB547F08AC98EBCA83D2A16057D36D5AB08FA8BF671A1998_1674431516953_googlgllglglg.png"/></noscript>
<p>点击<strong>使用Google </strong>按钮登录，将会出现一个同意屏幕或模式，如下所示:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/d3979913035ede6c53a568056646aaaf.png" alt="Popup Modal With Consent Screen Shown After Clicking Sign In With Google Button" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img11-React-Google-login-consent-screen-modal.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img11-React-Google-login-consent-screen-modal.png"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/d3979913035ede6c53a568056646aaaf.png" alt="Popup Modal With Consent Screen Shown After Clicking Sign In With Google Button" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img11-React-Google-login-consent-screen-modal.png"/></noscript>
<p>现在，我们已经看到了如何将Google登录添加到React应用程序中，让我们更进一步，获取用户的详细信息，以便在我们的应用程序中创建用户配置文件。我们只会将用户重定向到一个主页，然后获得用户的电子邮件，姓名和图像。</p>
<h2 id="creating-user-profile-react-app-users-google-profile">根据用户的Google档案在React应用程序中创建用户档案</h2>
<p>将Google login与我们的应用程序集成在一起，可以让我们访问用户的个人资料，包括用户名、电子邮件地址、图片、<code>accessToken</code>等等。我们将使用这些信息来创建我们的用户资料。</p>
<p>不过，在我们的<code>App.js</code>组件中，让我们用下面的代码替换我们现有的代码:</p>
<pre class="language-javascript hljs">/*App.js*/

import React, { useState, useEffect } from 'react';
import { googleLogout, useGoogleLogin } from '@react-oauth/google';
import axios from 'axios';

function App() {
    const [ user, setUser ] = useState([]);
    const [ profile, setProfile ] = useState([]);

    const login = useGoogleLogin({
        onSuccess: (codeResponse) =&gt; setUser(codeResponse),
        onError: (error) =&gt; console.log('Login Failed:', error)
    });

    useEffect(
        () =&gt; {
            if (user) {
                axios
                    .get(`https://www.googleapis.com/oauth2/v1/userinfo?access_token=${user.access_token}`, {
                        headers: {
                            Authorization: `Bearer ${user.access_token}`,
                            Accept: 'application/json'
                        }
                    })
                    .then((res) =&gt; {
                        setProfile(res.data);
                    })
                    .catch((err) =&gt; console.log(err));
            }
        },
        [ user ]
    );

    // log out function to log the user out of google and set the profile array to null
    const logOut = () =&gt; {
        googleLogout();
        setProfile(null);
    };

    return (
        &lt;div&gt;
            &lt;h2&gt;React Google Login&lt;/h2&gt;
            &lt;br /&gt;
            &lt;br /&gt;
            {profile ? (
                &lt;div&gt;
                    &lt;img src={profile.picture} alt="user image" /&gt;
                    &lt;h3&gt;User Logged in&lt;/h3&gt;
                    &lt;p&gt;Name: {profile.name}&lt;/p&gt;
                    &lt;p&gt;Email Address: {profile.email}&lt;/p&gt;
                    &lt;br /&gt;
                    &lt;br /&gt;
                    &lt;button onClick={logOut}&gt;Log out&lt;/button&gt;
                &lt;/div&gt;
            ) : (
                &lt;button onClick={() =&gt; login()}&gt;Sign in with Google 🚀 &lt;/button&gt;
            )}
        &lt;/div&gt;
    );
}
export default App;
</pre>
<p>在上面的代码中，我们从<code>@react-oauth/google</code>导入了<code>googleLogout</code>和<code>useGoogleLogin</code>。</p>
<p>API允许我们使用自定义按钮登录谷歌。也就是说，如果我们不想使用<code>@react-oauth/google</code>提供的<code>GoogleLogin</code>按钮，我们可以设计我们喜欢的按钮，然后使用<code>useGoogleLogin</code> API向我们提供的<code>clientId</code>发出登录请求。</p>
<p>如果请求成功，我们在<code>useGoogleLogin</code>仍然提供的<code>onSuccess</code>函数中处理它，但是如果请求失败，我们在<code>onFailure</code>函数中处理错误。</p>
<p>接下来，在我们的<code>onSuccess</code>函数中，我们用返回的数据设置我们的配置文件状态。这些数据包含用户的详细信息，如<code>google_id</code>、<code>access_token</code>、电子邮件、姓名等等。在用户数组发生任何变化时，我们的<code>useEffect</code>钩子将运行，并使用从Google login返回的访问令牌获取用户详细信息。用户是一个依赖关系，以确保在用户数组的任何变化，即从空数组到当我们从谷歌登录得到响应，<code>useEffect</code>将被监视，然后相应地触发。</p>
<p>最后，我们使用一个条件来改变我们的UI:如果profile是<code>true</code>，UI将向我们显示已登录用户的概要，以及他们的图像、姓名和电子邮件。如果配置文件变为空(即，当用户使用<code>GoogleLogout</code>按钮注销时)，它将向我们显示登录按钮:</p>
<p><img decoding="async" class="aligncenter jetpack-lazy-image" src="../Images/c56d1562350701ce8a57a51178631f77.png" alt="Cursor Shown Clicking Sign In With Google Button, Login Loading In Modal, And User Profile Being Generated From Google Information" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img12-React-Google-login-user-profile-from-Google-credentials.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img12-React-Google-login-user-profile-from-Google-credentials.gif"/></p><noscript><img data-lazy-fallback="1" decoding="async" loading="lazy" class="aligncenter" src="../Images/c56d1562350701ce8a57a51178631f77.png" alt="Cursor Shown Clicking Sign In With Google Button, Login Loading In Modal, And User Profile Being Generated From Google Information" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/img12-React-Google-login-user-profile-from-Google-credentials.gif"/></noscript>
<h2 id="conclusion">结论</h2>
<p>Google登录是我们的应用程序中包含的一个重要功能，可以节省时间并改善用户体验。添加这个特性的另一个重要原因是它的实现和使用都非常快速和简单。</p>
<p>在本教程中，我们回顾了如何使用<code>@react-oauth/google</code>向React应用程序添加Google登录。对于另一种方法，了解如何使用Firebase来处理谷歌认证和登录你的React应用。<br/>我希望你觉得这篇文章既容易理解，又对你自己的项目有帮助。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>