<html>
<head>
<title>Top Express.js template engines for dynamic HTML pages - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>动态 HTML 页面的顶级 Express.js 模板引擎</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/top-express-js-template-engines-for-dynamic-html-pages/#0001-01-01">https://blog.logrocket.com/top-express-js-template-engines-for-dynamic-html-pages/#0001-01-01</a></blockquote><div><article class="article-post">
<p>虽然可以从服务器呈现静态网站，但这种方法有很多限制，包括代码重复和缺乏灵活性——特别是在从数据库读取数据时。幸运的是，Express.js 为我们提供了一种通过模板引擎从服务器端应用程序创建动态 HTML 页面的方法。</p>
<p>模板引擎的工作方式非常简单:您创建一个模板，并使用适当的语法将变量传递给它。然后，在呈现模板的适当路径上，将值赋给模板文件中声明的变量。这些是在模板渲染时实时编译的。</p>
<p>模板引擎的一个重要特性是，它们允许我们创建可重用的组件，称为 partials，可以在其他文件中重用。这有助于防止代码重复，并使更改更容易实现。</p>
<p>现在有很多模板引擎可用，比较流行的包括 Pug (fka Jade)、Handlebars、EJS、Mustache、Swig 等等。本帖将讨论以下 Express 模板引擎:</p>

<h3 id="h3gettingstarted">入门指南</h3>
<p>通过在终端中键入以下命令，设置新的 npm 项目并安装 Express:</p>
<pre>npm init
npm i express
</pre>
<p>创建一个<code>src</code>文件夹。这是我们为这个项目编写所有代码的地方。在文件夹中，创建一个名为<code>app.js</code>的文件和一个名为<code>views</code>的文件夹来保存我们将通过 Express 渲染的视图。在<code>views</code>文件夹中添加一个<code>partials</code>子文件夹来保存片段。您的文件夹结构应该如下所示:</p>
<pre>├──src
  ├───views
    ├───partials
  app.js
</pre>
<p>将这个快速样板代码添加到<code>app.js</code>文件中:</p>
<pre>const express = require('express');
const path = require('path');
const app = express();
app.get('/', (request, response) =&gt; {
  return response.send('OK');
});
app.listen(5000, () =&gt; {
  console.log('App is listening on port 5000');
});
</pre>
<h3 id="h3integratingexpresstemplateengines">集成 Express 模板引擎</h3>
<p>将模板引擎集成到 Express 应用程序中只需要几行代码。在分配快速功能后(创建路线前)，添加以下应用程序设置:</p>
<ul>
<li><code>views</code>，模板文件所在的目录(如<code>app.set('views', './views')</code>)。这默认为应用程序根目录中的<code>views</code>目录</li>
<li><code>view engine</code>，你的模板引擎。例如，使用 Pug 模板引擎:<code>app.set('view engine', 'pug')</code></li>
</ul>
<h2 id="h2pug">哈巴狗</h2>
<p>Pug 有一个非常独特的语法，在 HTML 标签中支持缩进和空格，而不是传统的尖括号。包含页眉和正文的典型页面如下所示:</p>
<pre>doctype html
html
    head
        meta(name='viewport', content='width=device-width')
        link(rel="stylesheet", href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css")
        title= subject
    body
        div.container.mt-2
            header
                h2 Welcome
                p  Here is the homepage for #{name}
            section
                h2 Here is the body
                p Lorem ipsum dolor sit, amet consectetur adipisicing elit. Totam, repellendus!
            footer
                h2 Here is the footer
                p
                    a(href=link) Unsubscribe
</pre>
<p>从上面的例子中，您可以看到没有开始或结束标记。相反，封闭标签被声明，它的子标签被缩进，就像 Python 中一样。每个标签的内容在标签旁边声明，而属性在括号内声明。等级用<code>.</code>表示，<code>ids</code>用<code>#</code>表示。</p>
<p>变量可以用两种方式定义:</p>
<ul>
<li><strong>使用等号(<code>=</code>)符号</strong>——这通常在要声明的变量是相应标签或属性的唯一内容时使用，如我们的<code>title</code>和<code>a</code>标签所示</li>
<li><strong>使用<code>#{variable}</code>语法</strong>–当变量是标签/属性的唯一内容时，以及当变量是一个较长字符串的一部分时，都可以使用该方法</li>
</ul>
<p>要在 Express 中呈现上述内容，首先从 npm 安装 Pug 包:</p>
<pre>npm i pug
</pre>
<p>接下来，将上面的代码复制到<code>views</code>文件夹下的<code>index.pug</code>文件中，在<code>app.js</code>中，将 Pug 注册为首选模板引擎:</p>
<pre>app.set('view engine', 'pug');
app.set('views', path.join(__dirname, 'views'));
</pre>
<p>在同一个文件中，创建一个以如下方式呈现文件的路径:</p>
<pre>app.get('/index', (request, response) =&gt; {
  response.render('index', {
    subject: 'Pug template engine',
    name: 'our template',
    link: 'https://google.com'
  });
});
</pre>
<p>render 方法获取文件名(不带扩展名)，然后获取模板文件中变量的值。</p>
<h3 id="h3usingpartialsinpug">在 Pug 中使用偏旁音</h3>
<p>让我们在 partials 子文件夹中创建一个名为<code>_nav.pug</code>的可重用 nav 文件；我喜欢在部分前面加上下划线(<code>_</code>)。这将包含我们的导航菜单，代码如下:</p>
<pre>nav.navbar.navbar-dark.bg-primary.navbar-expand
    .container
        a.navbar-brand(href='#') TMP
        ul.navbar-nav.mr-auto
            li.nav-item
                a.nav-link(href='#')
                    span Home
            li.nav-item
                a.nav-link(href='#')
                    span About
            li.nav-item
                a.nav-link(href='#')
                    span Menu
            li.nav-item
                a.nav-link(href='#')
                    span Contact
        span.navbar-text
            a.nav-link(href='#')
                span  Login
</pre>
<p>然后，我们可以在<code>body</code>标签中使用<code>include</code>关键字将部分内容包含在我们的<code>index.pug</code>文件中:</p>
<pre>body
    include  partials/_nav  // partial included here
    div.container.mt-2
</pre>
<p>访问<code>localhost:5000/index</code>,你应该会看到这样的内容:</p>
<p><img data-attachment-id="43812" data-permalink="https://blog.logrocket.com/top-express-js-template-engines-for-dynamic-html-pages/partials-pug-template-homepage-localhost/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png" data-orig-size="730,226" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="partials-pug-template-homepage-localhost" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost-300x93.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png" decoding="async" class="aligncenter wp-image-43812 size-full jetpack-lazy-image" src="../Images/48d52d7c16c901462a419b854ea2ee0e.png" alt="Partials Pug Template Homepage Localhost" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost-300x93.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="43812" data-permalink="https://blog.logrocket.com/top-express-js-template-engines-for-dynamic-html-pages/partials-pug-template-homepage-localhost/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png" data-orig-size="730,226" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="partials-pug-template-homepage-localhost" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost-300x93.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png" decoding="async" loading="lazy" class="aligncenter wp-image-43812 size-full" src="../Images/48d52d7c16c901462a419b854ea2ee0e.png" alt="Partials Pug Template Homepage Localhost" srcset="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost-300x93.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/04/partials-pug-template-homepage-localhost.png"/></noscript>
<p>这是对 Pug 模板的简单介绍。可以从官方<a href="https://pugjs.org/api/getting-started.html"> pug 网站</a>了解更多。</p>
<h2 id="h2ejs">EJS</h2>
<p>EJS 比 Pug 更类似于 HTML，保留了打开和关闭标签以及指定属性的常用方法。变量使用尖括号和百分号声明，如下所示:<code>&lt;%= name %&gt;</code>。</p>
<p>EJS 标签可以以不同的方式使用:</p>
<ul>
<li><code>&lt;%=</code>–对提供的值进行转义，并输出到模板</li>
<li><code>&lt;%-</code>–输出给定值，不转义。建议您在渲染之前对所有 HTML 变量进行转义，以防止跨站脚本(XSS)攻击</li>
<li><code>&lt;%</code>–执行控制操作，例如使用条件 or 循环</li>
</ul>
<h3 id="h3integratingejsintoexpress">将 EJS 集成到 Express 中</h3>
<p>首先，从 npm 安装<code>ejs</code>包:</p>
<pre>npm i ejs
</pre>
<p>接下来，将 app <code>view engine</code>设置从帕格切换到 EJS:</p>
<pre>app.set('view engine', 'ejs');
</pre>
<p>现在，在 EJS 重写我们上面的 Pug 代码，在您的<code>views</code>文件夹中创建一个<code>index.ejs</code>文件，并添加以下代码:</p>
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta name="viewport" content="width=device-width" /&gt;
    &lt;link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    /&gt;
    &lt;title&gt;&lt;%= subject %&gt;&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class="container mt-2"&gt;
      &lt;header&gt;
        &lt;h2&gt;Welcome&lt;/h2&gt;
        &lt;p&gt;Here is the homepage for &lt;%= name %&gt;&lt;/p&gt;
      &lt;/header&gt;
      &lt;section&gt;
        &lt;h2&gt;Here is the body&lt;/h2&gt;
        &lt;p&gt;
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Totam,
          repellendus!
        &lt;/p&gt;
      &lt;/section&gt;
      &lt;footer&gt;
        &lt;h2&gt;Here is the footer&lt;/h2&gt;
        &lt;p&gt;&lt;a href="&lt;%= link %&gt;"&gt;Unsubscribe&lt;/a&gt;&lt;/p&gt;
      &lt;/footer&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<h3 id="h3usingpartialsinejs">在 EJS 使用偏音</h3>
<p>在<code>partials</code>子文件夹中，创建一个<code>_nav.ejs</code>文件并添加以下代码:</p>
<pre>&lt;nav class="navbar navbar-dark bg-primary navbar-expand"&gt;
  &lt;div class="container"&gt;&lt;a class="navbar-brand" href="#"&gt;TMP&lt;/a&gt;
    &lt;ul class="navbar-nav mr-auto"&gt;
      &lt;li class="nav-item"&gt;&lt;a class="nav-link" href="#"&gt;&lt;span&gt;Home&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li class="nav-item"&gt;&lt;a class="nav-link" href="#"&gt;&lt;span&gt;About&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li class="nav-item"&gt;&lt;a class="nav-link" href="#"&gt;&lt;span&gt;Menu&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li class="nav-item"&gt;&lt;a class="nav-link" href="#"&gt;&lt;span&gt;Contact&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;&lt;span class="navbar-text"&gt;&lt;a class="nav-link" href="#"&gt;&lt;span&gt; Login&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/nav&gt;
</pre>
<p>您可以将 nav partial 添加到您的索引文件中，方法是将 partial 文件的相对路径添加到<code>include</code>关键字中，修改刚好在<code>body</code>标签下面的行:</p>
<pre>&lt;body&gt;
    &lt;%- include('./partials/_nav'); %&gt; // partial included here
    &lt;div class="container mt-2"&gt;
      &lt;header&gt;
</pre>
<p>将以下路线添加到<code>app.js</code>文件中:</p>
<pre>app.get('/index', (request, response) =&gt; {
  response.render('index', {
    subject: 'EJS template engine',
    name: 'our template',
    link: 'https://google.com'
  });
});
</pre>
<p>现在，当您启动您的服务器并访问<code>/index</code>路线时，页面应该使用 Pug 模板呈现类似的内容。</p>
<h2 id="h2handlebars">把手</h2>
<p>像 EJS 一样，Handlebars 试图忠实于通常的 HTML 风格，用一种简单的方法插入变量，使用两个括号——例如，<code>{{variable}}</code>——或三个括号表示 HTML 非转义字符。它是基于<a href="https://mustache.github.io/">小胡子</a>模板引擎构建的，所以它们有一些相似之处。</p>
<p>有许多 npm 包可用于在 Express 中编译和渲染手柄，但我将使用<code>hbs</code>包。这是通过以下命令安装的:</p>
<pre>npm i hbs
</pre>
<p>然后，我们将视图引擎设置为<code>hbs</code>,使用:</p>
<pre>app.set('view engine', 'hbs');
</pre>
<p>对我们以前的索引页面的重写看起来像这样:</p>
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta name="viewport" content="width=device-width" /&gt;
    &lt;link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" /&gt;
    &lt;title&gt;
        {{subject}}
    &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container mt-2"&gt;
        &lt;header&gt;
            &lt;h2&gt;Welcome&lt;/h2&gt;
            &lt;p&gt;Here is the homepage for {{name}}
            &lt;/p&gt;
        &lt;/header&gt;
        &lt;section&gt;
            &lt;h2&gt;Here is the body&lt;/h2&gt;
            &lt;p&gt;
                Lorem ipsum dolor sit, amet consectetur adipisicing elit. Totam,
                repellendus!
            &lt;/p&gt;
        &lt;/section&gt;
        &lt;footer&gt;
            &lt;h2&gt;Here is the footer&lt;/h2&gt;
            &lt;p&gt;&lt;a href="{{link}}"&gt;Unsubscribe&lt;/a&gt;&lt;/p&gt;
        &lt;/footer&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<h3 id="h3usingpartialsinhandlebars">在车把上使用零件</h3>
<p>使用与前面相同的文件结构，在<code>partials</code>文件夹中创建一个<code>_nav.hbs</code>文件。我们将在上面的<code>_nav.ejs</code>文件中使用相同的代码，因为它是普通的 HTML 语法，没有定义任何变量。</p>
<p>与其他模板引擎不同，在使用之前，您必须在手柄中注册您的 partials。在您的<code>app.js</code>文件中导入<code>hbs</code>模块，并使用<code>registerPartials</code>方法:</p>
<pre>const hbs = require('hbs');
hbs.registerPartials(path.join(__dirname, 'views/partials'));
</pre>
<p>注册后，在将它包含在一个<code>hbs</code>文件中时，只需使用部分的文件名而不是相对路径。将一个部分包含到另一个<code>hbs</code>文件中的语法是<code>{{&gt;partialname}}</code>。您可以在索引文件中包含您的 nav partial，方法是在开始的<code>body</code>标记下面添加修改行:</p>
<pre>&lt;div class="container mt-2"&gt;
    {{&gt;_nav}}  // partial included here
    &lt;header&gt;
</pre>
<p>将以下路径添加到<code>app.js</code>中以呈现索引文件:</p>
<pre>app.get('/index', (request, response) =&gt; {
  response.render('index', {
    subject: 'hbs template engine',
    name: 'our template',
    link: 'https://google.com'
  });
});
</pre>
<p>访问<code>/index</code>路线应该在 Pug 应用程序中呈现一个类似于相同路线的页面。</p>
<h2 id="h2conclusion">结论</h2>
<p>模板引擎非常容易设置，几乎不需要样板文件，您可以用它们创建大型应用程序，而不必花太多时间学习语法。您可以通过访问他们的文档开始创建从服务器渲染的动态网页来了解他们的更多信息。</p>
<p>这个应用程序的源代码在<a href="https://github.com/supercede/express-templates.git"> GitHub </a>上，每个模板引擎在一个不同的分支中，以相同的名字命名。</p><div class="code-block code-block-23">
<div class="blog-plug inline-plug node-plug"><h2>200 只<img src="../Images/61167b9d027ca73ed5aaf59a9ec31267.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png"/> <noscript> <img data-lazy-fallback="1" src="../Images/61167b9d027ca73ed5aaf59a9ec31267.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png"/> </noscript>显示器出现故障，生产中网络请求缓慢</h2><p>部署基于节点的 web 应用程序或网站是容易的部分。确保您的节点实例继续为您的应用程序提供资源是事情变得更加困难的地方。如果您对确保对后端或第三方服务的请求成功感兴趣，</p><a href="https://lp.logrocket.com/blg/node-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer"><img src="../Images/cae72fd2a54c5f02a6398c4867894844.png" alt="LogRocket Network Request Monitoring" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png"/><noscript><img data-lazy-fallback="1" src="../Images/cae72fd2a54c5f02a6398c4867894844.png" alt="LogRocket Network Request Monitoring" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png"/></noscript></a><a href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的 DVR，记录下用户与你的应用程序交互时发生的一切。您可以汇总并报告有问题的网络请求，以快速了解根本原因，而不是猜测问题发生的原因。</p><p>LogRocket 检测您的应用程序以记录基线性能计时，如页面加载时间、到达第一个字节的时间、慢速网络请求，还记录 Redux、NgRx 和 Vuex 操作/状态。</p><a class="signup" href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a><p>. </p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>