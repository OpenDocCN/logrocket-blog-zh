<html>
<head>
<title>Build a full-stack app with Next.js and Supabase - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用Next.js和Supabase - LogRocket Blog构建一个全栈应用</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/#0001-01-01">https://blog.logrocket.com/build-full-stack-app-next-js-supabase/#0001-01-01</a></blockquote><div><article class="article-post">
<p>在我看来，在为下一个全栈应用构建和选择框架时，结合Next.js和Supabase是最好的选择之一。</p>
<p>Supabase是一个开源的Firebase替代品，有很多强大的工具，包括无缝认证<strong>。</strong>作为开发人员，这是构建成功的全栈应用的关键。</p>
<p>除了认证之外，Supabase还具有其他特性，如Postgres数据库、实时订阅和对象存储。我相信Supabase是最容易上手或集成的后端即服务之一。</p>
<p>在本文中，我们将学习如何使用Next.js和Supabase <strong>构建一个全栈app。</strong>我们将讨论如何建立一个Supabase项目，配置UI，实现认证和功能。</p>
<p>这个应用程序的概念是让用户根据指定的参数跟踪和创建锻炼活动，如果有任何错误或必要的更改，可以编辑这些活动，如果需要，可以删除它们。我们开始吧！</p>

<h2 id="introduction-next-js-supabase">Next.js和Supabase简介</h2>
<p>Next.js是构建生产就绪的React应用程序的最简单和最流行的方法之一。近年来，Next.js经历了显著的指数增长，许多公司都采用它来构建自己的应用程序。</p>
<h2 id="why-use-supabase">为什么要用Supabase？</h2>
<p>Supabase是Firebase 的一个无服务器、开源的替代方案，建立在PostgreSQL数据库之上。它提供了创建全栈应用所需的所有后端服务。</p>
<p>作为用户，您可以从Supabase界面管理您的数据库，从创建表和关系到在PostgreSQL之上编写您的SQL查询和实时引擎。</p>
<p>Supabase提供了非常酷的特性，让你的全栈应用开发变得更加容易。这些功能包括:</p>
<ul>
<li>行级安全性(RLS)–Supabase带有PostgreSQL RLS特性，允许您限制数据库表中的行。当您创建策略时，您可以使用SQL直接创建它们</li>
<li>实时数据库——Supabase在PostgreSQL数据库上有一个更新特性，可以用来监听实时变化</li>
<li>supa base UI——supa base有一个开源的用户界面组件库，可以快速高效地创建应用程序</li>
<li>用户认证——一旦您创建了数据库，Supabase就会创建一个<code>auth.users</code>表。当您创建一个应用程序时，只要您在数据库中可以引用的应用程序上注册，Supabase就会分配一个用户和ID。对于登录方法，有不同的方法可以验证用户，如电子邮件，密码，魔术链接，谷歌，GitHub，等等</li>
<li>边缘函数–边缘函数是在靠近用户的边缘全局分布的类型脚本函数。它们可以用来执行一些功能，比如与第三方集成或者监听WebHooks</li>
</ul>
<h2 id="initiating-project-next-js">用Next.js启动我们的项目</h2>
<p>为了在终端中使用Next.js模板启动我们的项目，我们将运行以下命令:</p>
<pre class="language-bash hljs">npx create-next-app nextjs-supabase
</pre>
<p><code>nextjs-supabase</code>是我们应用程序的文件夹名称，我们将在其中包含Next.js应用程序模板。</p>
<p>我们需要安装Supabase客户端包，以便稍后连接到Next.js应用程序。我们可以通过运行以下命令之一来实现这一点:</p>
<pre class="language-bash hljs">yarn add @supabase/supabase-js</pre>
<p>或者</p>
<pre class="language-bash hljs">npm i @supabase/supabase-js
</pre>
<p>应用程序完成设置后，在您喜欢的代码编辑器中打开文件夹。现在，我们可以删除我们的<code>/pages/index.js</code>文件中的基本模板，并替换为标题为“欢迎使用锻炼应用程序”的<code>h1</code></p>
<p>完成后，在终端中运行命令<code>yarn dev</code>在<a href="http://localhost:3000" target="_blank" rel="noopener"> http://localhost:3000 </a>启动你的应用。您应该会看到这样一个页面:</p>
<p id="gdcalert1"><img data-attachment-id="127423" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/welcome-screen-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="welcome-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png" decoding="async" class="aligncenter size-full wp-image-127423 jetpack-lazy-image" src="../Images/c873c723d49801d1ee303c4465dfb2b2.png" alt="Welcome Screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127423" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/welcome-screen-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="welcome-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127423" src="../Images/c873c723d49801d1ee303c4465dfb2b2.png" alt="Welcome Screen" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen.png"/></noscript>
<h2 id="setting-up-supabase-project-creating-database-table">建立Supabase项目并创建数据库表</h2>
<p>要设置Supabase项目，请访问<a href="https://app.supabase.com/" target="_blank" rel="noopener">app.supabase.com</a>使用您的GitHub帐户登录应用仪表板。</p>
<p id="gdcalert2"><img data-attachment-id="127425" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/supabase-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="supabase-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png" decoding="async" class="aligncenter size-full wp-image-127425 jetpack-lazy-image" src="../Images/b7e468756316acbd1a808c05981e2f38.png" alt="Supabase Dashboard" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127425" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/supabase-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="supabase-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127425" src="../Images/b7e468756316acbd1a808c05981e2f38.png" alt="Supabase Dashboard" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/supabase-dashboard.png"/></noscript>
<p>登录后，您可以创建您的组织，并通过单击<strong>所有项目</strong>在其中设置一个新项目。</p>
<p id="gdcalert3"><img data-attachment-id="127427" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/all-projects-organization-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="all-projects-organization-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png" decoding="async" class="aligncenter size-full wp-image-127427 jetpack-lazy-image" src="../Images/99832004974cd3bd8d18e37819797d61.png" alt="All Projects And Organization Screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127427" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/all-projects-organization-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="all-projects-organization-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127427" src="../Images/99832004974cd3bd8d18e37819797d61.png" alt="All Projects And Organization Screen" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/all-projects-organization-screen.png"/></noscript>
<p>点击<strong>新建项目</strong>，给你的项目起一个名字和数据库密码。点击<strong>新建项目</strong>按钮；您的项目启动并运行需要几分钟时间。</p>
<p id="gdcalert4"><img data-attachment-id="127429" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/create-new-project-3/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="create-new-project" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png" decoding="async" class="aligncenter size-full wp-image-127429 jetpack-lazy-image" src="../Images/7aa8fdbb58c51261ba8dd5224808a09e.png" alt="Create A New Project" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127429" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/create-new-project-3/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="create-new-project" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127429" src="../Images/7aa8fdbb58c51261ba8dd5224808a09e.png" alt="Create A New Project" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-project.png"/></noscript>
<p>项目创建完成后，您应该会看到如下所示的仪表板:</p>
<p id="gdcalert5"><img data-attachment-id="127432" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/workout-next-supabase-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="workout-next-supabase-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png" decoding="async" class="aligncenter size-full wp-image-127432 jetpack-lazy-image" src="../Images/25a36d9c562b11162fb9b3be62ab5cae.png" alt="Workout Next Supabase Dashboard" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127432" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/workout-next-supabase-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="workout-next-supabase-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127432" src="../Images/25a36d9c562b11162fb9b3be62ab5cae.png" alt="Workout Next Supabase Dashboard" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-next-supabase-dashboard.png"/></noscript>
<p>对于本教程，我已经创建了一个名为<code>workout-next-supabase.</code>的项目</p>
<p>现在，让我们通过点击仪表板上的<strong> SQL编辑器</strong>图标并点击<strong>新查询</strong>来创建我们的数据库表。在编辑器中输入下面的SQL查询，点击<strong>运行</strong>执行查询。</p>
<pre class="language-sql hljs">CREATE TABLE workouts (
 id bigint generated by default as identity primary key,
 user_id uuid references auth.users not null,
 user_email text,
 title text,
 loads text,
 reps text,
 inserted_at timestamp with time zone default timezone('utc'::text, now()) not null
);

alter table workouts enable row level security;

create policy "Individuals can create workouts." on workouts for
   insert with check (auth.uid() = user_id);

create policy "Individuals can update their own workouts." on workouts for
   update using (auth.uid() = user_id);

create policy "Individuals can delete their own workouts." on workouts for
   delete using (auth.uid() = user_id);

create policy "Workouts are public." on workouts for
   select using (true);
</pre>
<p id="gdcalert6"><img data-attachment-id="127434" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/execute-query/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="execute-query" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png" decoding="async" class="aligncenter size-full wp-image-127434 jetpack-lazy-image" src="../Images/5b489cef164ae25eb4d5bfe54940bd62.png" alt="Execute Your Query" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127434" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/execute-query/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="execute-query" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127434" src="../Images/5b489cef164ae25eb4d5bfe54940bd62.png" alt="Execute Your Query" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/execute-query.png"/></noscript>
<p>这将创建我们用来构建CRUD应用程序的测试表。</p>
<p>在创建表格的同时，将启用行级权限，以确保只有授权用户才能创建、更新或删除其锻炼的详细信息。</p>
<p>要查看健身表的外观，我们可以单击仪表盘上的<strong>表格编辑器</strong>图标，查看我们刚刚创建的健身表。</p>
<p>对于此应用程序，我们将有七列:</p>
<ul>
<li><code>user_id</code></li>
<li><code>user_email</code></li>
<li><code>id</code></li>
<li><code>title</code></li>
<li><code>loads</code></li>
<li><code>reps</code></li>
<li><code>Date stamp</code></li>
</ul>
<p id="gdcalert7"><img data-attachment-id="127437" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/table-editor/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="table-editor" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png" decoding="async" class="aligncenter size-full wp-image-127437 jetpack-lazy-image" src="../Images/32452f6e27b25d182398d3efd7d15d4e.png" alt="Table Editor" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127437" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/table-editor/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="table-editor" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127437" src="../Images/32452f6e27b25d182398d3efd7d15d4e.png" alt="Table Editor" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/table-editor.png"/></noscript>
<p>一旦我们的表和列设置好了，下一步就是将我们的Supabase数据库与我们的Next.js前端应用程序连接起来！</p>
<h2 id="connecting-next-js-supabase-database">将Next.js与Supabase数据库连接</h2>
<p>要将Supabase与我们的Next.js应用程序连接起来，我们需要我们的<strong>项目URL </strong>和<strong> Anon Key </strong>。这两者都可以在我们的数据库仪表板上找到。要得到这两把钥匙，点击齿轮图标进入<strong>设置</strong>，然后点击<strong> API </strong>。你会看到这两个键是这样显示的:</p>
<p id="gdcalert8"><img data-attachment-id="127439" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/url-api-setup/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="url-api-setup" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png" decoding="async" class="aligncenter size-full wp-image-127439 jetpack-lazy-image" src="../Images/69fbad5370f3620e2fd2a37ca041d579.png" alt="Url Api Setup" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127439" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/url-api-setup/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="url-api-setup" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127439" src="../Images/69fbad5370f3620e2fd2a37ca041d579.png" alt="Url Api Setup" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/url-api-setup.png"/></noscript>
<p>当然，我们不希望在浏览器或我们的存储库上公开这些值，因为这是敏感信息。对我们有利的是，Next.js提供了对环境变量的内置支持，允许我们在项目的根目录下创建一个<code>.env.local</code>文件。这将加载我们的环境变量，并通过在它前面加上<code>NEXT_PUBLIC</code>来向浏览器公开它们。</p>
<p>现在，让我们在项目的根目录下创建一个<code>.env.local</code>文件，并在文件中包含我们的URL和密钥。</p>
<pre class="language-plaintext">.env.local

NEXT_PUBLIC_SUPABASE_URL= // paste your project url here
NEXT_PUBLIC_SUPABASE_ANON_KEY= // paste your supabase anon key here
</pre>
<blockquote><p><strong>注意，</strong>不要忘记在你的<code>gitignore</code>文件中包含<code>.env.local</code>，以防止它在部署时被推送到GitHub repo(并可供所有人查看)。</p></blockquote>
<p>现在让我们通过在项目的根目录下创建一个名为<code>supabase.js</code>的文件来创建我们的Supabase客户端文件。在<code>supabase.js</code>文件中，我们将编写以下代码:</p>
<pre class="language-javascript hljs">// supabase.js
import { createClient } from "@supabase/supabase-js";

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

export const supabase = createClient(supabaseUrl, supabaseKey);
</pre>
<p>这里，我们从Supabase导入一个<code>createClient</code>函数，并创建一个名为<code>supabase</code>的变量。我们调用<code>createClient</code>函数，然后传入我们的参数:URL ( <code>supabaseUrl</code>)和Anon Key ( <code>supabaseKey</code>)。</p>
<p>现在，我们可以在项目的任何地方调用和使用Supabase客户端！</p>
<h2 id="configuring-app-ui">配置我们应用的用户界面</h2>
<p>首先，我们需要将我们的应用程序配置成我们想要的样子。我们将有一个项目名称的导航栏，以及首次加载应用程序时的<strong>登录</strong>和<strong>注册</strong>选项。当用户注册并登录时，我们将显示导航栏，其中有<strong>主页</strong>、<strong>注销</strong>和<strong>创建锻炼</strong>按钮。</p>
<p>网站上的每一页都会有一个页脚。</p>
<p>为此，我们将创建一个<code>component</code>文件夹来存放<code>Navbar.js</code>和<code>Footer.js</code>文件。然后，在<code>_app.js</code>中，我们将用<code>Navbar</code>和<code>Footer</code>组件包装我们的<code>pages</code>组件，这样它们就会显示在应用程序的每个页面上。</p>
<pre class="language-javascript hljs">// _app.js
import Footer from "../components/Footer";
import Navbar from "../components/Navbar";
import "../styles/globals.css";

function MyApp({ Component, pageProps }) {
 return (
   &lt;div&gt;
     &lt;Navbar/&gt;
     &lt;Component {...pageProps}/&gt;
     &lt;Footer /&gt;
   &lt;/div&gt;
 );
}

export default MyApp;
</pre>
<p><a href="https://gist.github.com/Taofiqq/5fe986309bf2bdbf7eb7edd4249960cd" target="_blank" rel="noopener">我在这里创建了一个GitHub gist】来看看这两个组件和我使用的风格是什么样子。</a></p>
<p>现在，我们的主页应该是这样的:</p>
<p id="gdcalert9"><img data-attachment-id="127441" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/andrenargy-home-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="andrenargy-home-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png" decoding="async" class="aligncenter size-full wp-image-127441 jetpack-lazy-image" src="../Images/8429fc85ad7207809cb3c742d387e864.png" alt="Adrenargy Home Screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127441" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/andrenargy-home-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="andrenargy-home-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127441" src="../Images/8429fc85ad7207809cb3c742d387e864.png" alt="Adrenargy Home Screen" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/andrenargy-home-screen.png"/></noscript>
<h2 id="implementing-user-authentication">实施用户身份验证</h2>
<p>为了实现用户认证，我们将在我们的<code>_app.js</code>文件中初始化用户状态，并创建一个<code>validateUser</code>函数来检查和验证用户。然后，我们将用户状态设置为返回的会话对象。</p>
<pre class="language-javascript hljs">// _app.js

import { useState, useEffect } from "react";
import Footer from "../components/Footer";
import Navbar from "../components/Navbar";
import "../styles/globals.css";
import { supabase } from "../utils/supabase";

function MyApp({ Component, pageProps }) {
 const [session, setSession] = useState(null);

 useEffect(() =&gt; {
   setSession(supabase.auth.session());
   supabase.auth.onAuthStateChange((_event, session) =&gt; {
     setSession(session);
   });
 }, []);
 return (
   &lt;div&gt;
     &lt;Navbar session={session} /&gt;
     &lt;Component {...pageProps} session={session} /&gt;
     &lt;Footer /&gt;
   &lt;/div&gt;
 );
}
export default MyApp;
</pre>
<p>当用户加载我们的应用程序的主页时，我们希望显示一个按钮，告诉他们要么登录，要么注册。当点击<strong>登录</strong>按钮时，它会将用户重定向到一个页面，用户可以在那里输入他们的电子邮件和密码。如果他们是现有用户并且登录详细信息有效，他们将被重定向到主页。</p>
<p>如果用户的凭据无效，将显示一条警告消息，告诉用户该问题。他们会看到一个注册选项。</p>
<p>当用户注册时，一封确认邮件将被发送到他们输入的邮箱。他们需要点击邮件正文中的链接来确认他们的邮件。</p>
<p id="gdcalert10"><img data-attachment-id="127443" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/confirm-signup-email/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png" data-orig-size="730,308" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="confirm-signup-email" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email-300x127.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png" decoding="async" class="aligncenter size-full wp-image-127443 jetpack-lazy-image" src="../Images/628fb98727a694912bb85a21f8f5b1d1.png" alt="Confirm Signup Email" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email-300x127.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127443" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/confirm-signup-email/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png" data-orig-size="730,308" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="confirm-signup-email" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email-300x127.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127443" src="../Images/628fb98727a694912bb85a21f8f5b1d1.png" alt="Confirm Signup Email" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email-300x127.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/confirm-signup-email.png"/></noscript>
<p>现在，当我们点击<strong>登录</strong>按钮时，我们应该被重定向到用户页面到这个页面:</p>
<p id="gdcalert11"><img data-attachment-id="127445" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/login-page-4/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png" data-orig-size="730,397" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="login-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page-300x163.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png" decoding="async" class="aligncenter size-full wp-image-127445 jetpack-lazy-image" src="../Images/02c68c1c9d234f7d72e919ae417018f7.png" alt="Login Page" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/login-page-300x163.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127445" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/login-page-4/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png" data-orig-size="730,397" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="login-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page-300x163.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127445" src="../Images/02c68c1c9d234f7d72e919ae417018f7.png" alt="Login Page" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/login-page-300x163.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/login-page.png"/></noscript>
<p>现在，我们可以点击<strong>注册</strong>按钮并输入电子邮件。</p>
<p id="gdcalert12"><img data-attachment-id="127447" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/sign-up-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png" data-orig-size="730,395" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="sign-up-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page-300x162.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png" decoding="async" class="aligncenter size-full wp-image-127447 jetpack-lazy-image" src="../Images/3a6381a0c2b4b711613903a566e9852e.png" alt="Sign Up Page" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page-300x162.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127447" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/sign-up-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png" data-orig-size="730,395" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="sign-up-page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page-300x162.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127447" src="../Images/3a6381a0c2b4b711613903a566e9852e.png" alt="Sign Up Page" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page-300x162.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/sign-up-page.png"/></noscript>
<p>单击此按钮后，将会发送一封电子邮件来确认电子邮件地址。确认后，它会让我们登录，我们应该会看到这样一个页面:</p>
<p id="gdcalert13"><img data-attachment-id="127449" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/welcome-screen-no-workouts-yet/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="welcome-screen-no-workouts-yet" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png" decoding="async" class="aligncenter size-full wp-image-127449 jetpack-lazy-image" src="../Images/d7fb960b19f7355d0c46b798821eb62a.png" alt="Welcome Screen With No Workouts Yet" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127449" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/welcome-screen-no-workouts-yet/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="welcome-screen-no-workouts-yet" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127449" src="../Images/d7fb960b19f7355d0c46b798821eb62a.png" alt="Welcome Screen With No Workouts Yet" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/welcome-screen-no-workouts-yet.png"/></noscript>
<p>请注意，如果我们尚未登录，我们将无法看到我们的活动仪表板、创建新健身程序的按钮或注销。这就是最初提到的由Supabase提供给我们的认证！</p>
<h2 id="implementing-workout-functionalities">实现健身程序功能</h2>
<p>现在，我们将让用户能够创建、修改和删除他们的锻炼。</p>
<h3 id="fetching-all-workouts">获取所有锻炼数据</h3>
<p>我们需要获取我们将创建的所有训练，并将其呈现在主页上。我们将在<code>index.js</code>文件中这样做:</p>
<pre class="language-javascript hljs">// /pages/index.js
import Head from "next/head";
import Link from "next/link";
import { useEffect, useState } from "react";
import styles from "../styles/Home.module.css";
import { supabase } from "../utils/supabase";
import WorkoutCard from "../components/WorkoutCard";

export default function Home({ session }) {
 const [workouts, setWorkouts] = useState([]);
 const [loading, setLoading] = useState(true);

 useEffect(() =&gt; {
   fetchWorkouts();
 }, []);

 const fetchWorkouts = async () =&gt; {
   const user = supabase.auth.user();
   try {
     setLoading(true);
     const { data, error } = await supabase
       .from("workouts")
       .select("*")
       .eq("user_id", user?.id);

     if (error) throw error;
     setWorkouts(data);
   } catch (error) {
     alert(error.message);
   } finally {
     setLoading(false);
   }
 };

 if (loading) {
   return &lt;div className={styles.loading}&gt;Fetching Workouts...&lt;/div&gt;;
 }
 return (
   &lt;div className={styles.container}&gt;
     &lt;Head&gt;
       &lt;title&gt;Nextjs x Supabase&lt;/title&gt;
       &lt;meta name="description" content="Generated by create next app" /&gt;
       &lt;link rel="icon" href="/favicon.ico" /&gt;
     &lt;/Head&gt;

     &lt;div className={styles.home}&gt;
       {!session?.user ? (
         &lt;div&gt;
           &lt;p&gt;
             Welcome to Adrenargy. Kindly log in to your account or sign in for
             a demo
           &lt;/p&gt;
         &lt;/div&gt;
       ) : (
         &lt;div&gt;
           &lt;p className={styles.workoutHeading}&gt;
             Hello &lt;span className={styles.email}&gt;{session.user.email}&lt;/span&gt;,
             Welcome to your dashboard
           &lt;/p&gt;
           {workouts?.length === 0 ? (
             &lt;div className={styles.noWorkout}&gt;
               &lt;p&gt;You have no workouts yet&lt;/p&gt;
               &lt;Link href="/create"&gt;
                 &lt;button className={styles.button}&gt;
                   {" "}
                   Create a New Workout
                 &lt;/button&gt;
               &lt;/Link&gt;
             &lt;/div&gt;
           ) : (
             &lt;div&gt;
               &lt;p className={styles.workoutHeading}&gt;Here are your workouts&lt;/p&gt;
               &lt;WorkoutCard data={workouts}/&gt;
             &lt;/div&gt;
           )}
         &lt;/div&gt;
       )}
     &lt;/div&gt;
   &lt;/div&gt;
 );
}
</pre>
<p>在这个组件中，我们正在析构从<code>_app.js</code>文件中的<code>page</code>道具传递来的<code>session</code>对象，并使用它来验证授权用户。如果没有用户，仪表板将不会显示。如果有用户登录，将会出现健身程序控制面板。如果没有创建健身程序，会出现一条“您还没有健身程序”的文字和一个创建新健身程序的按钮。</p>
<p>为了渲染我们创建的训练，我们有两个状态:<code>workouts</code>，一个空数组，和一个接受布尔值<code>true</code>的<code>loading</code>状态。加载页面时，我们使用<code>useEffect</code>从数据库中获取锻炼数据。</p>
<p><code>fetchWorkouts</code>函数用于调用Supabase实例，以使用<code>select</code>方法返回我们数据库中健身程序表的所有数据。的。<code>eq()</code> filter方法用于过滤并只返回用户id与当前登录用户匹配的数据。然后，<code>setWorkouts</code>被设置为从数据库发送的数据，一旦我们获取数据，<code>setLoading</code>被设置回<code>false</code>。</p>
<p>如果数据仍在获取中，页面应该显示“获取训练…”并且如果对我们的数据库的请求返回了我们的训练数组，我们希望映射数组并呈现<code>WorkoutCard</code>组件。</p>
<p>在<code>WorkoutCard</code>组件中，我们呈现了健身程序标题、负荷、重复次数以及创建的日期和时间。创建的时间正在使用<code>date-fns</code>库格式化，你可以在这里查看<a href="https://date-fns.org/" target="_blank" rel="noopener">。当我们在下一节开始创建卡片时，我们将看到我们的卡片是什么样子的。</a></p>
<pre class="language-javascript hljs">// Workoutcard.js

import Link from "next/link";
import styles from "../styles/WorkoutCard.module.css";
import { BsTrash } from "react-icons/bs";
import { FiEdit } from "react-icons/fi";
import { formatDistanceToNow } from "date-fns/";

const WorkoutCard = ({ data }) =&gt; {
 return (
   &lt;div className={styles.workoutContainer}&gt;
     {data?.map((item) =&gt; (
       &lt;div key={item.id} className={styles.container}&gt;
         &lt;p className={styles.title}&gt;
           {" "}
           Title: {""}
           {item.title}
         &lt;/p&gt;
         &lt;p className={styles.load}&gt;
           {" "}
           Load(kg): {"  "}
           {item.loads}
         &lt;/p&gt;
         &lt;p className={styles.reps}&gt;Reps:{item.reps}&lt;/p&gt;
         &lt;p className={styles.time}&gt;
           created:{" "}
           {formatDistanceToNow(new Date(item.inserted_at), {
             addSuffix: true,
           })}
         &lt;/p&gt;
       &lt;/div&gt;
     ))}
   &lt;/div&gt;
 );
};

export default WorkoutCard;
</pre>
<h3 id="creating-new-workout">创建新的健身程序</h3>
<p>现在我们已经登录，我们的仪表板是新鲜和干净的。为了实现创建新锻炼的能力，我们将分别在<code>pages</code>和<code>styles</code>文件夹中添加<code>create.js</code>和<code>Create.module.css</code>文件，并实现一些逻辑和样式。</p>
<pre class="language-javascript hljs">// /pages/create.js

import { supabase } from "../utils/supabase";
import { useState } from "react";
import styles from "../styles/Create.module.css";
import { useRouter } from "next/router";

const Create = () =&gt; {
 const initialState = {
   title: "",
   loads: "",
   reps: "",
 };

 const router = useRouter();
 const [workoutData, setWorkoutData] = useState(initialState);

 const { title, loads, reps } = workoutData;

 const handleChange = (e) =&gt; {
   setWorkoutData({ ...workoutData, [e.target.name]: e.target.value });
 };

 const createWorkout = async () =&gt; {
   try {
     const user = supabase.auth.user();

     const { data, error } = await supabase
       .from("workouts")
       .insert([
         {
           title,
           loads,
           reps,
           user_id: user?.id,
         },
       ])
       .single();
     if (error) throw error;
     alert("Workout created successfully");
     setWorkoutData(initialState);
     router.push("/");
   } catch (error) {
     alert(error.message);
   }
 };

 return (
   &lt;&gt;
     &lt;div className={styles.container}&gt;
       &lt;div className={styles.form}&gt;
         &lt;p className={styles.title}&gt;Create a New Workout&lt;/p&gt;
         &lt;label className={styles.label}&gt;Title:&lt;/label&gt;
         &lt;input
           type="text"
           name="title"
           value={title}
           onChange={handleChange}
           className={styles.input}
           placeholder="Enter a title"
         /&gt;
         &lt;label className={styles.label}&gt;Load (kg):&lt;/label&gt;
         &lt;input
           type="text"
           name="loads"
           value={loads}
           onChange={handleChange}
           className={styles.input}
           placeholder="Enter weight load"
         /&gt;
         &lt;label className={styles.label}&gt;Reps:&lt;/label&gt;
         &lt;input
           type="text"
           name="reps"
           value={reps}
           onChange={handleChange}
           className={styles.input}
           placeholder="Enter number of reps"
         /&gt;

         &lt;button className={styles.button} onClick={createWorkout}&gt;
           Create Workout
         &lt;/button&gt;
       &lt;/div&gt;
     &lt;/div&gt;
   &lt;/&gt;
 );
};

export default Create;
</pre>
<p>在这里，基本的UI范围是我们将有一个表单来创建一个新的锻炼。该表单将由三个字段(标题、负载和代表)组成，这是我们在创建数据库时指定的。</p>
<p>定义一个初始状态对象来处理所有这些被传递到<code>workoutsData</code>状态的字段。<code>onChange</code>功能用于处理输入字段的变化。</p>
<p><code>createWorkout</code>功能使用Supabase客户端实例，通过我们定义的初始状态字段创建新的健身程序，并将其插入数据库表格。</p>
<p>最后，我们有一个提醒祝酒词，通知我们新的锻炼何时创建。</p>
<p>然后，一旦创建了健身程序，我们就将表单数据设置回初始的空字符串状态。之后，我们使用<code>router.push</code>方法将用户导航回主页。</p>
<p id="gdcalert14"><img data-attachment-id="127452" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/create-new-workout/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="create-new-workout" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png" decoding="async" class="aligncenter size-full wp-image-127452 jetpack-lazy-image" src="../Images/ee75bd64cf85ff1d0857884011c7b69c.png" alt="Create New Project" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127452" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/create-new-workout/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="create-new-workout" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127452" src="../Images/ee75bd64cf85ff1d0857884011c7b69c.png" alt="Create New Project" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-workout.png"/></noscript>
<p id="gdcalert15"><img data-attachment-id="127454" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/workout-successfully-created/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png" data-orig-size="730,386" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="workout-successfully-created" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created-300x159.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png" decoding="async" class="aligncenter size-full wp-image-127454 jetpack-lazy-image" src="../Images/6ab89259f043910533908d1f6afc9680.png" alt="Workout Successfully Created" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created-300x159.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127454" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/workout-successfully-created/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png" data-orig-size="730,386" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="workout-successfully-created" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created-300x159.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127454" src="../Images/6ab89259f043910533908d1f6afc9680.png" alt="Workout Successfully Created" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created-300x159.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/workout-successfully-created.png"/></noscript>
<p id="gdcalert16"><img data-attachment-id="127456" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/dashboard-workouts-dumbell-press/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dashboard-workouts-dumbell-press" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png" decoding="async" class="aligncenter size-full wp-image-127456 jetpack-lazy-image" src="../Images/991f9480df2ae2eca90588824b1aacc7.png" alt="Dashboard With Workouts Dumbell Press" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127456" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/dashboard-workouts-dumbell-press/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dashboard-workouts-dumbell-press" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127456" src="../Images/991f9480df2ae2eca90588824b1aacc7.png" alt="Dashboard With Workouts Dumbell Press" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/dashboard-workouts-dumbell-press.png"/></noscript>
<h3 id="updating-workout">更新健身程序</h3>
<p>为了更新训练，我们将在我们的<code>pages</code>文件夹中创建一个名为<code>edit</code>的文件夹，用于保存我们的<code>[id].js</code>文件。我们将在健身程序组件卡上创建一个链接到此页面的编辑链接图标。当卡片呈现在主页上时，我们可以点击这个编辑图标，它将把我们带到特定卡片的编辑页面。</p>
<p>然后，我们将从我们的健身程序表中获取所需健身程序卡的详细信息，并由其<code>id</code>和卡的授权所有者进行更新。然后，我们将创建一个<code>updateWorkout</code>函数来更新我们的锻炼卡详情:</p>
<pre class="language-javascript hljs">// /pages/edit/[id].js
import { useRouter } from "next/router";
import { useEffect, useState } from "react";
import styles from "../../styles/Edit.module.css";
import { supabase } from "../../utils/supabase";

const Edit = () =&gt; {
 const [workout, setWorkout] = useState("");
 const router = useRouter();

 const { id } = router.query;
 useEffect(() =&gt; {
   const user = supabase.auth.user();
   const getWorkout = async () =&gt; {
     const { data } = await supabase
       .from("workouts")
       .select("*")
       .eq("user_id", user?.id)
       .filter("id", "eq", id)
       .single();
     setWorkout(data);
   };
   getWorkout();
 }, [id]);

 const handleOnChange = (e) =&gt; {
   setWorkout({
     ...workout,
     [e.target.name]: e.target.value,
   });
 };

 const { title, loads, reps } = workout;
 const updateWorkout = async () =&gt; {
   const user = supabase.auth.user();
   const { data } = await supabase
     .from("workouts")
     .update({
       title,
       loads,
       reps,
     })
     .eq("id", id)
     .eq("user_id", user?.id);

   alert("Workout updated successfully");

   router.push("/");
 };
 return (
   &lt;div className={styles.container}&gt;
     &lt;div className={styles.formContainer}&gt;
       &lt;h1 className={styles.title}&gt;Edit Workout&lt;/h1&gt;
       &lt;label className={styles.label}&gt; Title:&lt;/label&gt;
       &lt;input
         type="text"
         name="title"
         value={workout.title}
         onChange={handleOnChange}
         className={styles.updateInput}
       /&gt;
       &lt;label className={styles.label}&gt; Load (kg):&lt;/label&gt;
       &lt;input
         type="text"
         name="loads"
         value={workout.loads}
         onChange={handleOnChange}
         className={styles.updateInput}
       /&gt;
       &lt;label className={styles.label}&gt; Reps:&lt;/label&gt;
       &lt;input
         type="text"
         name="reps"
         value={workout.reps}
         onChange={handleOnChange}
         className={styles.updateInput}
       /&gt;

       &lt;button onClick={updateWorkout} className={styles.updateButton}&gt;
         Update Workout
       &lt;/button&gt;
     &lt;/div&gt;
   &lt;/div&gt;
 );
};

export default Edit;
</pre>
<p>首先，我们创建一个状态来存储将从我们的表中获取的锻炼卡细节。然后，我们使用<code>useRouter</code>钩子提取该卡的<code>id</code>。<code>getWorkout</code>功能调用Supabase客户端实例来过滤该健身卡的<code>id</code>并返回数据(标题、负荷和重复次数)。</p>
<p>返回健身卡详情后，我们可以创建<code>updateWorkout</code>函数，使用<code>.update()</code>函数修改详情。一旦用户更新了健身程序并点击了<strong>更新健身程序</strong>按钮，就会发送一条警告消息，用户将被重定向回主页。</p>
<p>让我们看看它是如何工作的。</p>
<p>单击编辑图标转到编辑页面。我们将把标题从“Dumbell Press”更名为“Arm Curl”:</p>
<p id="gdcalert17"><img data-attachment-id="127459" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/edit-workout-dumbell-press/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-workout-dumbell-press" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png" decoding="async" class="aligncenter size-full wp-image-127459 jetpack-lazy-image" src="../Images/26c2779b64b6a0f25f0b9d8b44452136.png" alt="Edit Workout Dumbell Press" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127459" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/edit-workout-dumbell-press/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png" data-orig-size="730,398" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-workout-dumbell-press" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127459" src="../Images/26c2779b64b6a0f25f0b9d8b44452136.png" alt="Edit Workout Dumbell Press" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-dumbell-press.png"/></noscript>
<p id="gdcalert18"><img data-attachment-id="127461" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/edit-workout-successful/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-workout-successful" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png" decoding="async" class="aligncenter size-full wp-image-127461 jetpack-lazy-image" src="../Images/aa4383959b637380a35ad63d657d541b.png" alt="Edit Workout Successful" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127461" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/edit-workout-successful/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-workout-successful" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127461" src="../Images/aa4383959b637380a35ad63d657d541b.png" alt="Edit Workout Successful" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-successful.png"/></noscript>
<p id="gdcalert19"><img data-attachment-id="127464" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/edit-workout-arm-curl/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-workout-arm-curl" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png" decoding="async" class="aligncenter size-full wp-image-127464 jetpack-lazy-image" src="../Images/d811692e3961842b960550bc3dcca136.png" alt="Edit Workout With Arm Curl" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127464" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/edit-workout-arm-curl/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png" data-orig-size="730,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-workout-arm-curl" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127464" src="../Images/d811692e3961842b960550bc3dcca136.png" alt="Edit Workout With Arm Curl" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-workout-arm-curl.png"/></noscript>
<h3 id="deleting-workout">删除健身程序</h3>
<p>要删除每张卡上的健身程序，我们将创建将<code>id</code>作为参数的<code>handleDelete</code>函数。我们将调用Supabase实例，使用</p>
<p><code>.delete()</code>功能。这个<code>.eq('id', id)</code>指定了表中要删除的行的<code>id</code>。</p>
<pre class="language-javascript hljs"> const handleDelete = async (id) =&gt; {
   try {


     const user = supabase.auth.user();
     const { data, error } = await supabase
       .from("workouts")
       .delete()
       .eq("id", id)
       .eq("user_id", user?.id);
     fetchWorkouts();
     alert("Workout deleted successfully");
   } catch (error) {
     alert(error.message);
   }
 };
</pre>
<p><code>eq('user_id', user?.id)</code>用于检查被删除的卡是否属于该特定用户。该函数将被传递给<code>index.js</code>文件中的<code>WorkoutCard</code>组件，并被析构以便在组件本身中使用，如下所示:</p>
<pre class="language-javascript hljs">const WorkoutCard = ({ data, handleDelete }) =&gt; {
 return (
   &lt;div className={styles.workoutContainer}&gt;
     {data?.map((item) =&gt; (
       &lt;div key={item.id} className={styles.container}&gt;
         &lt;p className={styles.title}&gt;
           {" "}
           Title: {""}
           {item.title}
         &lt;/p&gt;
         &lt;p className={styles.load}&gt;
           {" "}
           Load(kg): {"  "}
           {item.loads}
         &lt;/p&gt;
         &lt;p className={styles.reps}&gt;Reps:{item.reps}&lt;/p&gt;
         &lt;p className={styles.time}&gt;
           created:{" "}
           {formatDistanceToNow(new Date(item.inserted_at), {
             addSuffix: true,
           })}
         &lt;/p&gt;

         &lt;div className={styles.buttons}&gt;
           &lt;Link href={`/edit/${item.id}`}&gt;
             &lt;a className={styles.edit}&gt;
               &lt;FiEdit /&gt;
             &lt;/a&gt;
           &lt;/Link&gt;
           &lt;button
             onClick={() =&gt; handleDelete(item.id)}
             className={styles.delete}
           &gt;
             &lt;BsTrash /&gt;
           &lt;/button&gt;
         &lt;/div&gt;
       &lt;/div&gt;
     ))}
   &lt;/div&gt;
 );
};
</pre>
<p>一旦卡被成功删除，将显示一个提示提示，用户将被重定向到主页。</p>
<h2 id="deploying-vercel">部署到Vercel</h2>
<p>现在，我们必须将我们的应用程序部署到Vercel，这样互联网上的任何人都可以使用它！</p>
<p>要部署到Vercel，您必须首先将您的代码推送到您的存储库，登录到您的Vercel仪表板，点击<strong> Create New Project </strong>，然后点击您刚刚将代码推送到的存储库。</p>
<p>在<strong>环境变量</strong>字段中输入我们之前创建的环境变量及其值(<code>NEXT_PUBLIC_SUPABASE_URL</code>和<code>NEXT_PUBLIC_SUPABASE_ANON_KEY</code>，然后单击<strong>部署</strong>将您的应用程序部署到生产环境中。</p>
<p id="gdcalert20"><img data-attachment-id="127466" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/deploy-vercel/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png" data-orig-size="730,582" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="deploy-vercel" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel-300x239.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png" decoding="async" class="aligncenter size-full wp-image-127466 jetpack-lazy-image" src="../Images/91ae47d90742fa222a25fa5f67dc4cb5.png" alt="Deploy To Vercel" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel-300x239.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127466" data-permalink="https://blog.logrocket.com/build-full-stack-app-next-js-supabase/attachment/deploy-vercel/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png" data-orig-size="730,582" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="deploy-vercel" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel-300x239.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-127466" src="../Images/91ae47d90742fa222a25fa5f67dc4cb5.png" alt="Deploy To Vercel" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel-300x239.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/deploy-vercel.png"/></noscript>
<p>我们做到了！</p>
<h2 id="conclusion">结论</h2>
<p>感谢您的阅读！我希望这篇教程能给你提供使用Next.js和Supabase创建一个全栈应用程序所需的知识。</p>
<p>您可以根据您的用例定制样式，因为本教程主要关注创建全栈应用程序的逻辑。</p>
<p>你可以在这里找到这个项目的完整资源库和这里的<a href="https://nextjs-supabase-app.vercel.app/" target="_blank" rel="noopener"> live Vercel链接</a>。如果你想了解更多关于<a href="https://supabase.com/docs/" target="_blank" rel="noopener"> Supabase </a>和Next.js的信息，你可以查看他们的文档。</p><div class="code-block code-block-30">
<div class="blog-plug inline-plug next-plug"><h2><a href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank"> LogRocket </a>:全面了解生产Next.js应用</h2><p>调试下一个应用程序可能会很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪状态、自动显示JavaScript错误、跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" data-lazy-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/></noscript></a><a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a><p>LogRocket 就像是网络和移动应用的DVR，记录下你的Next.js应用上发生的一切。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。LogRocket还可以监控应用程序的性能，报告客户端CPU负载、客户端内存使用等指标。</p><p>LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p><p>让您调试Next.js应用的方式现代化— <a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>