<html>
<head>
<title>Creating Victory charts in React Native - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在 React Native - LogRocket 博客中创建胜利图表</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/creating-victory-charts-react-native/#0001-01-01">https://blog.logrocket.com/creating-victory-charts-react-native/#0001-01-01</a></blockquote><div><article class="article-post">
<p>在构建应用程序时，有效的数据可视化通过使数据易于阅读和理解来吸引用户。</p>
<p>在本帖中，我们将介绍如何使用<a href="https://formidable.com/open-source/victory/about" target="_blank" rel="noopener"> Victory </a>在 React Native 中实现数据可视化。</p>
<h2>什么是胜利？</h2>
<p>Victory 是 React 的数据可视化库。它包含各种基于组件的数据可视化工具，这些工具是交互式的、自以为是的，并且是完全可覆盖的。用 React 和 React 本机应用程序实现它是健壮且相对简单的。</p>
<p>这篇文章假设你有 React Native 的工作知识。如果你没有，这里有如何开始。</p>
<h2>在 React Native 中创建胜利图表</h2>
<p>现在，让我们创建您的第一个图表！首先，初始化一个 React 本地项目。</p>
<pre>npx react-native init VictoryRN</pre>
<p>接下来可以安装<a href="https://formidable.com/open-source/victory/docs/native" target="_blank" rel="noopener">胜利-原生</a>。</p>
<pre>npm install victory-native</pre>
<p>您还应该安装<a href="https://www.npmjs.com/package/react-native-svg" target="_blank" rel="noopener"> react-native-svg </a>，以便将 React Native SVG 的本机依赖项链接到 iOS 和 Android 项目:</p>
<pre>react-native install react-native-svg</pre>
<p>现在，您已经初始化了 React 本机应用程序并安装了依赖项，让我们开始添加一些图表。首先，让我们导入一些 victory-native 模块，我们将在下面的代码中使用这些模块:</p>
<pre>import { VictoryBar, VictoryChart, VictoryTheme } from "victory-native";</pre>
<p>我们需要一些虚拟数据来填充我们的图表。这些数据由一个对象数组表示。</p>
<pre>const data = [
 { year: '2011', earnings: 13000 },
 { year: '2012', earnings: 16500 },
 { year: '2013', earnings: 14250 },
 { year: '2014', earnings: 19000 }
];</pre>
<p>最后，让我们添加第一个胜利图表组件，如下所示:</p>
<pre>&lt;VictoryChart width={350} theme={VictoryTheme.material}&gt;
 &lt;VictoryBar data={data} x="quarter" y="earnings" /&gt;
&lt;/VictoryChart&gt;</pre>
<p>在网站上，它说<code>VictoryChart</code>是一个包装器组件，在一组笛卡尔或极轴上呈现一组给定的孩子。<code>VictoryBar</code>是胜利提供的条形图组件。添加上述代码后，我们的应用程序应该是这样的:</p>
<p><img data-attachment-id="63682" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/victory-charts-bar-code/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png" data-orig-size="512,296" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Victory charts bar code" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code-300x173.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png" decoding="async" class="aligncenter size-full wp-image-63682 jetpack-lazy-image" src="../Images/9ab7cfedf41cab3297e9cd643e26785d.png" alt="Code With A Mobile Device Displaying Bar Chart" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png 512w, https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code-300x173.png 300w" data-lazy-sizes="(max-width: 512px) 100vw, 512px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63682" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/victory-charts-bar-code/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png" data-orig-size="512,296" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Victory charts bar code" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code-300x173.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-63682" src="../Images/9ab7cfedf41cab3297e9cd643e26785d.png" alt="Code With A Mobile Device Displaying Bar Chart" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png 512w, https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code-300x173.png 300w" sizes="(max-width: 512px) 100vw, 512px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-bar-code.png"/></noscript>
<p>维奥拉，你的第一张胜利图表！现在我们已经有了基本的图表实现，让我们来试验一下动态图表。我们希望图表能够随着数据的更新而实时更新。我们还可以添加单选按钮来更改正在使用的图表类型。</p>
<h2>在 React Native 中动态制作胜利图表</h2>
<p>胜利图表的一大优点是它们可以动态地更新状态值。“它们可以响应状态变化，并显示任何新数据的动画。与 D3.js 等其他库不同，它不需要直接控制 DOM。</p>
<p>这很重要，因为使用 React，直接与 DOM 交互是一种反模式。决定是 React 还是您的第三方库应该更新图表可能会有点模糊。</p>
<p>现在，让我们来看看这种活力的表现吧！首先，让我们使用 React 钩子将数据移入组件的状态，并将其存储为<code>chartData</code>。</p>
<pre>const [chartData, setData] = useState(data)</pre>
<p>接下来，让我们添加一个按钮，当单击该按钮时，会将另一个数据对象添加到我们的<code>chartData</code>中。</p>
<pre>const addData = () =&gt; {
 var d = [...chartData]
 var obj = {year: `${maxYear}`, earnings: Math.random() * (20000 - 10000) + 10000}
 d.push(obj)
 setData(d)
 maxYear++
}</pre>
<p>在这个函数中，我们将创建一个新对象添加到<code>chartData</code>中，年份是<code>maxYear</code>，这是一个全局变量，是最近使用的一个变量之后的年份。对于收入，我正在利用<code>Math.random()</code>生成一个介于 10，000 和 20，000 之间的随机数。</p>
<p>一旦我们构造好了对象，我们可以将它添加到<code>d</code>(使用这个变量是为了避免直接改变<code>chartData</code>)，然后将其设置为新的<code>chartData</code>。我们需要做的最后一件事是将<code>maxYear</code>加 1。现在，我们可以将新函数应用于 React 本机按钮组件。见下文。</p>
<pre>&lt;Button onPress={addData} title="Add Earnings"/&gt;</pre>
<p>为了整理，我们可以包括另一个按钮，将我们的图表重置为其原始状态。<code>onPress</code>将调用我们的重置函数，该函数简单地将<code>chartData</code>重置为<code>data</code>，将<code>maxYear</code>重置回 2015 年。</p>
<p>现在，我们的应用程序可以动态地向图表添加数据，让我们更进一步，允许用户更改用于可视化可用数据的图表类型。为此，我们可以在组件状态中存储图表类型的值。</p>
<pre>const [chart, setChart] = useState(0)</pre>
<p>我们现在可以安装<a href="https://www.npmjs.com/package/react-native-simple-radio-button">react-native-simple-radio-button</a>，然后添加该库中提供的组件<code>RadioForm</code>。</p>
<pre>&lt;RadioForm
 radio_props={radio_props}
 formHorizontal={true}
 labelHorizontal={false}
 buttonColor={'#2196f3'}
 onPress={(value) =&gt; setChart(value)}
/&gt;</pre>
<p>我们的<code>radio_props</code>是一个对象数组。每个对象都有一个标签和值，对应于我们的<code>RadioForm</code>组件中的单选按钮。</p>
<pre>const radio_props = [
 {label: 'Bar', value: 0}, 
 {label: 'Line', value: 1}, 
 {label: 'Area', value: 2}
]</pre>
<p>既然我们可以更改图表类型，我们可以根据所选内容从不同的导入图表类型中进行选择。</p>
<pre>&lt;VictoryChart width={350}&gt;
 {chart === 0
   ? &lt;VictoryBar data={chartData} x="year" y="earnings" /&gt;
   : null
 }
 {chart === 1
   ? &lt;VictoryLine data={chartData} x="year" y="earnings" /&gt;
   : null
 }
 {chart === 2
   ? &lt;VictoryArea data={chartData} x="year" y="earnings" /&gt;
   : null
 }
&lt;/VictoryChart&gt;</pre>
<p>让我们看看添加了一些新功能的应用程序是什么样子的。</p>
<p><img data-attachment-id="63680" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/dynamic-victory-charts/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts.gif" data-orig-size="512,320" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Dynamic victory charts" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts-300x188.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts.gif" decoding="async" class="aligncenter size-full wp-image-63680 jetpack-lazy-image" src="../Images/f23c1a4f69eec6179a1a8477b8d9ccd1.png" alt="Code With A Mobile Device Displaying Various Dynamic Features Of Victory Charts" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63680" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/dynamic-victory-charts/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts.gif" data-orig-size="512,320" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Dynamic victory charts" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts-300x188.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-63680" src="../Images/f23c1a4f69eec6179a1a8477b8d9ccd1.png" alt="Code With A Mobile Device Displaying Various Dynamic Features Of Victory Charts" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/dynamic-victory-charts.gif"/></noscript>
<p>完美！现在，我们有了一个动态的应用程序，有多个可视化选项。这工作得很好，但是<a href="https://reactjs.org/docs/conditional-rendering.html" target="_blank" rel="noopener">条件渲染</a>有点重复。让我们试着提炼一下。</p>
<h2>干式条件渲染</h2>
<p>上面的条件渲染不是很干(不要重复自己)。我发现最好的解决方案是初始化一个变量，然后在 return 语句之前有条件地决定哪个图表应用于我们的变量。</p>
<pre>var MyChart = &lt;VictoryBar data={chartData} x="year" y="earnings" alignment="start"/&gt;

if (chart === 1){
  MyChart =  &lt;VictoryLine data={chartData} x="year" y="earnings" /&gt;
} else if (chart === 2){
  MyChart = &lt;VictoryArea data={chartData} x="year" y="earnings" /&gt;
}</pre>
<h3>一旦我们有了我们的图表改变逻辑，让我们看看它如何与我们的图表包装器，<code>VictoryChart</code>。</h3>
<pre>&lt;VictoryChart width={350} domainPadding={10}&gt;
         {MyChart}
 &lt;/VictoryChart&gt;</pre>
<p>完美。<code>VictoryChart</code>需要注意的一个道具是<code>domainPadding</code>。这很简单，但我发现这很重要，因为如果不将它设置为 10，横条就不会被正确放置。注意下面的第一个例子没有<code>domainPadding</code>，第二个例子的<code>domainPadding</code>为 10。</p>
<p><img data-attachment-id="63684" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/victory-chart-domain-padding/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png" data-orig-size="512,298" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Victory chart domain padding" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding-300x175.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png" decoding="async" class="aligncenter size-full wp-image-63684 jetpack-lazy-image" src="../Images/64342dd8ab6aa78d8b4233cf62a47ec9.png" alt="Two Mobile Devices One Displaying A Bar Starting On The Y-Axis And The Other Displaying Space In Between The First Bar" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png 512w, https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding-300x175.png 300w" data-lazy-sizes="(max-width: 512px) 100vw, 512px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63684" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/victory-chart-domain-padding/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png" data-orig-size="512,298" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Victory chart domain padding" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding-300x175.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-63684" src="../Images/64342dd8ab6aa78d8b4233cf62a47ec9.png" alt="Two Mobile Devices One Displaying A Bar Starting On The Y-Axis And The Other Displaying Space In Between The First Bar" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png 512w, https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding-300x175.png 300w" sizes="(max-width: 512px) 100vw, 512px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-chart-domain-padding.png"/></noscript>
<p>现在我们来看看<code>data</code>道具。在我们的例子中，我们的<a href="https://formidable.com/open-source/victory/docs/common-props/#data" target="_blank" rel="noopener">数据</a>对象相当简单，但是如果您想从中获得更多，您可以向数据对象添加更多的键/值对。</p>
<pre>{ x: 1, y: 1, label: "first", symbol: "star", opacity: 0.5, fill: "blue" }</pre>
<p>这里我们的<code>x</code>和<code>y</code>属性指向一个数字而不是一个字符串。图表可以逐字呈现<code>x</code>和<code>y</code>的值(就像上面的例子)，或者它们可以基于指定的键找到值(就像在我们的例子中，使用了<code>earnings</code>和<code>year</code>)。</p>
<p>这对定制数据来说很好，因为我们不必转换键值对来遵循字面上的<code>x</code>和<code>y</code>解释。我们所要做的就是指定哪些键对应于 x 轴和 y 轴，这可以在有条件呈现的图表组件上声明。</p>
<p>还可以包含数据对象的样式和符号。但是，在最新版本的 Victory 中，这些样式不会自动应用，因此您需要向您的图表添加一个样式道具，这是一个在功能上呈现样式的对象。</p>
<p>见下文。</p>
<pre>style={{
    data: {
      fill: ({ datum }) =&gt; datum.fill,
      opacity: ({ datum }) =&gt; datum.opacity
    }
  }}</pre>
<p>需要注意的是，对于将数据呈现为一个数据集的图表(如<code>VictoryArea</code>和<code>VictoryLine</code> ), <code>datum</code>不是有效的道具。相反，你应该这样写样式。</p>
<pre>style={{ data: { fill: "#c43a31" } }}</pre>
<p>如果您想更好地定制颜色并为您的<code>VictoryArea</code>使用渐变而不是单一颜色，您可以使用 react-native-svg 提供的一些组件。</p>
<pre>import {Defs, LinearGradient, Stop} from "react-native-svg";</pre>
<p>将成为我们的说唱歌手。该组件“用于嵌入可在 SVG 图像中重用的定义”。<code>LinearGradient</code>嵌套在<code>Defs</code>组件中，用于生成应用程序中呈现的实际<code>LinearGradient</code>。在<code>LinearGradient</code>内部，我们将拥有多个<code>Stop</code>组件。一个<code><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/stop" target="_blank" rel="noopener">&lt;stop&gt;</a></code>元素“定义一种颜色和它在渐变中的位置。”</p>
<p>下面是我们为<code>VictoryArea</code>图表加入线性渐变的代码。它将被放置在<code>VictoryChart</code>内<code>{MyChart}</code>的正上方。</p>
<pre>&lt;Defs&gt;
   &lt;LinearGradient id="gradientStroke" &gt;
     &lt;Stop offset="0%" stopColor="red"/&gt;
     &lt;Stop offset="25%" stopColor="orange"/&gt;
     &lt;Stop offset="50%" stopColor="gold"/&gt;
     &lt;Stop offset="75%" stopColor="yellow"/&gt;
     &lt;Stop offset="100%" stopColor="green"/&gt;
  &lt;/LinearGradient&gt;
&lt;/Defs&gt;</pre>
<p>现在，为了让它与我们的面积图一起工作，我们需要为<code>VictoryArea</code>组件添加一些东西到我们的样式道具中。</p>
<pre>style={{
  data: {
    fill: 'url(#gradientStroke)',
    ...  
  }
}}</pre>
<p><code>url(#gradientStroke)</code>是将我们的面积图的填充样式与我们的<code>LinearGradient</code>组件(ID 为<code>gradientStroke</code>)中定义的各种色标连接起来的东西。下面是我们实现当前线性渐变 UI 时的<code>VictoryArea</code>图表。</p>
<p><img data-attachment-id="63688" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/victory-charts-gradient/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png" data-orig-size="384,264" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Victory charts gradient" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient-300x206.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png" decoding="async" class="aligncenter size-full wp-image-63688 jetpack-lazy-image" src="../Images/7ba5c16fe144895ccd40100b94e94d81.png" alt="Area Chart With A Gradient" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png 384w, https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient-300x206.png 300w" data-lazy-sizes="(max-width: 384px) 100vw, 384px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63688" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/victory-charts-gradient/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png" data-orig-size="384,264" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Victory charts gradient" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient-300x206.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-63688" src="../Images/7ba5c16fe144895ccd40100b94e94d81.png" alt="Area Chart With A Gradient" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png 384w, https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient-300x206.png 300w" sizes="(max-width: 384px) 100vw, 384px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/victory-charts-gradient.png"/></noscript>
<p>现在，梯度不符合我们的特定类别。它只是以 25%的增量将颜色渲染为整个图形的一部分。如果您希望它选择一种颜色并响应每个类别的大小(比如如果您动态添加更多数据)，您可以使用下面的代码，以及预定义的颜色列表。</p>
<pre>const genStops = () =&gt; {
    var percentage = 100 / chartData.length
    //initialize at 0%
    var stops = [&lt;Stop offset="0%" stopColor={colorArray[0]}/&gt;]
    chartData.forEach((x, i)=&gt;{
      console.log(pickColor(i))
      var stop = &lt;Stop offset={`${percentage * (i + 1)}%`}
                       stopColor={pickColor(i)}
                 /&gt;
      stops.push(stop)
    })
    return stops
  }

  const pickColor = (i) =&gt; {
    var index = indexHelper(i, colorArray.length)
    return colorArray[index]
  }

  const indexHelper = (a, b) =&gt; {
    //start from beginning of color array when chartData gets too long
    return a &gt;= b ? indexHelper(a - b, b) : a
  }

  const stops = genStops()</pre>
<p>然后在你的<code>LinearGradient</code>组件中，不包括单独的<code>Stop</code>组件，你可以只包括<code>{stops}</code>。现在，渐变图表的颜色与类别相对应，而不是硬编码并作为一个整体应用于图表。</p>
<p>我想介绍的最后一个特性是动画。这是您可以传递给图表的道具，用于控制图表呈现的动画样式(而不是让它们立即呈现)。</p>
<p>为了给你的图表添加动画，<code><a href="https://formidable.com/open-source/victory/docs/common-props/#animate" target="_blank" rel="noopener">animate</a></code>道具是一个很好的起点。这个道具是一个接受一些属性的对象，其中我们将使用<code>duration</code>、<code>easing</code>和<code>onLoad</code>。</p>
<p><code>Duration</code>指的是动画需要多长时间(毫秒)，<code>easing</code>是动画风格，<code>onLoad</code>是一个也可以指定<code>animate</code>属性的对象。这些属性应用于加载或更新的数据。</p>
<pre>animate={{
  onLoad: {duration: 1000},
  duration: 1000,
  easing: "bounce"
}}</pre>
<p>您可以将<code>animate</code>属性应用于<code>VictoryChart</code>或子图表。就我个人而言，当我将动画应用到<code>VictoryChart</code>时，我发现在图表类型之间转换时有问题，而如果我将它们直接添加到子图表，我没有问题。参见下图中的<code>animate</code>属性。</p>
<p><img data-attachment-id="63691" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/animated-victory-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart.gif" data-orig-size="512,311" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Animated victory chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart-300x182.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart.gif" decoding="async" class="aligncenter size-full wp-image-63691 jetpack-lazy-image" src="../Images/36206800da71ee44e0f54803c61fd93f.png" alt="Code With A Mobile Device Displaying Animation Of Additional Bars Appearing On Chart" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63691" data-permalink="https://blog.logrocket.com/creating-victory-charts-react-native/animated-victory-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart.gif" data-orig-size="512,311" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Animated victory chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart-300x182.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-63691" src="../Images/36206800da71ee44e0f54803c61fd93f.png" alt="Code With A Mobile Device Displaying Animation Of Additional Bars Appearing On Chart" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/animated-victory-chart.gif"/></noscript>
<p>关于动画的更多信息，请查看胜利图表的<a href="https://formidable.com/open-source/victory/guides/animations" target="_blank" rel="noopener">动画指南</a>。</p>
<h2>结论</h2>
<p>Victory 是一个健壮而有效的数据可视化库，它的组成并不太死板。它固执己见，但也提供了足够的灵活性，使开发人员能够从内置功能之外的图表中获得更多。</p>
<p>Victory 也很有优势，因为它不像其他库那样直接与 DOM 交互。这允许更好的运行时间，更少的 UI 冲突，并且对于 React Native 是最佳的。</p>
<p>这个项目的所有源代码都可以在 GitHub 上找到。</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现 React 原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款 React 原生监控解决方案，可帮助您即时重现问题、确定 bug 的优先级并了解 React 原生应用的性能。</p><p>LogRocket 还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket 的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的 React 原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用 LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>