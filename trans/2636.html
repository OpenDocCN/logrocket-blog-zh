<html>
<head>
<title>Define properties with Vue Property Decorator and TypeScript - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用 Vue Property Decorator 和 TypeScript 定义属性</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/define-properties-vue-property-decorator-typescript/#0001-01-01">https://blog.logrocket.com/define-properties-vue-property-decorator-typescript/#0001-01-01</a></blockquote><div><article class="article-post">
<p>Vue 3 引入了一种新的、<a href="https://blog.logrocket.com/new-features-in-vue-3-and-how-to-use-them-2/#thecompositionapi">更好的方式来创建组件，即组合 API </a>。Composition API 的特性使得在组件增长时更好地维护代码、轻松地重用代码以及编写可靠的代码成为可能，同时还提供了类型脚本支持。</p>
<p>然而，Vue 组件严重依赖于 JavaScript 对象的<code>this</code>关键字，这使得创建 TypeScript 对象变得令人困惑。为了解决这个问题，Vue 类组件插件使用 ECMAScript decorators 将静态类型的值直接传递给 Vue 中的组件，使编译器理解正在发生的事情。</p>
<p>在本文中，您将了解如何通过在基于 Vue 类的组件中支持 TypeScript，直接在 Vue 组件中的类上定义属性，如数据、方法、计算属性、props 和观察器。我们将使用 Vue Class Component 和 Vue Property Decorator，我们还将讨论各种 JavaScript 等价物。</p>
<h3>先决条件</h3>
<p>要跟随本教程，您需要了解 TypeScript。您还需要在本地机器上安装 npm 和 Node.js <em> ≥ </em> v12.22.0。要确认 Node.js 已安装，请在终端中运行以下命令:</p>
<pre class="language-bash hljs">node -v
</pre>
<p>如果没有安装 Node.js，可以按照官方<a href="https://nodejs.org/"> Node.js </a>网站上的说明操作。最后，你需要熟悉<a href="https://cli.vuejs.org/guide/installation.html">建立一个 Vue 项目</a>。我们开始吧！</p>
<h3>目录</h3>

<h2 id="project-setup">项目设置</h2>
<p>打开你的终端，进入你想要保存项目的目录。运行以下命令。请注意，您可以随意命名您的项目:</p>
<pre class="language-vue hljs">vue create vue-props-example
</pre>
<p>在设置您的 Vue 项目时，您会被问及一系列问题。出于本教程的目的，您应该选择以下配置:</p>
<table class="tg">
<colgroup>
<col/>
<col/> </colgroup>
<thead>
<tr>
<th class="tg-0pky"><span>提示</span></th>
<th class="tg-z4bo">[计]选项</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tg-0pky"><span>请选择一个预设</span></td>
<td class="tg-0pky">手动选择功能</td>
</tr>
<tr>
<td class="tg-0pky">检查项目所需的功能</td>
<td class="tg-0pky">以打字打的文件</td>
</tr>
<tr>
<td class="tg-0pky">选择您想要用来启动项目的 Vue 版本</td>
<td class="tg-0pky">3.x</td>
</tr>
<tr>
<td class="tg-0pky">使用类样式的组件语法？</td>
<td class="tg-0pky">Y</td>
</tr>
<tr>
<td class="tg-0pky">在 TypeScript 旁边使用 Babel？</td>
<td class="tg-0pky">Y</td>
</tr>
</tbody>
</table>
<p><img data-attachment-id="90681" data-permalink="https://blog.logrocket.com/define-properties-vue-property-decorator-typescript/vue-configurations-display/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vue-configurations-display" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png" decoding="async" class="aligncenter wp-image-90681 size-full jetpack-lazy-image" src="../Images/9ed4f81865e5e3ee4a21b471e87ff265.png" alt="Vue Configurations Display" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display-300x168.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png"/></p>
<p>如果你看一下<code>package.json</code>文件，你会看到通过用 TypeScript 安装我们的项目，我们也安装了<code><a href="https://github.com/vuejs/vue-class-component">vue-class-component</a></code>插件，它用于定义类风格的组件，在创建 TypeScript 和 Vue 3 项目时默认安装。</p><noscript><img data-lazy-fallback="1" data-attachment-id="90681" data-permalink="https://blog.logrocket.com/define-properties-vue-property-decorator-typescript/vue-configurations-display/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png" data-orig-size="730,410" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vue-configurations-display" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png" decoding="async" loading="lazy" class="aligncenter wp-image-90681 size-full" src="../Images/9ed4f81865e5e3ee4a21b471e87ff265.png" alt="Vue Configurations Display" srcset="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display-300x168.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/02/vue-configurations-display.png"/></noscript>
<p><code>App.vue</code>文件使用 Vue 类组件，它使用<code>Options</code>装饰器来定义一个 Vue 组件。此时，您有了一个包含 TypeScript 功能的 Vue 3 项目。</p>
<p>安装 Vue 属性装饰器</p>
<h2 id="installing-vue-property-decorator">Vue 的一些最重要的部分在 Vue 类组件中缺失了，比如 ECMAScript 装饰器像<code>props</code>、<code>inject</code>、<code>model</code>、<code>ref</code>、<code>emit</code>和<code>provide</code>。因此，Vue 社区引入了一个名为<a href="https://github.com/kaorun343/vue-property-decorator"> Vue Property Decorator </a>的库，它完全依赖于 Vue 类组件，并且现在得到了 Vue 核心团队的完全认可。</h2>
<p>我们将通过在项目目录中运行以下命令，在项目中安装 Vue Property Decorator:</p>
<p>现在，我们完全可以在 TypeScript 中使用基于类的组件。</p>
<pre class="language-bash hljs">npm i vue-property-decorator
</pre>
<p>创建 TypeScript Vue 组件</p>
<h2 id="creating-typescript-vue-component">使用类风格的组件语法，我们将通过扩展 Vue 对象来构建组件。在<code>App.vue</code>中，复制并粘贴以下代码，用 TypeScript 创建一个简单的单文件组件:</h2>
<p>上面的代码直接在类和方法上定义属性，这在<code>@Component(componentConfig)</code>装饰器的帮助下是可能的。在编译期间，<code>@Component(componentConfig)</code> decorator 将类转换成 Vue 可以理解的格式。</p>
<pre class="language-vue hljs">&amp;lt;template&gt;
  &lt;div&gt;
    &lt;label&gt;Update inputData
      &lt;input :value="inputData" @input="updateInputData($event)"/&gt;
    &lt;/label&gt;
    &lt;div&gt;{{ inputData }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
import { Component, Vue } from 'vue-property-decorator'

@Component
export default class App extends Vue {
  // Data property
  inputData: string = 'My Input Data'

  // Component method
  updateInputData ($event: { target: { value: string } }) {
    this.inputData = $event.target.value
  }
}
&lt;/script&gt;
</pre>
<p>现在，当应用程序被编译时，如果你在<code><a href="http://localhost:8080/" rel="nofollow">http://localhost:8080/</a></code>看你的浏览器，你会看到一个输入框和一些文本阅读<code>myInputData</code>。<code>myInputData</code>将与输入域交互，相应地更新以反映用户在浏览器上输入文本的变化。</p>
<p>定义道具</p>
<h2 id="defining-props">使用来自 Vue 属性装饰库的<code>@Prop</code>装饰器，我们可以在类上定义道具。我们还可以为道具提供额外的细节，比如<code>required</code>、<code>type</code>和<code>default</code>，以实现数据对象的可重用性。</h2>
<p>我们首先从 Vue 属性装饰器库中导入<code>Prop</code>装饰器，并编写以下代码:</p>
<p>上面的代码是用 TypeScript 编写的，定义了各种叫做<code>text</code>、<code>name</code>、<code>age</code>、<code>phone</code>和<code>job</code>的道具。为了避免修改道具，分配了<code>readonly</code>属性。</p>
<pre class="language-vue hljs">&lt;script lang="ts"&gt;
import { Component, Prop, Vue } from 'vue-property-decorator'

@Component
export default class App extends Vue {
  @Prop() readonly text!: string
  @Prop({default: 'John doe'}) readonly name: string
  @Prop({required: true}) readonly age: number
  @Prop(String) readonly phone: string
  @Prop({required: true, type: String, default: 'Student'}) readonly job: string
}
&lt;/script&gt;
</pre>
<p>在 JavaScript 中，上面的代码相当于下面的代码:</p>
<p>定义计算属性</p>
<pre class="language-javascript hljs">&amp;lt;script&gt;
export default {
  props: {
    text,
    name: {
      default: 'John doe'
    },
    age: {
      required: true,
    },
    phone: {
      type: String
    },
    job: {
      required: true,
      type: String,
      default: 'Student'
    }
  }
}
&lt;/script&gt;
</pre>
<h2 id="defining-computed-properties">计算出的属性被写成<code>getters</code>和<code>setters</code>，并在类上定义。为了进行演示，下面的示例包含 TypeScript 中的计算属性，这些计算属性获取一个名为<code>computedProp</code>的计算属性，并返回一个随机数，将其显示在浏览器上:</h2>
<p>与上述代码等价的 JavaScript 代码是:</p>
<pre class="language-typescript hljs">&lt;template&gt;
  &lt;div&gt;{{ computedProp }}&lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
import { Component, Vue } from 'vue-property-decorator'

@Component
export default class App extends Vue {
  get computedProp() {
    return Math.random()
  }
}
&lt;/script&gt;
</pre>
<p>定义观察者</p>
<pre class="language-javascript hljs">&lt;style&gt;
export default {
  computed: {
    computedProp() {
      return Math.random()
    }
  }
}
&lt;/style&gt;
</pre>
<h2 id="defining-watchers">我们可以通过从 Vue Property Decorator 库中导入<code>@Watch(propertyString, config)</code> decorator 来定义类的观察者。您会注意到这与通常用 JavaScript 编写的完全不同。</h2>
<p>下面是 TypeScript 中的一个例子，它观察<code>myWatchedData</code>何时触发<code>onDataChanged</code>:</p>
<p>与上述代码等价的 JavaScript 代码是:</p>
<pre class="language-typescript hljs">&lt;template&gt;
  &lt;div&gt;
    &lt;label&gt;Update myWatchedData
      &lt;input :value="myWatchedData" @input="updateMyData($event)"/&gt;
    &lt;/label&gt;
    &lt;div&gt;{{ myWatchedDataStatus }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
import { Component, Watch, Vue } from 'vue-property-decorator'

@Component
export default class App extends Vue {
  myWatchedData: string = 'Watched Data'
  myWatchedDataStatus: string = ''

  @Watch('myWatchedData')
  onDataChanged(value: string, oldValue: string) {
    this.myWatchedDataStatus = 'Watched Data Changed'
  }

  updateMyData ($event: { target: { value: string } }) {
    this.myWatchedPData = $event.target.value
  }
}
&lt;/script&gt;
</pre>
<p>使用上面的代码，当您在<code><a href="http://localhost:8080/" rel="nofollow">http://localhost:8080/</a></code>访问浏览器时，您会看到一个输入字段。现在，更改输入值将显示消息<code>Watched Data Changed</code>。</p>
<pre class="language-javascript hljs">&amp;lt;script&gt;
export default {
  data() {
    return {
      myWatchedProperty: null
    }
  }

  methods: {
    onPropertyChanged(value, oldValue) {
      // ...
    }
  }

  watch: {
    myWatchedProperty: {
      handler: 'onPropertyChanged',
      immediate: false,
      deep: true
    }
  }
}
&lt;/script&gt;
</pre>
<p>结论</p>
<h2 id="conclusion">在本文中，我们使用 Vue 类组件和 Vue 属性装饰器直接在 Vue 组件中的类上定义属性，允许我们在基于 Vue 类的组件中支持 TypeScript。</h2>
<p>本文介绍了各种各样的装饰者，如<code>component</code>、<code>prop</code>、<code>watch</code>、<code>get</code>。你可以在上面链接的 Vue Class Component 和 Vue Property Decorator 的文档中了解更多关于 Decorator 和基于类的声明的信息。</p>
<p>对于初学者来说，用 TypeScript 创建 Vue 组件可能有点混乱，但是当你习惯了它，你就会享受到它带来的所有好处，使你的应用程序更加可靠。我希望你喜欢这篇文章，快乐编码！</p>
<p>像用户一样体验您的 Vue 应用</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>调试 Vue.js 应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的 Vue 突变感兴趣，</h2><p>. </p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>LogRocket 就像是网络和移动应用程序的 DVR，记录你的 Vue 应用程序中发生的一切，包括网络请求、JavaScript 错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket Vuex 插件将 Vuex 突变记录到 LogRocket 控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试 Vue 应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p><p>Modernize how you debug your Vue apps - <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a>.</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>