<html>
<head>
<title>Using Material UI with React Hook Form - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用带有 React Hook 表单的材质 UI</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/using-material-ui-with-react-hook-form/#0001-01-01">https://blog.logrocket.com/using-material-ui-with-react-hook-form/#0001-01-01</a></blockquote><div><article class="article-post">
<p>React Hook Form 是 React 生态系统中最流行的处理表单输入的库之一。如果您正在使用一个组件库，比如 Material UI，让它正常工作可能会很棘手。</p>
<p>在本指南中，我们将演示如何使用 React 钩子表单的材质 UI。如果你想集成一些其他的<a href="https://blog.logrocket.com/top-7-ui-libraries-and-kits-for-react/" target="_blank" rel="noopener"> React UI 库</a>，比如 Ant Design 或者 Semantic UI，这个教程也是有帮助的。</p>
<p>为了跟上进度，你应该已经对<a href="https://blog.logrocket.com/using-material-ui-in-react-native/" target="_blank" rel="noopener">材质 UI </a>和<a href="https://blog.logrocket.com/the-complete-guide-to-react-hook-form/" target="_blank" rel="noopener">反应钩子形式</a>有所了解。我们不会深入探究如何使用这些库。相反，我们将关注它们之间的集成。</p>
<p>为了展示如何在 React Hook 表单中使用 Material UI，我们将使用 Material UI 提供的最常用的输入组件构建一个完整的表单，包括:</p>
<ul>
<li>文本输入</li>
<li>无线电信号输入</li>
<li>下拉式</li>
<li>日期</li>
<li>检验盒</li>
<li>滑块</li>
</ul>
<p>该表单还将具有重置功能。它看起来会像这样:</p>
<p><img data-attachment-id="62701" data-permalink="https://blog.logrocket.com/using-material-ui-with-react-hook-form/material-ui-react-hook-form-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png" data-orig-size="720,577" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Material UI and React Hook Form example" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example-300x240.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png" decoding="async" class="aligncenter size-full wp-image-62701 jetpack-lazy-image" src="../Images/bf64c7ae8a4a287ce4879713eb80749f.png" alt="Material UI and React Hook Form Example" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png 720w, https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example-300x240.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="62701" data-permalink="https://blog.logrocket.com/using-material-ui-with-react-hook-form/material-ui-react-hook-form-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png" data-orig-size="720,577" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Material UI and React Hook Form example" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example-300x240.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-62701" src="../Images/bf64c7ae8a4a287ce4879713eb80749f.png" alt="Material UI and React Hook Form Example" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png 720w, https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example-300x240.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-example.png"/></noscript>
<p>如果你更喜欢视觉学习，请查看附带的视频教程:</p>
<p><span class="embed-youtube"> <iframe loading="lazy" class="youtube-player" src="https://www.youtube.com/embed/aaj6YCil1p4?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation">视频</iframe> </span></p>
<h2 id="text-input-component">文本输入组件</h2>
<p>让我们从一个简单的表单组件开始。该组件中只有一个文本输入。</p>
<p>要在没有任何库的情况下通过传统方法构建该表单，我们需要单独处理输入的更改。我们还必须自己负责重置功能和验证。</p>
<p>它可能看起来像这样:</p>
<pre>import TextField from "@material-ui/core/TextField";
import React, { useState } from "react";
import { Button, Paper } from "@material-ui/core";

export const FormWithoutHookForm = () =&gt; {
  const [textValue, setTextValue] = useState&lt;string&gt;("");

  const onTextChange = (e: any) =&gt; setTextValue(e.target.value);
  const handleSubmit = () =&gt; console.log(textValue);
  const handleReset = () =&gt; setTextValue("");

  return (
    &lt;Paper&gt;
      &lt;h2&gt;Form Demo&lt;/h2&gt;

      &lt;TextField
        onChange={onTextChange}
        value={textValue}
        label={"Text Value"} //optional
      /&gt;

      &lt;Button onClick={handleSubmit}&gt;Submit&lt;/Button&gt;
      &lt;Button onClick={handleReset}&gt;Reset&lt;/Button&gt;
    &lt;/Paper&gt;
  );
};
</pre>
<p>输出将如下所示:</p>
<p><img data-attachment-id="62704" data-permalink="https://blog.logrocket.com/using-material-ui-with-react-hook-form/material-ui-react-hook-form-text-input-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png" data-orig-size="720,315" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Material UI and React Hook Form text input component example" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example-300x131.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png" decoding="async" class="aligncenter size-full wp-image-62704 jetpack-lazy-image" src="../Images/069a98912e1eabb78ec290101988f3b3.png" alt="Material UI and React Hook Form Text Input Component Example" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png 720w, https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example-300x131.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="62704" data-permalink="https://blog.logrocket.com/using-material-ui-with-react-hook-form/material-ui-react-hook-form-text-input-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png" data-orig-size="720,315" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Material UI and React Hook Form text input component example" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example-300x131.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-62704" src="../Images/069a98912e1eabb78ec290101988f3b3.png" alt="Material UI and React Hook Form Text Input Component Example" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png 720w, https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example-300x131.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/material-ui-react-hook-form-text-input-example.png"/></noscript>
<p>这里我们使用 React 本身提供的<code>useState</code>钩子来存储值:</p>
<pre>const [textValue, setTextValue] = useState&lt;string&gt;("");
</pre>
<p>此外，我们在<code>onTextChange</code>函数中设置来自输入的值:</p>
<pre>const onTextChange = (e: any) =&gt; setTextValue(e.target.value);
</pre>
<p>如果我们查看由<code>material-ui</code>提供的<code>TextInput</code>组件，我们可以看到有两个重要的道具传递给它:<code>value</code>和<code>onChange</code>。<code>value</code>负责输入的实际值，而<code>onChange</code>决定输入改变时会发生什么。无论我们如何使用这种形式，我们都需要注意这两点。</p>
<h2 id="setting-up-react-hooks-form">设置 React 挂钩表单</h2>
<p>React Hook Form 从著名的<code>useForm</code>钩子中导出了一些实用程序，然后可以在输入组件中使用它们。</p>
<p>首先，导入<code>useForm</code>钩子:</p>
<pre>import { useForm } from "react-hook-form";
</pre>
<p>然后，使用组件内的挂钩:</p>
<pre>const { register } = useForm();
</pre>
<p>典型的输入可能如下所示:</p>
<pre>&lt;input type="text" ref={register} name="firstName" /&gt;
</pre>
<p>仔细看这里:我们将<code>register</code>作为一个值传递给实际输入组件的<code>ref</code>。所有的魔法都发生在幕后。</p>
<p><a href="https://reactstrap.github.io/" target="_blank" rel="noopener"> reactstrap </a>提供了一个类似的名为<code>innerRef</code>的道具，可以通过我们的<code>register</code>与<code>react-hook-form</code>无缝集成。</p>
<p>不幸的是，当我们使用材质 UI 时，情况并非如此；该库还没有提供任何类似的属性来将<code>register</code>作为一个值传递给<code>ref</code>属性。</p>
<h2 id="the-controller-component"><code>Controller</code>组件</h2>
<p>React Hook Form 包含一个名为<code>Controller</code>的包装器组件，用于处理不能直接访问<code>ref</code>的组件库。</p>
<p>根据<a href="https://reactjs.org/docs/render-props.html" target="_blank" rel="noopener"> React 文档</a>，这是一个 render prop——一个返回 React 元素并提供将事件和值附加到组件中的功能。</p>
<p>这个特殊<code>Controller</code>组件的框架如下:</p>
<pre>&lt;Controller
  control={control}
  name="test"
  render={({
    field: { onChange, onBlur, value, name, ref },
    fieldState: { invalid, isTouched, isDirty, error },
    formState,
  }) =&gt; ( WHATEVER_INPUT_WE_WANT )}
/&gt;
</pre>
<p>让我们来分析一下这里发生了什么:</p>
<ul>
<li><code>control</code>是一个道具，我们从<code>useForm</code>钩子得到它，并将其传递给输入</li>
<li>是 React Hook Form 如何在内部跟踪输入的值</li>
<li><code>render</code>是最重要的道具；我们在这里传递一个渲染函数</li>
</ul>
<h2 id="the-render-prop"><code>render</code>道具</h2>
<p><code>Controller</code>的<code>render</code>属性是理解的最重要道具。该功能有三个按键:<code>field</code>、<code>fieldState</code>和<code>formState</code>。我们现在将重点放在<code>field</code>上。</p>
<p>对象导出两个东西(除了别的以外):<code>value</code>和<code>onChange</code>。我们已经看到，我们需要这两个东西来控制几乎任何输入。</p>
<h2 id="refactoring-our-form">重构我们的表单</h2>
<p>所以让我们看看<code>Controller</code>组件是否真的解决了我们的问题。我们将使用<code>Controller</code>组件并在渲染函数中传递<code>TextInput</code>。</p>
<p>让我们首先从<code>useForm</code>钩子中提取出我们需要的东西:</p>
<pre>const { handleSubmit, reset, control } = useForm();
</pre>
<p>然后，像这样使用表单中的<code>Controller</code>组件:</p>
<pre>import TextField from "@material-ui/core/TextField";
import React, { useState } from "react";
import { Button, Paper } from "@material-ui/core";
import { Controller, useForm } from "react-hook-form";

export const FormWithHookForm = () =&gt; {
  const { handleSubmit, reset, control } = useForm();
  const onSubmit = (data: any) =&gt; console.log(data);

  return (
    &lt;form&gt;
      &lt;Controller
        name={"textValue"}
        control={control}
        render={({ field: { onChange, value } }) =&gt; (
          &lt;TextField onChange={onChange} value={value} label={"Text Value"} /&gt;
        )}
      /&gt;
      &lt;Button onClick={handleSubmit(onSubmit)}&gt;Submit&lt;/Button&gt;
      &lt;Button onClick={() =&gt; reset()} variant={"outlined"}&gt;Reset&lt;/Button&gt;
    &lt;/form&gt;
  );
};
</pre>
<p>这个表单的工作方式和前面的一样。神奇的事情发生了，这要感谢由<code>Controller</code>提供的渲染函数的<code>field</code>属性。</p>

<p>所以我们现在知道如何使用 React Hook 表单的<code>Controller</code>组件让表单在没有任何<code>ref</code>的情况下工作。现在让我们将输入组件提取到一个单独的组件中，这样我们就可以在任何地方使用它。</p>
<p>这个通用组件需要来自其父组件的三个支持:</p>
<ul>
<li><code>name</code>，用于输入的键</li>
<li>用于访问 React 钩子表单的功能</li>
<li><code>label</code>，输入的标签(可选)</li>
</ul>
<pre>import TextField from "@material-ui/core/TextField";
import { Controller } from "react-hook-form";
import React from "react";

export const FormInputText = ({ name, control, label }) =&gt; {
  return (
     (
        
      )}
    /&gt;
  );
};
</pre>
<p>我们将在表单中使用这个组件，如下所示:</p>
<pre>import { FormInputText } from "./FormInputTextGood";

export const FormWithHookForm = () =&gt; {
  // rest are same as before
  return (
    &lt;form&gt;
      &lt;FormInputText
        name={"textInput"}
        control={control}
        label={"Text Input"}
      /&gt;
    &lt;/form&gt;
  );
};
</pre>
<p>现在组件更容易理解和重用。让我们也关注一些其他的输入。</p>
<h2 id="the-radio-input-component"><code>Radio</code>输入组件</h2>
<p>第二常见的输入元件是<code>Radio</code>。这里有一个重要的概念需要记住。</p>
<p>如果你已经使用过材质 UI 中的<code>Radio</code>，你就已经知道你需要<code>RadioGroup</code>组件作为父组件，以及里面的一堆选项，比如单个的<code>Radio</code>按钮，作为子组件:</p>
<pre>import React from "react";
import {
  FormControl,
  FormControlLabel,
  FormLabel,
  Radio,
  RadioGroup,
} from "@material-ui/core";
import { Controller, useFormContext } from "react-hook-form";
import { FormInputProps } from "./FormInputProps";

const options = [
  {
    label: "Radio Option 1",
    value: "1",
  },
  {
    label: "Radio Option 2",
    value: "2",
  },
];

export const FormInputRadio: React.FC&lt;FormInputProps&gt; = ({ name,control,label }) =&gt; {
  const generateRadioOptions = () =&gt; {
    return options.map((singleOption) =&gt; (
      &lt;FormControlLabel
        value={singleOption.value}
        label={singleOption.label}
        control={&lt;Radio /&gt;}
      /&gt;
    ));
  };  

  return &lt;Controller
      name={name}
      control={control}
      render={({field: { onChange, value }}) =&gt; (
        &lt;RadioGroup value={value} onChange={onChange}&gt;
          {generateRadioOptions()}
        &lt;/RadioGroup&gt;
      )}
    /&gt;
};
</pre>
<p>这里的主要概念是相同的。我们只是使用来自渲染函数<code>field</code>对象的<code>onChange</code>和<code>value</code>，并将其传递给<code>RadioGroup</code>。</p>
<p>注意，我们在这里没有使用<code>label</code>。如果你想使用它，你需要添加材质 UI 的<code>FormControl</code>和<code>FormLabel</code>组件。</p>
<p>另请注意，使用了一个特殊功能<code>generateRadioOptions</code>来生成单独的无线电输入。我们在组件中添加了常量<code>options</code>。你可以把它们作为道具或者任何你认为合适的方式。</p>
<h2 id="dropdown">掉下</h2>
<p>几乎任何形式都需要某种下拉菜单。<code>Dropdown</code>组件的代码如下:</p>
<pre>import React from "react";
import { FormControl, InputLabel, MenuItem, Select } from "@material-ui/core";
import { useFormContext, Controller } from "react-hook-form";
import { FormInputProps } from "./FormInputProps";

const options = [
  {
    label: "Dropdown Option 1",
    value: "1",
  },
  {
    label: "Dropdown Option 2",
    value: "2",
  },
];

export const FormInputDropdown= ({name,control, label}) =&gt; {

  const generateSelectOptions = () =&gt; {
    return options.map((option) =&gt; {
      return (
        &lt;MenuItem key={option.value} value={option.value}&gt;
          {option.label}
        &lt;/MenuItem&gt;
      );
    });
  };

  return &lt;Controller
      control={control}
      name={name}
      render={({ field: { onChange, value } }) =&gt; (
        &lt;Select onChange={onChange} value={value}&gt;
          {generateSelectOptions()}
        &lt;/Select&gt;
      )}
    /&gt;
};
</pre>
<h2 id="date input">日期输入</h2>
<p>这是一个普通而特殊的组件。在 Material UI 中，我们没有任何开箱即用的组件。我们需要利用一些助手库。</p>
<p>首先，安装这些依赖项:</p>
<pre>yarn add @date-io/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="90f4f1e4f5bdf6fee3d0a1bea3bea1a3">[email protected]</a> @material-ui/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="74041d171f11060734475a475a4544">[email protected]</a> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2f4b4e5b4a0249415c6f1d011d1d011e">[email protected]</a>
</pre>
<p>小心版本。否则，您可能会遇到一些奇怪的问题。</p>
<p>我们还需要用一个特殊的包装器<code>MuiPickersUtilsProvider</code>包装我们的数据输入组件。这将为我们注入日期选择器功能。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自 LogRocket 的精彩文章:</h3>

<hr/></div>
<p>记住，这不是 React 钩子形式的要求；这是物料界面所要求的。因此，如果您使用任何其他设计库，如 Ant Design 或语义 UI，您不需要担心这一点。</p>
<pre>import React from "react";
import DateFnsUtils from "@date-io/date-fns";
import { KeyboardDatePicker, MuiPickersUtilsProvider} from "@material-ui/pickers";
import { Controller } from "react-hook-form";
const DATE_FORMAT = "dd-MMM-yy";

export const FormInputDate = ({ name, control, label }) =&gt; {
  return (
    &lt;MuiPickersUtilsProvider utils={DateFnsUtils}&gt;
      &lt;Controller
        name={name}
        control={control}
        render={({ field : {onChange , value } }) =&gt; (
          &lt;KeyboardDatePicker
            onChange={onChange}
            value={value}
            label={label}
          /&gt;
        )}
      /&gt;
    &lt;/MuiPickersUtilsProvider&gt;
  );
};
</pre>
<h2 id="checkbox-group">复选框组</h2>
<p>如果你想使用一个简单的像开关一样工作的复选框，那么它很容易使用。你只需要像前面的组件一样使用它，所以我不会再次展示相同的东西。</p>
<p>但是，当您想要创建一组复选框并将选定的值设置为选定项的数组时，情况就变得复杂了。这里的主要挑战是 Material UI 不提供多选复选框组件。</p>
<p>没有明确的例子说明如何使用 React 钩子形式的这个组件。要启用此功能，我们必须维护选定项目的本地状态:</p>
<pre>import React, { useEffect, useState } from "react";
import {Checkbox,FormControl,FormControlLabel,FormLabel} from "@material-ui/core";
import { Controller } from "react-hook-form";

const options = [
  {
    label: "Checkbox Option 1",
    value: "1",
  },
  {
    label: "Checkbox Option 2",
    value: "2",
  },
];

export const FormInputMultiCheckbox= ({name,control,setValue,label}) =&gt; {
  const [selectedItems, setSelectedItems] = useState&lt;any&gt;([]);

  // we are handling the selection manually here
  const handleSelect = (value: any) =&gt; {
    const isPresent = selectedItems.indexOf(value);
    if (isPresent !== -1) {
      const remaining = selectedItems.filter((item: any) =&gt; item !== value);
      setSelectedItems(remaining);
    } else {
      setSelectedItems((prevItems: any) =&gt; [...prevItems, value]);
    }
  };

  // we are setting form value manually here
  useEffect(() =&gt; {
    setValue(name, selectedItems); 
  }, [selectedItems]);

  return (
    &lt;FormControl size={"small"} variant={"outlined"}&gt;
      &lt;FormLabel component="legend"&gt;{label}&lt;/FormLabel&gt;

      &lt;div&gt;
        {options.map((option: any) =&gt; {
          return (
            &lt;FormControlLabel
              control={
                &lt;Controller
                  name={name}
                  render={({}) =&gt; {
                    return (
                      &lt;Checkbox
                        checked={selectedItems.includes(option.value)}
                        onChange={() =&gt; handleSelect(option.value)}
                      /&gt;
                    );
                  }}
                  control={control}
                /&gt;
              }
              label={option.label}
              key={option.value}
            /&gt;
          );
        })}
      &lt;/div&gt;
    &lt;/FormControl&gt;
  );
};
</pre>
<p>所以在这个组件中，我们手动控制<code>value</code>和<code>onChange</code>。这就是为什么在<code>render</code>函数中我们不再使用<code>field</code>道具的原因。为了设定价值，我们在这里采用了另一个名为<code>setValue</code>的新道具。该功能是<code>react-hook-form</code>的特殊功能，用于手动设定值。</p>
<p>您可能会问，如果我们手动处理输入，为什么还要这样做？答案是当你使用<code>react-hook-form</code>时，你希望所有的输入都在一个地方。所以我们在这里给这个<code>MultiSelectCheckbox</code>组件一个特殊的处理，这样它可以很容易地与其他组件一起工作。</p>
<h2 id="slider">滑块</h2>
<p>我们的最后一个组件是一个<code>Slider</code>组件，这是一个相当常见的组件。</p>
<p>代码很容易理解，但有一个问题:Material UI 提供的<code>onChange</code>函数不能与 React Hook 表单的<code>onChange</code>一起使用，因为签名不同。</p>
<p>因此，当我们试图在 React Hook 表单的<code>Controller</code>组件中使用<code>Slider</code>组件时，它会抛出错误。同样，我们必须维护一个本地状态来控制<code>onChange</code>并手动设置值。</p>
<p>该组件的完整代码如下:</p>
<pre>import React, { useEffect } from "react";
import { Slider } from "@material-ui/core";
import { Controller } from "react-hook-form";

export const FormInputSlider = ({name,control,setValue,label}) =&gt; {
  const [sliderValue, setSliderValue] = React.useState(0);

  useEffect(() =&gt; {
    if (sliderValue) setValue(name, sliderValue);
  }, [sliderValue]);

  const handleChange = (event: any, newValue: number | number[]) =&gt; {
    setSliderValue(newValue as number);
  };

  return &lt;Controller
      name={name}
      control={control}
      render={({ field, fieldState, formState }) =&gt; (
        &lt;Slider
          value={sliderValue}
          onChange={handleChange}
        /&gt;
      )}
    /&gt;
};
</pre>
<h2 id="putting-it-all-together">把所有的放在一起</h2>
<p>现在让我们在表单中使用所有这些组件。我们的表单将利用我们刚刚制作的所有可重用组件:</p>
<pre>import { Button, Paper, Typography } from "@material-ui/core";
import { FormProvider, useForm } from "react-hook-form";
import { FormInputText } from "./form-components/FormInputText";
import { FormInputMultiCheckbox } from "./form-components/FormInputMultiCheckbox";
import { FormInputDropdown } from "./form-components/FormInputDropdown";
import { FormInputDate } from "./form-components/FormInputDate";
import { FormInputSlider } from "./form-components/FormInputSlider";
import { FormInputRadio } from "./form-components/FormInputRadio";

const defaultValues = {
  textValue: "",
  radioValue: "",
  checkboxValue: [],
  dateValue: new Date(),
  dropdownValue: "",
  sliderValue: 0,
};

export const FormDemo = () =&gt; {
  const methods = useForm({ defaultValues: defaultValues });
  const { handleSubmit, reset, control, setValue } = methods;
  const onSubmit = (data: IFormInput) =&gt; console.log(data);

  return (
    &lt;Paper&gt;
      &lt;Typography variant="h6"&gt; Form Demo &lt;/Typography&gt;

      &lt;FormInputText name="textValue" control={control} label="Text Input" /&gt;
      &lt;FormInputRadio name={"radioValue"} control={control} label={"Radio Input"} /&gt;
      &lt;FormInputDropdownname="dropdownValue"control={control}label="Dropdown Input"/&gt;
      &lt;FormInputDate name="dateValue" control={control} label="Date Input" /&gt;

      &lt;FormInputMultiCheckbox
        control={control}
        setValue={setValue}
        name={"checkboxValue"}
        label={"Checkbox Input"}
      /&gt;

      &lt;FormInputSlider
        name={"sliderValue"}
        control={control}
        setValue={setValue}
        label={"Slider Input"}
      /&gt;

      &lt;Button onClick={handleSubmit(onSubmit)} variant={"contained"}&gt;
        Submit
      &lt;/Button&gt;
      &lt;Button onClick={() =&gt; reset()} variant={"outlined"}&gt;
        Reset
      &lt;/Button&gt;
    &lt;/Paper&gt;
  );
};
</pre>
<h2 id="conclusion">结论</h2>
<p>现在我们的表单更干净，性能更好。从这里，我们可以非常容易地添加我们的<a href="https://blog.logrocket.com/the-ultimate-roundup-of-react-form-validation-solutions/" target="_blank" rel="noopener">表单验证逻辑和错误处理</a>。</p>
<p>要自己试验这个例子，可以查看一下<a href="https://github.com/Mohammad-Faisal/react-hook-form-material-ui" target="_blank" rel="noopener"> GitHub </a>上的完整代码。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产 React 应用</h2><p>调试 React 应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪 Redux 状态、自动显示 JavaScript 错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的 web 和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket 不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux 中间件包为您的用户会话增加了一层额外的可见性。LogRocket 记录 Redux 存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试 React 应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>