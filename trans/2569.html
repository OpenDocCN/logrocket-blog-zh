<html>
<head>
<title>Build interactive charts with Flask and D3.js - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用 Flask 和 D3.js - LogRocket 博客构建交互式图表</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/build-interactive-charts-flask-d3js/#0001-01-01">https://blog.logrocket.com/build-interactive-charts-flask-d3js/#0001-01-01</a></blockquote><div><article class="article-post">
<p>多年来，数据分析对各个行业的影响越来越大，因为它已经成为公司决策的一个重要部分。数据分析技术可以揭示趋势、模式和指标，从而提供见解和优化。这就是为什么开发人员应该了解如何构建能够轻松实现数据可视化的程序。</p>
<p><a href="https://flask.palletsprojects.com/en/2.0.x/" target="_blank" rel="noopener"> Flask </a>是一个 Python web 框架，它提供了构建 web 应用程序所需的工具、库和技术。<a href="https://d3js.org/" target="_blank" rel="noopener"> D3.js </a>是一个 JavaScript 库，它使用数据操纵 DOM 元素来呈现可视化组件。</p>
<p>在本文中，使用<a href="https://blog.logrocket.com/build-deploy-flask-app-using-docker/" target="_blank" rel="noopener"> Flask </a>和 D3.js，您将构建一个简单的交互式数据仪表板，它将帮助您了解与<a href="https://www.kaggle.com/blastchar/telco-customer-churn" target="_blank" rel="noopener">假设客户流失率</a>相关的一些因素。本文将具体介绍:</p>

<h2 id="why-should-flask-d3-used-together">为什么 Flask 和 D3 要一起用？</h2>
<p>与其他框架相比，Flask 和 D3 需要的开发时间最少。D3 为您提供了灵活性和对可视化的完全控制，允许您按照自己的意愿定制数据。您可以用 D3 创建的可视化数量几乎是无限的，并且受到您的创造力水平的限制。</p>
<p>Flask 最适合构建轻量级应用程序。当与在交互性方面非常快的 D3 结合时，整体用户体验可以是相当愉快的。它们都是开源项目，这意味着您可以在两个源代码的基础上构建，并向它们贡献您的特性。</p>
<p>尽管 D3 以其陡峭的学习曲线和对初学者不太友好而闻名，但是您对 HTML、CSS 和 SVG 的丰富知识应该足以让您开始学习 D3。</p>
<p>同样，Flask 是初学者友好的，你可以基于你的 Python 基础知识开发简单的 Flask web 应用程序。这两个框架都有一个庞大的开发人员社区，他们正在积极地改进这些库，并且如果需要的话，可能能够提供帮助。</p>
<h2 id="project-setup-environment">项目设置和环境</h2>
<p>有必要创建一个隔离的本地环境来指定只适用于这个项目的各种已安装的包和版本，以防止全局安装和包冲突。</p>
<h3 id="overview-project-workflow">项目工作流程概述</h3>
<p>首先创建一个虚拟 Python 环境。</p>
<pre class="language-bash hljs">pip install virtualenv</pre>
<p>导航到项目根文件夹并创建虚拟环境:</p>
<pre class="language-bash hljs">virtualenv flask
</pre>
<p>必须先激活虚拟环境，然后才能安装软件包。在项目根文件夹中，执行:</p>
<pre class="language-bash hljs">source flask/bin/activate
</pre>
<p>激活后，您的终端应该在括号中包含虚拟环境名称，如下所示:</p>
<p id="gdcalert1"><img data-attachment-id="113469" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/virtual-environment-name-display/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png" data-orig-size="730,45" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="virtual-environment-name-display" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display-300x18.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png" decoding="async" class="aligncenter size-full wp-image-113469 jetpack-lazy-image" src="../Images/32b129c9e3bd5fae8d5bfe8c0a9b55db.png" alt="Our virtual environment name is displayed in the terminal" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display-300x18.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="113469" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/virtual-environment-name-display/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png" data-orig-size="730,45" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="virtual-environment-name-display" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display-300x18.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-113469" src="../Images/32b129c9e3bd5fae8d5bfe8c0a9b55db.png" alt="Our virtual environment name is displayed in the terminal" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display-300x18.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/virtual-environment-name-display.png"/></noscript>
<p>使用以下命令从终端安装 Flask:</p>
<pre class="language-bash hljs">pip install Flask</pre>
<p>安装 Pandas 库:</p>
<pre class="language-bash hljs">pip install pandas
</pre>
<p>安装 NumPy 库:</p>
<pre class="language-bash hljs">pip install numpy
</pre>
<p>运行以下命令来生成一个包含项目依赖关系的<code>requirements.txt</code>文件:</p>
<pre class="language-bash hljs">pip freeze &gt; requirements.txt
</pre>
<p><code>requirements.txt</code>文件至少应包含以下包:</p>
<ul>
<li><code>certifi==2021.10.8</code></li>
<li><code>click==8.0.3</code></li>
<li><code>Flask==2.0.2</code></li>
<li><code>itsdangerous==2.0.1</code></li>
<li><code>Jinja2==3.0.3</code></li>
<li><code>MarkupSafe==2.0.1</code></li>
<li><code>numpy==1.21.2</code></li>
<li><code>pandas==1.3.5</code></li>
<li><code>python-dateutil==2.8.2</code></li>
<li><code>pytz==2021.3</code></li>
<li><code>six==1.16.0</code></li>
<li><code>Werkzeug==2.0.2</code></li>
</ul>
<p>您的需求文件中生成的版本号可能与这里所写的不同，因为这取决于您正在构建的应用程序的类型以及您在构建应用程序时已经安装的包的版本。</p>
<p>如果您更愿意从 GitHub 存储库中的<a href="https://github.com/codebrain001/Interactive-charts-for-frontend-data-visualization-using-flask-and-D3js/blob/main/requirements.txt" target="" rel="noopener"> <code>requirements.txt</code>文件</a>中获取这个项目的文件，那么在将存储库中的文件内容复制到您的项目中之后，运行以下命令:</p>
<pre class="language-bash hljs">pip install -r requirements.txt
</pre>
<p>成功安装所需的 Python 包后，可以继续设置项目文件结构和所需的文件，如下所示:</p>
<pre class="language-plaintext hljs">.
├── README.md
├── app.py
├── flask
├── requirements.txt
├── static
│   ├── css
│   ├── data
│   ├── js
│   └── logo.jpeg
└── templates
    └── index.html
</pre>
<p>Flask 应用程序接收客户流失数据，并使用 Python 执行<a href="https://en.wikipedia.org/wiki/Data_wrangling" target="_blank" rel="noopener">数据争论</a>操作，然后将格式化的数据发送到数据仪表板。这里，<a href="https://blog.logrocket.com/using-d3-js-v6-with-react/" target="_blank" rel="noopener"> D3.js </a>将使用 JavaScript 呈现各自的图表。</p>
<p>下面是我们刚刚构建的环境的图示:</p>
<p id="gdcalert2"><img data-attachment-id="113472" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/graphical-view-virtual-environment/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png" data-orig-size="730,268" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="graphical-view-virtual-environment" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment-300x110.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png" decoding="async" class="aligncenter size-full wp-image-113472 jetpack-lazy-image" src="../Images/e97e39a58721bbf0762ff9f832e3fa0f.png" alt="A graphical representation of the virtual environment" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment-300x110.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="113472" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/graphical-view-virtual-environment/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png" data-orig-size="730,268" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="graphical-view-virtual-environment" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment-300x110.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-113472" src="../Images/e97e39a58721bbf0762ff9f832e3fa0f.png" alt="A graphical representation of the virtual environment" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment-300x110.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/graphical-view-virtual-environment.png"/></noscript>
<h2 id="anatomy-flask-web-app">剖析 Flask web 应用程序</h2>
<p>Python 脚本是一个包含入口点、路由和端点的 Flask 实例。Python 的<a href="https://pandas.pydata.org/" target="_blank" rel="noopener">熊猫</a>和<a href="https://numpy.org/" target="_blank" rel="noopener"> NumPy </a>库用于数据角力操作。预处理后的数据在提供给<code>index.html</code>文件之前被序列化为 JSON 格式。</p>
<p>该分析涵盖以下特征:</p>
<ul>
<li>合同特性:合同特性描述客户与示例公司的合同条款，有三个类别:按月、一年和两年</li>
<li>任期特征:任期是一个连续的特征，描述了客户在公司呆的月数</li>
</ul>
<p>在<code>data</code>文件夹中，创建一个<code>churn_data.csv</code>文件，并将这里的内容<a href="https://github.com/codebrain001/Interactive-charts-for-frontend-data-visualization-using-flask-and-D3js/blob/main/static/data/Churn_data.csv" target="_blank" rel="noopener">添加到文件中。然后，将下面的代码片段添加到<code>app.py</code>文件中:</a></p>
<pre class="language-python hljs">from flask import Flask, jsonify, render_template
import pandas as pd
import numpy as np

app = Flask(__name__)

#Reading data
data_df = pd.read_csv("static/data/churn_data.csv")
churn_df = data_df[(data_df['Churn']=="Yes").notnull()]

@app.route('/')
def index():
   return render_template('index.html')

def calculate_percentage(val, total):
   """Calculates the percentage of a value over a total"""
   percent = np.round((np.divide(val, total) * 100), 2)
   return percent

def data_creation(data, percent, class_labels, group=None):
   for index, item in enumerate(percent):
       data_instance = {}
       data_instance['category'] = class_labels[index]
       data_instance['value'] = item
       data_instance['group'] = group
       data.append(data_instance)

@app.route('/get_piechart_data')
def get_piechart_data():
   contract_labels = ['Month-to-month', 'One year', 'Two year']
   _ = churn_df.groupby('Contract').size().values
   class_percent = calculate_percentage(_, np.sum(_)) #Getting the value counts and total

   piechart_data= []
   data_creation(piechart_data, class_percent, contract_labels)
   return jsonify(piechart_data)

@app.route('/get_barchart_data')
def get_barchart_data():
   tenure_labels = ['0-9', '10-19', '20-29', '30-39', '40-49', '50-59', '60-69', '70-79']
   churn_df['tenure_group'] = pd.cut(churn_df.tenure, range(0, 81, 10), labels=tenure_labels)
   select_df = churn_df[['tenure_group','Contract']]
   contract_month = select_df[select_df['Contract']=='Month-to-month']
   contract_one = select_df[select_df['Contract']=='One year']
   contract_two =  select_df[select_df['Contract']=='Two year']
   _ = contract_month.groupby('tenure_group').size().values
   mon_percent = calculate_percentage(_, np.sum(_))
   _ = contract_one.groupby('tenure_group').size().values
   one_percent = calculate_percentage(_, np.sum(_))
   _ = contract_two.groupby('tenure_group').size().values
   two_percent = calculate_percentage(_, np.sum(_))
   _ = select_df.groupby('tenure_group').size().values
   all_percent = calculate_percentage(_, np.sum(_))

   barchart_data = []
   data_creation(barchart_data,all_percent, tenure_labels, "All")
   data_creation(barchart_data,mon_percent, tenure_labels, "Month-to-month")
   data_creation(barchart_data,one_percent, tenure_labels, "One year")
   data_creation(barchart_data,two_percent, tenure_labels, "Two year")
   return jsonify(barchart_data)

if __name__ == '__main__':
   app.run(debug=True)
</pre>
<h2 id="creating-html-file">创建 HTML 文件</h2>
<p><code>app.py</code>文件的入口点有一个用于数据仪表板布局的<code>index.html</code>模板文件。该模板由两个容器组成:编写部分和可视化部分。</p>
<p>将以下代码添加到<code>index.html</code>文件中:</p>
<pre class="language-html hljs">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

 &lt;head&gt;
   &lt;meta charset="utf-8"&gt;
   &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
   &lt;meta name="description" content="Data Dashboard"&gt;
   &lt;meta name="author" content="Aboze Brain"&gt;
   &lt;meta http-equiv="content-type" content="text/html; charset=utf-8"/&gt;
   &lt;title&gt;Data Dashboard&lt;/title&gt;


 &lt;/head&gt;
 &lt;body&gt;
       &lt;div class="about"&gt;
         &lt;h1&gt;Data Dashboard&lt;/h1&gt;
         &lt;h2&gt;Project: Interactive charts for frontend data visualization using flask and D3js&lt;/h2&gt;
         &lt;h2&gt;Author: Aboze Brain John&lt;/h2&gt;
         &lt;p&gt;Bio: Aboze Brain John is a Technology Business Analyst.
            He has experience in Data Science and Analytics, Software Engineering, Product Research, and Technical Writing.&lt;/p&gt;
         &lt;p&gt;Project Overview: The project is focused on the analysis of churned customers.
           This analysis is achieved using Python's Flask library to serve the data and Javascript D3.js library to visualize the analysis.
           The use case is the Telco Customer Churn found on Kaggle &lt;a href="https://www.kaggle.com/blastchar/telco-customer-churn"&gt;here&lt;/a&gt;
         &lt;/p&gt;
         &lt;h4&gt;The code can be found on Github &lt;a href="https://github.com/codebrain001/Interactive-charts-for-frontend-data-visualization-using-flask-and-D3js"&gt;here&lt;/a&gt;&lt;/h4&gt;
         &lt;h4&gt;The article can be found on Logrocket blog &lt;a href="https://blog.logrocket.com/build-interactive-charts-flask-d3js/"&gt;here&lt;/a&gt;&lt;/h4&gt;
       &lt;img src="{{ url_for('static', filename='logo.jpeg')}}" alt="Logrocket logo"&gt;
       &lt;/div&gt;

       &lt;div class="visualization"&gt;
         &lt;div id="pieChart"&gt;&lt;/div&gt;
         &lt;div id="barChart"&gt;&lt;/div&gt;
       &lt;/div&gt;

 &lt;/body&gt;
&lt;/html&gt;
</pre>
<p>此时，您可以使用下面的命令运行应用程序，并通过<code>localhost:5000</code>在浏览器上查看它:</p>
<pre class="language-bash hljs">python app.py
</pre>
<p id="gdcalert3"><img data-attachment-id="113474" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/app-view-localhost-browser/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png" data-orig-size="730,163" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="app-view-localhost-browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser-300x67.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png" decoding="async" class="aligncenter size-full wp-image-113474 jetpack-lazy-image" src="../Images/a5369225b720eedac61ba9416466eeb8.png" alt="Our app, as viewed in our browser" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser-300x67.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="113474" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/app-view-localhost-browser/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png" data-orig-size="730,163" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="app-view-localhost-browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser-300x67.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-113474" src="../Images/a5369225b720eedac61ba9416466eeb8.png" alt="Our app, as viewed in our browser" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser-300x67.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/app-view-localhost-browser.png"/></noscript>
<p>应用程序似乎只呈现 HTML 文件的文本内容，而没有图表。这是因为您还没有链接 JavaScript 脚本，这些脚本将从 Python 文件中获取数据并将其呈现在 HTML 文件上。</p>
<h2 id="making-charts-interactive">让图表互动</h2>
<h3 id="creating-pie-chart-function">创建饼图函数</h3>
<p id="gdcalert4"><img data-attachment-id="113476" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/customer-churn-pie-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png" data-orig-size="730,558" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="customer-churn-pie-chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart-300x229.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png" decoding="async" class="aligncenter size-full wp-image-113476 jetpack-lazy-image" src="../Images/b8912b1533281e9eb1e2747692f6688e.png" alt="The customer churn pie chart we'll build" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart-300x229.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="113476" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/customer-churn-pie-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png" data-orig-size="730,558" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="customer-churn-pie-chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart-300x229.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-113476" src="../Images/b8912b1533281e9eb1e2747692f6688e.png" alt="The customer churn pie chart we'll build" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart-300x229.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-pie-chart.png"/></noscript>
<p>下面的<code>d3PieChart</code>函数接受两个参数:</p>
<ul>
<li><code>dataset</code> —包含饼图数据</li>
<li><code>datasetBarChart</code> —选择饼图的一部分时更新条形图。这个函数将利用<a href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics" target="_blank" rel="noopener"> SVG 元素</a>,因为它们提供不同的形状，并提供更多的灵活性和控制</li>
</ul>
<p>在静态文件夹中创建一个<code>pieChart.js</code>文件，并将以下函数添加到该文件中:</p>
<pre class="language-javascript hljs">function d3PieChart(dataset, datasetBarChart){
   // Set up SVG dimensions and properties
   const margin = {top:20, right:20, bottom:20, left:20};
   const width = 350 - margin.left - margin.right,
   height = 350 - margin.top - margin.bottom,
   outerRadius = Math.min(width, height) / 2,
   innerRadius = outerRadius * .5,
   color = d3.scaleOrdinal(d3.schemeAccent); //color scheme

   // Selecting the div with id pieChart on the index.html template file
   const visualization = d3.select('#pieChart')
       .append("svg")      //Injecting an SVG element
       .data([dataset])    //Binding the pie chart data
       .attr("width", width)
       .attr("height", height)
       .append("g")        //Grouping the various SVG components  
       .attr("transform", "translate(" + outerRadius + "," + outerRadius + ")"); //Piechart tranformation and transition upon page loading

   const data = d3.pie()   //Creating the data object that will develop the various segment of the pie chart.
       .sort(null)
       .value(function(d){return d.value;})(dataset);    // Retrieve the pie chart data values from our Flask app, the pie chart where tied to a 'value' key of a JSON object.

   // Generate an arc generator that produces the circular chart (outer circle)
   const arc = d3.arc()   
       .outerRadius(outerRadius)
       .innerRadius(0);

    // Generate an arc generator that produces the circular chart (inner circle)
   const innerArc = d3.arc()
       .innerRadius(innerRadius)
       .outerRadius(outerRadius);

   // Create pie chart slices based on the data object created
   const arcs = visualization.selectAll("g.slice")
       .data(data)                    
       .enter()    // creates the initial join of data to elements                      
       .append("svg:g")              
       .attr("class", "slice")
       .on("click", click);

   arcs.append("svg:path")     // create path element
       .attr("fill", function(d, i) { return color(i); } )     //Add color to slice
       .attr("d", arc)     // creates actual SVG path with associated data and the arc drawing function
       .append("svg:title")        // Add title to each piechart slice
       .text(function(d) { return d.data.category + ": " + d.data.value+"%"; });          

   d3.selectAll("g.slice")     // select slices in the group SVG element (pirchart)
       .selectAll("path")
       .transition()           //Set piechart transition on loading
       .duration(200)
       .delay(5)
       .attr("d", innerArc);

   arcs.filter(function(d) { return d.endAngle - d.startAngle &gt; .1; })     //Define slice labels at certain angles
       .append("svg:text")     //Insert text area in SVG
       .attr("dy", "0.20em")      //shift along the y-axis on the position of text content
       .attr("text-anchor", "middle")      //Position slice labels
       .attr("transform", function(d) { return "translate(" + innerArc.centroid(d) + ")"; }) //Positioning upon transition and transform
       .text(function(d) { return d.data.category; }); // Append category name on slices

   visualization.append("svg:text") //Append the title of chart in the middle of the pie chart
       .attr("dy", ".20em")
       .attr("text-anchor", "middle")
       .text("churned customers")
       .attr("class","title");        

   // Function to update barchart when a piechart slice is clicked
   function click(d, i) {
       updateBarChart(d.data.category, color(i), datasetBarChart);
    }
}
</pre>
<h3 id="creating-bar-chart-function">创建条形图功能</h3>
<p id="gdcalert5"><img data-attachment-id="113478" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/customer-churn-bar-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png" data-orig-size="730,704" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="customer-churn-bar-chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart-300x289.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png" decoding="async" class="aligncenter size-full wp-image-113478 jetpack-lazy-image" src="../Images/bde10dcd423e4589313c5abeea00248c.png" alt="Customer churn bar chart" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart-300x289.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="113478" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/customer-churn-bar-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png" data-orig-size="730,704" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="customer-churn-bar-chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart-300x289.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-113478" src="../Images/bde10dcd423e4589313c5abeea00248c.png" alt="Customer churn bar chart" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart-300x289.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/customer-churn-bar-chart.png"/></noscript>
<p><code>d3BarChart</code>函数定义了当页面被加载并且没有选择特定的契约类时，浏览器将呈现的默认组。默认组是被搅动客户的任期分布。<code>d3BarChart</code>只接受一个参数:提供的条形图数据。</p>
<p>在<code>static </code>文件夹中，创建一个<code> barChart.js</code>文件，并在文件中包含以下代码:</p>
<pre class="language-javascript hljs">//Set up SVG dimensions and properties
const margin = {top: 20, right: 10, bottom: 20, left: 20},
width = 350 - margin.left - margin.right,
height = 350 - margin.top - margin.bottom,
barPadding = 5,
graph_misc = {ylabel: 4, xlabelH : 5, title:9};

// Setting the default group
const group = "All";

// Function to get the percentage values  for a specific selected group from the whole dataset.
function get_percentage(group, datasetBarChart){
   const _ = [];
   for (instance in datasetBarChart){
       if (datasetBarChart[instance].group==group){
           _.push(datasetBarChart[instance])
       }
   } return _;
};

function d3BarChart(datasetBarChart){
   defaultBarChart = get_percentage(group, datasetBarChart);

   const xScale = d3.scaleLinear()     // Barchart X axis scale
       .domain([0, defaultBarChart.length]) // Scale range from 0 to the length of data object
       .range([0, width]);

   const yScale = d3.scaleLinear() // Barchart y axis scale
       .domain([0, d3.max(defaultBarChart, function(d) { return d.value; })])    //Scale range from 0 to the maximum value of the default bar chart data
       .range([height, 0]);

   // // Selecting the div with id barChart on the index.html template file
   const bar = d3.select('#barChart')
       .append('svg')
       .attr('width', width + margin.left + margin.right)
       .attr('height', height + margin.top + margin.bottom)
       .attr('id', 'barChartPlot');

   //Adding barchart title
   bar.append('text')
       .attr('x', (width + margin.left + margin.right)/2)
       .attr('y', graph_misc.title)
       .attr('class','title')             
       .attr('text-anchor', 'middle')
       .text('Tenure group for churned customers');

   const visualization = bar.append('g')
       .attr("transform", "translate(" + margin.left + "," + (margin.top + graph_misc.ylabel) + ")");

   visualization.selectAll("rect")
       .data(defaultBarChart)
       .enter()
       .append("rect")
       .attr("x", function(d, i) {
           return xScale(i);
       })
       .attr("width", width / defaultBarChart.length - barPadding)  
       .attr("y", function(d) {
           return yScale(d.value);
       }) 
       .attr("height", function(d) {
           return height-yScale(d.value);
       })
       .attr("fill", "#757077");

   //Adding  barchart labels
   visualization.selectAll('text')
       .data(defaultBarChart)
       .enter()
       .append("text")
       .text(function(d) {
               return d.value+"%";
       })
       .attr("text-anchor", "middle")

       .attr("x", function(d, i) {
               return (i * (width / defaultBarChart.length)) + ((width / defaultBarChart.length - barPadding) / 2);
       })
       .attr("y", function(d) {
               return (yScale(d.value) - graph_misc.ylabel); //Setting the Y axis to represent the value in the served JSON data
       })
       .attr("class", "yAxis");

   const xLabels = bar
       .append("g")
       .attr("transform", "translate(" + margin.left + "," + (margin.top + height + graph_misc.xlabelH)  + ")");

   xLabels.selectAll("text.xAxis")
       .data(defaultBarChart)
       .enter()
       .append("text")
       .text(function(d) { return d.category;})
       .attr("text-anchor", "middle")
       .attr("x", function(d, i) {
           return (i * (width / defaultBarChart.length)) + ((width / defaultBarChart.length - barPadding) / 2);
       })
       .attr("y", 15)
       .attr("class", "xAxis");           
}
</pre>
<p>到目前为止，您已经成功地创建了默认条形图。要让图表完全发挥作用，只剩下一件事了:让图表具有交互性。</p>
<p>您将在<code>static</code>文件夹中创建的<code>updateBarChart.js</code>文件将允许您用饼图的任何切片的任何选择来更新条形图。这个文件将包含一个接受三个参数的<code>updateBarChart</code>函数:</p>
<ol>
<li><code>group</code>–在饼图上选择的组</li>
<li><code>color</code>–饼图切片的颜色</li>
<li><code>datasetBarChart</code>–更新后的条形图数据</li>
</ol>
<p>看一下函数:</p>
<pre class="language-javascript hljs">function updateBarChart(group, color, datasetBarChart){
   const currentBarChart = get_percentage(group, datasetBarChart);

   //Defining chart scale, same as the default bar chart
   const xScale = d3.scaleLinear()
       .domain([0, currentBarChart.length])
       .range([0, width]);

   const yScale = d3.scaleLinear()
       .domain([0, d3.max(currentBarChart, function(d) { return d.value; })])
       .range([height,0]);

   const bar = d3.select('#barChart svg');  //Selecting the div containing bar chart ID and creating an SVG element

   // Add title to Barchart
   bar.selectAll("text.title")
       .attr("x", (width + margin.left + margin.right)/2)
       .attr("y", graph_misc.title)
       .attr("class","title")             
       .attr("text-anchor", "middle")
       .text("Tenure group for churned customers "+group);

   const visualization = d3.select('barChartPlot')
       .datum(currentBarChart);    //binding data to multiple SVG elements

   visualization.selectAll('rect')
       .data(currentBarChart)
       .transition()
       .duration(750)
       .attr('x',  (width + margin.left + margin.right)/2)
       .attr('y', graph_misc.title)
       .attr('class', 'title')
       .attr('text-anchor', 'middle')
       .text('Tenure group for churned customers '+group);

   const plot = d3.select('#barChartPlot')
       .datum(currentBarChart);        //binding data to multiple SVG elements

   plot.selectAll('rect')
       .data(currentBarChart)
       .transition()       //Setting bar chart change transition
       .duration(800)
       .attr('x', function(d,i){
           return xScale(i);
       })
       .attr('width', width/currentBarChart.length - barPadding)
       .attr('y', function(d){
           return yScale(d.value)
       })
       .attr("height", function(d) {
           return height-yScale(d.value);
       })
       .attr("fill", color);

   plot.selectAll("text.yAxis")
       .data(currentBarChart)
       .transition()
       .duration(750)
       .attr("text-anchor", "middle")
       .attr("x", function(d, i) {
           return (i * (width / currentBarChart.length)) + ((width / currentBarChart.length - barPadding) / 2);})
       .attr("y", function(d) {
           return yScale(d.value) - graph_misc.ylabel;})
       .text(function(d) {
       return d.value+'%';})
       .attr("class", "yAxis");
};
</pre>
<p>上面创建的 JavaScript 脚本使用带有各种函数的函数式编程范例来创建在名为<code>index.js</code>的中央文件中执行的组件。<code>index.js</code>文件使用<a href="https://blog.logrocket.com/improve-async-programming-with-javascript-promises/" target="_blank" rel="noopener">承诺</a>来处理异步操作，并对操作的最终完成(或失败)和结果值负责。</p>
<p>下面是<code>index.js file:</code>的代码片段</p>
<pre class="language-javascript hljs">const urls = [pieChartDataUrl, barChartDataUrl];

Promise.all(urls.map(url =&gt; d3.json(url))).then(run);

function run(dataset) {
   d3PieChart(dataset[0], dataset[1]);
   d3BarChart(dataset[1]);
};
</pre>
<p>最后，在<code>index.html</code>文件的 body 标签中，添加下面的代码片段，将 JavaScript 文件链接到 HTML 文件:</p>
<pre class="language-javascript hljs"> &lt;script src="https://d3js.org/d3.v5.min.js"&gt;&lt;/script&gt;
   &lt;script&gt;
       const pieChartDataUrl = "{{ url_for('get_piechart_data') }}";
       const barChartDataUrl = "{{ url_for('get_barchart_data') }}";
   &lt;/script&gt;
   &lt;script src="{{ url_for('static', filename='js/pieChart.js') }}"&gt;&lt;/script&gt;
   &lt;script src="{{ url_for('static', filename='js/barChart.js') }}"&gt;&lt;/script&gt;
   &lt;script src="{{ url_for('static', filename='js/updateBarChart.js') }}"&gt;&lt;/script&gt;
   &lt;script src="{{ url_for('static', filename='js/index.js') }}"&gt;&lt;/script&gt;
</pre>
<p>HTML 文件包含脚本文件的访问点和将 D3.js 链接到项目的 CDN。这些脚本包括并执行以下功能:</p>
<ul>
<li><code>pieChart.js</code> —呈现饼图</li>
<li><code>barChart.js</code> —呈现默认条形字符</li>
<li><code>updateBarChart.js</code> —根据饼图的选择更新条形图</li>
<li><code>index.js</code> —包括运行图表函数以在仪表板上呈现的主脚本</li>
</ul>
<p><code>index.html</code>模板还通过带有两个变量的路由 URL 获取 JSON 响应数据:<code>pieChartDataUrl</code>和<code>barChartDataUrl</code>。</p>
<p>在您的浏览器上刷新应用程序时，您的应用程序应该如下所示:</p>
<figure id="attachment_113481" aria-describedby="caption-attachment-113481" class="wp-caption aligncenter"><img data-attachment-id="113481" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/bar-pie-chart-interactive/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive.gif" data-orig-size="730,1270" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="bar-pie-chart-interactive" data-image-description="" data-image-caption="&lt;p&gt;Our bar and pie charts, but interactive. The bar chart responds to clicks made on the pie chart&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive-172x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive-589x1024.gif" decoding="async" class="size-full wp-image-113481 jetpack-lazy-image" src="../Images/6f221af9968c23d2feaf14db4dac0aef.png" alt="Our bar and pie charts, but interactive. The bar chart responds to clicks made on the pie chart" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive.gif"/><noscript><img data-lazy-fallback="1" data-attachment-id="113481" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/bar-pie-chart-interactive/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive.gif" data-orig-size="730,1270" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="bar-pie-chart-interactive" data-image-description="" data-image-caption="&lt;p&gt;Our bar and pie charts, but interactive. The bar chart responds to clicks made on the pie chart&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive-172x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive-589x1024.gif" decoding="async" loading="lazy" class="size-full wp-image-113481" src="../Images/6f221af9968c23d2feaf14db4dac0aef.png" alt="Our bar and pie charts, but interactive. The bar chart responds to clicks made on the pie chart" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/bar-pie-chart-interactive.gif"/></noscript><figcaption id="caption-attachment-113481" class="wp-caption-text">Our bar and pie charts, but interactive. The bar chart responds to clicks made on the pie chart</figcaption></figure>
<p>此时，您可以通过单击饼图的不同部分来与应用程序进行交互。注意条形图对每次点击的反应！</p>
<h2 id="styling-charts-css">用 CSS 设计图表样式</h2>
<p>尽管这个应用程序看起来功能齐全，但它仍然需要一些样式上的修饰。在<code>CSS</code>文件夹中创建一个<code>styles.css</code>静态文件，并将以下代码添加到该文件中，以设置应用程序的样式:</p>
<pre class="language-css hljs">/* Reset default browser settings */

/* Box sizing rules */
*,
*::before,
*::after {
 box-sizing: border-box;
}

/* Remove default padding and margin */
* {
 padding: 0;
 margin: 0;
}

/* Set core body defaults */
body {
 position: fixed;
 display: flex;
 background: #fdfdfd;
 scroll-behavior: smooth;
 text-rendering: optimizeSpeed;
 font-family: "Roboto Mono", monospace;
 font-weight: bold;
 -webkit-font-smoothing: antialiased;
 overflow-x: hidden;
}

/* Make images easier to work with */
img {
 max-width: 100%;
 display: block;
}

.about {
   margin: 10% 2%;
   width: 40%;
   text-align: justify;

}
h1 {
   text-decoration: underline;
   margin: 0.5em 0em;
}

p, h2, h6 {
   margin: 0.7em 0em;
}

a {
   text-decoration: none;
}

.visualization {
   display: flex;
   align-items: center;
   flex-direction: column;
   width:60%;
}

#pieChart {
   margin-top: 4em;
   font-size: 12px;
}

#barChart {
   font-size: 9px;
   margin-top: 4em;
}

#pieChart .title, #barChart .title{
   font-weight: bold;
}

.slice {
   font-size: 8px;
    font-family: "Roboto Mono", monospace;
   fill: white;
   font-weight: bold;  
   cursor: pointer;
}
</pre>
<p>通过在 HTML 文件的 head 标签中添加下面的代码行，将<code>styles.css</code>文件链接到<code>index.html</code>文件:</p>
<p><code>&lt;link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet"&gt;</code></p>
<p>下面是应用程序的最终输出:</p>
<p id="gdcalert7"><img data-attachment-id="113485" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/final-app-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output.gif" data-orig-size="730,430" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="final-app-output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output-300x177.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output.gif" decoding="async" class="aligncenter size-full wp-image-113485 jetpack-lazy-image" src="../Images/70c036a73fbe3ba50c4bb89343270040.png" alt="The final output of our app" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="113485" data-permalink="https://blog.logrocket.com/build-interactive-charts-flask-d3js/final-app-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output.gif" data-orig-size="730,430" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="final-app-output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output-300x177.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-113485" src="../Images/70c036a73fbe3ba50c4bb89343270040.png" alt="The final output of our app" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/final-app-output.gif"/></noscript>
<h2>结论</h2>
<p>在本文中，您了解了如何使用 Flask 提供的和预处理的数据构建交互式图表仪表板。您操纵 DOM 元素在网页上用 D3.js 呈现可视化效果。</p>
<p>您可以使用这种技术来呈现条形图或饼图，并轻松地将数据可视化整合到您的下一个项目中。</p>
<p>这个项目在<a href="https://github.com/codebrain001/Interactive-charts-for-frontend-data-visualization-using-flask-and-D3js" target="_blank" rel="noopener"> GitHub </a>上有完整版本。</p><div class="code-block code-block-1">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket 会告诉您应用程序中实际影响用户的最具影响力的 bug 和 UX 问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket 自动聚合客户端错误、JS 异常、前端性能指标和用户交互。然后 LogRocket 使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的 bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试 LogRocket】。</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>