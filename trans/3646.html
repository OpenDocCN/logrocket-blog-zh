<html>
<head>
<title>How to run Laravel with Docker Compose on Ubuntu v22.04 </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Ubuntu v22.04上用Docker Compose运行Laravel</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/#0001-01-01">https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/#0001-01-01</a></blockquote><div><article class="article-post">
<p>Laravel是最流行的PHP框架之一。据BuiltWith称，Laravel被世界各地超过72万个T2网站使用。Laravel是一个自以为是的框架，模块化，易于使用，并且有一个<a href="https://i.ibb.co/Fh8TknP/laravel-ecosystem.jpg">新兴的生态系统</a>。在这篇文章中，你将学习如何在Ubuntu 22.04上使用Docker Compose运行Laravel。</p>
<p>向前跳:</p>

<h2 id="prerequisites">先决条件</h2>
<ul>
<li>安装了Docker和Docker Compose的Ubuntu v22.04。对于本教程，我们将使用Docker v20.10.20和Docker Compose v2.12.2</li>
<li>码头工人的经验</li>
<li>一些关于Laravel的先验知识会有所帮助</li>
<li>任何关于Docker多阶段构建的知识都是有用的</li>
<li>了解Apache的工作原理及其与PHP的关系</li>
</ul>
<h2 id="what-docker">Docker是什么？</h2>
<p>Docker 是一个开源平台，它使软件工程师能够将他们的应用程序打包到称为容器的工件中，使它们易于运输，并避免了将“我的机器上的作品”添加到搜索查询中的问题。</p>
<p>那么，什么是容器呢？容器是一种使用户能够将整个堆栈打包成工件的技术。在这个上下文中，整个堆栈指的是操作系统、具有任何依赖关系的语言、您的应用程序代码及其依赖关系。因此，在每次部署时，您交付的是整个堆栈，而不仅仅是发生变化的五行代码。</p>
<p>容器由来已久，但在2014年被Docker普及。</p>
<p>映像是按照<a href="https://opencontainers.org/">开放容器倡议(OCI)标准</a>构建的，因此它们可以在任何地方运行。</p>
<h2 id="example-laravel-app-backpack">带背包的Laravel应用示例</h2>
<p>在这篇使用Docker和Docker Compose运行Laravel的指南中，我们将使用一个简单的Laravel应用程序。这个基本的Laravel应用程序将使用一个MySQL数据库，为了展示事情是如何工作的，我们将使用流行的<a href="https://backpackforlaravel.com/"> Backpack </a> Laravel包，它用于构建和定制管理面板。</p>
<p>为了保持简单，因为Laravel已经提供了用户表和用户模型，我们将把它与Backpack连接起来，以查看和编辑用户。这里需要注意的是，如果您编辑一个用户，该用户将无法登录，因为密码不会被加密。然而，这不是本教程的关注点。对于这篇文章，重点是在Ubuntu v22.04上使用Docker和Docker Compose运行带有MySQL的Laravel应用程序。</p>
<p>我们应用程序的完整代码可以在这个<a href="https://github.com/geshan/laravel-backpack-demo"> GitHub库</a>中找到。还包括<a href="https://github.com/geshan/laravel-backpack-demo/blob/master/Dockerfile"> Dockerfile </a>和<a href="https://github.com/geshan/laravel-backpack-demo/blob/master/docker-compose.yml"> docker-compose.yml </a>文件。</p>
<p>登录后，终端应用程序会列出访问<a href="http://localhost:8082/admin/user"> <code>http://localhost:8082/admin/user</code> </a>的用户:</p>
<p><img data-attachment-id="144040" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/laravel-application-listing-users/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg" data-orig-size="730,383" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Laravel app listing users" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users-300x157.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg" decoding="async" class="aligncenter size-full wp-image-144040 jetpack-lazy-image" src="../Images/6c4749c80cdea1de79e70ab91be2d4f5.png" alt="Laravel Application Listing Users" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users-300x157.jpg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144040" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/laravel-application-listing-users/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg" data-orig-size="730,383" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Laravel app listing users" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users-300x157.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144040" src="../Images/6c4749c80cdea1de79e70ab91be2d4f5.png" alt="Laravel Application Listing Users" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users-300x157.jpg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-application-listing-users.jpg"/></noscript>
<h2 id="laravel-sail">拉勒维尔帆</h2>
<p>Laravel 9.x的默认<a href="https://laravel.com/docs/9.x/installation#getting-started-on-linux">安装说明</a>随Laravel Sail一起提供。Sail是一款很棒的产品，也是Laravel生态系统不可或缺的一部分。其GitHub报告称，“Sail为Laravel提供了Docker驱动的本地开发体验，兼容macOS、Windows (WSL2)和Linux。”那么，为什么我们不使用它呢？</p>
<p>Sail对于开发环境来说是一个很好的工具，但是它不适合类似生产的环境，因为:</p>
<ul>
<li>Sail太通用了，包含了多个东西，比如数据库、Redis和使用MeiliSearch的搜索。在生产中，这些依赖被卸载到其他服务，如RDS或open search</li>
<li><a href="https://github.com/laravel/sail/blob/1.x/runtimes/8.1/Dockerfile"> Dockerfile </a>非常适合开发环境。它有xdebug，Node.js 16，和yarn。它也有MySQL和Node.js的客户端，但是这些东西增加了容器的体积和重量，使得它不适合类似生产的环境</li>
<li>Sail没有使用官方的Docker图像，而是以Ubuntu v22.04作为基础图像，并根据需要添加内容。它看起来更像一个虚拟机(VM ),而不是一个优化的Docker映像</li>
<li>Sail没有使用Docker的功能，如<a href="https://geshan.com.np/blog/2019/11/how-to-use-docker-multi-stage-build/"> Docker多阶段构建</a>，这不仅可以减少图像的大小，还可以使Docker图像在某些环境下得到很好的优化</li>
</ul>
<p>这将带我们进入下一步，在这里您将克隆存储库，并了解使用Docker和Docker Compose运行Laravel应用程序所涉及的部分。</p>
<h2 id="setting-up-docker-dockercompose">设置Docker和Docker撰写</h2>
<p>首先，您可以使用<code>git clone <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="02656b7642656b766a77602c616d6f">[email protected]</a>:geshan/laravel-backpack-demo.git</code>克隆存储库。您可以使用<code>cd laravel-backpack-demo</code>进入文件夹，查看文件结构:</p>
<p><img data-attachment-id="144042" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/laravel-backpack-demo/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg" data-orig-size="451,842" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Laravel Backpack demo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo-161x300.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg" decoding="async" class="aligncenter size-full wp-image-144042 jetpack-lazy-image" src="../Images/b4a604e4ed51293835e36a8f8e93b28d.png" alt="Laravel Backpack Demo" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg 451w, https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo-161x300.jpg 161w" data-lazy-sizes="(max-width: 451px) 100vw, 451px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144042" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/laravel-backpack-demo/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg" data-orig-size="451,842" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Laravel Backpack demo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo-161x300.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144042" src="../Images/b4a604e4ed51293835e36a8f8e93b28d.png" alt="Laravel Backpack Demo" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg 451w, https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo-161x300.jpg 161w" sizes="(max-width: 451px) 100vw, 451px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-backpack-demo.jpg"/></noscript>
<p>它看起来很像其他的Laravel 9.x项目，但是您会发现一些其他有趣的文件。首先是<code>/db/init.sql</code>文件，除了默认的Laravel数据库结构之外，它还用于加载MySQL Docker容器中的一些用户和迁移数据。</p>
<p>然后在<code>/docker</code>文件夹中有一些Docker特有的配置文件。因为我们将在Apache中使用默认的PHP Docker映像，所以这里有一个Apache配置。同样，为了在生产中获得更好的性能，还包括了<a href="https://www.php.net/manual/en/book.opcache.php"> Opcache </a>配置文件。不会用到，但是放在那里做参考。</p>
<p>然后，在项目的根目录下，有三个文件将构成本教程的基础。<code>docker-compose-sail.yml</code>文件是默认的Docker Compose文件，它随Laravel 9.x的Sail安装一起提供。它已经从<code>docker-compose.yml</code>重命名为<code>docker-compose-sail.yml</code>，这样我们就可以使用<code>docker-compose.yml</code>文件作为默认文件。之后，我们有了利用多阶段Docker构建的Docker文件。</p>
<h2 id="dockerfile-laravel">Dockerfile for Laravel</h2>
<p>在多阶段构建之后，在Ubuntu 22.04上运行Laravel 9.x(撰写本文时为9.19)的docker文件如下所示:</p>
<pre class="language-bash hljs">FROM composer:2.4 as build
COPY . /app/
RUN composer install --prefer-dist --no-dev --optimize-autoloader --no-interaction

FROM php:8.1-apache-buster as dev

ENV APP_ENV=dev
ENV APP_DEBUG=true
ENV COMPOSER_ALLOW_SUPERUSER=1

RUN apt-get update &amp;&amp; apt-get install -y zip
RUN docker-php-ext-install pdo pdo_mysql

COPY . /var/www/html/
COPY --from=build /usr/bin/composer /usr/bin/composer
RUN composer install --prefer-dist --no-interaction

COPY docker/apache/000-default.conf /etc/apache2/sites-available/000-default.conf
COPY .env.dev /var/www/html/.env

RUN php artisan config:cache &amp;&amp; \
    php artisan route:cache &amp;&amp; \
    chmod 777 -R /var/www/html/storage/ &amp;&amp; \
    chown -R www-data:www-data /var/www/ &amp;&amp; \
    a2enmod rewrite

FROM php:8.1-apache-buster as production

ENV APP_ENV=production
ENV APP_DEBUG=false

RUN docker-php-ext-configure opcache --enable-opcache &amp;&amp; \
    docker-php-ext-install pdo pdo_mysql
COPY docker/php/conf.d/opcache.ini /usr/local/etc/php/conf.d/opcache.ini

COPY --from=build /app /var/www/html
COPY docker/apache/000-default.conf /etc/apache2/sites-available/000-default.conf
COPY .env.prod /var/www/html/.env

RUN php artisan config:cache &amp;&amp; \
    php artisan route:cache &amp;&amp; \
    chmod 777 -R /var/www/html/storage/ &amp;&amp; \
    chown -R www-data:www-data /var/www/ &amp;&amp; \
    a2enmod rewrite

</pre>
<p>这个Docker文件从PHP Composer 2.4官方Docker映像的构建阶段开始。在这个阶段，整个应用程序被复制到映像中的<code>/app</code>文件夹，Composer安装在生产模式下运行，没有交互，并留下了开发依赖项。所以此时，所有的非开发Composer包都已经安装在了<code>vendor</code>文件夹中。</p>
<p>接下来可以看到<code>dev</code>阶段。这也是稍后将在<code>docker-compose.yml</code>文件中使用的阶段。从<a href="https://hub.docker.com/_/php">官方PHP </a> v8.1 Apache Docker镜像开始。它将一些环境变量如<code>APP_ENV</code>设置为<code>dev</code>，<code>APP_DEBUG</code>设置为true，<code>COMPOSER_ALLOW_SUPERUSER</code>设置为<code>1</code>。这些变量是不言自明的。然后它安装了zip，这是安装其他包所需要的。</p>
<p>因为我们在这个项目中只使用MySQL，所以它只安装了<code>pdo</code>和<code>pdo_mysql</code> PHP扩展。然后，我们从构建阶段获得合成可执行文件。这是使用多阶段Docker构建的另一个优势。因为我们将使用这个映像进行开发，所以我们用<code>composer install</code>安装了所有的依赖项，包括开发依赖项。</p>
<p>之后，我们将Apache配置文件从<code>/docker/apache/000-default.conf</code>复制到容器中的正确位置。该文件的内容如下所示:</p>
<pre class="language-bash hljs">&lt;VirtualHost *:80&gt;

  ServerAdmin <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4d3a282f202c3e39283f0d21222e2c2125223e39">[email protected]</a>
  DocumentRoot /var/www/html/public/

  &lt;Directory /var/www/&gt;
    AllowOverride All
    Require all granted
  &lt;/Directory&gt;

  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined

&lt;/VirtualHost&gt;</pre>
<p>这是一个简单的Apache配置文件，从<code>/var/www/html/public</code>开始在端口80上为网站提供服务。它还有一些关于虚拟主机日志的指令。接下来，我们将<code>.env.dev</code>文件复制为容器上的<code>.env</code>文件。这个文件包含所有的配置，比如MySQL数据库的凭证。</p>
<p>最后，我们运行常规的Laravel artisan命令来配置缓存、路由缓存并使存储可写。然后确保用户<code>www:data</code>拥有正确的权限，并启用重写Apache模块。它应该可以工作，因为图像使用了<a href="https://hub.docker.com/layers/library/php/8.1-apache-buster/images/sha256-b11d9c766bcf836c1c0553b22ffdeff46eb117605f214cad5c47843ac84d5ede?context=explore"> apache2前台</a>作为命令。</p>
<p>下一个阶段是<code>production</code>，也是从官方的<code>php:8.1-apache</code>形象开始。它配置并启用<a href="https://www.php.net/manual/en/intro.opcache.php"> OPcache </a>用于生产中的缓存。OPcache通过在共享内存中存储预编译的脚本字节码来提高PHP性能，这使得它非常适合生产用例。</p>
<p>然后像开发阶段一样安装<code>pdo</code>和<code>pdo_mysql</code>。还会加载OPcache配置。如果你对OPcache配置感兴趣，请查看<a href="https://github.com/geshan/laravel-backpack-demo/blob/master/docker/php/conf.d/opcache.ini">这个文件</a>。接下来，它从构建阶段复制整个应用程序，在执行<code>compose install</code>时忽略了开发依赖。</p>
<p>同样的Apache配置也在这个Docker阶段加载，但是环境变量<code>.env.prod</code>被复制到<code>/var/www/html/.env</code>路径。在实际的应用程序中，这一行可能会被省略，以便以其他方式注入运行时环境变量，比如使用Kubernetes secrets。最后，使用相同的命令让Apache服务于我们的Laravel应用程序。在下一节中，您将了解Docker合成文件。</p>
<h2 id="docker-compose-laravel">拉威尔式码头</h2>
<p>上述Docker文件是用Docker合成文件定义构建和运行的。您可以使用常规的Docker命令构建和运行单个容器。当你想运行多个容器并且不想输入带有多个参数的长命令时，Docker Compose 就派上了用场。</p>
<p>Docker Compose文件是一个YAML文件，用于配置应用程序的服务。下面是运行我们的Laravel应用程序的Docker Compose文件和所需的MySQL容器。让我们仔细分析一下它的内容:</p>
<pre class="language-bash hljs">version: '3'
services:
  app:
    build:
      context: ./
      target: dev
    volumes:
      - .:/var/www/html
      - .env.dev:/var/www/html/.env
    ports:
      - "8082:80"
    environment:
      - APP_ENV=local
      - APP_DEBUG=true
    networks:
      - laravel
    depends_on:
      - mysql    
  mysql:
      image: 'mysql/mysql-server:8.0'
      environment:
        MYSQL_ROOT_HOST: "%"
        MYSQL_ROOT_PASSWORD: "root"
        MYSQL_USER: "laravel"
        MYSQL_PASSWORD: "FhgVoFuOrWspc3TgBIA2K4dZGuJTPwSYBoLnNckcaxy"
        MYSQL_DATABASE: "laravel"
        MYSQL_ALLOW_EMPTY_PASSWORD: 1
      ports:
        - 3906:3306
      volumes:
        - 'mysql8:/var/lib/mysql'
        - './db/init.sql:/docker-entrypoint-initdb.d/01init.sql'
      networks:
        - laravel
networks:
    laravel:
        driver: bridge
volumes:
    mysql8:
        driver: local
</pre>
<p>Docker合成文件从<a href="https://docs.docker.com/compose/compose-file/compose-file-v3/">版本3 </a>开始，它有一组特性。然后我们定义我们的服务。第一个是<code>app</code>服务，它将PHP和Apache服务器运行在相同的容器中。为此，我们指示Docker Compose Docker文件与context在同一个目录中，目标(读取阶段)是dev。因此，我们希望Docker Compose从我们在上一节中讨论的多阶段支持Dockerfile构建<code>dev</code>阶段。</p>
<p>在这个<code>app</code>服务中，我们然后在volumes部分指定我们想要从本地机器同步到容器的文件。我们说我们希望当前目录中的所有文件都同步到容器中的<code>/var/www/html</code>。我们还指定本地的<code>.env.dev</code>文件需要与同一路径的<code>.env</code>文件同步。</p>
<p>接下来，我们指定本地端口<code>8082</code>映射到容器端口80。在容器的端口80上，Apache服务器将会运行。之后，我们添加两个值为<code>local</code>的环境变量<code>APP_ENV</code>和值为<code>true</code>的<code>APP_DEBUG</code>。当我们使用这个容器进行本地开发时，如果发生错误，这些设置将在浏览器上显示错误。</p>
<p>之后，我们将app服务的网络指定为<code>laravel</code>。在<a href="https://docs.docker.com/compose/networking/"> Docker Compose </a>中的联网使多个服务能够相互通信。对于这个例子，我们将使用<a href="https://docs.docker.com/network/bridge/">桥接网络</a>，它允许连接到同一个桥接网络的容器之间的通信。因此，我们指定应用容器<code>depends_on</code> MySQL容器在文件中被定义。它不是一个硬依赖，而是用于控制启动和关闭的<a href="https://docs.docker.com/compose/startup-order/">序列。</a></p>
<p>文件中接下来定义了<code>mysql</code>服务。它是由MySQL提供的一个<a href="https://hub.docker.com/r/mysql/mysql-server"> MySQL服务器镜像</a>。对于本指南，我们使用8.0版。这里定义了一些重要的环境变量，比如根用户的密码<code>ROOT_HOST</code>，以及另一个MySQL用户和密码。数据库被指定为<code>laravel</code>。</p>
<p>主机上的端口3906映射到运行MySQL服务器的容器上的3306。为了在重启后保持数据的持久性，定义了一个名为<code>mysql8</code>的卷，它被映射到容器上的默认数据目录MySQL的<code>/var/lib/mysql</code>中。另一个重要的卷映射是入口点的<code>./db/init.sql</code>文件。这样做是为了在第一次启动时，我们的虚拟用户数据将被加载到空的MySQL服务器实例上。接下来，网络被定义为<code>laravel</code>并且<code>laravel</code>网络被设置为桥接网络。</p>
<p>最后但同样重要的是，名为<code>mysql8</code>的MySQL服务器卷被标记为本地驱动程序。这意味着Docker将管理数据的存储位置。您可以通过运行<code>docker volume ls</code>命令来了解有关该卷的更多信息。您还可以了解其他有用的<a href="https://geshan.com.np/blog/2022/05/docker-commands/"> Docker命令</a>，比如Docker图像、日志等等。在下一节中，您将了解Docker <code>ignore</code>文件。</p>
<h2 id="dockerignore-file">不要忽略<code>dockerignore</code>文件</h2>
<p>类似于我们如何使用<code>.gitignore</code>文件从git中排除某些文件，我们可以使用<code>.dockerignore</code>文件来排除复制到Docker映像和容器的文件。例如，下面是这个例子中使用的<a href="https://github.com/geshan/laravel-backpack-demo/blob/master/.dockerignore"> <code>.dockerignore</code>文件</a>。</p>
<pre class="language-bash hljs">.git
.env

</pre>
<p>上面的文件指示Docker不要将<code>.git</code>文件夹和<code>.env</code>文件复制到容器中。这不仅有助于保持较小的集装箱尺寸，还能缓解任何<a href="https://securityaffairs.co/wordpress/137371/security/millions-git-folders-exposed-public.html">安全问题</a>。接下来，我们将在Ubuntu 22.04上构建并运行Laravel的容器。</p>
<h2 id="build-run-locally">在本地构建和运行</h2>
<p>现在我们已经定义并描述了我们的<code>Dockerfile</code>和<code>docker-compose.yml</code>文件。要构建映像，您可以运行以下命令:</p>
<pre class="language-bash hljs">docker compose build
</pre>
<p>它将在开始时显示以下输出:</p>
<p><img data-attachment-id="144045" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/dockercompose-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg" data-orig-size="730,205" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Docker Compose output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output-300x84.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg" decoding="async" class="aligncenter size-full wp-image-144045 jetpack-lazy-image" src="../Images/0b1aee36f262522562ff6d074f0e5178.png" alt="Docker Compose Output" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output-300x84.jpg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144045" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/dockercompose-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg" data-orig-size="730,205" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Docker Compose output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output-300x84.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144045" src="../Images/0b1aee36f262522562ff6d074f0e5178.png" alt="Docker Compose Output" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output-300x84.jpg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-output.jpg"/></noscript>
<p>它从DockerHub中提取所有需要的Docker图像层来构建图像。在我的测试中，下载所有的图层几乎花了三分钟。当我使用Docker 20.10时，它默认使用<a href="https://docs.docker.com/build/buildkit/"> BuildKit </a>。它以以下输出结束:</p>
<p><img data-attachment-id="144049" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/docker-output-using-buildkit/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg" data-orig-size="730,206" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Docker output using BuildKit" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit-300x85.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg" decoding="async" class="aligncenter size-full wp-image-144049 jetpack-lazy-image" src="../Images/d96876e53c714630b8601445358564c9.png" alt="Docker Output Using BuildKit" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit-300x85.jpg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144049" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/docker-output-using-buildkit/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg" data-orig-size="730,206" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Docker output using BuildKit" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit-300x85.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144049" src="../Images/d96876e53c714630b8601445358564c9.png" alt="Docker Output Using BuildKit" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit-300x85.jpg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-output-using-buildkit.jpg"/></noscript>
<p>此时，最好将composer依赖项拉入本地，因为它将与Docker Compose文件中的卷映射在一起。您可以通过运行以下命令来实现:</p>
<pre class="language-bash hljs">docker run --rm --interactive --tty \
  --volume $PWD:/app \
  composer install
</pre>
<p>这将在您的机器上本地提取所有依赖项，稍后，当卷被映射时，这些依赖项也将在容器上可用。请记住，如果没有使用Docker Compose或者整个文件夹没有映射为一个卷，则不需要这样做。它将产生以下输出:</p>
<p><img data-attachment-id="144052" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/docker-compose-not-used/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg" data-orig-size="730,387" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="If Docker Compose is not used" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used-300x159.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg" decoding="async" class="aligncenter size-full wp-image-144052 jetpack-lazy-image" src="../Images/88c2df7f03c0393de0c4989de95ff309.png" alt="If Docker Compose Is Not Used" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used-300x159.jpg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144052" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/docker-compose-not-used/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg" data-orig-size="730,387" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="If Docker Compose is not used" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used-300x159.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144052" src="../Images/88c2df7f03c0393de0c4989de95ff309.png" alt="If Docker Compose Is Not Used" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used-300x159.jpg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/docker-compose-not-used.jpg"/></noscript><br/>
Then, to run the container, we can execute:
<pre class="language-bash hljs">docker compose up
</pre>
<p>根据您的Docker和Docker Compose版本，如果您使用的是旧版本的Docker Compose，也可以是<code>docker-compose up</code>。它将产生以下结果:</p>
<p><img data-attachment-id="144055" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/dockercompose-up/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg" data-orig-size="730,328" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Docker-Compose up command being used" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up-300x135.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg" decoding="async" class="aligncenter size-full wp-image-144055 jetpack-lazy-image" src="../Images/aee5374ad454251f93d1f0171d456719.png" alt="Docker-Compose Up Command Being Used" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up-300x135.jpg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144055" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/dockercompose-up/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg" data-orig-size="730,328" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Docker-Compose up command being used" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up-300x135.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144055" src="../Images/aee5374ad454251f93d1f0171d456719.png" alt="Docker-Compose Up Command Being Used" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up-300x135.jpg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/dockercompose-up.jpg"/></noscript>
<p>这将启动服务和它们的相关容器。一旦两个容器都打开了，你可以在<a href="http://localhost:8082"> <code>http://localhost:8082</code> </a>查看浏览器上的应用程序，它将显示默认的Laravel页面:</p>
<p><img data-attachment-id="144058" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/default-laravel-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg" data-orig-size="730,368" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Default Laravel page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page-300x151.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg" decoding="async" class="aligncenter size-full wp-image-144058 jetpack-lazy-image" src="../Images/79152173470909a267f71e925aa45406.png" alt="Default Laravel Page" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page-300x151.jpg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144058" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/default-laravel-page/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg" data-orig-size="730,368" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Default Laravel page" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page-300x151.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144058" src="../Images/79152173470909a267f71e925aa45406.png" alt="Default Laravel Page" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page-300x151.jpg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/default-laravel-page.jpg"/></noscript>
<p>我在<code>Documentation</code>之外加了一个<code>-</code>，看看更新效果如何，效果不错。要登录并查看用户，您可以导航到<code><a href="http://localhost:8082/admin/login" rel="nofollow">http://localhost:8082/admin/login</a></code>，使用<code><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3f4b5a4c4b7f4b5a4c4b115c5052">[email protected]</a></code>作为用户，使用<code>testpass</code>作为密码，点击<strong>登录</strong>:</p>
<p><img data-attachment-id="144060" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/laravel-login/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg" data-orig-size="730,385" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Laravel login" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login-300x158.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg" decoding="async" class="aligncenter size-full wp-image-144060 jetpack-lazy-image" src="../Images/1ffd072897251041f84a9d4d70a1a083.png" alt="Laravel Login" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login-300x158.jpg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144060" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/laravel-login/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg" data-orig-size="730,385" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Laravel login" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login-300x158.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144060" src="../Images/1ffd072897251041f84a9d4d70a1a083.png" alt="Laravel Login" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login-300x158.jpg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/laravel-login.jpg"/></noscript>
<p>这在不运行任何<code>artisan migrate</code>的情况下是可能的，因为初始数据已经用文件<code>./db/init.sql</code>加载，该文件有两个用户。登录后点击左侧的<strong>用户</strong>即可看到:</p>
<p><img data-attachment-id="144063" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/image7-10/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg" data-orig-size="730,381" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="List of users" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/image7-300x157.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg" decoding="async" class="aligncenter size-full wp-image-144063 jetpack-lazy-image" src="../Images/0447c91759dd945cd2ae8f9198c152fe.png" alt="List Of Users" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/image7-300x157.jpg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144063" data-permalink="https://blog.logrocket.com/how-to-run-laravel-docker-compose-ubuntu-v22-04/attachment/image7-10/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg" data-orig-size="730,381" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="List of users" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/image7-300x157.jpg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-144063" src="../Images/0447c91759dd945cd2ae8f9198c152fe.png" alt="List Of Users" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/image7-300x157.jpg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/image7.jpg"/></noscript>
<p>你有它！Laravel 9.x在Ubuntu 22.04上运行MySQL，带有Docker和Docker Compose。这个Docker形象除了设置简单，还有制作的舞台，比Laravel Sail优化很多。</p>
<h2 id="conclusion">结论</h2>
<p>在本指南中，您了解了Docker是什么。然后你了解了一个简单的Laravel 9.x app，用Backpack展示用户。之后，您将了解Docker文件和Docker Compose文件，以便在Ubuntu v22.04上使用Docker运行此应用程序。在此过程中，您还了解了<code>dockerignore</code>以及如何为Laravel构建和运行Docker容器，这些容器适用于本地开发，也支持生产模式。</p>
<p>编码快乐！</p><div class="code-block code-block-4">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket会告诉您应用程序中实际影响用户的最具影响力的bug和UX问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket自动聚合客户端错误、JS异常、前端性能指标和用户交互。然后LogRocket使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试LogRocket】。</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>