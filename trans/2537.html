<html>
<head>
<title>Fela: Writing state-driven styles for React and React Native - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Fela:为 React 和 React Native - LogRocket 博客编写状态驱动的样式</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/fela-state-driven-styles-react-react-native/#0001-01-01">https://blog.logrocket.com/fela-state-driven-styles-react-react-native/#0001-01-01</a></blockquote><div><article class="article-post">
<p>React 最初可能是为 web 设计的，但它通常在 web 和 HTML 及 CSS 领域之外使用。React 是作为独立于框架的渲染引擎构建的，这意味着最终渲染的内容取决于您使用的渲染器。</p>
<p>有许多渲染器可以用来提供各种结果。最受欢迎的渲染器之一是<a href="https://reactnative.dev/docs/intro-react" target="_blank" rel="noopener"> React Native Renderer </a>，它为 Android 或 iOS 生成原生移动元素。</p>
<p>在下图中，您可以看到 React 和 React Native 中各部分的结构以及两者的异同。</p>
<figure id="attachment_85174" aria-describedby="caption-attachment-85174" class="wp-caption aligncenter"><img data-attachment-id="85174" data-permalink="https://blog.logrocket.com/fela-state-driven-styles-react-react-native/attachment/react-web-native-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png" data-orig-size="730,252" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React Web and React Native structures" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure-300x104.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png" decoding="async" class="wp-image-85174 size-full jetpack-lazy-image" src="../Images/135f98767731c8ba69629059fa7c322b.png" alt="React Web and React Native Structures" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure-300x104.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="85174" data-permalink="https://blog.logrocket.com/fela-state-driven-styles-react-react-native/attachment/react-web-native-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png" data-orig-size="730,252" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React Web and React Native structures" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure-300x104.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png" decoding="async" loading="lazy" class="wp-image-85174 size-full" src="../Images/135f98767731c8ba69629059fa7c322b.png" alt="React Web and React Native Structures" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure-300x104.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/react-web-native-structure.png"/></noscript><figcaption id="caption-attachment-85174" class="wp-caption-text"><a href="https://blog.atulr.com/static/cc397bd7316079f477f29f36fd058a80/6774c/common-reconciler.png" target="_blank" rel="noopener">Source</a></figcaption></figure>
<p>在本文中，我们将介绍<a href="https://fela.js.org" target="_blank" rel="noopener"> Fela </a>，React 的一个新的样式框架，它将帮助您避免样式不一致和繁琐的代码。</p>
<p><em>向前跳转:</em></p>

<h2 id="styling-for-react">React 的样式</h2>
<p>除了呈现器因 React 代码运行的平台而异之外，创建样式本身也会因代码呈现的位置而异。例如，通常不可能在 React 和 React Native 之间共享样式。</p>
<p>出于这个原因，用于 web 的样式库，如 styled-components、Emotion 和 Tailwind CSS，不能在 React Native 中工作。相反，我们必须<a href="https://blog.logrocket.com/react-native-styling-tutorial-with-examples/" target="_blank" rel="noopener">创建在 React 本地应用</a>中工作的样式表。</p>
<p>但是这样做最终会使你的设计系统变得麻烦，并导致样式和代码的不一致，你需要保持这两种风格。这就是新的样式框架 Fela 的用武之地。</p>
<h2 id="what-is-fela">什么是 Fela？</h2>
<p><a href="https://fela.js.org/" target="_blank" rel="noopener"> Fela </a>是一个独立于任何 JavaScript 框架的样式框架。Fela 渲染器可以注入到你想要的用例中，生成你需要的样式。</p>
<p>本质上，您定义您的样式，为您希望在其上使用样式的每个平台安装和配置特定的渲染器，然后注入样式。</p>
<h2 id="why-use-fela">为什么您应该使用 Fela</h2>
<p>Fela 希望解决三个核心问题，这些正是 Fela 的独特之处。</p>
<h3 id="dynamic-styling-default">1.默认情况下使样式动态化</h3>
<p>风格通常是静态的。这是有意义的，因为定义不会经常改变。然而，与其改变应该使用的定义，为什么不把样式本身变成动态的，这样当状态改变时它们也会改变？</p>
<p>根据<a href="https://fela.js.org/docs/latest/intro/principles" target="_blank" rel="noopener"> Fela 文档，</a>“如果视图是状态的函数，你的 CSS 也应该是，因为它是视图的一部分。”这指的是这样一个事实，即 Fela 中的所有样式定义都是动态的，并且是从组件的状态中派生出来的。</p>
<h3 id="framework-agnostic">2.Fela 是框架不可知的</h3>
<p>这大概是图书馆最大的优势。不用考虑 JavaScript 框架也可以编写 Fela 样式。我们将在后面看到这是如何可能的。</p>
<h3 id="highly-performant">3.费拉是高性能的</h3>
<p>呈现样式和加载样式永远不会成为应用程序的瓶颈。这就是为什么<a href="https://fela.js.org/docs/latest/intro/benefits#high-performance" target="_blank" rel="noopener">费拉速度超快的原因</a>。为什么？因为原子样式很容易被缓存和重用。这个原则，<a href="https://blog.logrocket.com/atomic-css-in-js-vs-utility-first-frameworks/" target="_blank" rel="noopener">结合 CSS-in-JS </a>的一般优势，意味着 Fela 拥有最佳的速度组合。</p>
<p>让我们探索一下如何实际使用这个库。我们将为一个按钮创建一个样式，既可以在 web 上使用，也可以在 React 本地应用程序中使用。</p>
<h2 id="setting-up-react-project-fela">设置 React 项目和 Fela</h2>
<p>我们的目标是创建一个网站和一个移动应用程序，使用一个样式源来呈现具有相同外观和感觉的按钮。这个项目由三部分组成，看起来像这样:</p>
<pre class="language-bash hljs">-- mobile_app
-- web_app
-- shared
</pre>
<h2 id="writing-basic-styles">写作基本风格</h2>
<p>让我们从在你的<code>shared</code>文件夹中写风格开始，这样你就不需要安装包了。我们可以用 JavaScript 编写和定义我们的样式，因为它们被定义为简单的对象或函数。</p>
<pre class="language-javascript hljs">// shared/index.js

export const buttonStyles = (props) =&gt; {
    width: props.size,
    padding: '10px',
    backgroundColor: 'black',
    color: 'white',
}
</pre>
<p>如果您想使用伪类为按钮添加一些元素或交互性，可以通过嵌套另一个对象来实现，如下所示:</p>
<pre class="language-javascript hljs">// shared/index.js

export const buttonStyles = (props) =&gt; {
    width: props.size,
    padding: '10px',
    backgroundColor: 'black',
    color: 'white',

    ':hover': {
      opacity: '0.8'
    }

    ':before': {
      content: '" "',
      height: '10px',
      width: '10px',
    }
}
</pre>
<p>最后，当我们在一个更小的设备上使用它时，我们也应该给我们的按钮一点改变。为此，我们还可以在媒体查询下添加一些样式，如下所示:</p>
<pre class="language-javascript hljs">// shared/index.js

export const buttonStyles = (props) =&gt; {
    // ... previous styles
    '@media (min-height: 540px)': {
      padding: '5px',
    },
}
</pre>
<p>如果你想了解更多关于如何用 Fela 编写样式，以及如何使用高级 CSS 特性，比如选择器、伪元素等。，你可以在 Fela 官方网站上阅读<a href="https://fela.js.org/docs/latest/basics/rules" target="_blank" rel="noopener">文章和指南</a>，它解释了如何通过编写 Fela 样式来实现任何 CSS 特性。</p>
<h2 id="using-styles-react-web-app">在 React web 应用程序中使用样式</h2>
<p>要在 React 应用程序中使用定义的样式，您需要在 React 项目中安装以下内容:</p>
<pre class="language-bash hljs">yarn add fela React-fela
</pre>
<p>我们需要安装特定的渲染器来渲染我们的样式，以便在 web 应用程序中使用。接下来，您需要使用特定的 Fela 提供程序来打包 React 应用程序，该提供程序允许将样式呈现为 CSS:</p>
<pre class="language-javascript hljs">// web_app/App.jsx

import { createRenderer } from 'fela'
import { RendererProvider } from 'react-fela'
import MyApp from './MyApp'

const renderer = createRenderer()

export default () =&gt; (
    &lt;RendererProvider renderer={renderer}&gt;
        &lt;MyApp /&gt;
    &lt;/RendererProvider&gt;
)
</pre>
<p>如果这是在您的 web React 应用程序的根目录中定义的，那么您现在可以在您的组件中使用您的共享样式，如下所示:</p>
<pre class="language-javascript hljs">// web_app/components/App.jsx
import { buttonStyles } from '../../shared'

function Button({ children, size = 16 }) {
    const { css } = useFela({ size })

    return &lt;button className={css(buttonStyles)}&gt;{children}&lt;/button&gt;
}
</pre>
<p>就是这样！这将生成通用样式，以便 web 浏览器能够理解它们。</p>
<h2 id="using-styles-react-native-application">在 React 本机应用程序中使用样式</h2>
<p>类似于 web，让我们在 react 原生项目中安装 Fela 和 react-fela。此外，还需要安装 React Native 专用的 Fela 包。</p>
<pre class="language-bash hljs">yarn add fela React-fela fela-native
</pre>
<p>与我们在 React web 应用程序中所做的类似，您需要使用一个专用的渲染器提供程序来打包整个应用程序，如下所示:</p>
<pre class="language-javascript hljs">// mobile_app/App.js
import React from 'react'
import { AppRegistry } from 'react-native'
import { createRenderer } from 'fela-native'
import { RendererProvider } from 'react-fela'
import MyApp from './MyApp'

const renderer = createRenderer()

const App = (props) =&gt; (
    &lt;RendererProvider renderer={renderer}&gt;
        &lt;App /&gt; 
    &lt;/RendererProvider&gt;
)

AppRegistry.registerComponent('FelaNative', () =&gt; App)
</pre>
<p>为了使用我们在 web 应用程序中用于按钮的相同样式，用法非常相似。唯一的区别是样式被附加到按钮组件的 React Native <code>style</code>标签，而不是<code>className</code>。</p>
<pre class="language-javascript hljs">// mobile_app/components/App.js
import { buttonStyles } from '../../shared'
import { Button } from 'react-native'
import { useFela } from 'react-fela'

function Button({ children, size = 16 }) {
    const { style } = useFela({ size })

    return &lt;Button style={style(buttonStyles)}&gt;{children}&lt;/button&gt;
}
</pre>
<p>这将使相同的样式定义不仅反映 web 按钮的样式，还反映 React 本机移动按钮的样式。这只是一个简单的例子，但当涉及到设计系统中复杂的风格定义时，可以跨平台共享并提供一致的品牌外观和感觉，Fela 是强大的。</p>
<h2>结论</h2>
<p>由于不同设备显示内容的方式不同，我们编写应用程序的方式也发生了变化。现在，为不同平台编写应用程序的需求变得更加重要。</p>
<p>幸运的是，技术也已经适应了，所以我们不必为每个平台从头开始开发每个应用程序。使用 Fela 跨多个平台创建样式节省了时间，防止了错误，并提供了一致的品牌。</p>
<p>尽管 Fella 有一些小警告，但我是这个图书馆的忠实粉丝。请在下面的评论中告诉我你的想法！</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现 React 原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款 React 原生监控解决方案，可帮助您即时重现问题、确定 bug 的优先级并了解 React 原生应用的性能。</p><p>LogRocket 还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket 的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的 React 原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用 LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>