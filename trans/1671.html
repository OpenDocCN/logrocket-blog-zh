<html>
<head>
<title>The complete guide to React Native for Web - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>完全指南反应原生的网络日志火箭博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/complete-guide-react-native-web/#0001-01-01">https://blog.logrocket.com/complete-guide-react-native-web/#0001-01-01</a></blockquote><div><article class="article-post">
<p><strong> <em>编者按:</em> </strong> <em>本文于 2022 年 3 月 16 日更新，包含 React Native for Web </em>  <em>最新发布的大多数</em> <a href="https://github.com/necolas/react-native-web/releases/tag/0.17.0" target="_blank" rel="noopener"> <em>的信息，并说明了突破性的变化。</em></a></p>
<h2>介绍</h2>
<p>当开始一个新项目时，要做的最重要的决定之一是选择你的开发栈。你需要选择一个你的大多数用户都活跃的平台，但同时，这个平台不应该有太多的限制。</p>
<p>应用程序的未来发展可能需要您在一个完全不同的平台上接触用户。因此，您的初始堆栈应该足够灵活，以适应这种增长需求。</p>
<p>说到通用技术，<a href="https://blog.logrocket.com/sharing-code-react-native-web/" target="_blank" rel="noopener"> React Native for Web </a>使开发人员能够在 Web 上使用 React Native 组件和 API。这是移动优先框架之战中的一个游戏改变者，因为 React Native 是构建跨平台移动应用程序的最受欢迎的选择之一。</p>
<p>在本文中，我们将讨论围绕 React Native for Web 的讨论，并使用它建立一个演示项目！</p>
<h2 id="contents">内容</h2>

<h2 id="can-react-native-used-web-mobile">React Native 可以用于 web 和移动吗？</h2>
<p>是啊！通过 React Native for web，开发人员可以编写一个 React Native 应用程序，该应用程序可以在 Android 和 iOS 上本地运行，也可以在使用标准 Web 技术的 Web 浏览器上运行。</p>
<p>但是考虑到 React Native 的概念母体 React 是专门为 web 构建的，首先值得质疑的是为什么这种技术是必要的。</p>
<p>现实是，移动应用的基础与 web 应用的基础完全不同。例如，React 使用基本的 HTML5 元素，如<code>div</code>和<code>span</code>来构建布局，而 React Native 使用自定义 UI APIs，如<code>View</code>和<code>Text</code>。由于这种差异，很少有技术支持构建 web 和移动应用程序。</p>
<p><a href="https://blog.logrocket.com/react-native-web-vs-flutter-web/" target="_blank" rel="noopener"> React Native for Web </a>就是试图弥合这一鸿沟。它旨在帮助使用单一 React 原生代码库创建真正的跨平台应用程序。但是它是如何做到的呢？让我们找出答案。</p>
<h2 id="using-react-native-browser-how-does-react-native-web-work">在浏览器上使用 React Native:React Native 如何用于 Web 工作？</h2>
<p>如前所述，web 应用和移动应用有着非常不同的基础。两个平台上都有不同的 API 来完成相同的工作，比如呈现 UI。</p>
<p>任何旨在弥合这一差距的框架背后的思想都很简单:使用一个平台的 API 来构建另一个平台的 API 的等价物。React Native for Web 就是这么做的。</p>
<p>React Native for Web 提供了 React Native 组件的浏览器兼容等价物。例如，如果在 React Native mobile 中使用一个<code>&lt;View&gt;</code>来呈现视图，那么在 React Native for Web 中可以获得这个<code>&lt;View&gt;</code>的浏览器兼容版本，它有一个将这个视图编译成 web <code>&lt;div&gt;</code>的方法。</p>
<p>这提出了一个重要的观点:并不是所有的本地组件都是浏览器友好的。一些面向移动设备的组件利用了移动硬件 API，这些 API 不能通过 web 浏览器直接访问。</p>
<p>这意味着我们不能使用 React Native for Web 将应用程序完全移植到其 Web 版本中。但是我们仍然可以移植它的大部分，而且通常情况下，这就足够了。</p>
<p>样式是 React 和 React Native 的另一个不同之处。在 React 中，我们可以使用一长串样式解决方案，包括 CSS、<a href="https://blog.logrocket.com/sass-react-native-guide/" target="_blank" rel="noopener"> Sass </a>、CSS-in-JS 等。另一方面，在 React Native 中，所有样式都是用 CSS-in-JS 编写的。</p>
<p>也许不出所料，React Native for Web 采用了 React Native 的 CSS-in-JS 方法，确保同一组样式在移动和 Web 上都可以很好地工作。</p>
<h2 id="integrations">集成</h2>
<p>你可以访问<a href="https://reactnative.directory/?web=true" target="_blank" rel="noopener"> React 原生目录</a>来查找提供 web 支持的 React 原生包。</p>
<p>以下流行的 web 框架也为集成提供了 API:</p>

<h2 id="getting-started-react-native-web">React Native for Web 入门</h2>
<p>现在，我们已经从理论上理解了 React Native 系列 API 背后的概念，让我们通过安装过程来了解如何设置我们的 web 友好的 React Native 应用程序。</p>
<p>我们可以通过两种方式为 web 应用程序设置 React Native:Expo 和 Create React App。</p>
<h3>世博会</h3>
<p>Expo 是一个通用 React 应用开发框架。它支持通过<a href="https://docs.expo.dev/workflow/web/" target="_blank" rel="noopener"> Expo for web </a>开发 Android、iOS 和 web 应用程序。</p>
<p>Expo for web 提供了一系列现成的跨平台 API，包括 web 构建优化，并提供了一个通用 SDK，用于使用 React Native for web 在 Web 上运行原生移动 Expo 应用程序。</p>
<p>要使用 Expo for web 引导 React Native for Web 应用程序，请执行以下步骤:</p>
<pre class="language-shell hljs">// initialize project with npm
npx expo-cli init your-app-name
cd my-app

// install react-dom and react-native-web
npm install react-dom react-native-web
npx expo-cli start                                                       
</pre>
<h3>创建 React 应用</h3>
<p>创建 React 应用程序是引导纯 web React 应用程序的标准方式。虽然自带了对别名<code>react-native-web</code>到<code>react-native</code>的内置支持，但还是建议使用 Expo。</p>
<p>但是，我们可以通过以下步骤使用 CRA 引导 React Native for Web 应用程序:</p>
<pre class="language-shell hljs">// initialize create-react-app project
npx create-react-app your-app-name
cd my-app

// install react-dom and react-native-web
npm install react-native-web
npm start
</pre>
<h2 id="prepare-react-native-application-web">为 web 准备 React 本机应用程序</h2>
<p>让我们从引导您的 Expo 项目开始，如下所示:</p>
<pre class="language-shell hljs">// initilaize project
npx create-react-app &lt;-- app-name --&gt;
</pre>
<p>注意，通过使用<code>npx</code>，我们使用了最新版本的 CRA 包。这消除了我们在全球安装时在本地管理其版本的麻烦:</p>
<pre class="language-shell hljs">// change directory
cd &lt;-- app-name --&gt;

// install dependencies
npm i react-native-web
</pre>
<p>现在我们已经安装了主包，我们将使用 React native 的<code>[AppRegistry.registerComponent](<a href="https://reactnative.dev/docs/appregistry" rel="nofollow">https://reactnative.dev/docs/appregistry</a>)</code>注册我们的<code>App</code>根组件——注意，如果您使用的是<code>expo-cli</code>，这一步是不需要的。</p>
<p><code>AppRegistry</code>是运行所有 React 原生应用的 JavaScript 入口点，您可以通过用以下代码替换<code>index.js</code>文件中的代码来注册<code>App</code>根组件:</p>
<pre class="language-javascript hljs">import { AppRegistry } from "react-native";
import App from "./App";

AppRegistry.registerComponent("App", () =&gt; App);
AppRegistry.runApplication("App", {
  rootTag: document.getElementById("root")
});
</pre>
<p>接下来，让我们添加一些使用 React Native CLI 的样板代码。用以下代码替换<code>App</code>组件中的代码:</p>
<pre class="language-javascript hljs">import React from 'react';
import { Button, StyleSheet, Text, View, Dimensions } from 'react-native';

function Link(props) {
  return &lt;Text {...props} accessibilityRole="link" style={StyleSheet.compose(styles.link, props.style)} /&gt;;
}

function App() {
  return (
    &lt;View style={styles.container}&gt;
      &lt;View style={styles.header}&gt;
        &lt;Text style={styles.title}&gt;Welcome to React Native for Web&lt;/Text&gt;
      &lt;/View&gt;
      &lt;Text style={styles.text}&gt;
        This starter project enables you to build web application using React Native module. .
      &lt;/Text&gt;
      &lt;Text style={styles.text}&gt;
        Built with &lt;Link href="https://github.com/facebook/create-react-app"&gt;Create React App&lt;/Link&gt; and{' '}
        &lt;Link href="https://github.com/necolas/react-native-web"&gt;React Native for Web&lt;/Link&gt;
      &lt;/Text&gt;
      &lt;Button onPress={() =&gt; {}} title="Example button" /&gt;
    &lt;/View&gt;
  );
}
let ScreenHeight = Dimensions.get('window').height;
const styles = StyleSheet.create({
  container: {
    flex: 1,
    height: ScreenHeight,
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: '#F5FCFF'
  },
  header: {
    padding: 20
  },
  title: {
    fontWeight: 'bold',
    fontSize: '1.5rem',
    marginVertical: '1em',
    textAlign: 'center'
  },
  text: {
    lineHeight: '1.5em',
    fontSize: '1.125rem',
    marginVertical: '1em',
    textAlign: 'center'
  },
  link: {
    color: '#1B95E0'
  },
  code: {
    fontFamily: 'monospace, monospace'
  }
});
export default App;
</pre>
<p>现在，我们可以通过运行以下命令来测试应用程序:</p>
<pre class="language-shell hljs">npm start
</pre>
<p>我们应该得到如下结果。</p>
<p><img data-attachment-id="98490" data-permalink="https://blog.logrocket.com/complete-guide-react-native-web/blank-react-native-web-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png" data-orig-size="730,366" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="blank-react-native-web-app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app-300x150.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png" decoding="async" class="size-full wp-image-98490 aligncenter jetpack-lazy-image" src="../Images/665b48940acc784e4c7957d315185199.png" alt="Blank React Native for Web app" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app-300x150.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="98490" data-permalink="https://blog.logrocket.com/complete-guide-react-native-web/blank-react-native-web-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png" data-orig-size="730,366" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="blank-react-native-web-app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app-300x150.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png" decoding="async" loading="lazy" class="size-full wp-image-98490 aligncenter" src="../Images/665b48940acc784e4c7957d315185199.png" alt="Blank React Native for Web app" srcset="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app-300x150.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/03/blank-react-native-web-app.png"/></noscript>
<h2 id="customization-enhancements-webpack-babel">webpack 和 Babel 的定制和增强</h2>
<p>CRA 在幕后为我们做了很多，比如<a href="https://necolas.github.io/react-native-web/docs/setup/#package-aliasing" target="_blank" rel="noopener">包别名</a>和优化的 webpack 配置。</p>
<p>开箱即用，CRA 使用 webpack 的<a href="https://webpack.js.org/configuration/resolve/#resolvealias" target="_blank" rel="noopener"> <code>resolve.alias</code> </a>为 Web 提供了别名 React Native 的内置支持。因此，当我们将 React Native 导入我们的应用程序时，它解析为 React Native for Web。</p>
<p>CRA 还提供了一个内部优化的 webpack 配置，但是对于有定制需求(比如使用 Babel 进行编译或构建增强)的精明开发者来说，你应该使用 Expo 引导你的应用程序。此外，确保将您的自定义 webpack 配置添加到您的<code>webpack.config.js</code>文件中，如下例所示:</p>
<pre class="language-javascript hljs"> const webpack = require('webpack');

module.exports = {
  entry: {
    main: './index.web.js',
  },
  module: {
    loaders: [
      {
        test: /\.js?$/,
        exclude: /node_modules/,
        loader: 'babel',
        query: {
          presets: ['es2015', 'react'],
        },
      },
    ],
  },
  resolve: {
    alias: {
      'react-native$': 'react-native-web',
    },
  },
};
</pre>
<p>在上面的代码中，webpack 使用<a href="https://webpack.js.org/loaders/babel-loader/#root" target="_blank" rel="noopener"> babel-loader </a>将 ES2015 和 JSX 代码转换成浏览器友好的 JavaScript。我们已经使用 webpack 的<code>resolve.alias</code>手动设置了包别名。<code>$</code>只是指定一个直接匹配。</p>
<p>请注意，为了使用上述配置，我们需要手动安装所需的依赖项，如下所示:</p>
<pre class="language-shell hljs">npm i webpack babel-loader babel-preset-react babel-preset-es2015
npm i webpack-dev-server --save-dev
</pre>
<p>或者，Babel 通过使用<code><a href="https://www.npmjs.com/package/babel-plugin-module-resolver" target="_blank" rel="noopener">babel-plugin-module-resolver</a></code>来支持模块别名:</p>
<pre class="language-javascript hljs">{
  "plugins": [
    ["module-resolver", {
      "alias": {
        "^react-native$": "react-native-web"
      }
    }]
  ]
}
</pre>
<h2 id="further-recommendations">进一步建议</h2>
<p>尽管 CRA 提供了一些开箱即用的功能，但通常建议您使用 Expo 引导您的应用程序，尤其是如果您正在构建一个多平台的应用程序。</p>
<p>对于构建时优化，建议您使用<code>babel-plugin-react-native-web</code>插件。您可以将它作为开发依赖项安装，如下所示:</p>
<pre class="language-shell hljs">npm install --save-dev babel-plugin-react-native-web
</pre>
<p>另外，可以使用平台模块添加特定于平台的代码:</p>
<pre class="language-javascript hljs">import { Platform } from 'react-native';

const styles = StyleSheet.create({
  height: (Platform.OS === 'web') ? 200 : 100,
});
</pre>
<h2 id="conclusion">结论</h2>
<p>回顾本教程，我们讨论了什么是 React Native for Web，它解决的问题，以及它是如何工作的。然后，我们学习了如何在从头开始创建我们自己的 React Native for Web 应用程序之前建立一个 React Native for Web 项目。</p>
<p>我们还学习了如何使用定制的 webpack 配置，以及如何使用 Babel 添加增强功能。</p>
<p>有趣的是，React Native for Web 被 Twitter、优步和美国职业足球大联盟用于生产 Web 应用程序。我希望您学到了足够的知识，可以在下一个多平台项目中尝试它。</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现 React 原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款 React 原生监控解决方案，可帮助您即时重现问题、确定 bug 的优先级并了解 React 原生应用的性能。</p><p>LogRocket 还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket 的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的 React 原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用 LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>