<html>
<head>
<title>Rendering JSON animations in React applications - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在 React 应用程序中渲染 JSON 动画</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/rendering-json-animations-react-applications/#0001-01-01">https://blog.logrocket.com/rendering-json-animations-react-applications/#0001-01-01</a></blockquote><div><article class="article-post">
<p>使用 JSON 动画可能有点棘手。没有太多的资源可以深入讨论它们，所以如果您选择在下一个 React 项目中使用 JSON 动画，您可能会很容易迷失方向。</p>
<p>在本教程中，我将分享我在自己构建的 React 应用程序中尝试渲染 JSON 动画的个人经验。我将介绍我所面临的挑战，我如何解决这些问题，以及在 React 应用程序中呈现 JSON 动画的简单方法。</p>
<p>虽然您可以在这个演示中使用任何框架，但我将使用 Next.js，因为它非常棒，速度非常快。你可以通过预先填充的链接查看<a href="https://github.com/fullstackmafia/json-animation-react"> React 项目</a>和<a href="https://github.com/fullstackmafia/json-animation-nextjs"> Next.js 项目</a>的源代码。我们开始吧！</p>
<h3>目录</h3>

<h2 id="getting-started-nextjs">Next.js 入门</h2>
<p>首先，我们将从头开始创建一个 Next.js 项目。您可以使用下面的命令通过 IDE 的终端创建一个:</p>
<pre>npx create-next-app
</pre>
<p>上面的命令创建了一个样板 Next.js 应用程序，可以通过<code>port 3000</code>上的 dev 服务器访问。导航到项目文件夹，使用以下代码启动项目:</p>
<pre>cd front-end-app
npm run dev
</pre>
<p>您应该会在浏览器中看到下面的屏幕:</p>
<p><img data-attachment-id="98234" data-permalink="https://blog.logrocket.com/rendering-json-animations-react-applications/nextjs-homepage-project-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png" data-orig-size="730,487" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nextjs-homepage-project-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png" decoding="async" class="aligncenter wp-image-98234 size-full jetpack-lazy-image" src="../Images/0b51348b64a1f327f9426e8841c09ffb.png" alt="Nextjs Homepage Project Screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen-300x200.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="98234" data-permalink="https://blog.logrocket.com/rendering-json-animations-react-applications/nextjs-homepage-project-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png" data-orig-size="730,487" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nextjs-homepage-project-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png" decoding="async" loading="lazy" class="aligncenter wp-image-98234 size-full" src="../Images/0b51348b64a1f327f9426e8841c09ffb.png" alt="Nextjs Homepage Project Screen" srcset="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen-300x200.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/nextjs-homepage-project-screen.png"/></noscript>
<p>既然我们已经从头开始搭建了 Next.js 应用程序，让我们来看看真正的问题所在，部署动画！</p>
<h2 id="configuring-nextjs-lottie-cloudinary">使用 Lottie 和 Cloudinary 配置 Next.js</h2>
<p>网络上的大多数 JSON 动画都是通过一个制作和托管动画的在线平台<a href="https://lottiefiles.com/"> Lottie </a>制作的。<a href="https://blog.logrocket.com/creating-animations-lottie-react-native/">洛蒂动画附带预配置的说明</a>，用于在网页上添加和配置动画。</p>
<p>下面是我们将要使用的动画片段:</p>
<p><span class="embed-youtube"> <iframe loading="lazy" class="youtube-player" src="https://www.youtube.com/embed/GlN2v46Grvk?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation">视频</iframe> </span></p>
<p><a href="https://youtu.be/GlN2v46Grvk">https://youtu.be/GlN2v46Grvk</a></p>
<p>务必<a href="https://lottiefiles.com/login">注册一个</a> <a href="https://lottiefiles.com/login">免费</a> <a href="https://lottiefiles.com/login">洛蒂账户</a>。在我们开始之前，让我们的 Next.js 应用程序看起来更像一个工作场所。</p>
<p>我们将用一系列书籍替换默认页面，包括每本书的详细信息以及一些照片。每本书的照片将被托管在一个基于云的图片管理服务上。下面的代码片段是针对图书收藏的:</p>
<pre>// pages/index.js

  &lt;h1 className={styles.title}&gt;
          Welcome to our Book Store!
        &lt;/h1&gt;
        &lt;p className={styles.description}&gt;
          Get started by browsing our collection
        &lt;/p&gt;
        &lt;div className={styles.grid}&gt;
          &lt;a className={styles.card}&gt;
            &lt;h2&gt;Fiction&lt;/h2&gt;
            &lt;p&gt;Find in-depth information all the fiction you can read!&lt;/p&gt;
            &lt;img src='https://res.cloudinary.com/fullstackmafia/image/upload/c_scale,w_150/v1592001844/41QG0l2KA4L._SX329_BO1_204_203_200__tuyia3.jpg'/&gt;
          &lt;/a&gt;
          &lt;a className={styles.card}&gt;
            &lt;h2&gt;Science&lt;/h2&gt;
            &lt;p&gt;Explore our books and learn all you can about science &lt;/p&gt;
            &lt;img src='https://res.cloudinary.com/fullstackmafia/image/upload/c_scale,h_226,w_150/v1592001680/220px-TheGreatGatsby_1925jacket_iujiwh.jpg' /&gt;
          &lt;/a&gt;
          &lt;a
            className={styles.card}
          &gt;
            &lt;h2&gt;Engineering&lt;/h2&gt;
            &lt;p&gt;Get in and learn our engineering best practices&lt;/p&gt;
            &lt;img src='https://res.cloudinary.com/fullstackmafia/image/upload/c_scale,w_150/v1591993407/220px-Where_The_Crawdads_Sing_Book_Cover_mzfiuc.jpg' /&gt;
          &lt;/a&gt;
          &lt;a
            className={styles.card}
          &gt;
            &lt;h2&gt;Product&lt;/h2&gt;
            &lt;p&gt;
              Create amazing products with knowledge gotten from our books
            &lt;/p&gt;
            &lt;img src='https://res.cloudinary.com/fullstackmafia/image/upload/c_scale,h_226,w_150/v1592002306/51K84pomCRL._SX305_BO1_204_203_200__mjbffh.jpg' /&gt;
          &lt;/a&gt;
        &lt;/div&gt;
</pre>
<p>此时，您的页面应该看起来有点像下面的视频:</p>
<p><span class="embed-youtube"> <iframe loading="lazy" class="youtube-player" src="https://www.youtube.com/embed/X2OOV6SvNyU?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation">视频</iframe> </span></p>
<p><a href="https://youtu.be/X2OOV6SvNyU">https://youtu.be/X2OOV6SvNyU</a></p>
<h2 id="rendering-animations-nextjs-lotties-configuration">用 Lottie 渲染 Next.js 动画</h2>
<p>现在，对于我们教程的主要部分，我们将使用 Lottie 渲染一个动画。首先，将 Lottie 的 web 组件添加到您的应用程序中，这可以通过一个<code>script</code>标签来实现。将下面的标签插入到你的应用程序的<code>pages/index.js</code>文件的<code>Head</code>部分:</p>
<pre>&lt;script src="https://unpkg.com/@lottiefiles/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="137f7c67677a763e637f726a7661537f7267766067">[email protected]</a>/dist/lottie-player.js"&gt;&lt;/script&gt;
</pre>
<p>接下来，你需要获得你的动画的 URL，你可以通过上传你的 JSON 动画到你的 Lottie 账户来获得。最后，您必须在代码中使用 Lottie 的<code>&lt;lottie-player&gt;</code>元素来渲染动画。另外，确保动画的 URL 出现在<code>src</code>属性中，如下所示:</p>
<pre> &lt;lottie-player src="URL HERE" background="transparent"  speed="1"  style="width: 300px; height: 300px;" loop controls autoplay&gt;&lt;/lottie-player&gt;
</pre>
<p>上面的元素还包含预配置的设置，您可以根据需要更改这些设置来改变动画的尺寸:</p>
<ul>
<li><code>autoplay</code>:表示页面加载后是否播放动画</li>
<li><code>loop</code>:表示动画是否应该循环播放</li>
<li><code>style</code>:表示动画的任何额外配置，如样式、边框等。</li>
<li><code>controls</code>:指示播放控件是否应与动画一起呈现</li>
<li><code>speed</code>:表示动画的播放速度</li>
</ul>
<p>由于我们正在使用 Next.js 框架并编写 JSX，我们需要对<code>&lt;lottie-player&gt;</code>元素做一些修改:</p>
<pre>  &lt;lottie-player src="URL HERE" background="transparent"  speed="1"  style={{width: "300px", height: "300px"}} loop controls autoplay&gt;&lt;/lottie-player&gt;
</pre>
<p>现在，您应该会看到页面上的动画。保存您的更改并进行硬刷新:</p>
<p><span class="embed-youtube"> <iframe loading="lazy" class="youtube-player" src="https://www.youtube.com/embed/uV1Hta1Fn_8?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation">视频</iframe> </span></p>
<p><a href="https://youtu.be/uV1Hta1Fn_8">https://youtu.be/uV1Hta1Fn_8</a></p>
<h2 id="limitations-lottie-nextjs">使用 Lottie 和 Next.js 的限制</h2>
<p>虽然和洛蒂一起工作很棒，但我注意到它有很多缺点。和洛蒂在一起时，我找不到这样做的方法。相反，我不得不公开托管我的动画，让每个人都可以使用。</p>
<p>这促使我寻找一个替代的解决方案，同时仍然保留我选择的框架。谢天谢地，我找到了一个有<a href="https://github.com/chenqingspring/react-lottie">反应的——洛蒂</a>。</p>
<h2 id="react-lottie-working-json--animations-react">react-lottie:使用 JSON 动画和 react</h2>
<p>React 生态系统的一个不可否认的优势是它获得了大量的支持，从为 React 应用程序开发的第三方包的数量就可以看出这一点。</p>
<p>在 React 中处理动画是可能的，这要感谢一个名为 react-lottie 的包，它包装了 Adobe 的<a href="https://exchange.adobe.com/creativecloud.details.12557.bodymovin.html"> Bodymovin </a>插件，以将动画导出或转换为 JSON 格式。为了探索 react-lottie 如何工作，让我们从头开始创建一个新的 react 项目:</p>
<pre>npx create-react-app animation-demo
</pre>
<p>导航到您新创建的应用程序并安装 react-lottie，如下所示:</p>
<pre>cd animation-demo

npm install react-lottie
</pre>
<p>接下来，让我们将 JSON 动画添加到 React 项目中。在项目的<code>/src</code>目录中，创建一个名为<code>animations</code>的文件夹。在其中，添加您的 JSON 文件。注意，你可以通过注册<a href="https://lottiefiles.com/">洛蒂</a>来下载 JSON 动画。</p>
<p>让我们创建一个组件来处理我们的动画。在<code>/src</code>目录中，创建第二个名为<code>components</code>的文件夹。在<code>components</code>中，创建一个名为<code>AnimationPage</code>的 JSX 文件:</p>
<pre>// src/components/AnimationPage.jsx

import React, { Component } from 'react';
import Lottie from 'react-lottie';
import animationData from '../animations/data.json'
class AnimationPage extends Component {
    render() {
        const defaultOptions = {
            loop: true,
            autoplay: true,
            animationData: animationData,
            renderer: 'svg'
        }
        return (
            &lt;div&gt;
               &lt;Lottie
                options={defaultOptions}
                height={500}
                width={500}
               /&gt;
            &lt;/div&gt;
        )
    };  
}
export default AnimationPage;
</pre>
<p>在上面的代码片段中，我们导入了 JSON 动画，并配置了用于呈现该动画的选项。我们的配置设置包括以下内容:</p>
<ul>
<li><code>loop</code>:一个布尔值，它决定动画是否应该在显示器上循环播放</li>
<li><code>autoplay</code>:一个布尔值，它决定是否在页面加载完成后立即播放动画</li>
<li><code>renderer</code>:表示应该以何种文件格式渲染动画</li>
</ul>
<p>我们还导入了一个<code>Lottie</code>组件，用于处理要显示的动画。有了这个组件，我们将配置设置作为道具传递，并配置动画的<code>width</code>和<code>height</code>。</p>
<p>现在，让我们保存它并将<code>AnimationPage</code>组件导入到我们项目的<code>App.js</code>文件中:</p>
<pre> src/App.js

import './App.css';
import AnimationPage from './components/AnimationPage';
function App() {
  return (
    &lt;div className="App"&gt;
      &lt;AnimationPage/&gt;
    &lt;/div&gt;
  );
}
export default App;
</pre>
<p>让我们保存并重新加载我们的应用程序。您应该会看到动画浮动:</p>
<p><span class="embed-youtube"> <iframe loading="lazy" class="youtube-player" src="https://www.youtube.com/embed/Gq4rRZm3f1I?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation">视频</iframe> </span></p>
<p><a href="https://youtu.be/Gq4rRZm3f1I">https://youtu.be/Gq4rRZm3f1I</a></p>
<p>让我们通过创建一个功能组件来包含我们的图书详细信息，从而将我们的图书收藏添加到新创建的 React 项目中。在<code>components</code>文件夹中，创建一个名为<code>BookPage</code>的新 JSX 组件:</p>
<pre>// src/components/BookPage.jsx

import React from 'react';
import '../styles/BookPage.css'
function BookPage()  {
    return(
        &lt;main className="main"&gt;
          &lt;h1 className="title"&gt;Welcome to our Book Store!&lt;/h1&gt; 
          &lt;p className="description"&gt;Get started by browsing our collection&lt;/p&gt;
          &lt;div className="grid"&gt;
            &lt;a className="card"&gt;
              &lt;h2&gt;Fiction&lt;/h2&gt;
              &lt;p&gt;Find in-depth information all the fiction you can read!&lt;/p&gt;
              &lt;img src="https://res.cloudinary.com/fullstackmafia/image/upload/c_scale,w_150/v1592001844/41QG0l2KA4L._SX329_BO1_204_203_200__tuyia3.jpg" /&gt;
            &lt;/a&gt;

          // ....

          &lt;/div&gt;
        &lt;/main&gt; 
    ) 
}
export default BookPage;
</pre>
<p>现在，保存并刷新您的应用程序。它应该类似于 Next.js 应用程序:</p>
<p><span class="embed-youtube"> <iframe loading="lazy" class="youtube-player" src="https://www.youtube.com/embed/z4kjJxw42ng?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation">视频</iframe> </span></p>
<p><a href="https://youtu.be/z4kjJxw42ng">https://youtu.be/z4kjJxw42ng</a></p>
<h2 id="conclusion">结论</h2>
<p>React 有一个非常健康的生态系统，支持前端工程师蓬勃发展。开发人员通常可以在各种工具、插件和包的帮助下解决利基用例中的问题。</p>
<p>在本教程中，我们解决了在 Lottie 中使用 react-lottie 渲染 JSON 动画时出现的问题，react-Lottie 是 Adobe body movin 扩展的包装器。您可以应用本文中的信息在自己的 React 主题应用程序中呈现 JSON 应用程序。我希望你喜欢这篇文章，如果你有任何问题，一定要留下评论。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产 React 应用</h2><p>调试 React 应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪 Redux 状态、自动显示 JavaScript 错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的 web 和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket 不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux 中间件包为您的用户会话增加了一层额外的可见性。LogRocket 记录 Redux 存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试 React 应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>