<html>
<head>
<title>How to create a multilevel dropdown menu in React - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在 React - LogRocket 博客中创建多级下拉菜单</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/#0001-01-01">https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/#0001-01-01</a></blockquote><div><article class="article-post">
<p><em> <strong>编者按:</strong>此贴已于 2022 年 8 月 17 日更新，以更新代码示例和项目说明，并添加关于<a href="#multilevel-menu-vs-megamenu">多级菜单与巨型菜单</a>和<a href="#implementing-routing">实现菜单项</a>的路由的章节。</em></p>
<p>多级下拉菜单是网页设计的主要元素。由于能够提供多种选项供选择，它们使导航栏变得动态而有条理。</p>
<p>对于任何使用 React 或任何基于 React 的项目(如 Gatsby 或 Next.js)的开发人员，本教程涵盖了如何在 React 项目中实现 dropdown 特性的分步过程。</p>
<p>在本指南的最后，我们将看到下面的菜单:</p>
<p><img data-attachment-id="128556" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img1-final-outcome-react-multilevel-dropdown-menu-project/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project.gif" data-orig-size="730,314" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Final-outcome-react-multilevel-dropdown-menu-project" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project-300x129.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project.gif" decoding="async" class="aligncenter size-full wp-image-128556 jetpack-lazy-image" src="../Images/fe9dd04d5ff132b6275afc190990eb98.png" alt="Cursor Shown Clicking Through Final Project Outcome Of Frontend Menu With Multilevel Dropdown Components Under Services And About Menu Items" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="128556" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img1-final-outcome-react-multilevel-dropdown-menu-project/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project.gif" data-orig-size="730,314" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Final-outcome-react-multilevel-dropdown-menu-project" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project-300x129.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-128556" src="../Images/fe9dd04d5ff132b6275afc190990eb98.png" alt="Cursor Shown Clicking Through Final Project Outcome Of Frontend Menu With Multilevel Dropdown Components Under Services And About Menu Items" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img1-Final-outcome-react-multilevel-dropdown-menu-project.gif"/></noscript>
<p>要遵循本教程，请确保您对 React 有基本的了解，并确认您的计算机上安装了 Node.js。然后，我们可以开始了。</p>
<p>以下是我们将要介绍的内容:</p>


<p>当我们点击或悬停在子菜单项上时，多级菜单被设计成显示深度嵌套的导航，如上面的 GIF 所示。这种设计是中小型企业网站或博客的理想选择。</p>
<p>另一方面，巨型菜单可以一次显示整个网站的导航，而无需点击子菜单。也就是说，一个简单的扩展就可以揭示一个嵌套很深的网站菜单。这种设计对于拥有许多类别和子类别的大型网站非常有用，例如，一个零售网站。</p>

<p>让我们使用<code>create-react-app</code> CLI 创建一个新的 React 项目:</p>
<pre class="language-javascript hljs">npx create-react-app react-multilevel-dropdown-menu
</pre>
<p>然后执行以下操作:</p>
<pre class="“language-bash">cd react-multilevel-dropdown-menu
npm start
</pre>
<h2 id="react-project-structure">React 项目结构</h2>
<p>让我们将我们的项目形象化，并将用户界面分解成小块组件:</p>
<p><img data-attachment-id="128559" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img2-labeled-user-interface-project-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg" data-orig-size="730,274" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Labeled-user-interface-project-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure-300x113.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg" decoding="async" class="aligncenter size-full wp-image-128559 jetpack-lazy-image" src="../Images/0a154a0ed1608232fb2c78443497884e.png" alt="Frontend UI Shown With Number Labels One Through Five Corresponding With Various Smaller Component Pieces" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure-300x113.jpeg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="128559" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img2-labeled-user-interface-project-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg" data-orig-size="730,274" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Labeled-user-interface-project-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure-300x113.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-128559" src="../Images/0a154a0ed1608232fb2c78443497884e.png" alt="Frontend UI Shown With Number Labels One Through Five Corresponding With Various Smaller Component Pieces" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure-300x113.jpeg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img2-Labeled-user-interface-project-structure.jpeg"/></noscript>
<p>上图中的编号标签对应于以下组件名称:</p>
<ol>
<li><code>App</code>:父/根组件</li>
<li><code>Header</code>:渲染 logo 和导航条内容</li>
<li><code>Navbar</code>:渲染<code>MenuItems</code>组件</li>
<li><code>MenuItems</code>:渲染单个项目和下拉菜单</li>
<li><code>Dropdown</code>:也呈现菜单项</li>
</ol>
<p>根据这个细分，我们将创建五个不同的组件。当我们开始路由时，我们将添加更多的组件。</p>
<p>正如我们所看到的，这个项目在页面的顶部呈现了菜单导航。尽管如此，相同的过程将被应用于在侧边栏中呈现导航。</p>
<h3 id="creating-project-files">创建项目文件</h3>
<p>在<code>src</code>文件夹中，让我们确保文件树遵循以下结构:</p>
<pre class="language-javascript hljs"> ...
  ├── src
  │    ├── components
  │    │     ├── App.js
  │    │     ├── Dropdown.js
  │    │     ├── Header.js
  │    │     ├── MenuItems.js
  │    │     └── Navbar.js
  │    ├── App.css
  │    └── index.js
</pre>
<p>在<code>components/App.js</code>文件中，让我们呈现一些简单的文本:</p>
<pre class="language-javascript hljs">const App = () =&gt; {
  return &lt;div&gt;App content&lt;/div&gt;;
};

export default App;
</pre>
<p>保存文件。现在用以下内容替换<code>src/index.js</code>文件的内容:</p>
<pre class="language-javascript hljs">import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './components/App';

// styles
import './App.css';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  &lt;React.StrictMode&gt;
    &lt;App /&gt;
  &lt;/React.StrictMode&gt;
);
</pre>
<p>我们导入了一个 CSS 文件，将我们想要的“外观”添加到我们的项目中。所以，让我们从多级下拉菜单项目中复制样式<a href="https://github.com/Ibaslogic/react-multilevel-dropdown-menu/blob/main/src/App.css" target="_blank" rel="noreferrer noopener">来替换<code>src/App.css</code>文件中的样式。</a></p>
<p>保存所有文件，查看浏览器中呈现的<code>App</code>组件的内容。</p>

<p>让我们从呈现顶级菜单项开始构建。为此，让我们创建一个<code>src/menuItems.js</code>文件来保存菜单项:</p>
<pre class="language-javascript hljs">export const menuItems = [
  {
    title: 'Home',
    url: '/',
  },
  {
    title: 'Services',
    url: '/services',
  },
  {
    title: 'About',
    url: '/about',
  },
];
</pre>
<p>现在，保存文件。</p>
<p>如果我们从一开始就回忆我们的项目图像，<code>components/App.js</code>文件将呈现包含徽标的<code>Header</code>组件和<code>Navbar</code>组件。所以，在<code>components/Header.js</code>文件中，让我们添加以下代码:</p>
<pre class="language-javascript hljs">import Navbar from './Navbar';

const Header = () =&gt; {
  return (
    &lt;header&gt;
      &lt;div className="nav-area"&gt;
        &lt;a href="/" className="logo"&gt;
          Logo
        &lt;/a&gt;
        &lt;Navbar /&gt;
      &lt;/div&gt;
    &lt;/header&gt;
  );
};

export default Header;
</pre>
<p>现在，我们对内部链接使用<code>&lt;a&gt;</code>标签。在本指南的后面，我们将用<code>react-router-dom</code>中的<code>Link</code>或<code>NavLink</code>组件替换它。</p>
<p>注意，我们导入了<code>Navbar</code>组件。因此，转到<code>components/Navbar.js</code>并添加以下代码:</p>
<pre class="language-javascript hljs">const Navbar = () =&gt; {
  return (
    &lt;nav&gt;
      &lt;ul className="menus"&gt;Nav Items here&lt;/ul&gt;
    &lt;/nav&gt;
  );
};

export default Navbar;
</pre>
<p>接下来，让我们确保更新了<code>components/App.js</code>文件以呈现<code>Header</code>组件:</p>
<pre class="language-javascript hljs">import Header from './Header';

const App = () =&gt; {
  return (
    &lt;div&gt;
      &lt;Header /&gt;
    &lt;/div&gt;
  );
};

export default App;
</pre>
<p>如果我们保存所有文件，我们应该看到一个标志和导航文本显示在前端。</p>
<p>接下来，在<code>components/Navbar.js</code>文件中，导入<code>menuItems</code>数据，遍历它，然后在 JSX 中渲染它们:</p>
<pre class="language-javascript hljs">import { menuItems } from '../menuItems';
const Navbar = () =&gt; {
  return (
    &lt;nav&gt;
      &lt;ul className="menus"&gt;
        {menuItems.map((menu, index) =&gt; {
          return (
            &lt;li className="menu-items" key={index}&gt;
              &lt;a href={menu.url}&gt;{menu.title}&lt;/a&gt;
            &lt;/li&gt;
          );
        })}
      &lt;/ul&gt;
    &lt;/nav&gt;
  );
};

export default Navbar;
</pre>
<p>保存文件并检查前端。它应该是这样的:</p>
<p><img data-attachment-id="128561" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img3-frontend-progress-navbar-menu-items/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png" data-orig-size="730,458" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Frontend-progress-navbar-menu-items" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png" decoding="async" class="aligncenter size-full wp-image-128561 jetpack-lazy-image" src="../Images/9589d624fdbf440f85f08faef48d5a71.png" alt="Frontend Progress With Navbar And Menu Items Home, Services, And About" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items-300x188.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="128561" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img3-frontend-progress-navbar-menu-items/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png" data-orig-size="730,458" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Frontend-progress-navbar-menu-items" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-128561" src="../Images/9589d624fdbf440f85f08faef48d5a71.png" alt="Frontend Progress With Navbar And Menu Items Home, Services, And About" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items-300x188.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img3-Frontend-progress-navbar-menu-items.png"/></noscript>
<p>这是一个基本的导航菜单。让我们更进一步，接下来显示一个单级下拉列表。</p>

<p>让我们转到<code>src/menuItems.js</code>文件，更新数据以包含一个<code>submenu</code>，如下所示:</p>
<pre class="language-javascript hljs">export const menuItems = [
  // ...
  {
    title: 'Services',
    url: '/services',
    submenu: [
      {
        title: 'web design',
        url: 'web-design',
      },
      {
        title: 'web development',
        url: 'web-dev',
      },
      {
        title: 'SEO',
        url: 'seo',
      },
    ],
  },
  // ...
];
</pre>
<p>这里，我们给<code>Services</code>添加了一个<code>submenu</code>，因为我们想让它成为一个下拉菜单。让我们保存文件。</p>
<p>请注意，您可以忽略<code>submenu</code>URL 中的正斜杠<code>/</code>。在我们这种情况下，加不加都无所谓。但是，如果你想实现一个动态嵌套路由，你不能包含它。</p>
<p>此时，<code>Navbar</code>正在我们的代码中呈现菜单项。如果我们再看一下设计，作为<code>Navbar</code>的直接子组件的<code>MenuItems</code>组件负责呈现这些项目。</p>
<p>所以，修改<code>Navbar</code>，这样我们就有了以下内容:</p>
<pre class="language-javascript hljs">import { menuItems } from '../menuItems';
import MenuItems from './MenuItems';
const Navbar = () =&gt; {
  return (
    &lt;nav&gt;
      &lt;ul className="menus"&gt;
        {menuItems.map((menu, index) =&gt; {
          return &lt;MenuItems items={menu} key={index} /&gt;;
        })}
      &lt;/ul&gt;
    &lt;/nav&gt;
  );
};

export default Navbar;
</pre>
<p>在代码中，我们通过<code>items</code>属性将菜单项数据传递给<code>MenuItems</code>组件。这是一个被称为正确钻孔的过程，也是一个基本的反应原理。</p>
<p>在<code>MenuItems</code>组件中，我们将接收项目属性并显示菜单项。我们还将检查项目是否有一个<code>submenu</code>，然后显示一个下拉列表。所以打开<code>components/MenuItems.js</code>文件并添加以下代码:</p>
<pre class="language-javascript hljs">import Dropdown from './Dropdown';

const MenuItems = ({ items }) =&gt; {
  return (
    &lt;li className="menu-items"&gt;
      {items.submenu ? (
        &lt;&gt;
          &lt;button type="button" aria-haspopup="menu"&gt;
            {items.title}{' '}
          &lt;/button&gt;
          &lt;Dropdown submenus={items.submenu} /&gt;
        &lt;/&gt;
      ) : (
        &lt;a href={items.url}&gt;{items.title}&lt;/a&gt;
      )}
    &lt;/li&gt;
  );
};

export default MenuItems;
</pre>
<p>在代码中，我们使用<code>button</code>元素打开<a href="https://blog.logrocket.com/building-a-custom-dropdown-menu-component-for-react-e94f02ced4a1/" target="_blank" rel="noreferrer noopener">下拉菜单</a>。如果我们使用链接标签，如果我们需要辅助技术，比如屏幕阅读器，我们必须添加一个<code>role="button"</code>。</p>
<p>同样在代码中，我们导入了<code>Dropdown</code>组件，并通过 prop 传递了<code>submenu</code>项。</p>
<p>现在让我们打开<code>components/Dropdown.js</code>文件并访问道具，这样我们可以像这样渲染<code>submenu</code>:</p>
<pre class="language-javascript hljs">const Dropdown = ({ submenus }) =&gt; {
  return (
    &lt;ul className="dropdown"&gt;
      {submenus.map((submenu, index) =&gt; (
        &lt;li key={index} className="menu-items"&gt;
          &lt;a href={submenu.url}&gt;{submenu.title}&lt;/a&gt;
        &lt;/li&gt;
      ))}
    &lt;/ul&gt;
  );
};

export default Dropdown;
</pre>
<p>记得保存所有文件。</p>
<p>要查看下拉菜单，打开<code>src/App.css</code>文件并暂时注释掉 CSS 的<code>display: none;</code>部分:</p>
<pre class="“language-css">.dropdown {
 ...
 /* display: none; */
}
</pre>
<p>我们在下拉菜单中添加了一个<code>display: none;</code>属性，默认情况下隐藏它，只有当我们与菜单交互时才打开它。</p>
<p>一旦我们删除了<code>display: none;</code>属性，菜单看起来应该是这样的:</p>
<p><img data-attachment-id="128563" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img4-frontend-progress-services-dropdown/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png" data-orig-size="730,458" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Frontend-progress-services-dropdown" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png" decoding="async" class="aligncenter size-full wp-image-128563 jetpack-lazy-image" src="../Images/e49fa034b73748850ed98a7c2ad10ac2.png" alt="Frontend Progress Showing Navbar, Menu Items, And Services Dropdown Menu" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown-300x188.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="128563" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img4-frontend-progress-services-dropdown/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png" data-orig-size="730,458" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Frontend-progress-services-dropdown" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-128563" src="../Images/e49fa034b73748850ed98a7c2ad10ac2.png" alt="Frontend Progress Showing Navbar, Menu Items, And Services Dropdown Menu" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown-300x188.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img4-Frontend-progress-services-dropdown.png"/></noscript>
<p>很好。我们快到了！</p>

<p>现在，让我们定义检测下拉菜单项何时被单击的逻辑，以便我们可以动态地显示或隐藏下拉框。为此，我们必须添加一个状态，并在下拉菜单中单击更新它。</p>
<p>在<code>components/MenuItems.js</code>文件中，让我们更新代码以包含状态:</p>
<pre class="language-javascript hljs">import { useState } from "react";
// ...
const MenuItems = ({ items }) =&gt; {
 const [dropdown, setDropdown] = useState(false);
 return (
  &lt;li className="menu-items"&gt;
   {items.submenu ? (
    &lt;&gt;
     &lt;button
      // ...
      aria-expanded={dropdown ? "true" : "false"}
      onClick={() =&gt; setDropdown((prev) =&gt; !prev)}
     &gt;
      {items.title}{" "}
     &lt;/button&gt;
     &lt;Dropdown 
      // ...
      dropdown={dropdown} 
     /&gt;
    &lt;/&gt;
   ) : (
    // ...
   )}
  &lt;/li&gt;
 );
};
</pre>
<p>在代码中，我们定义了一个名为<code>dropdown</code>的状态变量，默认值为<code>false</code>和一个<code>setDropdown</code>更新器，用于在单击下拉按钮时切换状态，如<code>onClick</code>事件所示。</p>
<p>这允许我们动态地给<code>aria-expanded</code>属性添加值，以指示下拉框是展开还是折叠，这对屏幕阅读器是有益的。我们还将<code>dropdown</code>变量作为道具传递给了<code>Dropdown</code>组件，这样我们就可以处理下拉切换。</p>
<p>让我们打开<code>components/Dropdown.js</code>来访问<code>dropdown</code>属性，并使用它在单击下拉菜单时动态添加一个类名。</p>
<pre class="language-javascript hljs">const Dropdown = ({ submenus, dropdown }) =&gt; {
 return (
  &lt;ul className={`dropdown ${dropdown ? "show" : ""}`}&gt;
   {/* ... */}
  &lt;/ul&gt;
 );
};

export default Dropdown;
</pre>
<p>激活下拉菜单时会添加<code>show</code>类名。我们还在 CSS 文件中添加了一个<code>display: block;</code>样式声明来显示下拉列表。</p>
<p>现在，我们可以将<code>display: none;</code>返回到<code>src/App.css</code>中的<code>.dropdown</code>类选择器:</p>
<pre class="“language-css">.dropdown {
 ...
 display: none;
}
</pre>
<p>让我们保存我们的文件。我们现在应该能够切换我们的下拉菜单，就像这样:</p>
<p><img data-attachment-id="128565" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img5-menu-dropdown-being-toggled/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled.gif" data-orig-size="730,293" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Menu-dropdown-being-toggled" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled-300x120.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled.gif" decoding="async" class="aligncenter size-full wp-image-128565 jetpack-lazy-image" src="../Images/8de93bd4b02faa0a02af9a23d6e15508.png" alt="Cursor Shown Toggling Menu Dropdown By Clicking Services Menu Item" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="128565" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img5-menu-dropdown-being-toggled/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled.gif" data-orig-size="730,293" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Menu-dropdown-being-toggled" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled-300x120.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-128565" src="../Images/8de93bd4b02faa0a02af9a23d6e15508.png" alt="Cursor Shown Toggling Menu Dropdown By Clicking Services Menu Item" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img5-Menu-dropdown-being-toggled.gif"/></noscript>

<p>像单级下拉列表一样，要添加多级下拉列表，让我们打开<code>src/menuItems.js</code>文件并更新数据以包含多级<code>submenu</code>组件，如下所示:</p>
<pre class="language-javascript hljs">export const menuItems = [
  // ...
  {
    title: 'web development',
    url: 'web-dev',
    submenu: [
      {
        title: 'Frontend',
        url: 'frontend',
      },
      {
        title: 'Backend',
        submenu: [
          {
            title: 'NodeJS',
            url: 'node',
          },
          {
            title: 'PHP',
            url: 'php',
          },
        ],
      },
    ],
  },
  // ...
];
</pre>
<p>在“web 开发”选项中添加了一个<code>submenu</code>和“后端”选项中添加了另一个<code>submenu</code>之后，保存文件。</p>

<p>我们知道，一个下拉项目也可以有菜单项，另一个下拉项目，等等。为了实现这个设计，我们将递归地呈现菜单项。在<code>Dropdown</code>组件中，让我们将菜单项的呈现委托给<code>MenuItems</code>组件。</p>
<p>打开<code>components/Dropdown.js</code>文件，导入<code>MenuItems</code>，通过<code>items</code>道具传递<code>submenu</code>:</p>
<pre class="language-javascript hljs">import MenuItems from "./MenuItems";
const Dropdown = ({ submenus, dropdown }) =&gt; {
 return (
  &lt;ul className={`dropdown ${dropdown ? "show" : ""}`}&gt;
   {submenus.map((submenu, index) =&gt; (
    &lt;MenuItems items={submenu} key={index} /&gt;
   ))}
  &lt;/ul&gt;
 );
};

export default Dropdown;
</pre>
<p>如果我们保存文件并测试下拉列表，它可以工作，但是我们会注意到下拉列表相互重叠:</p>
<p><img data-attachment-id="128567" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img6-frontend-progress-overlapping-dropdowns/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png" data-orig-size="730,275" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Frontend-progress-overlapping-dropdowns" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns-300x113.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png" decoding="async" class="aligncenter size-full wp-image-128567 jetpack-lazy-image" src="../Images/76f7fbf67307c2629ec348f6fa0b044f.png" alt="Frontend Progress With Multilevel Dropdown Added, But Submenus Overlapping Dropdown Menu Instead Of Being Logically Positioned To The Right" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns-300x113.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="128567" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img6-frontend-progress-overlapping-dropdowns/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png" data-orig-size="730,275" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Frontend-progress-overlapping-dropdowns" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns-300x113.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-128567" src="../Images/76f7fbf67307c2629ec348f6fa0b044f.png" alt="Frontend Progress With Multilevel Dropdown Added, But Submenus Overlapping Dropdown Menu Instead Of Being Logically Positioned To The Right" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns-300x113.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img6-Frontend-progress-overlapping-dropdowns.png"/></noscript>
<p>当我们点击“web development”子菜单时，我们希望在逻辑上将它的下拉菜单放在右边。我们可以通过检测下拉深度级别来实现这一点。</p>

<p>了解菜单深度级别可以让我们做几件事情。首先，我们可以动态地添加不同的箭头来显示下拉菜单的存在。第二，我们可以用它来检测“第二层及以上”的下拉菜单，因此逻辑上将它们定位在子菜单的右边。</p>
<p>打开<code>components/Navbar.js</code>文件，在<code>return</code>语句上方添加以下内容:</p>
<pre class="language-javascript hljs">const depthLevel = 0;
</pre>
<p>同样，让我们确保通过一个 prop 将值传递给<code>MenuItems</code>。我们的代码现在看起来像这样:</p>
<pre class="language-javascript hljs">// ...
 return (
  // ...
   {menuItems.map((menu, index) =&gt; {
    const depthLevel = 0;
    return &lt;MenuItems items={menu} key={index} depthLevel={depthLevel} /&gt;;
   })}
  // ...
 );
// ...
</pre>
<p>接下来，在<code>MenuItems</code>组件中，我们访问<code>depthLevel</code>并使用它来显示下拉箭头:</p>
<pre class="language-javascript hljs">const MenuItems = ({ items, depthLevel }) =&gt; {
 // ...
 return (
  &lt;li className="menu-items"&gt;
   {items.submenu ? (
    &lt;&gt;
     &lt;button
      // ...
     &gt;
      {items.title}{" "}
      {depthLevel &gt; 0 ? &lt;span&gt;&amp;raquo;&lt;/span&gt; : &lt;span className="arrow" /&gt;}
     &lt;/button&gt;
     &lt;Dropdown
      depthLevel={depthLevel}
      // ...
     /&gt;
</pre>
<p>对于大于 T1 的 T0，我们使用一个 HTML 实体名<code>&amp;raquo;</code>显示一个右箭头，否则我们添加一个<code>.arrow</code>类名来定制一个向下箭头。在样式表中，我们添加了向下箭头的样式。</p>
<p>还要注意，我们通过 prop 将<code>depthLevel</code>传递给<code>Dropdown</code>；在那里，我们将为下拉菜单增加它。</p>
<p>在<code>components/Dropdown.js</code>文件中，访问<code>depthLevel</code>属性，增加它，并检查值是否大于<code>1</code>，这样我们可以向下拉列表中添加一个自定义类。我们已经在样式表中为该类添加了样式。</p>
<p>同样，确保我们将<code>depthLevel</code>作为道具传递给<code>MenuItems</code>:</p>
<pre class="language-javascript hljs">const Dropdown = ({ submenus, dropdown, depthLevel }) =&gt; {
 depthLevel = depthLevel + 1;
 const dropdownClass = depthLevel &gt; 1 ? "dropdown-submenu" : "";
 return (
  &lt;ul className={`dropdown ${dropdownClass} ${dropdown ? "show" : ""}`}&gt;
   {submenus.map((submenu, index) =&gt; (
    &lt;MenuItems 
     // ... 
     depthLevel={depthLevel} 
    /&gt;
   ))}
  &lt;/ul&gt;
 );
};

export default Dropdown;
</pre>
<p>让我们保存文件并测试项目。</p>
<p><img data-attachment-id="128569" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img7-frontend-progress-multiple-dropdown-menus-opening-right/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png" data-orig-size="730,206" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Frontend-progress-multiple-dropdown-menus-opening-right" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right-300x85.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png" decoding="async" class="aligncenter size-full wp-image-128569 jetpack-lazy-image" src="../Images/0765e88af6df466d5581cd34dcb8317d.png" alt="Frontend Progress Testing Showing Multiple Dropdown Menus Extending Logically And Progressively To The Right" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right-300x85.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="128569" data-permalink="https://blog.logrocket.com/how-create-multilevel-dropdown-menu-react/attachment/img7-frontend-progress-multiple-dropdown-menus-opening-right/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png" data-orig-size="730,206" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Frontend-progress-multiple-dropdown-menus-opening-right" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right-300x85.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-128569" src="../Images/0765e88af6df466d5581cd34dcb8317d.png" alt="Frontend Progress Testing Showing Multiple Dropdown Menus Extending Logically And Progressively To The Right" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right-300x85.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/img7-Frontend-progress-multiple-dropdown-menus-opening-right.png"/></noscript>
<p>现在我们可以切换菜单，我们需要一种方法来关闭下拉菜单，当我们点击它的外部。</p>

<p>通过在下拉菜单外单击，我们想要关闭它。我们可以通过将<code>dropdown</code>状态设置为默认值<code>false</code>来做到这一点。我们将定义一个逻辑来检测下拉列表之外的点击。</p>
<p>让我们打开<code>components/MenuItems.js</code>文件并更新<code>import</code>以包含<code>useEffect</code>和<code>useRef</code>钩子，如下所示:</p>
<pre class="language-javascript hljs">import { useState, useEffect, useRef } from "react";
</pre>
<p>接下来，我们将使用<code>useRef</code>通过向目标节点传递一个引用对象来访问下拉列表中的 DOM 元素:</p>
<pre class="language-javascript hljs">const MenuItems = ({ items, depthLevel }) =&gt; {
 // ...
 let ref = useRef();
 return (
  &lt;li className="menu-items" ref={ref}&gt;
   {/* ... */}
  &lt;/li&gt;
 );
};

export default MenuItems;
</pre>
<p>然后，在<code>return</code>语句上方添加以下代码:</p>
<pre class="language-javascript hljs">useEffect(() =&gt; {
 const handler = (event) =&gt; {
  if (dropdown &amp;&amp; ref.current &amp;&amp; !ref.current.contains(event.target)) {
   setDropdown(false);
  }
 };
 document.addEventListener("mousedown", handler);
 document.addEventListener("touchstart", handler);
 return () =&gt; {
  // Cleanup the event listener
  document.removeEventListener("mousedown", handler);
  document.removeEventListener("touchstart", handler);
 };
}, [dropdown]);
</pre>
<p>让我们保存文件并测试我们的项目。有用！</p>
<p>在<code>useEffect</code>钩子中，我们检查下拉菜单是否打开，然后检查被点击的 DOM 节点是否在下拉菜单之外，然后我们关闭下拉菜单。你可以在这里阅读更多关于<a href="https://blog.logrocket.com/detect-click-outside-react-component-how-to/" target="_blank" rel="noreferrer noopener">检测外部点击反应。</a></p>
<h2 id="toggling-dropdown-mouse-hover-bigger-screens">切换鼠标悬停时的下拉菜单以获得更大的屏幕</h2>
<p>让我们添加当用户将鼠标移动到菜单项上时显示下拉菜单的功能。</p>
<p>在<code>components/MenuItems.js</code>中，更新 JSX 中的<code>li</code>以包含<code>onMouseEnter</code>和<code>onMouseLeave</code>事件:</p>
<pre class="language-javascript hljs">const MenuItems = ({ items, depthLevel }) =&gt; {
 // ...
 return (
  &lt;li
   // ...
   onMouseEnter={onMouseEnter}
   onMouseLeave={onMouseLeave}
  &gt;
   {/* ... */}
  &lt;/li&gt;
 );
};

export default MenuItems;
</pre>
<p>然后，在<code>return</code>语句上方添加以下事件处理函数:</p>
<pre class="language-javascript hljs">const onMouseEnter = () =&gt; {
 window.innerWidth &gt; 960 &amp;&amp; setDropdown(true);
};

const onMouseLeave = () =&gt; {
 window.innerWidth &gt; 960 &amp;&amp; setDropdown(false);
};
</pre>
<p>保存文件并测试您的项目。</p>
<p>通过这段代码，当鼠标指针移动到一个菜单项上时，就会调用<code>onMouseEnter</code>处理程序。从那里，我们检查窗口的内部宽度是否大于<code>960px</code>，然后，我们打开下拉菜单。</p>
<p>每当鼠标离开菜单项时，我们调用<code>onMouseLeave</code>处理程序，然后关闭下拉菜单。</p>
<h2 id="implementing-routing">实施路由</h2>
<p>目前，在我们的项目中，我们使用 HTML <code>&lt;a&gt;</code>标签来链接内部页面。每当我们单击任何菜单项时，都会导致整个页面重新加载。</p>
<p>对于一个 React 应用程序，我们期望使用优化的链接标签，比如用于该操作的<code>Link</code>或<code>NavLink</code>组件。同样，我们需要确保导航条目指向并呈现它们各自的页面，这样我们就有了多页面应用程序的感觉。</p>
<p>这就是路由的用武之地。我们将使用 React 路由器跟踪当前的 URL，并根据 URL 显示不同的视图。</p>
<p>让我们安装库:</p>
<pre class="“language-bash">npm install <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0b796e6a687f2679647e7f6e79266f64664b3d">[email protected]</a>
</pre>
<h3 id="connect-react-app-browsers-url">将 React 应用程序连接到浏览器的 URL</h3>
<p>在<code>src/index.js</code>文件中，让我们将顶层组件<code>App</code>包装在路由器组件中:</p>
<pre class="language-javascript hljs">// ...
import { BrowserRouter } from 'react-router-dom';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  &lt;React.StrictMode&gt;
    &lt;BrowserRouter&gt;
      &lt;App /&gt;
    &lt;/BrowserRouter&gt;
  &lt;/React.StrictMode&gt;
);
</pre>
<p>保存并确保您的应用程序仍能工作。</p>
<h3 id="updating-internal-links">更新内部链接</h3>
<p><code>Header</code>和<code>MenuItems</code>组件都使用<code>&lt;a&gt;</code>标签来链接内部页面。我们将用路由器库中的<code>Link</code>组件替换标签。打开<code>components/Header.js</code>，导入<code>Link</code>，使用方法如下:</p>
<pre class="language-javascript hljs">// ...
import { Link } from 'react-router-dom';

const Header = () =&gt; {
  return (
    &lt;header&gt;
      &lt;div className="nav-area"&gt;
        &lt;Link to="/" className="logo"&gt;
          Logo
        &lt;/Link&gt;
        &lt;Navbar /&gt;
      &lt;/div&gt;
    &lt;/header&gt;
  );
};

export default Header;
</pre>
<p>同样，在<code>components/MenuItems.js</code>中，让我们导入<code>Link</code>来替换 HTML <code>&lt;a&gt;</code>标签:</p>
<pre class="language-javascript hljs">// ...
import { Link } from 'react-router-dom';

const MenuItems = ({ items, depthLevel }) =&gt; {
  // ...
  return (
    &lt;li&gt;
      {items.submenu ? (
        &lt;&gt;{/* ... */}&lt;/&gt;
      ) : (
        &lt;Link to={items.url}&gt;{items.title}&lt;/Link&gt;
      )}
    &lt;/li&gt;
  );
};

export default MenuItems;
</pre>
<p>如果我们保存文件并测试我们的应用程序，我们现在应该能够导航而不需要重新加载页面。</p>
<h3 id="adding-some-routes">添加一些路线</h3>
<p>现在，我们将添加路线并渲染它们以匹配它们的 URL。让我们创建一个<code>src/routes</code>文件夹来保存所有不同的路线。在文件夹中，让我们添加<code>Home.js</code>文件来呈现索引页面，并添加以下代码:</p>
<pre class="language-javascript hljs">const Home = () =&gt; {
  return &lt;h2&gt;Home page content&lt;/h2&gt;;
};

export default Home;
</pre>
<p>您可以在这里找到所有项目路线的<a href="https://github.com/Ibaslogic/react-multilevel-dropdown-menu/tree/main/src/routes" target="_blank" rel="noreferrer noopener">列表。请将它们包含在您的项目中，并确保您添加了它们各自的内容。</a></p>
<p>接下来，我们将配置路由，以便 React router 知道如何在不同的 URL 呈现应用程序。我们将在<code>components/App.js</code>文件中这样做。这个文件目前呈现了<code>Header</code>组件。</p>
<p>让我们移除<code>Header</code>组件并渲染路线:</p>
<pre class="language-javascript hljs">import { Routes, Route } from 'react-router-dom';
import Home from '../routes/Home';
import About from '../routes/About';
// ...

const App = () =&gt; {
  return (
    &lt;&gt;
      &lt;Routes&gt;
        &lt;Route path="/" element={&lt;Layout /&gt;}&gt;
          &lt;Route index element={&lt;Home /&gt;} /&gt;
          &lt;Route path="about" element={&lt;About /&gt;} /&gt;
          {/* ...*/}
        &lt;/Route&gt;
      &lt;/Routes&gt;
    &lt;/&gt;
  );
};

export default App;
</pre>
<p>为了简洁起见，我们删除了一些路线。参见<a href="https://github.com/Ibaslogic/react-multilevel-dropdown-menu/blob/main/src/components/App.js" target="_blank" rel="noreferrer noopener">这里的完整代码</a>。</p>
<p>在代码中，我们将所有路由作为孩子嵌套在一个<code>Layout</code>路由中。让我们创建一个<code>components/Layout.js</code>文件，并呈现在子路由之间交换的<code>Header</code>组件和<code>Outlet</code>。</p>
<pre class="language-javascript hljs">import { Outlet } from 'react-router-dom';
import Header from './Header';

const Layout = () =&gt; {
  return (
    &lt;div&gt;
      &lt;Header /&gt;
      &lt;div className="content"&gt;
        &lt;Outlet /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
};

export default Layout;
</pre>
<p>如果我们保存并测试我们的项目，我们应该能够呈现与其路线相匹配的组件。</p>
<h3 id="linkable-dropdown-button">可链接的下拉按钮</h3>
<p>有时，我们可能希望像“服务”这样的下拉菜单按钮指向自己的页面<code>/services</code>,而当我们悬停在大屏幕上时仍然显示下拉项目。</p>
<p>为此，我们必须确保<code>src/menuItems.js</code>中的下拉菜单也包含其 URL 路径:</p>
<pre class="language-javascript hljs">export const menuItems = [
  // ...
  {
    title: 'Services',
    url: '/services',
    submenu: [
      // ...
    ],
  },
  // ...
];
</pre>
<p>接下来，在<code>components/MenuItems.js</code>文件中，我们将展开条件检查。目前，我们只检查是否存在一个<code>submenu</code>来呈现一个按钮元素，如下所示:</p>
<pre class="language-javascript hljs">return (
  &lt;li&gt;
    {items.submenu ? (
      &lt;&gt;
        &lt;button&gt;
          {items.title}{' '}
          {/* ... */}
        &lt;/button&gt;
      &lt;/&gt;
    ) : (
      &lt;Link to={items.url}&gt;{items.title}&lt;/Link&gt;
    )}
  &lt;/li&gt;
);
</pre>
<p>现在，我们不仅要检查<code>submenu</code>还要检查 URL，然后我们将确保按钮是可链接的，如下所示:</p>
<pre class="language-javascript hljs">return (
  &lt;li&gt;
    {items.submenu &amp;&amp; items.url ? (
      &lt;&gt;
        &lt;button&gt;
          &lt;Link to={items.url}&gt;{items.title}&lt;/Link&gt;
          {/* ... */}
        &lt;/button&gt;
      &lt;/&gt;
    ) : !items.url &amp;&amp; items.submenu ? (
      &lt;&gt;
        &lt;button&gt;
          {items.title}{' '}
          {/* ... */}
        &lt;/button&gt;
      &lt;/&gt;
    ) : (
      &lt;Link to={items.url}&gt;{items.title}&lt;/Link&gt;
    )}
  &lt;/li&gt;
); 
</pre>
<h3 id="closing-dropdown-when-item-clicked">单击下拉菜单的项目时关闭下拉菜单</h3>
<p>当我们单击一个下拉项目来打开它的页面时，我们希望关闭下拉面板。我们将向菜单项添加一个 click 事件，以调用一个函数来将下拉列表状态设置回默认的 false 值。</p>
<pre class="language-javascript hljs">const MenuItems = ({ items, depthLevel }) =&gt; {
  const [dropdown, setDropdown] = useState(false);
  // ...
  const closeDropdown = () =&gt; {
    dropdown &amp;&amp; setDropdown(false);
  };

  return (
    &lt;li
      // ...
      onMouseEnter={onMouseEnter}
      onMouseLeave={onMouseLeave}
      onClick={closeDropdown}
    &gt;
      {/* ... */}
    &lt;/li&gt;
  );
};

export default MenuItems; 
</pre>
<h3 id="single-level-dropdown-smaller-screen">较小屏幕上的单级下拉菜单</h3>
<p>虽然我们的项目可以在桌面和移动设备上运行，但用户体验在设计导航菜单时很重要，而不仅仅是为了 React 中<a href="https://blog.logrocket.com/building-accessible-menubar-component-react/" target="_blank" rel="noreferrer noopener">菜单栏的可访问性。</a></p>
<p>我们可能希望将下拉级别限制为单个下拉，然后防止菜单按钮指向自己的页面，而是打开一个下拉面板。以我们目前所学，我们应该能够实现我们想要的任何逻辑。</p>
<p>在<code>components/MenuItems.js</code>中，在<code>button</code>元素内，如果屏幕小于 960 像素，我们可以删除主导航条的<code>Link</code>功能:</p>
<pre class="language-javascript hljs">{items.submenu &amp;&amp; items.url ? (
  &lt;&gt;
    &lt;button
    // ...
    &gt;
      {window.innerWidth &lt; 960 &amp;&amp; depthLevel === 0 ? (
        items.title
      ) : (
        &lt;Link to={items.url}&gt;{items.title}&lt;/Link&gt;
      )}
      {/* ... */}
    &lt;/button&gt;
  &lt;/&gt;
) : !items.url &amp;&amp; items.submenu ? (
  &lt;&gt;{/* ... */}&lt;/&gt;
) : (
  {
    /* ... */
  }
)}
</pre>
<p>接下来，我们将删除目标窗口屏幕下拉列表中的右箭头。仍然在<code>components/MenuItems.js</code>中，在<code>button</code>元素中查找以下代码:</p>
<pre class="language-javascript hljs">{depthLevel &gt; 0 ? (
  &lt;span&gt;&amp;raquo;&lt;/span&gt;
) : (
  &lt;span className="arrow" /&gt;
)}
</pre>
<p>替换为:</p>
<pre class="language-javascript hljs">{depthLevel &gt; 0 &amp;&amp;
window.innerWidth &lt; 960 ? null : depthLevel &gt; 0 &amp;&amp;
  window.innerWidth &gt; 960 ? (
  &lt;span&gt;&amp;raquo;&lt;/span&gt;
) : (
  &lt;span className="arrow" /&gt;
)}
</pre>
<p>保存并测试您的项目。它应该像预期的那样工作。</p>
<h2 id="conclusion">结论</h2>
<p>我很高兴我们在这里。现在我们可以在 React 项目中实现一个<a href="https://blog.logrocket.com/how-to-build-a-react-accordion-menu-from-scratch/" target="_blank" rel="noreferrer noopener">多级下拉菜单。</a></p>
<p>使用本教程中的实现，我们可以在数据文件中添加尽可能多的菜单和子菜单，多级下拉菜单神奇地出现在前端。然而，我们应该注意我们添加的下拉列表的级别，这样用户就不会觉得讨厌了。</p>
<p>如果你有问题和/或贡献，我在评论区。如果你喜欢这个教程，确保你在网上分享它。</p>
<p>你可以从<a href="https://github.com/Ibaslogic/react-multilevel-dropdown-menu" target="_blank" rel="noreferrer noopener">这个 GitHub 库</a>中找到项目源代码。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产 React 应用</h2><p>调试 React 应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪 Redux 状态、自动显示 JavaScript 错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的 web 和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket 不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux 中间件包为您的用户会话增加了一层额外的可见性。LogRocket 记录 Redux 存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试 React 应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>