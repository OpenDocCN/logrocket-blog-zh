<html>
<head>
<title>The guide to syntax highlighting in React - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>React - LogRocket博客中的语法高亮指南</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/guide-syntax-highlighting-react/#0001-01-01">https://blog.logrocket.com/guide-syntax-highlighting-react/#0001-01-01</a></blockquote><div><article class="article-post">
<p>软件开发人员读的代码和他们写的一样多。因此，为了增强代码的可读性，您不仅应该努力编写可读的代码，还应该应用适当的代码格式和语法突出显示。</p>
<p>开发人员日常使用几种编程和非编程计算机语言。每种语言都有自己的语法，因此，需要突出语法。为了在浏览器环境中应用语法高亮，存在诸如Prism、Highlight和<a href="https://blog.logrocket.com/tag/react/"> React </a>语法高亮器之类的库。</p>
<p>这些库各有优缺点。其中一些库是为普通JavaScript开发的，而其他库也支持React等前端框架。</p>
<p>本文将全面介绍Prism等流行的语法高亮库，以及如何在React中使用它们。我们还将强调他们的优势和劣势。</p>
<h3>目录</h3>

<h2 id="introduction-prismjs"><code>prism.js</code>简介</h2>
<p>Prism是JavaScript中最受欢迎的语法高亮库之一，在GitHub上有超过10，000颗星。您可以将它与普通JavaScript和React等框架一起使用。它支持多种语言，拥有丰富的主题和插件生态系统，可以用来扩展其核心功能。</p>
<p>为了体验Prism，您可以通过CDN快速加载它，或者下载源代码并使用<code>script</code>标签将其添加到您的标记中。您还可以下载对特定语言、主题和插件的支持。</p>
<p>核心Prism库占地面积很小。它的压缩包大小约为2kB。虽然你用core Prism下载的额外主题和插件可能会增加软件包的大小，但是你可以完全控制你可以下载的插件或主题。</p>
<p>此外，与一些语法高亮器不同，Prism强迫您使用语义HTML来表示代码。可定制性和其他几个特性使得Prism成为语法突出显示的流行选择。</p>
<p>Babel-plugin-prismjs 是一个将Prism与Babel和webpack一起使用的便捷包。在下一节中，我们将看看如何在React应用程序中使用这个插件。</p>
<h2 id="how-use-prism-syntax-highlighting-react">如何在React中使用Prism进行语法高亮显示</h2>
<p>如前一节所述，开始使用Prism最简单、最快速的方法是使用CDN。虽然CDN可能很方便，但在使用React这样的框架时，几乎总是不可能使用它。因此，您需要从NPM安装它。</p>
<pre class="language-shell hljs"># using npm
npm install prismjs
# using yarn
yarn add prismjs
</pre>
<p>如果你想在React应用程序中使用Prism进行语法高亮显示，那么Babel插件就派上了用场。您可以使用它来配置要与Prism捆绑的语言、主题和插件。您可以从NPM将它作为开发依赖项进行安装。</p>
<pre class="language-shell hljs"># using npm
npm i -D babel-plugin-prismjs
# using yarn
yarn add -D babel-plugin-prismjs
</pre>
<p>您需要在您的Babel配置文件中注册插件，如下所示:</p>
<pre class="language-json hljs">{
  "plugins": [
    ["prismjs", {
        "languages": ["javascript", "css", "markup"],
        "plugins": ["line-numbers"],
        "theme": "twilight",
        "css": true
    }]
  ]
}
</pre>
<p>您可以在配置文件中包含项目所需的语言、插件和主题。查看Prism文档，获得支持语言的完整列表以及可以使用的主题和插件。</p>
<p>如果你想使用<code>babel-plugin-prismjs</code>插件，设置一个自定义的react应用程序。然而，要与<a href="https://blog.logrocket.com/getting-started-with-create-react-app-d93147444a27/"> Create React App </a>一起使用，你需要弹出——我认为这样做违背了使用Create React App的目的。</p>
<p>此外，一些React语法突出显示包使用Prism。我们将在下面的章节中探讨其中的一些。如果您的项目不是基于定制的React应用程序，您可以考虑使用其中的一个。</p>
<p>完成上述设置后，将Prism导入React组件并调用<code>useEffect</code>钩子中的<code>highlightAll</code>方法，如下所示:</p>
<pre class="language-javascript hljs">import React, { useEffect } from "react";
import Prism from "prismjs";

function App() {
  useEffect(() =&gt; {
    Prism.highlightAll();
  });
  return (
    &lt;div&gt;
      &lt;p&gt;
        You can declare a variable in JavaScript using the
        <code>const</code>, <code>let</code> or <code>var</code> keyword. &lt;/p&gt; &lt;/div&gt; ); } export default App;</pre>
<p>当使用Prism时，您需要将内联代码包装在<code>code</code> HTML标签中，并根据您突出显示的语言，对其应用适当的类。类名应该采用<code>lang-xxxx</code>或<code>language-xxxx</code>的形式。</p>
<p><code>xxxx</code>是语言的占位符。在上面的例子中，我们向<code>code</code>元素添加了<code>lang-javascript</code>类，因为我们突出显示了JavaScript代码。</p>
<p>正如上一节所指出的，Prism迫使您在向标记中添加代码时使用语义HTML。因此，在突出显示代码块时，必须将代码包装在<code>pre</code>元素中。</p>
<p>在呈现代码块时，将您的功能提取到一个单独的组件以实现可重用性是很方便的，如下例所示。你可以把代码块和语言作为道具传递。</p>
<pre class="language-javascript hljs">import React, { useEffect } from "react";
import Prism from "prismjs";

const CodeBlock = ({ code, language }) =&gt; {
  useEffect(() =&gt; {
    Prism.highlightAll();
  }, []);
  return (
    &lt;pre&gt;
      &lt;code children={code} className={`language-${language}`} /&gt;
    &lt;/pre&gt;
  );
};

export default CodeBlock;
</pre>
<h2 id="how-use-prism-react-renderer">如何使用棱镜反应渲染器</h2>
<p>您也可以使用prism-react-renderer来突出显示react应用程序中的代码，而不是像我们在上一节中那样将Prism与React应用程序一起使用。</p>
<p>prism-react-renderer与prism的修改版本捆绑在一起，默认情况下，它提供了对一些常见语言和主题的支持。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>需要安装NPM的<a href="https://www.npmjs.com/package/prism-react-renderer">p</a><a href="https://www.npmjs.com/package/prism-react-renderer">rism</a><a href="https://www.npmjs.com/package/prism-react-renderer">–</a><a href="https://www.npmjs.com/package/prism-react-renderer">react</a><a href="https://www.npmjs.com/package/prism-react-renderer">–</a><a href="https://www.npmjs.com/package/prism-react-renderer">渲染器</a>才能使用。</p>
<pre class="language-shell hljs">sh
# install with npm
npm i prism-react-renderer

# install with yarn
yarn add prism-react-renderer
</pre>
<p>Prism react渲染器将<code>Highlight</code>公开为其主要组件，并导出一些默认道具，您可以将这些道具传递给<code>Highlight</code>。您需要将一个<code>render</code>道具传递给<code>Highlight</code>组件，如下例所示。</p>
<pre class="language-javascript hljs">import React from "react";
import Highlight, { defaultProps } from "prism-react-renderer";

export const CodeBlock = ({ code, language }) =&amp;gt; {
  return (
    &amp;lt;Highlight {...defaultProps} code={code} language={language}&amp;gt;
      {({ className, style, tokens, getLineProps, getTokenProps }) =&amp;gt; {
        return (
          &amp;lt;pre className={className} style={style}&amp;gt;
            &lt;code&gt;
                  {tokens.map((line, idx) =&gt; {
                    return (
                      &lt;div {...getLineProps({ line, key: `line-${idx}` })}&gt;
                        {line.map((token, i) =&gt; {
                          return (
                            &lt;span
                              {...getTokenProps({ token, key: `token-${i}` })}
                            /&gt;
                          );
                        })}
                      &lt;/div&gt;
                    );
                  })}
                &lt;/code&gt;
          &amp;lt;/pre&amp;gt;
        );
      }}
    &amp;lt;/Highlight&amp;gt;
  );
};
&lt;/code&gt;&lt;/pre&gt;</pre>
<p>上面的代码块演示了如何用prism-react-renderer包突出显示一个简单的代码块。<code>Highlight</code>组件将几个参数传递给渲染属性。您可以使用这些道具来呈现您的代码块，如上例所示。</p>
<p>你可以导入我们上面写的<code>CodeBlock</code>组件，在渲染代码块的时候传入<code>code</code>和<code>language</code>道具。这样做可以使组件可重用。</p>
<pre class="language-javascript hljs">import { CodeBlock } from "./CodeBlock";

const code = `
  const add = (a, b) =&gt; {
    return a + b;
  }
`;

function MyComponent() {
  return (
    &lt;div className="App"&gt;
      &lt;CodeBlock code={code} language="javascript" /&gt;
    &lt;/div&gt;
  );
}
</pre>
<h2 id="introduction-react-syntax-highlighter">react-syntax-highlight简介</h2>
<p>react-syntax-highlighter是react中用于语法高亮显示的React组件。它使用Prism和Highlight在内部突出显示语法。Prism和Highlight是浏览器环境中流行的语法高亮工具。</p>
<p>你从NPM安装它，并传递必要的道具来开始使用react-syntax-highlighter。</p>
<pre class="language-shell hljs"># using npm
npm i react-syntax-highlighter

# using yarn
yarn add react-syntax-highlighter
</pre>
<p>与前几节中描述的一些包不同，您不需要额外的配置就可以让它工作。让我们在下一节看看如何在React中使用它来突出显示语法。</p>
<h2 id="how-use-react-syntax-highlighter">如何使用react-syntax-highlight</h2>
<p>安装react-syntax-highlighter后，可以导入并呈现必要的组件。如前一节所述，您可以选择使用高亮或棱镜来高亮显示。</p>
<p>但是，react-syntax-highlight导出一个默认情况下使用高亮显示的组件。在呈现时，您需要将配置选项作为道具传递，如下所示:</p>
<pre class="language-javascript hljs">import SyntaxHighlighter from "react-syntax-highlighter";
import { dracula } from "react-syntax-highlighter/dist/esm/styles/hljs";

const code = `
console.log("hello world");
`;

function App() {
  return (
      &lt;SyntaxHighlighter children={code} language="javascript" style={dracula} /&gt;
  );
}
</pre>
<p>如上例所示，您将想要突出显示的代码和格式化语言作为字符串属性进行传递。除了<code>children</code>、<code>language</code>和<code>style</code>道具，还有几个其他的格式选项，比如显示和样式化行号。请务必查阅文档以获得可用选项的完整列表。</p>
<p>正如在简介中指出的，react-syntax-highlighter与Highlight和Prism捆绑在一起。除了使用上面例子中的高光，你还可以使用棱镜。使用Prism时，还需要导入想要使用的Prism主题，如下例所示。</p>
<pre class="language-javascript hljs">import { Prism as SyntaxHighlighter } from 'react-syntax-highlighter';
import { dark } from 'react-syntax-highlighter/dist/esm/styles/prism';
</pre>
<p>尽管上面描述的使用方法加载了一些现成的特性，但是它占用了大量内存。因此，react-syntax-highlighter有一个轻量级的构建，只加载和捆绑您需要的功能。</p>
<p>但是，请注意，灯光构建没有默认样式。所以，你需要自己导入主题。此外，使用<code>registerLanguage</code>函数导入并注册语言，如下例所示。</p>
<pre class="language-javascript hljs">import { Light as SyntaxHighlighter } from "react-syntax-highlighter";

import typescript from "react-syntax-highlighter/dist/esm/languages/hljs/typescript";
import a11yDark from "react-syntax-highlighter/dist/esm/styles/hljs/a11y-dark";

SyntaxHighlighter.registerLanguage('typescript', typescript);
</pre>
<p>默认情况下，上面的灯光构建示例使用高光。你可以类似地使用Prism。导入<code>PrismLight</code>而不是<code>Light</code>，如下例所示。</p>
<pre class="language-javascript hljs">import { PrismLight as SyntaxHighlighter } from "react-syntax-highlighter";

import typescript from "react-syntax-highlighter/dist/esm/languages/prism/typescript";
import a11yDark from "react-syntax-highlighter/dist/esm/styles/prism/a11y-dark";

SyntaxHighlighter.registerLanguage('typescript', typescript);
</pre>
<p>有关react-syntax-highlighter包的更多特性和限制，请查看文档。</p>
<h2 id="introduction-rainbow">彩虹简介</h2>
<p>上面提到的语法高亮库是最流行的，也是最容易与React一起使用的。</p>
<p>然而，它们并不是唯一的语法高亮库。Rainbow是另一个简单的轻量级语法高亮包。这是值得探索的，尤其是当你没有使用React这样的框架时。</p>
<h2 id="conclusion">结论</h2>
<p>当发布包含内联代码片段或代码块的内容以增加可读性时，语法高亮是不可避免的。在浏览器环境中突出显示代码时，有几个库可供选择——最流行的语法突出显示库是Prism和Highlight。</p>
<p>如上所述，您可以在普通JavaScript中使用一些语法高亮库，在React等框架中使用其他语法高亮库。Babel插件可以让你将Prism与webpack这样的捆绑器一起使用。但是，您也可以使用React包，如prism-react-renderer或react-syntax-highlighter，它们捆绑了prism的修改版本。</p>
<p>当考虑核心库时，Prism占用的空间很小。然而，当你用额外的主题和插件扩展它的核心功能时，它就变得相当大了。</p>
<p>虽然我们在本文中关注的是可与React一起使用的语法高亮器，但是其他几个语法高亮库，比如Rainbow，也值得一试。如果您没有使用React这样的前端框架，Rainbow是一个很好的语法高亮库。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>