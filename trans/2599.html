<html>
<head>
<title>Develop, test, and deploy Cloudflare Workers with Denoflare - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用 Denoflare - LogRocket 博客开发、测试和部署 Cloudflare 工作人员</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/#0001-01-01">https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/#0001-01-01</a></blockquote><div><article class="article-post">
<p>在我职业生涯的大部分时间都在使用 Node.js 之后，我很感兴趣地听到了它的对等物 Deno。<a href="https://deno.land/" target="_blank" rel="noopener"> Deno </a>是服务器端 JavaScript 的一个不同版本。Deno 的设计<a href="https://www.youtube.com/watch?v=M3BM9TB-8yA" target="_blank" rel="noopener">是为了纠正 Node.js </a>的错误，并创建一个默认安全的运行时。</p>
<h2>什么是德诺？</h2>
<p>Deno 结合了一些其他方面，比如内置的 TypeScript 编译器、linter、格式化程序和包管理器。它还支持<a href="https://blog.logrocket.com/how-to-use-ecmascript-modules-with-node-js/" target="_blank" rel="noopener"> ESM 模块</a>，使用网络平台作为其标准库的基础，并围绕 IO 进行默认安全设计。</p>
<p>与 Node.js 相比，这极大地简化了开发体验。我开始使用 Deno 作为我需要编写的 CLI 工具(使用<a href="https://github.com/c4spar/deno-cliffy" target="_blank" rel="noopener"> deno-cliffy </a>),并对这种体验感到满意。当我第一次听说<a href="https://denoflare.dev/" target="_blank" rel="noopener"> Denoflare </a>的时候，我认为这将是一个理想的机会来试验<a href="https://workers.cloudflare.com/" target="_blank" rel="noopener"> Cloudflare 工人</a>，同时获得更多关于 Deno 的经验。</p>
<h2>对 Cloudflare Workers 使用 Deno</h2>
<p>与 AWS Lambda 等服务相比，Cloudflare Workers 是无服务器基础架构的替代方案。在其核心，它像一个无服务器的功能，接受请求信息，应用逻辑，并发送响应。</p>
<p>预期的用例是不同的，因为它意味着充当中间件，拦截发送到原始服务器的请求，并应用逻辑。Cloudflare 的行为类似于<a href="https://developers.google.com/web/fundamentals/primers/service-workers/" target="_blank" rel="noopener">浏览器服务工作者</a>。</p>
<p><img data-attachment-id="88203" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/client-cloudflare-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png" data-orig-size="381,86" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Client, Cloudflare, server" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server-300x68.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png" decoding="async" class="aligncenter size-full wp-image-88203 jetpack-lazy-image" src="../Images/a657df844aa4316f40b7d56a820ea6cd.png" alt="Client, Cloudflare, Server" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png 381w, https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server-300x68.png 300w" data-lazy-sizes="(max-width: 381px) 100vw, 381px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="88203" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/client-cloudflare-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png" data-orig-size="381,86" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Client, Cloudflare, server" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server-300x68.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-88203" src="../Images/a657df844aa4316f40b7d56a820ea6cd.png" alt="Client, Cloudflare, Server" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png 381w, https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server-300x68.png 300w" sizes="(max-width: 381px) 100vw, 381px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/client-cloudflare-server.png"/></noscript>
<p>Cloudflare Workers 没有充满正在旋转的隔离容器，提供了零冷启动的好处。Cloudflare Workers 的其他一些不错的功能是全球 CDN 部署和按请求付费。</p>
<h2>什么是 Denoflare？</h2>
<p>Denoflare 是一个小框架，允许您发布用 Deno 编写的 Cloudflare Workers。这是一个天然的组合，因为 Deno 和 Cloudflare 工作人员都遵循标准化的 web 平台运行时 API。</p>
<p>Denoflare 允许您在本地为您的工作人员提供服务，以在隔离的环境中测试您的更改，这与 Cloudflare 运行它们的方式类似。它支持出色的热重装开发人员体验，能够将工作人员权限发布到 Cloudflare 平台，跟踪生产中的日志，等等。</p>
<p>这与使用另一个 worker 框架(如<a href="https://github.com/cloudflare/miniflare" target="_blank" rel="noopener"> Miniflare </a>)有相似的体验，除了它更简单，因为 Deno 正在做大部分工作。例如，不像 Miniflare 那样依赖 Jest，您可以编写测试来运行本机 Deno 测试运行程序。</p>
<h2>使用 Cloudflare 和 Denoflare</h2>
<p>体验 Cloudflare 和 Denoflare 的最佳方式是通过一个真实的示例用例。使用最少的代码，我们将为一个博客设置<a href="https://en.wikipedia.org/wiki/A/B_testing" target="_blank" rel="noopener"> A/B 测试</a>。一半的时间，用户将被放入测试组，并将看到一个新的标题。其他人将被放入控制组，看不到新标题。</p>
<p>使用 Cloudflare Workers，这就像拦截对博客源服务器的请求一样简单，根据我们的划分将用户放入一个组，并用组名设置响应头<code>Set-Cookie</code>。完成后，我们的博客可以读取 cookie 来决定显示哪个标题。</p>
<blockquote><p>我们省略了更改博客标题所需的代码，因为有几种不同的方法可以做到这一点。</p></blockquote>
<h2>设置您的 Cloudflare Workers 帐户</h2>
<p>我们必须做的第一件事<a href="https://dash.cloudflare.com/sign-up/workers" target="_blank" rel="noopener">是注册一个 Cloudflare 帐户，由 Cloudflare 工作人员设置</a>。</p>
<p>完成后，创建一个免费的。开发子域测试我们的工人。我们会选择免费计划。</p>
<p><img data-attachment-id="88207" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/set-up-cloudflare-workers-subdomain/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg" data-orig-size="730,607" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Set up Cloudflare Workers subdomain" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain-300x249.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg" decoding="async" class="aligncenter size-full wp-image-88207 jetpack-lazy-image" src="../Images/902ed848bc61ec291774b25cada0125b.png" alt="Set Up Cloudflare Workers Subdomain" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain-300x249.jpeg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="88207" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/set-up-cloudflare-workers-subdomain/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg" data-orig-size="730,607" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Set up Cloudflare Workers subdomain" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain-300x249.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-88207" src="../Images/902ed848bc61ec291774b25cada0125b.png" alt="Set Up Cloudflare Workers Subdomain" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain-300x249.jpeg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/set-up-cloudflare-workers-subdomain.jpeg"/></noscript>
<p>创造一个自由的。开发测试子域。</p>
<blockquote><p>注意:您可以稍后将其更改为您将在生产中使用的域。</p></blockquote>
<p>Denoflare 需要一个 API 令牌来允许我们将编译后的 worker 推送到 Cloudflare。转到 Cloudflare 控制面板中的<a href="https://dash.cloudflare.com/profile/api-tokens" target="_blank" rel="noopener">令牌页面</a>，并选择<strong>创建令牌</strong>。一旦出现，你应该选择<strong>编辑 Cloudflare 工人</strong>作为模板。请注意这个标记，以便以后使用。</p>
<p>从概览屏幕中，复制帐户 ID 以备后用。</p>
<h2>使用 Denoflare 开发</h2>
<p>Deno 提供了很棒的开发体验，在使用 Denoflare 的时候我们会原封不动的保留下来。</p>
<blockquote><p><a href="https://github.com/aleccool213/denoflare-blog-posthttps://github.com/aleccool213/denoflare-blog-post" target="_blank" rel="noopener">注:你可以在这个 GitHub repo </a>里找到所有代码。</p></blockquote>
<p>首先，设置 Deno 版本，并使用<a href="https://asdf-vm.com/" target="_blank" rel="noopener"> asdf </a>将其安装在您的本地机器上:</p>
<pre>echo "deno 1.16.0" &gt; .tool-versions &amp;&amp; brew install asdf &amp;&amp; asdf plugin add deno &amp;&amp; deno install
</pre>
<p>让我们配置我们的 IDE。如果你使用的是 Visual Studio 代码，你会对 Deno 有很好的体验。安装 Deno 扩展，<a href="https://marketplace.visualstudio.com/items?itemName=denoland.vscode-deno" target="_blank" rel="noopener">，可以在这里找到</a>。它支持类型检查、林挺等等。</p>
<p>要启用它，您必须在<code>.vscode/settings.json</code>的工作区设置文件中打开它:</p>
<pre class="language-typescript hljs">{
  "deno.enable": true
}
</pre>
<p>接下来，我们将安装<a href="https://github.com/jurassiscripts/velociraptor" target="_blank" rel="noopener"> Velociraptor </a>，Deno 的脚本管理器。Velociraptor 使所有开发人员在执行常见任务时使用相同的脚本变得很容易(想想 npm 脚本)。</p>
<p>在控制台中运行以下命令:</p>
<pre class="language-bash hljs">deno install -qAn vr https://deno.land/x/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0274676e6d616b706372766d7042332c312c32">[email protected]</a>/cli.ts
</pre>
<p>我们将定义一个 Velociraptor 脚本来调用 Denoflare CLI，允许我们运行 Denoflare 命令，如<code>serve</code>和<code>push</code>。</p>
<pre class="language-typescript hljs">{
  "scripts": {
    "denoflare": "deno run --unstable --allow-read --allow-net --allow-env https://raw.githubusercontent.com/skymethod/denoflare/v0.3.3/cli/cli.ts"
  }
}
</pre>
<p>现在我们已经有了 IDE 和环境运行时设置，我们可以继续看代码了。使用 Deno，通常在一个名为<code>deps.ts</code>的文件中声明所有的依赖项。这是因为模块是由 URL 定义的，如果分散在一个项目中的任何地方，就会变得难以管理。</p>
<p>我们需要一种类型的 Cloudflare 工作程序，Denoflare 将其定义为:</p>
<pre class="language-typescript hljs">export type { IncomingRequestCf } from "https://raw.githubusercontent.com/skymethod/denoflare/v0.3.0/common/cloudflare_workers_types.d.ts";
</pre>
<p>一旦我们有了这个类型，我们就可以在<code>index.ts</code>中编写我们的 A/B 测试器逻辑:</p>
<pre class="language-typescript hljs">import { IncomingRequestCf } from "./deps.ts";

/**
 * Based on the A/B Testing Cloudflare Worker example.
 * Ref: https://developers.cloudflare.com/workers/examples/ab-testing
 */
function fetch(request: IncomingRequestCf): Response {
  const NAME = "experiment-0";

  const TEST_RESPONSE = new Response("Test group");
  const CONTROL_RESPONSE = new Response("Control group");

  // Determine which group this requester is in.
  const cookie = request.headers.get("cookie");
  if (cookie &amp;&amp; cookie.includes(`${NAME}=control`)) {
    return CONTROL_RESPONSE;
  } else if (cookie &amp;&amp; cookie.includes(`${NAME}=test`)) {
    return TEST_RESPONSE;
  } else {
    // If there is no cookie, this is a new client. Choose a group and set the cookie.
    const group = Math.random() &lt; 0.5 ? "test" : "control"; // 50/50 split
    const response = group === "control" ? CONTROL_RESPONSE : TEST_RESPONSE;
    response.headers.append("Set-Cookie", `${NAME}=${group}; path=/`);

    return response;
  }
}

export default {
  fetch,
};
</pre>
<p>最后一步是声明一个<code>.denoflare</code>文件，Denoflare 使用它来运行和发布您的 Cloudflare Worker:</p>
<pre class="language-typescript hljs">{
  "$schema": "https://raw.githubusercontent.com/skymethod/denoflare/v0.3.3/common/config.schema.json",
  "scripts": {
    "a-b-test-local": {
      "path": "index.ts",
      "localPort": 3030
    }
  },
  "profiles": {
    "account1": {
      "accountId": "INSERT_ACCOUNT_ID_FROM_PREVIOUS_STEP",
      "apiToken": "INSERT_API_TOKEN_FROM_PREVIOUS_STEP"
    }
  }
}
</pre>
<p>就是这样！让我们在本地为 Cloudflare 工作人员提供服务，以确保一切正常运行:</p>
<pre>vr denoflare serve a-b-test-local
</pre>
<p>输出应该是这样的:</p>
<pre>Compiling https://raw.githubusercontent.com/skymethod/denoflare/v0.3.3/cli-webworker/worker.ts into worker contents...
Compiled https://raw.githubusercontent.com/skymethod/denoflare/v0.3.3/cli-webworker/worker.ts into worker contents in 277ms
runScript: index.ts
Compiled index.ts into module contents in 142ms
worker: start
Started in 456ms (isolation=isolate)
Local server running on http://localhost:3030
</pre>
<p>现在，打开浏览器，进入<code>localhost:3030</code>。您将看到该响应是用户所在的组:</p>
<p><img data-attachment-id="88209" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/test-group/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg" data-orig-size="730,169" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Test group" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group-300x69.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg" decoding="async" class="aligncenter size-full wp-image-88209 jetpack-lazy-image" src="../Images/532555c72900ba3258eca2ede117b0b7.png" alt="Test Group" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/test-group-300x69.jpeg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="88209" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/test-group/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg" data-orig-size="730,169" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Test group" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group-300x69.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-88209" src="../Images/532555c72900ba3258eca2ede117b0b7.png" alt="Test Group" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/test-group-300x69.jpeg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/test-group.jpeg"/></noscript>
<h2>测试应用程序</h2>
<p>因为 Cloudflare Workers 是一个 Deno 应用程序，所以我们可以使用它的工具来验证和测试我们的代码。由于您安装了扩展，所有这些都会在您使用 Visual Studio 代码进行开发时自动运行。</p>
<p>用以下代码运行 Deno linter:</p>
<pre>deno lint
</pre>
<p>确保 Deno 应用程序通过以下方式编译:</p>
<pre>deno compile index.ts
</pre>
<p>编写一些测试，并使用以下代码运行它们:</p>
<pre>deno test index.test.ts
</pre>
<h2>部署 Cloudflare 工作人员</h2>
<p>一旦您在 Denoflare 配置(<code>.denoflare</code>)中有了正确的帐户 ID 和令牌，部署 Cloudflare Workers 应该没有问题。</p>
<p>默认情况下，Denoflare 会将您的工作线程推送到。开发子域你已经为你的帐户设置。</p>
<p>通过运行以下命令将其部署到 Cloudflare 实例:</p>
<pre>vr denoflare push a-b-test-local
</pre>
<p>您应该会看到该员工立即出现在您的员工仪表板上。</p>
<p><img data-attachment-id="88211" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/worker-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg" data-orig-size="730,346" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Worker dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard-300x142.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg" decoding="async" class="aligncenter size-full wp-image-88211 jetpack-lazy-image" src="../Images/7410e6e623be3b1c152faee3771c52b8.png" alt="Worker Dashboard" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard-300x142.jpeg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="88211" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/worker-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg" data-orig-size="730,346" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Worker dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard-300x142.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-88211" src="../Images/7410e6e623be3b1c152faee3771c52b8.png" alt="Worker Dashboard" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard-300x142.jpeg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/worker-dashboard.jpeg"/></noscript>
<p>默认情况下，其公共访问是禁用的。进入<strong>服务详情</strong>页面并启用路线。</p>
<p><img data-attachment-id="88213" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/enabling-route/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg" data-orig-size="730,240" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Enabling route" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route-300x99.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg" decoding="async" class="aligncenter size-full wp-image-88213 jetpack-lazy-image" src="../Images/fd117f499ece87768bba244d1d944ae6.png" alt="Enabling Route" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route-300x99.jpeg 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="88213" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/enabling-route/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg" data-orig-size="730,240" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Enabling route" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route-300x99.jpeg" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg" decoding="async" loading="lazy" class="aligncenter size-full wp-image-88213" src="../Images/fd117f499ece87768bba244d1d944ae6.png" alt="Enabling Route" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route-300x99.jpeg 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/enabling-route.jpeg"/></noscript>
<p>当您执行这条路线时，您应该会看到一个响应，显示这个请求被放入了哪个组。</p>
<p><img data-attachment-id="88215" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/control-group/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png" data-orig-size="730,89" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Control group" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group-300x37.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png" decoding="async" class="aligncenter size-full wp-image-88215 jetpack-lazy-image" src="../Images/149a48d7df1d4f857f19026a897328cd.png" alt="Control Group" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/control-group-300x37.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="88215" data-permalink="https://blog.logrocket.com/develop-test-deploy-cloudflare-workers-denoflare/control-group/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png" data-orig-size="730,89" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Control group" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group-300x37.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-88215" src="../Images/149a48d7df1d4f857f19026a897328cd.png" alt="Control Group" srcset="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/01/control-group-300x37.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/01/control-group.png"/></noscript>
<h2>结论</h2>
<p>Denoflare 是一个围绕 Deno 构建的简单迷你框架，允许我们轻松发布 Cloudflare Workers。</p>
<p>由于它实现 web 标准 API 的方式以及在安全模型中与 Cloudflare Workers 的相似性，Deno 是一个自然的选择。Cloudflare Workers 是一种强大的方式，可以将中间件逻辑部署到云上，靠近用户使用您的应用程序的地方，因为他们的 edge CDN 策略在全球范围内部署工作人员。</p>
<p><a href="https://developers.cloudflare.com/workers/examples" target="_blank" rel="noopener">看看 Cloudflare 团队收集的其他示例</a>,这样你就能更好地了解它的其他用途。</p>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>