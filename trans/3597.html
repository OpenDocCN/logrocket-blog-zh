<html>
<head>
<title>Build a site search with Lyra and TypeScript </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用Lyra和TypeScript构建一个站点搜索</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/build-site-search-lyra-typescript/#0001-01-01">https://blog.logrocket.com/build-site-search-lyra-typescript/#0001-01-01</a></blockquote><div><article class="article-post">
<p>现场搜索功能允许用户快速查询数据，结果提供相关信息。如果你的搜索功能是无效的，用户可能会在没有满足他们的需求的情况下退出你的应用程序，造成糟糕的用户体验，导致糟糕的转化率。</p>
<p>在本教程中，我们将使用Lyra和TypeScript构建一个搜索功能，并学习如何将通知从您的应用程序推送到不同的平台。</p>
<h2 id="tableofcontents">目录</h2>

<h2 id="what-typescript-why-should-you-use-it">什么是TypeScript，为什么要使用它？</h2>
<p>TypeScript是JavaScript的超集，可以用来构建和管理小型到大型的JavaScript应用程序。强类型和精确，TypeScript为团队协作提供了简单的代码管理。</p>
<p>JavaScript是一种解释型编程语言，因此不涉及代码编译。错误是在应用程序运行时捕获的。因为TypeScript编译成JavaScript，所以错误是在编译时而不是运行时报告的。错误非常详细，使它们更容易调试和修复。</p>
<p>TypeScript还包括可选的静态类型及其类型推理系统。如果用户创建了一个没有指定类型的变量，TypeScript会根据它的值为它分配一个类型。</p>
<h2 id="what-is-site-search-feature">什么是站点搜索功能？</h2>
<p>在web应用程序中，站点搜索功能允许站点访问者根据他们在提供的输入字段中输入的搜索词来过滤他们获得的内容。因此，网站访问者可以很容易地找到符合他们需求的相关信息，降低了web应用程序的跳出率。</p>
<h3 id="why-use-lyra">为什么要用天琴座？</h3>
<p><a href="https://lyrajs.io/"> Lyra </a>是用TypeScript开发的易于集成的成熟搜索功能。Lyra帮助开发人员执行闪电般的数据查询，它还可以为用户搜索查询提供建议、自动完成和容错。</p>
<h2 id="what-is-apprise">通知了什么？</h2>
<p><a href="https://github.com/caronc/apprise">appraise</a>是一个轻量级的通知服务，允许开发者同时向不同的平台发送通知，包括社交媒体平台、邮件和SMTP服务。</p>
<h2 id="how-does-typescript-operate">TypeScript是如何工作的？</h2>
<p>要使用TypeScript，我们需要安装一个TypeScript编译器。我们可以使用以下命令执行TypeScript的全局安装:</p>
<pre class="language-bash hljs">npm install -g typescript
</pre>
<p>一旦安装完成，在工作目录中，运行<code>npm init--y</code>用默认设置初始化npm。</p>
<p>接下来，我们可以创建一个TypeScript配置文件，让我们配置我们的TypeScript文件的行为，包括我们的TypeScript文件将被转换到哪个版本的JavaScript，转换后的文件的目标文件夹，允许JavaScript文件的选项，以及将存储所有TypeScript文件的根目录<code>Jsx</code>。默认情况下，有许多可用选项被注释掉，如果需要，可以启用这些选项。</p>
<p>要在目录中创建一个配置文件，在CLI中键入<code>tsc--init</code>并点击<strong>回车</strong>按钮。TypeScript允许用户定义TypeScript文件和转换后的JavaScript文件将存储在什么目录中。这些文件夹习惯上分别被称为<code>src</code>和<code>dist</code>文件夹。为此，修改配置文件<code>tsconfig.json</code>，如下所示:</p>
<pre class="language-javascript hljs">//...
    "rootDir": "./src",                                  
/* Specify the root folder within your source files. */
//...
    "module": "ES6",                                /* Specify what module code is generated. */
//...
    "outDir": "./dist",                                   
/* Specify an output folder for all emitted files. */
</pre>
<p>要将TypeScript文件编译成JavaScript，我们可以使用<code>Tsc</code>编译器和要编译的文件名。</p>
<p>或者，为了避免手动编译我们的TypeScript文件，我们可以设置编译器来监视文件中的变化，并在检测到变化时重新编译。为此，我们将修改我们的<code>package.json</code>文件中的<code>start</code>脚本来运行<code>watch</code>命令:</p>
<pre class="language-javascript hljs">//...
 "scripts": {
    "start": "tsc --watch"
  },
</pre>
<p>指定了<code>src</code>目录后，TypeScript将自动监视该文件夹中TypeScript文件的变化，并自动将它们转换为<code>dist</code>目录中的JavaScript文件。</p>
<h2 id="installing-development-dependencies">安装开发依赖项</h2>
<p>对于我们的站点搜索功能，我们将使用TypeScript和Lyra。要设置TypeScript，请在本地计算机上打开您选择的目录，并启动命令行界面的一个实例。在终端环境中，运行以下命令安装TypeScript编译器:</p>
<pre class="language-bash hljs">npm insta f
</pre>
<p>您可以使用<code>typescript -v</code>命令检查您安装的TypeScript编译器的版本。</p>
<p>为了方便地使用TypeScript的节点模块，我们需要一个bundler为此，我们将使用Next.js。要在本地计算机上使用TypeScript设置Next.js，请在您选择的目录中运行以下命令:</p>
<pre class="language-bash hljs">npx <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="721100171306175f1c170a065f130202321e1306170106">[email protected]</a> --ts
</pre>
<p>要安装Lyra搜索依赖项，请运行以下命令:</p>
<pre class="language-bash hljs">cd &lt;name of your application created with the above command&gt;
npm i @lyrasearch/lyra
</pre>
<p>我们在应用程序中需要的最后一个依赖项是Apprise，我们将使用它来发送Lyra搜索字段所查询数据的通知。我们将在本教程的后面安装。</p>
<h2 id="building-frontend-application">构建我们的应用程序前端</h2>
<p>对于我们的应用程序，我们将首先创建使用Lyra的输入字段，之后我们将使用它添加和查询数据。修改<code>pages</code>目录中的<code>index.txs</code>文件，如下所示:</p>
<pre class="language-javascript hljs">import type { NextPage } from 'next'
import Head from 'next/head'
import { useState } from 'react'

const Home: NextPage = () =&gt; {
  const [query, setQuery] = useState('')
  return (
    &lt;div&gt;
      &lt;Head&gt;
        &lt;title&gt;Create Next App&lt;/title&gt;
        &lt;meta name="description" content="Generated by create next app" /&gt;
        &lt;link rel="icon" href="/favicon.ico" /&gt;
      &lt;/Head&gt;
      &lt;div className="maincontainer"&gt;
        &lt;input type="text" id="input" placeholder="Enter your search term" value={query} onChange={(e)=&gt;{setQuery(e.target.value)}} /&gt;
        &lt;div id="results"&gt;{/* display search results  */}&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  )
}
export default Home
</pre>
<p>在上面的代码中，我们已经创建了基本的输入字段和显示区域。要设计我们的应用程序，请将以下代码添加到<code>global.css</code>:</p>
<pre class="language-css hljs">html,
body {
  padding: 0;
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen,
    Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;
}
a {
  color: inherit;
  text-decoration: none;
}
* {
  box-sizing: border-box;
}
@media (prefers-color-scheme: dark) {
  html {
    color-scheme: dark;
  }
  body {
    color: white;
    background: black;
  }
}
.maincontainer{
  min-height: 100vh;
  background: #1c1e21;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}
#results{
  display: grid;
  margin-top: 55px;
  grid-template-columns: 1fr 2fr 1fr;
  gap: 20px;
  padding: 14px;
  width: 85%;
  height: 60vh;
  overflow-y: scroll;
  background: #3b3b3b;
}
#input{
  height: 25px;
  margin-top: 25px;
  width: 450px;
  outline: none;
  border: 2px solid rgb(72, 72, 255);
  padding-left: 2px;
  border-radius: 5px;
  background: #3b3b3b;
}
</pre>
<p>如果我们用<code>npm run dev</code>命令运行我们的应用程序，我们将得到类似下图的结果:</p>
<p><img data-attachment-id="141950" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/basic-frontend-application-typescript/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png" data-orig-size="730,322" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="basic-frontend-application-typescript" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript-300x132.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png" decoding="async" class="aligncenter wp-image-141950 size-full jetpack-lazy-image" src="../Images/6d72ba16295acc137e0832a2133f29e6.png" alt="Basic Frontend Application Typescript" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript-300x132.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="141950" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/basic-frontend-application-typescript/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png" data-orig-size="730,322" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="basic-frontend-application-typescript" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript-300x132.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png" decoding="async" loading="lazy" class="aligncenter wp-image-141950 size-full" src="../Images/6d72ba16295acc137e0832a2133f29e6.png" alt="Basic Frontend Application Typescript" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript-300x132.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/basic-frontend-application-typescript.png"/></noscript>
<h2 id="adding-lyra-search-feature">添加Lyra搜索功能</h2>
<p>接下来，我们将使用<code>pages</code>目录中的<code>index.tsx</code>文件将Lyra依赖项添加到我们的输入字段中:</p>
<pre class="language-javascript hljs">import { create, search, insert } from "@lyrasearch/lyra";
</pre>
<p>在上面的代码块中，我们从Lyra导入了<code>create</code>、<code>search</code>和<code>insert</code>方法。这三种方法将执行以下功能。</p>
<h3 id="create"><code>create</code></h3>
<p>我们将使用<code>create</code>方法来定义我们将要存储的数据的模式。我们还将为每个属性定义数据类型。下面的代码举例说明了这一点:</p>
<pre class="language-javascript hljs">const newMovies = create({
      schema: {
        name: "string",
        downloadURL: "string",
        rating: "number",
      },
    });
</pre>
<p>我们创建了一个名为<code>newMovies</code>的Lyra实例。它的模式将包含三组值，<code>name</code>、<code>downloadURL</code>和<code>rating</code>。因此，任何添加到<code>newMovies</code>实例的数据都必须包含这些字段。</p>
<h3 id="search"><code>search</code></h3>
<p><code>search</code>方法用于查询存储在创建的实例中的数据，我们将使用它来实现我们的搜索功能。</p>
<h3 id="insert"><code>insert</code></h3>
<p>我们使用<code>insert</code>方法向创建的实例添加新数据:</p>
<pre class="language-javascript hljs"> insert(newMovies, {
      name: "The Shawshank Redemption",
      downloadURL: "https://www.imdb.com/title/tt0111161/",
      rating: 9.3,
    });
</pre>
<p>在上面的代码中，我们将新数据插入到了<code>newMovies</code>实例中。为了创建我们的<code>Lyra</code>实例，向<code>index.tsx</code>添加以下内容:</p>
<pre class="language-javascript hljs">import { useState, useEffect } from "react";
import {
  create,
  search,
  insert,
} from "@lyrasearch/lyra";
const Home: NextPage = () =&gt; {
  const [query, setQuery] = useState("");
  const [results, setResults] = useState([]);
  const newMovies = create({
    schema: {
      name: "string",
      downloadURL: "string",
      rating: "number",
    },
  });
  insert(newMovies, {
    name: "The Shawshank Redemption",
    downloadURL: "https://www.imdb.com/title/tt0111161/",
    rating: 9.3,
  });
  insert(newMovies, {
    name: "The Godfather",
    downloadURL: "https://www.imdb.com/title/tt0068646/",
    rating: 9.2,
  });
  insert(newMovies, {
    name: "The Godfather: Part II",
    downloadURL: "https://www.imdb.com/title/tt0071562/",
    rating: 9.0,
  });
  insert(newMovies, {
    name: "The Dark Knight",
    downloadURL: "https://www.imdb.com/title/tt0468569/",
    rating: 9.0,
  });
  insert(newMovies, {
    name: "Superman",
    downloadURL: "https://www.imdb.com/title/tt0078346/",
    rating: 7.3,
  });
  insert(newMovies, {
    name: "Batman Begins",
    downloadURL: "https://www.imdb.com/title/tt0372784/",
    rating: 8.3,
  });
  insert(newMovies, {
    name: "The Dark Knight Rises",
    downloadURL: "https://www.imdb.com/title/tt1345836/",
    rating: 8.5,
  });
  useEffect(() =&gt; {
    const searchresults = search(newMovies, {
    //search here
  }, [query]);
</pre>
<p>我们创建了一个名为<code>newMovies</code>的Lyra实例，并使用<code>insert</code>方法向其中添加电影。我们使用了<code>useEffect</code>钩子和<code>search</code>方法来查询<code>newMovies</code>实例，并返回与搜索字段中的输入相匹配的结果。</p>
<h2 id="returningoursearchresults">返回我们的搜索结果</h2>
<p>为了在我们的应用程序中返回搜索结果，我们将用来自我们的<code>search</code>方法的结果更新<code>results</code>状态。我们将在应用程序中呈现该数组，如下所示:</p>
<pre class="language-javascript hljs">//useEffect
 const searchresults = search(newMovies, {
      term: query,
      properties: '*',
    });
    setResults(searchresults.hits);
</pre>
<p>然后，在我们的<code>return</code>块中，添加以下代码:</p>
<pre class="language-javascript hljs">&lt;div id="results"&gt;
    {/* display search results  */}
    {/* {console.log(results)} */}
    {results.length &gt; 0 ? (
     results &amp;&amp; results.map((movie, index) =&gt; 
     &lt;div key={index} style={{background: "#1c1e21", height: '200px', paddingLeft: "13px"}}&gt;
      &lt;h3&gt;{movie.name}&lt;/h3&gt;
      &lt;a href={movie.downloadURL} style={{color: "blueviolet"}} target="_blank" rel="noreferrer" &amp;gt;Download URL&lt;/a&gt;
      &lt;p&gt;Movie Rating: {movie.rating}&lt;/p&gt;
     &lt;/div&gt;
     )
    ) : (
      &lt;div style={{textAlign: "center", fontSize: "25px"}}&gt;No results found&lt;/div&gt;
    )}
  &lt;/div&gt;
</pre>
<p>当我们的<code>results</code>状态返回一个数组长度大于零的值时，我们呈现来自Lyra搜索结果的内容。否则，我们返回一个简单的文本读数<code>No results found</code>。现在，如果我们用<code>npm run dev</code>命令运行我们的应用程序，我们将得到以下结果:</p>
<p><img data-attachment-id="141952" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/frontend-application-typescript/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript.gif" data-orig-size="730,298" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="frontend-application-typescript" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript-300x122.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript.gif" decoding="async" class="aligncenter wp-image-141952 size-full jetpack-lazy-image" src="../Images/a0bae19395d75a43d38f0f5bb1fb5aee.png" alt="Frontend Application Typescript" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="141952" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/frontend-application-typescript/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript.gif" data-orig-size="730,298" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="frontend-application-typescript" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript-300x122.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript.gif" decoding="async" loading="lazy" class="aligncenter wp-image-141952 size-full" src="../Images/a0bae19395d75a43d38f0f5bb1fb5aee.png" alt="Frontend Application Typescript" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/frontend-application-typescript.gif"/></noscript>
<h2 id="dockersetup">Docker设置</h2>
<p>要安装通知，您需要在您的本地机器Docker。如果你还没有安装Docker，你可以按照指南来安装它。</p>
<p>安装Docker后，我们可以通过在终端中运行<code>docker pull caronc/apprise</code>来安装aperture。安装完成后，我们可以通过选择左侧导航栏上的<strong>图像</strong>选项，在打开的新窗口中运行“通知”:</p>
<p><img data-attachment-id="141954" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/install-apprise-docker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png" data-orig-size="730,363" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="install-apprise-docker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker-300x149.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png" decoding="async" class="aligncenter wp-image-141954 size-full jetpack-lazy-image" src="../Images/7f77a850c3e6c454715d08e3d7298824.png" alt="Install Apprise Docker" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker-300x149.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="141954" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/install-apprise-docker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png" data-orig-size="730,363" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="install-apprise-docker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker-300x149.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png" decoding="async" loading="lazy" class="aligncenter wp-image-141954 size-full" src="../Images/7f77a850c3e6c454715d08e3d7298824.png" alt="Install Apprise Docker" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker-300x149.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/install-apprise-docker.png"/></noscript>
<p>在附加设置下，您可以指定通知的名称或端口，然后单击<strong>运行</strong>启动服务器。运行通知时，在浏览器中打开URL会产生以下结果:</p>
<p><img data-attachment-id="141957" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/open-url-apprise/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png" data-orig-size="730,369" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="open-url-apprise" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise-300x152.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png" decoding="async" class="aligncenter wp-image-141957 size-full jetpack-lazy-image" src="../Images/8eb3095e9058d3edcef71f5bf304a953.png" alt="Open URL Apprise" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise-300x152.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="141957" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/open-url-apprise/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png" data-orig-size="730,369" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="open-url-apprise" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise-300x152.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png" decoding="async" loading="lazy" class="aligncenter wp-image-141957 size-full" src="../Images/8eb3095e9058d3edcef71f5bf304a953.png" alt="Open URL Apprise" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise-300x152.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/open-url-apprise.png"/></noscript>
<h2 id="making-post-request-next-js-api-route">从Next.js API路由发出<code>POST</code>请求</h2>
<p>我们将向<a href="https://github.com/caronc/apprise/wiki/Notify_discord">不和谐</a>和<a href="https://github.com/caronc/apprise/wiki/Notify_telegram">电报</a>发送通知。我们需要以下配置:</p>
<h3>为了不和谐</h3>
<p>对于不一致，我们将需要我们希望向其发送通知的通道的<code>webhook id</code>和<code>webhook token</code>。您可以从<strong>集成</strong>窗格下的不和谐频道的<strong>设置</strong>选项卡中获得:</p>
<p><img data-attachment-id="141959" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/discord-require-webook-id-token/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png" data-orig-size="730,324" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="discord-require-webook-id-token" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token-300x133.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png" decoding="async" class="aligncenter wp-image-141959 size-full jetpack-lazy-image" src="../Images/866369a4b6a0ea4d2f158e71512a62db.png" alt="Discord Require Webook ID Token" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token-300x133.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="141959" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/discord-require-webook-id-token/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png" data-orig-size="730,324" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="discord-require-webook-id-token" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token-300x133.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png" decoding="async" loading="lazy" class="aligncenter wp-image-141959 size-full" src="../Images/866369a4b6a0ea4d2f158e71512a62db.png" alt="Discord Require Webook ID Token" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token-300x133.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/discord-require-webook-id-token.png"/></noscript>
<p>点击<strong>复制Webhook URL </strong>获得包含您的ID和hook的URL。然后，创建一个URL，如下所示:</p>
<pre class="language-javascript hljs">discord://{your webhook id}/{your webhook token}
</pre>
<h3>电报用</h3>
<p>要向Telegram发送通知，我们首先需要设置一个Telegram bot，<a href="https://botsfortelegram.com/project/the-bot-father/"> BotFather </a>。为了给机器人发消息，<a href="https://github.com/caronc/apprise/wiki/Notify_telegram#bot-setup">参考文档中的步骤</a>。</p>
<p><span>我已经创建了一个名为</span> <code>lyratypescript_bot</code>的新机器人，但是你可以随意命名你的机器人。使用以下格式创建一个电报URL:</p>
<pre>tgram://&lt;your telegram bot token&gt;/
</pre>
<h2 id="defining-post-request">定义我们的<code>POST</code>请求</h2>
<p>随着我们的通知服务器的启动和运行，我们将在我们的<code>api</code>目录中定义一个<code>POST</code>请求，每当一部电影被点击时，从我们的<code>newMovies</code>实例中发布详细信息。在<code>api</code>文件夹中，创建一个名为<code>sendnotifications.ts</code>的新文件，并向其中添加以下代码:</p>
<pre class="language-javascript hljs">// Next.js API route support: https://nextjs.org/docs/api-routes/introduction
import type { NextApiRequest, NextApiResponse } from "next";
import axios from "axios";
type Data = {
  name: string;
};
export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse&lt;Data&gt;
) {
  let headersList = {
    Accept: "*/*",
    "Content-Type": "application/json",
  };
  let bodyContent = JSON.stringify({
    urls: "&lt;discord URL&gt;, &lt;telegram URL&gt;",
    title: "Sent from Lyra Search",
    body: `Movie name: ${JSON.parse(req.body).title}, Movie link: ${JSON.parse(req.body).Movielink}`,
    tag: "all",
  });
  let reqOptions = {
    url: "http://localhost:8000/notify/",
    method: "POST",
    headers: headersList,
    data: bodyContent,
  };
  let response: Data = await axios.request(reqOptions);
  console.log(response.data);
  res.status(200).json(response.data);
}
</pre>
<p>在我们的<code>index.tsx</code>文件中，我们可以用我们的电影数据创建一个<code>POST</code>请求到这个<code>api</code> URL:</p>
<pre class="language-javascript hljs">//function to send notifications  
const sendnotifs = async (notification) =&gt; {
    const response = await fetch("/api/sendnotifications", {
      method: "POST",
      body: JSON.stringify({
        title: notification.name,
        Movielink: notification.downloadURL,
        rating: notification.rating,
      }),
    });
    const data = await response.json();
    console.log(data);
  };
</pre>
<p>然后，在我们的<code>results</code>显示容器中，我们将添加一个<code>onClick</code>处理程序来运行这个函数，将<code>movie</code>作为参数传递:</p>
<pre class="language-javascript hljs">//....
&lt;div
  key={index}
  style={{
    background: "#1c1e21",
    height: "200px",
    paddingLeft: "13px",
  }}
  onClick={() =&gt; {
    sendnotifs(movie);
  }}
&gt;
</pre>
<p>现在，当我们点击任何一个<code>movies</code>时，我们会得到一个发送给Discord和Telegram的响应:</p>
<figure id="attachment_141964" aria-describedby="caption-attachment-141964" class="wp-caption aligncenter"><img data-attachment-id="141964" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/send-response-telegram/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png" data-orig-size="730,636" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="send-response-telegram" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram-300x261.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png" decoding="async" class="wp-image-141964 size-full jetpack-lazy-image" src="../Images/31152252d95ff21d7dfacc38ea5283e1.png" alt="Send Response Telegram" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram-300x261.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="141964" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/send-response-telegram/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png" data-orig-size="730,636" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="send-response-telegram" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram-300x261.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png" decoding="async" loading="lazy" class="wp-image-141964 size-full" src="../Images/31152252d95ff21d7dfacc38ea5283e1.png" alt="Send Response Telegram" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram-300x261.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-telegram.png"/></noscript><figcaption id="caption-attachment-141964" class="wp-caption-text">Telegram</figcaption></figure>
<h3>结论</h3>
<figure id="attachment_141967" aria-describedby="caption-attachment-141967" class="wp-caption aligncenter"><img data-attachment-id="141967" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/send-response-discord/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png" data-orig-size="730,341" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="send-response-discord" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord-300x140.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png" decoding="async" class="wp-image-141967 size-full jetpack-lazy-image" src="../Images/10cacf94a3ac33e102d3c4f0d827aa9c.png" alt="Send Response Discord" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord-300x140.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="141967" data-permalink="https://blog.logrocket.com/build-site-search-lyra-typescript/attachment/send-response-discord/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png" data-orig-size="730,341" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="send-response-discord" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord-300x140.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png" decoding="async" loading="lazy" class="wp-image-141967 size-full" src="../Images/10cacf94a3ac33e102d3c4f0d827aa9c.png" alt="Send Response Discord" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord-300x140.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/send-response-discord.png"/></noscript><figcaption id="caption-attachment-141967" class="wp-caption-text">Discord</figcaption></figure>
<h2 id="conclusion">在本教程中，我们学习了如何使用Lyra来执行搜索功能，以及如何使用Apprise处理推送通知。我们回顾了在您的web应用程序中添加搜索功能的好处，并且我们看到了设置和开始使用Lyra和TypeScript是多么容易。</h2>
<p>如果你有任何问题，欢迎在下面留言。编码快乐！</p>
<p><a class="signup" href="https://lp.logrocket.com/blg/typescript-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>:全面了解您的网络和移动应用</p><div class="code-block code-block-21">
<div class="blog-plug inline-plug typescript-plug"><h2>LogRocket 是一个前端应用程序监控解决方案，可以让您回放问题，就像问题发生在您自己的浏览器中一样。LogRocket不需要猜测错误发生的原因，也不需要向用户询问截图和日志转储，而是让您重放会话以快速了解哪里出错了。它可以与任何应用程序完美配合，不管是什么框架，并且有插件可以记录来自Redux、Vuex和@ngrx/store的额外上下文。</h2>
<a href="https://lp.logrocket.com/blg/typescript-signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p>除了记录Redux操作和状态，LogRocket还记录控制台日志、JavaScript错误、堆栈跟踪、带有头+正文的网络请求/响应、浏览器元数据和自定义日志。它还使用DOM来记录页面上的HTML和CSS，甚至为最复杂的单页面和移动应用程序重新创建像素级完美视频。</p>
<p>.</p>
<a class="signup" href="https://lp.logrocket.com/blg/typescript-signup" target="_blank" rel="noopener noreferrer">Try it for free</a><p>.</p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>