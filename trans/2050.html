<html>
<head>
<title>Using SharedPreferences in Flutter to store data locally - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在 Flutter 中使用 SharedPreferences 在本地存储数据</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/#0001-01-01">https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/#0001-01-01</a></blockquote><div><article class="article-post">
<p>可能会有一个时候，你想在你的 Flutter 应用持久化数据，这样你就可以在以后重用它。此功能的一个常见用例是存储登录凭据，以便用户下次启动应用程序时调用。</p>
<p>使用 SharedPreferences，您可以配置您的 Flutter 应用程序，即使在用户终止他们的活动后也能记住数据。SharedPreferences 可用于存储密码、令牌和复杂关系数据等关键数据。</p>
<p>在本教程中，我们将演示如何在 Flutter 应用程序中使用 SharedPreferences 持久化和修改数据。我们将通过实际例子介绍以下内容:</p>

<h2 id="what-is-sharedpreferences-in-flutter">Flutter 中的 SharedPreferences 是什么？</h2>
<p>SharedPreferences 是 Android 和 iOS 应用程序用来在分配的空间中存储简单数据的工具。即使当应用程序关闭并再次启动时，这些数据仍然存在；我们仍然可以恢复原来的值。</p>
<p>存储在 SharedPreferences 中的数据可以编辑和删除。SharedPreferences 将数据存储在一个<a href="https://flutter.dev/docs/cookbook/persistence/key-value">键值对</a>中。</p>
<p>为了在 Flutter 中使用 SharedPreferences，一个名为<code><a href="https://gist.github.com/philipszdavido/aa5086ce7f0f85e50cddd008895ae4b6" target="_blank" rel="noopener">shared_preferences</a></code>的插件使我们能够存储数据。该插件在 iOS 上包装了<code>NSUserDefaults</code>，在 Android 上包装了<code>SharedPreferences</code>。</p>
<h2 id="scaffolding-a-flutter-project">搭建一个颤动的项目</h2>
<p>让我们来看看如何搭建一个 Flutter 项目，将<code>shared_preferences</code>插件添加到一个 Flutter 项目中，以及插件向我们展示的方法。</p>
<p>你需要在你的机器上安装一些工具和二进制文件，包括 Flutter SDK 和 Android Studio。</p>
<h3 id="flutter-sdk">颤振 SDK</h3>
<p>要在我们的机器上安装 Flutter SDK，您需要根据您的机器在下面选择您的 Flutter 二进制文件:</p>

<p>安装完成后，您将可以在系统中全局使用 Flutter CLI。运行以下命令对此进行测试:</p>
<pre>➜  flutter --version

Flutter 2.0.6 • channel stable • https://github.com/flutter/flutter.git
Framework • revision 1d9032c7e1 (3 months ago) • 2021-04-29 17:37:58 -0700
Engine • revision 05e680e202
Tools • Dart 2.12.3</pre>
<p>您的版本可能与我的不同，但您应该能够验证 Flutter SDK 已成功安装。</p>
<h3 id="android-studio">安卓工作室</h3>
<p>我们将为 Android 操作系统开发，我们需要一个模拟器来测试我们的应用程序运行。Android Studio 是用于构建、测试和发布 Android 应用程序的官方 IDE/SDK。<br/>前往<a href="https://developer.android.com/studio" target="_blank" rel="noopener">官网</a>下载并在你的机器上安装 Android Studio。</p>
<p>要使用 Android Studio 开发 Flutter 项目，您需要安装以下插件:</p>

<p>要搭建颤振项目，请运行以下命令:</p>
<pre>flutter create shared_pref
</pre>
<p>该命令创建一个文件夹<code>shared_pref</code>，并在其中放置一个 Flutter 项目。可以使用 VS 代码或者 Android Studio 打开项目。</p>
<h2 id="installing-shared-preferences">安装<code>shared_preferences</code></h2>
<p>现在我们已经准备好了 Flutter SDK，是时候安装<code>shared_preferences</code>插件了。</p>
<p>打开<code>pubspec.yaml</code>文件，在<code>dependencies</code>部分添加<code>shared_preferences</code>:</p>
<pre>dependencies:
  flutter:
    sdk: flutter
  shared_preferences:
</pre>
<p>这将安装该依赖项的最新版本。</p>
<p>要使用<code>shared_preferences</code>插件，我们必须将它导入到我们的文件中:</p>
<pre>import 'package:shared_preferences/shared_preferences.dart';
</pre>
<p><code>shared_preferences</code>插件导出一个<code>SharedPreferences</code>类，该类包含可用于在 SharedPreferences 中设置各种原始类型数据的方法。它有一个方法<code>getInstance</code>，用于创建一个<code>SharedPreferences</code>的实例。</p>
<pre>SharedPreferences prefs = await SharedPreferences.getInstance();
</pre>
<p><code>getInstance</code>创建并返回一个<code>SharedPreferences</code>实例。<code>prefs</code>持有<code>SharedPreferences</code>的实例。</p>
<h2 id="shared-preference-methods"><code>shared_preferences</code>方法</h2>
<p>在本节中，我们将演示如何向 SharedPreferences 添加数据，以及从其中获取、编辑和删除数据。</p>
<h3 id="adding-data">添加数据</h3>
<p>可以向 SharedPreferences 添加基本类型的数据。我们可以添加以下基本类型:</p>

<p>每个基本类型都有相应的 setter 方法。(注意:键-值对的键在字符串中。)</p>
<h4>添加到</h4>
<pre>prefs.setInt('counter', 1);
</pre>
<p>这将向 SharedPreferences 的<code>counter</code>表中添加一个 int，<code>1</code>。</p>
<h4>添加字符串</h4>
<pre>prefs.setString('counter', "yes");
</pre>
<p>这将向<code>counter</code>添加一个字符串<code>"yes"</code>。</p>
<h4>Add bool</h4>
<pre>prefs.setBool('counter', true);
</pre>
<p>这将向<code>counter</code>添加一个布尔值<code>true</code>。</p>
<h4>添加双精度</h4>
<pre>prefs.setDouble('counter', 10.2);
</pre>
<p>这为<code>counter</code>增加了一个双精度值<code>10.2</code>。</p>
<h3 id="retrieving-data">检索数据</h3>
<p>现在，让我们看看如何从 SharedPreferences 中检索数据。因为我们有用于基本类型的 setter 方法，所以我们有用于检索数据的 getter 方法。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自 LogRocket 的精彩文章:</h3>

<hr/></div>
<h4>获取整数数据</h4>
<pre>int value = prefs.getInt('counter');
</pre>
<p><code>getInt</code>方法用于从 SharedPreferences 中检索一个<code>int value</code>。</p>
<pre>value // 1
</pre>
<h4>Get bool data</h4>
<pre>bool value = prefs.getBool('counter');
</pre>
<p>这个方法<code>getBool</code>从 SharedPreferences 返回一个布尔值。</p>
<pre>value // true
</pre>
<h4>获取双重数据</h4>
<pre>double value = prefs.getDouble('counter');
</pre>
<p><code>getDouble</code>方法从 SharedPreferences 返回一个 double 值。</p>
<pre>value // 10.2
</pre>
<h4>获取字符串数据</h4>
<pre>string value = prefs.getString('counter');
</pre>
<p><code>getString</code>方法从 SharedPreferences 返回一个字符串值。</p>
<pre>value // "yes"
</pre>
<h4><code>null</code> <strong>值</strong></h4>
<p>在 SharedPreferences 中不存在数据的情况下，返回一个<code>null</code>值:</p>
<pre>prefs.getInt("_counter")
// null

prefs.getBool("_counter")
// null

prefs.getString("_counter")
// null

prefs.getDouble("_counter")
// null
</pre>
<h3 id="deleting-data">删除数据</h3>
<p>为了从 SharedPreferences 中删除数据，我们将使用<code>remove</code>方法。数据的键被传递给<code>.remove</code>方法，因此<code>SharedPreferences</code>中的键-值对数据被删除。</p>
<pre>prefs.remove("counter");
</pre>
<p>这里删除了<code>SharedPreferences</code>中的<code>counter</code>。</p>
<h3 id="verifying-that-data-exists">验证数据是否存在</h3>
<p>我们可以在读取或写入之前检查<code>SharedPreferences</code>中的数据是否存在。为此，我们将使用<code>containsKey</code>方法。</p>
<p><code>containsKey</code>方法在其 arg 中接受数据的键，并用它来检查该键是否存在于 SharedPreferences 中。</p>
<p>该方法返回一个布尔值，<code>true</code>或<code>false</code>:</p>
<pre>prefs.containsKey("counter")
// true
</pre>
<p>在上面的示例中，<code>counter</code>存在于 SharedPreferences 中。这就是它返回<code>true</code>的原因。</p>
<pre>prefs.containsKey("_counter")
// false
</pre>
<p><code>_counter</code>不存在，所以返回<code>false</code>。</p>
<h2 id="using-shared-preferences-in-flutter">在颤振中使用<code>shared_preferences</code></h2>
<p>默认情况下，每当您搭建一个新项目时，Flutter 都会添加一个计数器项目。这个计数器项目使我们能够在按下<code>FloatingActionButton</code>时增加一个计数器。计数器的当前状态随着它的增加而显示。</p>
<pre>import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  // This widget is the root of your application.
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Flutter Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: MyHomePage(title: 'Flutter Demo Home Page'),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage({Key key, this.title}) : super(key: key);

  final String title;

  @override
  _MyHomePageState createState() =&gt; _MyHomePageState();
}

class _MyHomePageState extends State&lt;MyHomePage&gt; {
  int _counter = 0;

  void _incrementCounter() {
    setState(() {
      _counter++;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: &lt;Widget&gt;[
            Text(
              'You have pushed the button this many times:',
            ),
            Text(
              '$_counter',
              style: Theme.of(context).textTheme.headline4,
            ),
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _incrementCounter,
        tooltip: 'Increment',
        child: Icon(Icons.add),
      ), // This trailing comma makes auto-formatting nicer for build methods.
    );
  }
}
</pre>
<p>当应用程序被销毁或关闭时,<code>counter</code>恢复为<code>0</code>。我们将使用 SharedPreferences 来持久化计数器的状态，以便计数器值从应用程序关闭之前的位置开始。</p>
<p>让我们开始吧。</p>
<p>首先，导入<code>shared_preferences</code>插件:</p>
<pre>import 'package:flutter/material.dart';
import 'package:shared_preferences/shared_preferences.dart';
</pre>
<p>接下来，在<code>MyHomePageState</code>小部件中添加一个<code>initState</code>生命周期方法。这个生命周期方法在有状态小部件初始化时被调用。</p>
<p>这里，我们将从 SharedPreferences 加载计数器。如果存在，我们就把它作为计数器值。如果不是，我们将<code>0</code>分配给计数器:</p>
<pre>  void loadCounter() async {
    SharedPreferences prefs = await SharedPreferences.getInstance();
    setState(() {
      _counter = (prefs.getInt('counter') ?? 0);
    });
  }

  @override
  void initState() {
    super.initState();
    loadCounter();
  }
</pre>
<p>现在让我们把<code>_incrementCounter</code>函数变成<code>async</code>函数。在其中，我们将从 SharedPreferences 获取计数器，对其进行递增，然后用递增量设置计数器，并在 SharedPreferences 中设置递增量。</p>
<pre>  void _incrementCounter() async {
    SharedPreferences prefs = await SharedPreferences.getInstance();
    setState(() {
      _counter = ((prefs.getInt('counter') ?? 0) + 1);
      prefs.setInt('counter', _counter);
    });
  }
</pre>
<p>现在，我们的 Flutter 应用程序可以在关闭和重启时记住计数器的最后一个值。</p>
<h2 id="testing-our-flutter-app">测试我们的颤振应用</h2>
<p>首先，让我们启动我们的应用程序:</p>
<p><img data-attachment-id="63201" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-start-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png" data-orig-size="500,904" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Start app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png" decoding="async" class="aligncenter size-full wp-image-63201 jetpack-lazy-image" src="../Images/1a416d225e713dcc02c72d4a76d63f63.png" alt="Flutter SharedPreferences Demo: Start App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png 500w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app-166x300.png 166w" data-lazy-sizes="(max-width: 500px) 100vw, 500px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63201" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-start-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png" data-orig-size="500,904" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Start app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-63201" src="../Images/1a416d225e713dcc02c72d4a76d63f63.png" alt="Flutter SharedPreferences Demo: Start App" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png 500w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app-166x300.png 166w" sizes="(max-width: 500px) 100vw, 500px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-start-app.png"/></noscript>
<p>增加到 7:</p>
<p><img data-attachment-id="63193" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-increment-3/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png" data-orig-size="360,651" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Increment to 3" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png" decoding="async" class="alignnone size-full wp-image-63193 jetpack-lazy-image" src="../Images/3e9b42c850e15c4444e06ced66624a5c.png" alt="Flutter SharedPreferences Demo: Increment to 3" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3-166x300.png 166w" data-lazy-sizes="(max-width: 360px) 100vw, 360px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63193" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-increment-3/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png" data-orig-size="360,651" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Increment to 3" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63193" src="../Images/3e9b42c850e15c4444e06ced66624a5c.png" alt="Flutter SharedPreferences Demo: Increment to 3" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3-166x300.png 166w" sizes="(max-width: 360px) 100vw, 360px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-3.png"/></noscript> <img data-attachment-id="63187" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-increment-7/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png" data-orig-size="360,651" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Increment to 7" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png" decoding="async" class="alignnone size-full wp-image-63187 jetpack-lazy-image" src="../Images/70437ddd5e8a22056f1e5413707d1668.png" alt="Flutter SharedPreferences Demo: Increment to 7" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7-166x300.png 166w" data-lazy-sizes="(max-width: 360px) 100vw, 360px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="63187" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-increment-7/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png" data-orig-size="360,651" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Increment to 7" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63187" src="../Images/70437ddd5e8a22056f1e5413707d1668.png" alt="Flutter SharedPreferences Demo: Increment to 7" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7-166x300.png 166w" sizes="(max-width: 360px) 100vw, 360px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png"/></noscript>
<p>现在让我们试着关掉这个应用程序:</p>
<p><img data-attachment-id="63203" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-killing-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png" data-orig-size="500,904" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Killing the app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png" decoding="async" class="aligncenter size-full wp-image-63203 jetpack-lazy-image" src="../Images/539f6c169135f21e6f78668be1c8779f.png" alt="Flutter SharedPreferences Demo: Killing the App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png 500w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app-166x300.png 166w" data-lazy-sizes="(max-width: 500px) 100vw, 500px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63203" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-killing-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png" data-orig-size="500,904" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Killing the app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-63203" src="../Images/539f6c169135f21e6f78668be1c8779f.png" alt="Flutter SharedPreferences Demo: Killing the App" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png 500w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app-166x300.png 166w" sizes="(max-width: 500px) 100vw, 500px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-killing-app.png"/></noscript>
<p>重新启动应用程序后，按钮数应该仍然显示为 7。</p>
<p><img data-attachment-id="63189" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-restart-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png" data-orig-size="360,651" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Restart app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png" decoding="async" class="alignnone size-full wp-image-63189 jetpack-lazy-image" src="../Images/9af0fac42e0727163e71f1bf0a554105.png" alt="Flutter SharedPreferences Demo: Restart App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app-166x300.png 166w" data-lazy-sizes="(max-width: 360px) 100vw, 360px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63189" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-restart-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png" data-orig-size="360,651" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Restart app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63189" src="../Images/9af0fac42e0727163e71f1bf0a554105.png" alt="Flutter SharedPreferences Demo: Restart App" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app-166x300.png 166w" sizes="(max-width: 360px) 100vw, 360px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-restart-app.png"/></noscript> <img data-attachment-id="63187" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-increment-7/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png" data-orig-size="360,651" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Increment to 7" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png" decoding="async" class="alignnone size-full wp-image-63187 jetpack-lazy-image" src="../Images/70437ddd5e8a22056f1e5413707d1668.png" alt="Flutter SharedPreferences Demo: Increment to 7" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7-166x300.png 166w" data-lazy-sizes="(max-width: 360px) 100vw, 360px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="63187" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-demo-increment-7/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png" data-orig-size="360,651" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Increment to 7" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7-166x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63187" src="../Images/70437ddd5e8a22056f1e5413707d1668.png" alt="Flutter SharedPreferences Demo: Increment to 7" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7-166x300.png 166w" sizes="(max-width: 360px) 100vw, 360px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-demo-increment-7.png"/></noscript>
<h2 id="implementing-a-splash-screen-using-shared-preferences">使用 SharedPreferences 实现闪屏</h2>
<p>我们可以在 Flutter 中使用 shared preferences<a href="https://blog.logrocket.com/make-splash-screen-flutter/" target="_blank" rel="noopener">实现闪屏。</a></p>
<p>首次启动应用程序时会出现闪屏，随后启动应用程序时不会再次出现。</p>
<p>假设我们有一个 app，有两个屏幕:<code>ProfileScreen</code>和<code>SplashScreen</code>。我们将挂钩到<code>MyApp</code>小部件中的<code>initState</code>方法。从那里，我们将总是检查 SharedPreferences 中的数据—比如说<code>newLaunch</code>。如果此<code>newLaunch</code>为<code>true</code>，则显示<code>SplashScreen</code>，一段时间后显示<code>ProfileScreen</code>。<code>SplashScreen</code>会将<code>newLaunch</code>重置为<code>false</code>。</p>
<p>如果<code>newLaunch</code>是<code>false</code>，跳过<code>SplashScreen</code>，显示<code>ProfileScreen</code>。</p>
<p>让我们编写我们的闪屏和简介屏幕！</p>
<p>在<code>lib</code>文件夹中创建一个文件夹<code>screens</code>:</p>
<pre>mkdir lib/screens
touch lib/screens/ProfileScreen.dart lib/screens/SplashScreen.dart
</pre>
<p>让我们按如下方式编辑<code>MyApp</code>小部件:</p>
<pre>import 'package:flutter/material.dart';
import 'package:shared_preferences/shared_preferences.dart';
import 'screens/ProfileScreen.dart';
import 'screens/SplashScreen.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  // This widget is the root of your application.
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
        title: 'SharedPreferences Demo',
        theme: ThemeData(
          primarySwatch: Colors.blue,
        ),
        home: LoadPage() //MyHomePage(title: 'SharedPreferences Demo'),
        );
  }
}

class LoadPage extends StatefulWidget {
  LoadPage({Key key}) : super(key: key);

  @override
  LoadPageState createState() =&gt; LoadPageState();
}

class LoadPageState extends State {
  var newLaunch;

  @override
  void initState() {
    super.initState();
    loadNewLaunch();
  }

  loadNewLaunch() async {
    SharedPreferences prefs = await SharedPreferences.getInstance();
    setState(() {
      bool _newLaunch = ((prefs.getBool('newLaunch') ?? true));
      newLaunch = _newLaunch;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(body: newLaunch ? SplashScreen() : ProfileScreen());
  }
}
</pre>
<p>我们有<code>LoadPage</code>小部件和它的状态小部件<code>LoadPageState</code>。在<code>LoadPageState</code>中，我们有一个方法<code>loadNewLaunch</code>，它检查从 SharedPrefs 中获取<code>newLaunch</code>数据，并将其分配给<code>newLaunch</code>状态变量。</p>
<p>在<code>LoadPageState</code>的<code>build</code>方法中，小部件检查<code>newLaunch</code>状态。如果状态是<code>true</code>，这意味着应用程序第一次启动，并且显示<code>SplashScreen</code>小部件。如果不是<code>true</code>，则显示<code>ProfileScreen</code>。</p>
<p>让我们编写<code>SplashScreen</code>小部件的代码:</p>
<pre>import 'dart:async';
import 'package:shared_preferences/shared_preferences.dart';
import 'package:flutter/material.dart';
import 'ProfileScreen.dart';

class SplashScreen extends StatefulWidget {
  SplashScreen({Key key}) : super(key: key);

  @override
  _SplashScreenState createState() =&gt; _SplashScreenState();
}

class _SplashScreenState extends State&lt;SplashScreen&gt; {
  resetNewLaunch() async {
    SharedPreferences prefs = await SharedPreferences.getInstance();
    if (prefs.containsKey("newLaunch")) {
      prefs.setBool('newLaunch', false);
    } else {
      prefs.setBool('newLaunch', false);
    }
  }

  @override
  void initState() {
    super.initState();
    Timer(
        Duration(seconds: 3),
        () =&gt; Navigator.pushReplacement(context,
                MaterialPageRoute(builder: (context) {
              resetNewLaunch();
              return ProfileScreen();
            })));
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
        body: Container(
            color: Colors.blue,
            child: Center(
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: &lt;Widget&gt;[
                  Text('Splash Screen',
                      style: new TextStyle(color: Colors.white, fontSize: 40)),
                ],
              ),
        )
      )
    );
  }
}
</pre>
<p><code>resetNewLaunch</code>方法将 SharedPrefs 中的<code>newLaunch</code>数据设置为<code>false</code>。</p>
<p>在<code>initState</code>方法中，<code>SplashScreen</code>调用<code>resetNewLaunch</code>方法将<code>newLaunch</code>数据设置为 SharedPrefs 中的<code>false</code>。这将导致应用程序在随后启动时仅显示<code>ProfileScreen</code>。</p>
<p>在显示<code>ProfileScreen</code>之前，计时器代码等待三秒钟。</p>
<p>现在让我们对<code>ProfileScreen</code>进行编码:</p>
<pre>import 'package:flutter/material.dart';
import 'package:shared_preferences/shared_preferences.dart';

class ProfileScreen extends StatefulWidget {
  ProfileScreen({Key key}) : super(key: key);

  @override
  _ProfileScreenState createState() =&gt; _ProfileScreenState();
}

class _ProfileScreenState extends State&lt;ProfileScreen&gt; {
  clearSharedPrefs() async {
    SharedPreferences prefs = await SharedPreferences.getInstance();
    prefs.remove('newLaunch');
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
        appBar: AppBar(
          title: Text("Profile"),
        ),
        body: Container(
          child: Center(
            child: Column(
              mainAxisAlignment: MainAxisAlignment.center,
              children: &lt;Widget&gt;[
                Text('Profile Screen', style: new TextStyle(fontSize: 40)),
                RaisedButton(
                  child: Text("Clear SharedPrefs"),
                  onPressed: clearSharedPrefs,
                )
              ],
            ),
          ),
        ));
  }
}
</pre>
<p>这里没什么可看的。我们有一个<strong>清除 SharedPrefs </strong>按钮，它清除 SharedPrefs 中的<code>newLaunch</code>数据。此操作将使应用程序在下次启动时显示<code>SplashScreen</code>。</p>
<h2 id="testing-our-splashs-creen">测试我们的闪屏</h2>
<p>安装后首次启动时，闪屏和配置文件屏幕应如下所示:</p>
<p><img data-attachment-id="63191" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-splash-screen-app-launch/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png" data-orig-size="360,647" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Splash screen on app launch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png" decoding="async" class="alignnone size-full wp-image-63191 jetpack-lazy-image" src="../Images/cd4febec2fbdff4cc80939133ef3b180.png" alt="Flutter SharedPreferences Demo: Splash Screen on App Launch" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch-167x300.png 167w" data-lazy-sizes="(max-width: 360px) 100vw, 360px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63191" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-splash-screen-app-launch/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png" data-orig-size="360,647" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Splash screen on app launch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63191" src="../Images/cd4febec2fbdff4cc80939133ef3b180.png" alt="Flutter SharedPreferences Demo: Splash Screen on App Launch" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch-167x300.png 167w" sizes="(max-width: 360px) 100vw, 360px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-splash-screen-app-launch.png"/></noscript> <img data-attachment-id="63183" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-profile-screen-app-launch/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png" data-orig-size="360,647" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Profile screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png" decoding="async" class="alignnone size-full wp-image-63183 jetpack-lazy-image" src="../Images/a5fa87014d37f66bfbc1a9069701208f.png" alt="Flutter SharedPreferences Demo: Profile Screen at Launch" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch-167x300.png 167w" data-lazy-sizes="(max-width: 360px) 100vw, 360px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="63183" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-profile-screen-app-launch/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png" data-orig-size="360,647" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Profile screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63183" src="../Images/a5fa87014d37f66bfbc1a9069701208f.png" alt="Flutter SharedPreferences Demo: Profile Screen at Launch" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png 360w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch-167x300.png 167w" sizes="(max-width: 360px) 100vw, 360px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-app-launch.png"/></noscript>
<p><code>SplashScreen</code>首先显示，随后是<code>ProfileScreen</code>。</p>
<p>后续启动应显示以下屏幕:</p>
<p><img data-attachment-id="63197" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-profile-screen-subequent-launch-1/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png" data-orig-size="240,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Profile screen upon subsequent launch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png" decoding="async" class="alignnone size-full wp-image-63197 jetpack-lazy-image" src="../Images/e28471a234b3ee3fd1eecc45e0bd866b.png" alt="Flutter SharedPreferences Demo: Profile Screen Upon Subsequent Launch" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png 240w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1-167x300.png 167w" data-lazy-sizes="(max-width: 240px) 100vw, 240px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="63197" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-profile-screen-subequent-launch-1/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png" data-orig-size="240,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Profile screen upon subsequent launch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63197" src="../Images/e28471a234b3ee3fd1eecc45e0bd866b.png" alt="Flutter SharedPreferences Demo: Profile Screen Upon Subsequent Launch" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png 240w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1-167x300.png 167w" sizes="(max-width: 240px) 100vw, 240px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-1.png"/></noscript> <img data-attachment-id="63195" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-profile-screen-subequent-launch-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png" data-orig-size="240,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Profile screen upon subsequent launch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png" decoding="async" class="alignnone size-full wp-image-63195 jetpack-lazy-image" src="../Images/c9b2e611fa9d2b77849119ec7335e924.png" alt="Flutter SharedPreferences Demo: Profile Screen Upon Subsequent Launch" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png 240w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2-167x300.png 167w" data-lazy-sizes="(max-width: 240px) 100vw, 240px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="63195" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-profile-screen-subequent-launch-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png" data-orig-size="240,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Profile screen upon subsequent launch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63195" src="../Images/c9b2e611fa9d2b77849119ec7335e924.png" alt="Flutter SharedPreferences Demo: Profile Screen Upon Subsequent Launch" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png 240w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2-167x300.png 167w" sizes="(max-width: 240px) 100vw, 240px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-2.png"/></noscript> <img data-attachment-id="63199" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-profile-screen-subequent-launch-3/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png" data-orig-size="240,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Profile screen upon subsequent launch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png" decoding="async" class="alignnone size-full wp-image-63199 jetpack-lazy-image" src="../Images/40b3cfc9f05f28ddba2fd918787e1e4c.png" alt="Flutter SharedPreferences Demo: Profile Screen Upon Subsequent Launch" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png 240w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3-167x300.png 167w" data-lazy-sizes="(max-width: 240px) 100vw, 240px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="63199" data-permalink="https://blog.logrocket.com/using-sharedpreferences-in-flutter-to-store-data-locally/flutter-sharedpreferences-profile-screen-subequent-launch-3/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png" data-orig-size="240,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter SharedPreferences demo: Profile screen upon subsequent launch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3-167x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-63199" src="../Images/40b3cfc9f05f28ddba2fd918787e1e4c.png" alt="Flutter SharedPreferences Demo: Profile Screen Upon Subsequent Launch" srcset="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png 240w, https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3-167x300.png 167w" sizes="(max-width: 240px) 100vw, 240px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/08/flutter-sharedpreferences-profile-screen-subequent-launch-3.png"/></noscript>
<p><code>SplashScreen</code>永远不会再出现，而<code>ProfileScreen</code>则直线出现。</p>
<h2 id="conclusion">结论</h2>
<p>在本教程中，我们介绍了什么是 SharedPreferences，以及如何在 Android 和 iOS 应用程序中使用它。我们还介绍了<code>shared_preferences</code>插件，并学习了如何用 SharedPreferences 设置 Flutter。</p>
<p>接下来，我们学习了如何导入<code>shared_preferences</code>插件，演示了如何初始化它的实例，并回顾了它的方法以及它们的作用。我们修改了一个普通的颤振计数器项目，以展示如何使用<code>shared_preferences</code>插件来保存计数器值，并在应用程序被终止并重启后检索它。</p>
<p>本教程中所有示例的源代码都可以在<a href="https://github.com/flutter-prjs/shared_prefs" target="_blank" rel="noopener"> GitHub </a>上获得。</p>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>