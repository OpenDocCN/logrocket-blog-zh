<html>
<head>
<title>Building a tag input field component for React - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>为 React - LogRocket 博客构建标签输入字段组件</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/#0001-01-01">https://blog.logrocket.com/building-a-tag-input-field-component-for-react/#0001-01-01</a></blockquote><div><article class="article-post">
<p>有没有想过如何为 React 应用程序构建标签输入字段组件？以下是方法。</p>
<p>首先，让我们从将要实现的标记的可视化表示开始。我们需要一个包装标签和输入字段的容器。当我们添加更多的标签时，输入字段被迫进一步向右移动，这给人一种将标签添加到输入字段的感觉。</p>
<p><img data-attachment-id="47096" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/tags-right-input-field/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png" data-orig-size="560,144" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Tags to the right of the input field" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field-300x77.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png" decoding="async" class="aligncenter size-full wp-image-47096 jetpack-lazy-image" src="../Images/65c058be3d287a7a7c61138fab3268af.png" alt="Tags to the Right of the Input Field" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png 560w, https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field-300x77.png 300w" data-lazy-sizes="(max-width: 560px) 100vw, 560px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="47096" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/tags-right-input-field/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png" data-orig-size="560,144" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Tags to the right of the input field" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field-300x77.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-47096" src="../Images/65c058be3d287a7a7c61138fab3268af.png" alt="Tags to the Right of the Input Field" srcset="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png 560w, https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field-300x77.png 300w" sizes="(max-width: 560px) 100vw, 560px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tags-right-input-field.png"/></noscript>
<p>对应于上述可视化的伪标记如下所示。</p>
<pre>&lt;div className="container"&gt;
  {tags.map((tag) =&gt; &lt;div&gt;{tag}&lt;/div&gt;)}
  &lt;input/&gt;
&lt;/div&gt;
</pre>
<p>此时，很明显我们需要一个状态变量来存储输入的标签，以及另一个状态变量来控制输入字段。<code>input</code>和<code>tags</code>状态默认分别为空字符串和空数组。</p>
<pre>const [input, setInput] = useState('');
const [tags, setTags] = useState([]);
</pre>
<p>我们需要做的下一件事是监听输入字段的变化，这样我们就可以设置<code>input</code>状态，并创建一个逻辑在某个键被按下时填充<code>tags</code>状态。让我们假设我们想要用逗号键分隔标签，所以当这个键被按下时，我们将把<code>input</code>状态的内容作为一个新值推送到<code>tags</code>数组。</p>
<p>为此，我们需要使用<code>onChange</code>和<code>onKeyDown</code>事件。现在我们的标记有了一点变化，添加了新的属性:</p>
<pre>&lt;div className="container"&gt;
  {tags.map((tag) =&gt; &lt;div className="tag"&gt;{tag}&lt;/div&gt;)}
  &lt;input
    value={input}
    placeholder="Enter a tag"
    onKeyDown={onKeyDown}
    onChange={onChange}
  /&gt;
&lt;/div&gt;
</pre>
<h2>输入事件的类型</h2>
<h3>onChange</h3>
<p>该事件仅用于监听输入字段的变化，并更新<code>input</code>状态变量。</p>
<pre><code>const onChange = (e) =&gt; {
  const { value } = e.target;
  setInput(value);
};
</code></pre>
<h3>onKeyDown</h3>
<p>与<strong> onChange </strong>事件不同，<strong> onKeyDown </strong>事件公开了<code>key</code>属性，告诉我们按下了哪个键盘按键。因为我们想用逗号分隔标签，所以在 if 语句中，我们需要检查<code>key</code>是否等于<code>,</code>。</p>
<p>我们在 if 语句中的第二个检查是确保在通过<code>trim()</code>方法删除字符串两边的空白之后<code>input</code>状态变量不为空。</p>
<p>我们需要的最后一项检查是确保该标签不存在。因为我们将标签存储在<code>tags</code>状态变量中，所以我们简单地检查该数组是否包含相同的<code>trimmedInput</code>。如果没有，我们可以将这个新标签放入<code>tags</code>数组。</p>
<p>一旦我们进入 if 语句，我们需要通过调用<code>e.preventDefault()</code>来防止默认行为，这样即使逗号字符被注册，它也不会出现在输入字段中。接下来，使用<code>setTags</code>函数将标签推入<code>tags</code>数组。最后，我们通过将空字符串传递给<code>setInput</code>函数来清除输入字段。</p>
<pre>const onKeyDown = (e) =&gt; {
  const { key } = e;
  const trimmedInput = input.trim();

  if (key === ',' &amp;&amp; trimmedInput.length &amp;&amp; !tags.includes(trimmedInput)) {
    e.preventDefault();
    setTags(prevState =&gt; [...prevState, trimmedInput]);
    setInput('');
  }
};
</pre>
<p>现在，如果您输入一个文本并点击逗号键，您将看到标签呈现在输入字段的顶部，并且输入字段被清除。</p>
<p><img data-attachment-id="47098" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/tag-rendered-on-input-field/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field.gif" data-orig-size="400,127" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Tag rendered on input field" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field-300x95.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field.gif" decoding="async" class="aligncenter size-full wp-image-47098 jetpack-lazy-image" src="../Images/aa5dfc1f457b07ad0dfa0a2bfc2c3e6c.png" alt="Tag Rendered on Input Field" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="47098" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/tag-rendered-on-input-field/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field.gif" data-orig-size="400,127" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Tag rendered on input field" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field-300x95.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-47098" src="../Images/aa5dfc1f457b07ad0dfa0a2bfc2c3e6c.png" alt="Tag Rendered on Input Field" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-rendered-on-input-field.gif"/></noscript>
<p>我们还需要能够在按下退格键时删除标签，这有两种不同的方法:要么立即完全删除标签，要么删除标签并将标签内容返回到输入字段，以便用户可以编辑标签并再次提交。我将展示第二种方法的实现。</p>
<p><img data-attachment-id="47099" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/tag-backspaced-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example.gif" data-orig-size="400,127" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Tag backspaced example" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example-300x95.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example.gif" decoding="async" class="aligncenter size-full wp-image-47099 jetpack-lazy-image" src="../Images/5c6dd5c667b20bcf2939290986e0c66f.png" alt="Tag Backspaced Example" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="47099" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/tag-backspaced-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example.gif" data-orig-size="400,127" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Tag backspaced example" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example-300x95.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-47099" src="../Images/5c6dd5c667b20bcf2939290986e0c66f.png" alt="Tag Backspaced Example" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-backspaced-example.gif"/></noscript>
<p>因为我们需要监听退格键的按下，我们将再次使用<strong> onKeyDown </strong>事件。</p>
<p>这次，<code>key</code>应该等于<code>"Backspace"</code>。我们还需要检查输入字段是否为空，以及<code>tags</code>数组是否为空。</p>
<p>一旦这些条件成立，我们需要删除<code>tags</code>数组中的最后一项，并将最后一个元素放入输入字段。</p>
<p>为此，我简单地克隆了<code>tags</code>状态变量，将它扩展到一个新数组中，然后将它赋给一个名为<code>tagsCopy</code>的新变量。创建数组克隆的原因是不要改变状态变量。</p>
<p>然后，我对该变量调用<code>pop()</code>方法来获取数组中的最后一个元素，并将其从数组中移除。这个弹出的值现在存储在一个名为<code>poppedTag</code>的变量中。</p>
<p>我们使用<code>setTags</code>用<code>tagsCopy</code>数组更新<code>tags</code>状态，这个数组没有最后一个标签。现在，我们需要输入字段中弹出的标签值，这就是为什么我们调用<code>setInput(poppedTag)</code>用最后一个标签值更新<code>input</code>状态变量。</p>
<pre>const onKeyDown = (e) =&gt; {
  const { key } = e;
  const trimmedInput = input.trim();

  if (key === ',' &amp;&amp; trimmedInput.length &amp;&amp; !tags.includes(trimmedInput)) {
    e.preventDefault();
    setTags(prevState =&gt; [...prevState, trimmedInput]);
    setInput('');
  }

  if (key === "Backspace" &amp;&amp; !input.length &amp;&amp; tags.length) {
    e.preventDefault();
    const tagsCopy = [...tags];
    const poppedTag = tagsCopy.pop();

    setTags(tagsCopy);
    setInput(poppedTag);
  }
};
</pre>
<p>这很好，但是有一个问题。当您按下退格键并且输入字段中有最后一个标签时，您可能希望按住退格键来完全删除该标签——但是对于当前的实现，如果您不快速释放该键，您将会很快删除一个又一个标签。</p>
<p><img data-attachment-id="47100" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/deleting-tags-quickly/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly.gif" data-orig-size="400,183" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Deleting tags quickly" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly-300x137.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly.gif" decoding="async" class="aligncenter size-full wp-image-47100 jetpack-lazy-image" src="../Images/676c3feeb8ac0b9dadd3912a1c159bc4.png" alt="Deleting Tags Quickly" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="47100" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/deleting-tags-quickly/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly.gif" data-orig-size="400,183" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Deleting tags quickly" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly-300x137.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-47100" src="../Images/676c3feeb8ac0b9dadd3912a1c159bc4.png" alt="Deleting Tags Quickly" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/deleting-tags-quickly.gif"/></noscript>
<p>我期望的行为是删除输入字段中的字符，然后停止而不删除下一个标签，除非用户松开键并再次按 backspace。</p>
<p>这个问题的解决方法很简单。除了<strong> onKeyDown </strong>事件，我们还需要使用<strong> onKeyUp </strong>事件来跟踪一个按键是否被释放。这样，我们可以检测到用户是否按下了退格键来清除输入字段。</p>
<p>首先，我们需要一个新的布尔状态变量来切换按键的按下和释放。</p>
<pre>const [isKeyReleased, setIsKeyReleased] = useState(false);
</pre>
<p>在<strong> onKeyDown </strong>功能中设置<code>isKeyReleased</code>为<code>false</code>，在<strong> onKeyUp </strong>中设置<code>true</code>。</p>
<p>然后我们需要使用<code>isKeyReleased</code>作为标签删除逻辑的 if 语句的条件。这样，我们只在按住退格键时删除输入字段中的字符。</p>
<p><img data-attachment-id="47101" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/pressed-and-held-delete/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete.gif" data-orig-size="400,183" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Pressed and held delete" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete-300x137.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete.gif" decoding="async" class="aligncenter size-full wp-image-47101 jetpack-lazy-image" src="../Images/4ace96d7431e1e06f87758e52402c625.png" alt="Pressed and Held Delete" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="47101" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/pressed-and-held-delete/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete.gif" data-orig-size="400,183" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Pressed and held delete" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete-300x137.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-47101" src="../Images/4ace96d7431e1e06f87758e52402c625.png" alt="Pressed and Held Delete" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/pressed-and-held-delete.gif"/></noscript>
<p>下面是这两个函数的最终版本。</p>
<pre>const onKeyDown = (e) =&gt; {
  const { key } = e;
  const trimmedInput = input.trim();

  if (key === ',' &amp;&amp; trimmedInput.length &amp;&amp; !tags.includes(trimmedInput)) {
    e.preventDefault();
    setTags(prevState =&gt; [...prevState, trimmedInput]);
    setInput('');
  }

  if (key === "Backspace" &amp;&amp; !input.length &amp;&amp; tags.length &amp;&amp; isKeyReleased) {
    const tagsCopy = [...tags];
    const poppedTag = tagsCopy.pop();
    e.preventDefault();
    setTags(tagsCopy);
    setInput(poppedTag);
  }

  setIsKeyReleased(false);
};

const onKeyUp = () =&gt; {
  setIsKeyReleased(true);
}
</pre>
<p>不要忘记用 onKeyUp 处理程序更新 HTML 输入<strong> <em>标签。</em></strong></p>
<pre>&lt;input
  value={input}
  placeholder="Enter a tag"
  onKeyDown={onKeyDown}
  onKeyUp={onKeyUp}
  onChange={onChange}
/&gt;
</pre>
<h2>删除特定标签</h2>
<p>为了创造良好的用户体验，能够删除特定的标签是另一个必需的特性。为了实现这一点，我们需要稍微修改一下标签标记，只添加一个 HTML 按钮<em> <em/> </em>标签。</p>
<p>按钮的<strong> onClick </strong>事件处理程序调用名为<code>deleteTag</code>的函数，其中标签的<code>index</code>作为参数传递。</p>
<pre>{tags.map((tag, index) =&gt; (
  &lt;div className="tag"&gt;
    {tag}
    &lt;button onClick={() =&gt; deleteTag(index)}&gt;x&lt;/button&gt;
  &lt;/div&gt;
))}
</pre>
<p><code>deleteTag</code>函数根据索引值过滤掉标签。因为我们传递了想要删除的标签的<code>index</code>,所以我们选择了在数组中没有相同索引位置的所有标签。</p>
<pre>const deleteTag = (index) =&gt; {
  setTags(prevState =&gt; prevState.filter((tag, i) =&gt; i !== index))
}
</pre>
<p><img data-attachment-id="47102" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/delete-tags-with-box/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box.gif" data-orig-size="400,183" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Delete tags with box" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box-300x137.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box.gif" decoding="async" class="aligncenter size-full wp-image-47102 jetpack-lazy-image" src="../Images/20bba722f1af26f457401c9807d004ef.png" alt="Delete Tags With Box" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="47102" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/delete-tags-with-box/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box.gif" data-orig-size="400,183" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Delete tags with box" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box-300x137.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-47102" src="../Images/20bba722f1af26f457401c9807d004ef.png" alt="Delete Tags With Box" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/delete-tags-with-box.gif"/></noscript>
<p>此时，我们有了一个功能齐全的标签输入字段，但是它看起来显然不太好。我不会进入样式的细节，但下面你可以找到一个示例 CSS 文件，它看起来像这样:</p>
<p><img data-attachment-id="47103" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/tag-auto-add/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add.gif" data-orig-size="500,82" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Tag auto add" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add-300x49.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add.gif" decoding="async" class="aligncenter size-full wp-image-47103 jetpack-lazy-image" src="../Images/c6b828adcfb8beff875f69c60b4a5adb.png" alt="Tag Auto Add" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="47103" data-permalink="https://blog.logrocket.com/building-a-tag-input-field-component-for-react/tag-auto-add/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add.gif" data-orig-size="500,82" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Tag auto add" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add-300x49.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-47103" src="../Images/c6b828adcfb8beff875f69c60b4a5adb.png" alt="Tag Auto Add" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/05/tag-auto-add.gif"/></noscript>
<pre>.container {
  display: flex;
  overflow: scroll;
  width: 100%;
  max-width: 100%;
  padding-left: 14px;
  border: 1px grey solid;
  border-radius: 5px;
  color: black
}

.container input {
  width: 100%;
  min-width: 50%;
  border: none;
  border-radius: 5px;
  padding: 14px;
  padding-left: 14px;
}

.tag {
  display: flex;
  align-items: center;
  margin: 7px 0;
  margin-right: 10px;
  padding: 0 10px;
  padding-right: 5px;
  border: 1px solid orange;
  border-radius: 5px;
  background-color: orange;
  white-space: nowrap;
  color: white;
}

.tag button {
  display: flex;
  padding: 6px;
  border: none;
  background-color: unset;
  cursor: pointer;
  color: white;
}
</pre>
<p>我希望这篇关于在 React 中构建标签输入字段组件的教程对您有所帮助。感谢阅读。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产 React 应用</h2><p>调试 React 应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪 Redux 状态、自动显示 JavaScript 错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的 web 和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket 不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux 中间件包为您的用户会话增加了一层额外的可见性。LogRocket 记录 Redux 存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试 React 应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>