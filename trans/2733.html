<html>
<head>
<title>What's new in MDX v2 - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>MDX v2 中的新功能- LogRocket 博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/whats-new-mdx-v2/#0001-01-01">https://blog.logrocket.com/whats-new-mdx-v2/#0001-01-01</a></blockquote><div><article class="article-post">
<p/>
<p>经过两年半的等待开发，MDX v2 终于发布了。MDX v2 在性能和语法等方面对 MDX v1 的功能进行了一些急需的改进，并增加了一些功能，如支持 JavaScript 表达式和更多 JSX 运行时。</p>
<p>在本文中，我们将探讨 MDX v2 发行说明中强调的一些惊人改进，包括:</p>

<p>尽情享受吧！</p>
<h2>改进的 MDX 语法格式</h2>
<p>与第一个版本相比，新改进的 MDX 语法使得在 JSX 使用 MDX 更加容易。根据 MDX 团队的发布帖子，</p>
<blockquote><p>我们花了很多时间思考和尝试不同的方法来改进格式。最初，这种格式非常接近 Markdown，以及 Markdown 中的 HTML 的工作方式。我们发现旧的行为经常会产生意想不到的结果。在版本 2 中，我们稍微改变了格式，使之更接近 JS(X)的工作方式。</p></blockquote>
<p>在旧格式中，MDX 语法被转换成相对的 Markdown 格式，如下所示:</p>
<ul>
<li class="language-markdown hljs"><code>&lt;div&gt;*italicize*&lt;/div&gt;</code>转换为<code>&lt;div&gt;*italicize*&lt;/div&gt;</code></li>
<li class="language-markdown hljs"><code>&lt;div&gt;# header one&lt;/div&gt;</code>转换为<code>&lt;div&gt;# header one&lt;/div&gt;</code></li>
</ul>
<p>但是这导致了一系列的解析问题。使用新的语法，MDX 代码将直接转换为其等效的 JSX 格式:</p>
<ul>
<li><code>&lt;div&gt;*italicize*&lt;/div&gt;</code>变成了<code>&lt;div&gt;&lt;em&gt;italicize&lt;/em&gt;&lt;/div&gt;</code></li>
<li><code>&lt;div&gt;# header one&lt;/div&gt;</code>变成了<code>&lt;div&gt;&lt;h1&gt;header one&lt;/h1&gt;&lt;/div&gt;</code></li>
</ul>
<p>此更新承诺解决 MDX v1 语法中遇到的解析问题。点击此<a href="https://mdxjs.com/docs/what-is-mdx/#mdx-syntax" target="_blank" rel="noopener">链接</a>了解更多关于 MDX v2 语法的信息。</p>
<h2 id="support-javascript-expressions">支持 JavaScript 表达式</h2>
<p>MDX v2 支持向 MDX 代码添加表达式，如 JavaScript 表达式。表达式可以添加到 MDX 文档中花括号内的任何地方，不需要限制在文档的某些区域。</p>
<p>现在，您可以在 MDX 代码中直接执行算术运算。例如，这段代码:</p>
<pre class="language-markdown hljs"># Quick maths -&gt; { (2+2) * Math.PI}
</pre>
<p>产生以下输出:</p>
<pre class="language-markdown hljs">Quick maths -&gt; 12.566370614359172
</pre>
<p>表达式的大括号也可以为空或包含注释。</p>
<pre class="language-markdown hljs">{/* This is a lovely comment! */}
</pre>
<p>要了解有关 MDX 表达式的更多信息，请访问此<a href="https://mdxjs.com/docs/what-is-mdx/#expressions" target="_blank" rel="noopener">链接</a>。</p>
<h2 id="increased-expanded-support-jsx-runtimes">增加和扩展了对 JSX 运行时的支持</h2>
<p>MDX v2 增加了对更多 JavaScript 运行时和包的支持。MDX 的 v1 版本主要与 Babel、webpack 和 React 一起工作，并且不能够容易地与其他工具一起使用。</p>
<p>这在 v2 版本中已经改变。Babel、webpack 和 React 现在是可选的，MDX 现在可以用于:</p>

<p>请访问<a href="https://mdxjs.com/docs/getting-started/#getting-started" target="_blank" rel="noopener"> MDX 迁移页面</a>了解更多信息。</p>
<h2 id="support-es-modules">支持 ES 模块</h2>
<p>MDX v2 已经完全转变为仅支持 ECMAScript 模块(ESM)。虽然 MDX v1 支持 ESM，但 v2 只能与支持 ESM 的工具配合使用。因此，像下面这样的导入无法在 MDX v2 上运行。</p>
<ul>
<li><code>const data = require('./data')</code></li>
<li><code>import { foo } from 'foo/lib/main'</code></li>
</ul>
<p>你得改为 ESM JavaScript。</p>
<ul>
<li><code>import data from './data.js'</code></li>
<li><code>import { foo } from 'foo/lib/main.js'</code></li>
</ul>
<p>点击了解有关 MDX v2 ESM 支持<a href="https://mdxjs.com/docs/troubleshooting-mdx/#esm" target="_blank" rel="noopener">的更多信息。</a></p>
<h2 id="improved-documentation">改进的文档</h2>
<p>整个 MDX 文档从上到下都进行了重写，以便为试图修改 MDX v2 的人们提供更好的体验。所有不一致和重复的内容也已从文档网站上删除。</p>
<p>文档网站也用 MDX 重新构建，提供了更优化的体验和性能。据 MDX 团队称，与以前的版本相比，新的文档网站在所有性能和可访问性测试中得分都很高。</p>
<h2 id="architectural-improvements">建筑改进</h2>
<p>为了提高新版本的性能和功能，整个 MDX 体系结构已经过重写。新架构具有:</p>
<ul>
<li>更快的错误标记</li>
<li>更好的 MDX 语法</li>
<li>支持更多的运行时和包</li>
</ul>
<p>但是最令人兴奋的特性是改进的<a href="https://www.telerik.com/blogs/asts-markdown-and-mdx" target="_blank" rel="noopener">抽象语法树(AST) </a>。新的 AST 更详细地描述了 MDX v2 语法，这将通过允许插件以新的方式增强 MDX 来改善 MDX 周围的生态系统，并帮助 MDX 解决以前可能导致崩溃的边缘情况。</p>
<p>MDX 团队声称，改进的架构比以前的版本编译时间快 25 %,生成代码的速度快 100 %,包的大小比使用 MDX v1 编写的包小 250%。</p>
<p>您可以在发行说明中了解更多关于改进架构的信息。</p>
<h2 id="typescript-support">类型脚本支持</h2>
<p>改进的 MDX 体系结构还提供了 TypeScript 支持。根据 MDX 团队的说法，</p>
<blockquote><p>所有的<a href="https://mdxjs.com/packages/" target="_blank" rel="noopener"> @mdx-js/*包</a>现在都通过 JSDoc 注释用 TypeScript 完全类型化了。这意味着我们的 API 是作为 TypeScript 类型公开的，而且我们的项目在内部是类型安全的。</p></blockquote>
<p>要为 MDX 文档添加 TypeScript 支持，请安装<a href="https://github.com/DefinitelyTyped/DefinitelyTyped/tree/HEAD/types/mdx" target="_blank" rel="noopener"> @types/mdx </a>。</p>
<pre class="language-bash hljs">npm install @types/mdx
</pre>
<p>TypeScript 应该在安装后自动获取 MDX 文档。</p>
<h2 id="migrating-react-vue-preact-apps-mdx-v2">将 React、Vue 和 Preact 应用迁移到 MDX v2</h2>
<p>在将您的应用迁移到 MDX v2 之前，请确保您使用的是最新版本的 React、Preact 或 Vue 3。此外，请注意，没有 ESM 支持的工具将无法在 MDX v2 中工作，您可以在此了解有关 MDX v2 ESM 支持的更多信息<a href="https://mdxjs.com/docs/troubleshooting-mdx/#esm" target="_blank" rel="noopener">。</a></p>
<p>您可以使用以下命令更新 React 版本。</p>
<pre class="language-bash hljs">npm install --save <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="681a0d090b1c2804091c0d1b1c">[email protected]</a>
</pre>
<p>然后，用下面的命令安装<a href="https://mdxjs.com/packages/react/" target="_blank" rel="noopener"> (@mdx-js/react) </a>。</p>
<pre class="language-bash hljs">npm install @mdx-js/react 
</pre>
<p>要将 MDX v2 添加到 Vue CLI，首先，使用以下命令更新您的 Vue 应用程序。</p>
<pre class="language-bash hljs">npm update -g @vue/cli
</pre>
<p>用下面的命令安装<a href="https://mdxjs.com/packages/vue/" target="_blank" rel="noopener"> (@mdx-js/vue) </a>。</p>
<pre class="language-bash hljs">npm install @mdx-js/vue 
</pre>
<p>要将 MDX v2 添加到 Preact 应用程序中，首先要安装 Preact 的最新版本。</p>
<pre class="language-bash hljs">npm install preact
</pre>
<p>然后用下面的命令安装<a href="https://mdxjs.com/packages/preact/" target="_blank" rel="noopener"> (@mdx-js/preact) </a>。</p>
<pre class="language-bash hljs">npm install  @mdx-js/preact
</pre>
<p>有关如何从 MDX v1 迁移到 MDX v2 的更多说明，请访问<a href="https://mdxjs.com/migrating/v2/#mdx-jsloader" target="_blank" rel="noopener"> MDX 迁移指南</a>。</p>
<h2 id="possible-mdx-v2-breaking-changes">可能的 MDX v2 突破性更改</h2>
<p>由于新的语法，升级到新版本后，您可能会从 MDX 文件中得到错误。仔细研究错误消息，了解您遇到了什么错误以及如何修复这些错误。以下是一些常见的问题:</p>
<ul>
<li><code>Could not parse import/exports with acorn: $error</code> —当您使用无效的<code>import</code>或<code>export</code>语句时，会出现这种情况</li>
<li><code>Unexpected end of file in expression, expected a corresponding closing brace for `{`: $error</code> —当有左花括号而没有右花括号时，会出现这种情况</li>
<li><code>Could not parse expression with acorn: $error</code> —当花括号内的表达式无效时，会出现这种情况</li>
<li>当花括号中的表达式过多时，就会出现这种情况</li>
</ul>
<p>更多错误及解决方法，请参见<a href="https://mdxjs.com/docs/troubleshooting-mdx/" target="_blank" rel="noopener"> MDX v2 故障排除指南</a>。</p>
<h3>ESM 支持的迁移问题</h3>
<p>如果您在将 MDX v2 与特定工具集成时遇到问题，这很可能是因为 MDX v2 ESM 支持。与 MDX v1 不同，MDX v2 只能与支持 ESM 的工具一起使用。您可以在此了解有关 MDX v2 ESM 支持<a href="https://mdxjs.com/docs/troubleshooting-mdx/#esm" target="_blank" rel="noopener">的更多信息。</a></p>
<h2>结论</h2>
<p>在本文中，我们讨论了新发布的 MDX v2。我们讨论了架构和语法的改进，它们可能的突破性变化，以及如何在 React、Vue 和 Preact 应用程序中迁移到新版本。</p>
<p>新发布的 MDX v2 为 MDX 语言带来了一些急需的改进。由于减少了解析问题，改进的语法应该使 MDX 更便于使用。对更多 JSX 运行时的支持也应该增加它被更多前端框架采用的可能性。</p>
<p>更多的改进还在后面——现在，我们知道对带有<a href="https://github.com/mdx-js/mdx/issues/1046" target="_blank" rel="noopener"> <code>let/const/var</code>的 JavaScript 变量声明的支持预计将在 v2.1 </a>中发布，而<a href="https://github.com/mdx-js/mdx/issues/741" target="_blank" rel="noopener"> MDX 插件</a>预计将在 v2.2 中发布</p>
<p>要了解更多信息，您可以访问<a href="https://github.com/mdx-js/mdx/issues/1041" target="_blank" rel="noopener"> GitHub </a>上的 MDX 发布说明。</p><div class="code-block code-block-1">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket 会告诉您应用程序中实际影响用户的最具影响力的 bug 和 UX 问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket 自动聚合客户端错误、JS 异常、前端性能指标和用户交互。然后 LogRocket 使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的 bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试 LogRocket】。</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>