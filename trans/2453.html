<html>
<head>
<title>Using FlutterGen code generator in Flutter - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在 Flutter - LogRocket 博客中使用 FlutterGen 代码生成器</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/using-fluttergen-code-generator-flutter/#0001-01-01">https://blog.logrocket.com/using-fluttergen-code-generator-flutter/#0001-01-01</a></blockquote><div><article class="article-post">
<p>那些已经开发了原生 Android 应用的人可能会在尝试使用 Flutter 中的资产时畏缩不前。作为一名 Flutter 开发人员，您别无选择，只能在代码中直接使用字符串来引用它们。例如，处理图像并不容易，因为您必须通过它们的路径字符串来引用它们。</p>
<p>Android 应用程序开发环境有一个工具，可以帮助您将所有资产转换为类型安全的变量，这些变量可以在代码中的任何地方引用。这个工具有很多好处，包括:</p>
<ul>
<li>当提到你的资产时，减少拼写错误的风险。如果出现拼写错误，它们会出现在一个地方，这样更容易调试</li>
<li>轻松跟踪您的资产在代码中的使用位置</li>
<li>轻松识别代码中未使用的资产</li>
<li>还有更多！</li>
</ul>
<p>Flutter 没有提供这种现成的工具。幸运的是，有<a href="https://github.com/FlutterGen/flutter_gen" target="_blank" rel="noopener"> FlutterGen </a>，这是一个为你的资产提供的 Flutter 代码生成器，可以帮助你删除应用程序中所有基于字符串的 API。</p>
<p>在本文中，您将了解如何在您的 Flutter 应用程序中使用 FlutterGen。</p>
<h2>介绍</h2>
<p>资产是与您的应用程序一起捆绑和部署的任何文件，以便在运行时访问。资产可以是以下形式:</p>
<ul>
<li>形象</li>
<li>动画片</li>
<li>字体</li>
<li>配置文件</li>
<li>静态数据，例如文本或 JSON 文件</li>
</ul>
<p>要在 Flutter 应用程序中加载资产，您必须使用路径字符串引用资产，这是不安全的。<a href="https://github.com/FlutterGen/flutter_gen" target="_blank" rel="noopener"> FlutterGen </a>包通过为您的所有资产生成代码，帮助您删除应用程序中所有基于字符串的 API。</p>
<p>使用 FlutterGen 非常简单:</p>
<ol>
<li>你像平常一样在<code>pubspec.yaml</code>文件中申报资产；不需要其他配置</li>
<li>默认情况下，FlutterGen 将在<code>lib/gen</code>目录下生成相关的 Dart 文件</li>
<li>然后，您可以使用生成的类加载您的资产</li>
</ol>
<p>以下是您可以配置的可用解析器:</p>
<ul>
<li>资产—该配置在<code>lib/gen</code>下生成<code>assets.gen.dart</code>文件</li>
<li>字体—该配置在<code>lib/gen</code>下生成<code>fonts.gen.dart</code>文件</li>
<li>颜色—该配置在<code>lib/gen</code>下生成<code>colors.gen.dart</code>文件</li>
</ul>
<p>在处理动画等资源时，FlutterGen 提供了以下集成:</p>

<p>我们来试试吧！</p>
<h2>入门指南</h2>
<p>为了跟进，你可以<a href="https://github.com/Ivy-Walobwa/flutter_gen_demo" target="_blank" rel="noopener">在这里</a>获得入门应用。该应用程序在根目录的<code>assets</code>文件夹下添加了以下资产:</p>
<ul>
<li>动画— <code>.riv</code>文件</li>
<li>字体— <code>.ttf</code>文件</li>
<li>图像— <code>.png</code>和<code>.svg</code>文件</li>
<li>JSON — <code>.json</code>文件</li>
<li>视频— <code>.mp4</code></li>
</ul>
<p>按照文件夹结构中所示的类型对资产进行分组是一种很好的做法。</p>
<p>下面是文件夹结构和应用外观:</p>
<p><img data-attachment-id="81712" data-permalink="https://blog.logrocket.com/using-fluttergen-code-generator-flutter/fluttergen-folder-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png" data-orig-size="607,452" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="FlutterGen folder structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure-300x223.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png" decoding="async" class="size-full wp-image-81712 aligncenter jetpack-lazy-image" src="../Images/34ea1e72d25c351cdd9fb7e5489e537e.png" alt="FlutterGen Folder Structure" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png 607w, https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure-300x223.png 300w" data-lazy-sizes="(max-width: 607px) 100vw, 607px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="81712" data-permalink="https://blog.logrocket.com/using-fluttergen-code-generator-flutter/fluttergen-folder-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png" data-orig-size="607,452" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="FlutterGen folder structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure-300x223.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png" decoding="async" loading="lazy" class="size-full wp-image-81712 aligncenter" src="../Images/34ea1e72d25c351cdd9fb7e5489e537e.png" alt="FlutterGen Folder Structure" srcset="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png 607w, https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure-300x223.png 300w" sizes="(max-width: 607px) 100vw, 607px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-folder-structure.png"/></noscript>
<p><img data-attachment-id="81714" data-permalink="https://blog.logrocket.com/using-fluttergen-code-generator-flutter/fluttergen-demo-assets/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets.gif" data-orig-size="288,640" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="FlutterGen demo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets-135x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets.gif" decoding="async" class="size-full wp-image-81714 aligncenter jetpack-lazy-image" src="../Images/683f94774ca96684280141efc23f545b.png" alt="FlutterGen Demo" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="81714" data-permalink="https://blog.logrocket.com/using-fluttergen-code-generator-flutter/fluttergen-demo-assets/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets.gif" data-orig-size="288,640" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="FlutterGen demo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets-135x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets.gif" decoding="async" loading="lazy" class="size-full wp-image-81714 aligncenter" src="../Images/683f94774ca96684280141efc23f545b.png" alt="FlutterGen Demo" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/12/fluttergen-demo-assets.gif"/></noscript>
<p>资产已加载到应用程序中，但带有路径字符串。您将为资产生成代码，并使用静态变量来访问它们。您可以在 FlutterGen 分支中找到带有生成代码的最终应用程序。</p>
<p>接下来了解如何开始使用 FlutterGen。</p>
<h2>设置 FlutterGen</h2>
<p>要在应用程序中设置 FlutterGen:</p>
<h3>安装 FlutterGen</h3>
<p>您可以通过多种方式安装 FlutterGen:</p>
<ul>
<li>使用自制软件</li>
<li>全局添加</li>
<li>作为<code>build_runner</code>的一部分</li>
</ul>
<p>我们将把它作为<code>build_runner</code>的一部分来安装。</p>
<p>将<code>build_runner</code>和<code>flutter_gen</code>作为<code>dev_dependencies</code>的一部分添加到<code>pubspec.yaml</code>文件中:</p>
<pre class="language-dart hljs">dev_dependencies:
  build_runner:
  flutter_gen_runner:</pre>
<p>在您的根应用程序目录中运行以下命令来安装 FlutterGen:</p>
<pre class="language-bash hljs">$ flutter pub get</pre>
<h3>使用 FlutterGen</h3>
<p>在您的<code>pubspec.yaml</code>文件中指定资产，如下所示:</p>
<pre class="language-dart hljs">flutter:
  uses-material-design: true
  assets:
    - assets/images/
    - assets/video/
    - assets/animations/
    - assets/json/

  fonts:
    - family: RobotoMono
      fonts:
        - asset: assets/fonts/RobotoMono-Regular.ttf
        - asset: assets/fonts/RobotoMono-Bold.ttf
          weight: 700
        - asset: assets/fonts/RobotoMono-Italic.ttf
          style: italic
</pre>
<p>注意使用的解析器的类型，<code>assets</code>和<code>fonts</code>。<a href="https://github.com/Ivy-Walobwa/flutter_gen_demo" target="_blank" rel="noopener">启动应用</a>包含资源和字体。</p>
<h4>为资产生成代码</h4>
<p>在您的根应用程序目录中运行<code>flutter packages pub run build_runner build</code>。该命令将在<code>lib/gen</code>文件夹中生成相关资产的文件。在这种情况下，因为指定了两个解析器，<code>assets</code>和<code>fonts</code>，所以为每个解析器生成两个文件:</p>
<ul>
<li><code>assets.gen.dart</code> —包含为您的图像、视频、动画和 JSON 资产生成的代码</li>
<li><code>fonts.gen.dart</code> —包含为字体资源生成的代码</li>
</ul>
<h4>使用生成的代码</h4>
<p>您必须将文件导入添加到相关的布局文件中:</p>
<pre class="language-dart hljs">import '../gen/assets.gen.dart';
import '../gen/fonts.gen.dart';
</pre>
<p>根据您如何命名您的资产文件，将创建一个类来读取其路径字符串。</p>
<p>例如，如果我们以下面的格式添加了一个视频，就会创建一个 string 类并可以访问它:</p>
<pre class="language-dart hljs">// getter
String get bee =&gt; 'assets/video/bee.mp4';

// static variable
static const String robotoMono = 'RobotoMono';
</pre>
<p>现在，您已经为您的资产生成了代码，告别输入错误，使用代码中生成的静态变量。</p>
<p>接下来，您将学习如何在布局文件中处理生成的代码。</p>
<h2>使用图像</h2>
<p>如果 Flutter 支持添加的图像的格式，就会生成一个<code>Image</code>类。<br/>对于您的情况，图像路径是<code>assets/images/add_color.png</code>。您可以按以下格式加载图像:</p>
<ul>
<li><code>Assets.images.addcolor</code> —实现<code>AssetImage</code>类</li>
<li><code>Assets.images.addcolor.image(...)</code> —返回<code>Image</code>类</li>
<li><code>Assets.images.addcolor.path</code> —返回路径字符串</li>
</ul>
<p>在起始代码中，用生成的路径替换图像路径:</p>
<pre class="language-dart hljs">// with string APIs
Image.asset(
  "assets/images/add_color.png",
  height: 400,
  width: 400,
),

// with generated path - option 1
Image.asset(
 Assets.images.addColor.path,
  height: 400,
  width: 400,
),

// with generated image class- option 2
Assets.images.addColor.image(width: 400, height: 400),
</pre>
<p>您也可以使用<code>.svg</code>图像文件。在这种情况下也创建了<code>svg</code>类。您将实现<code>flutter_svg</code>集成来加载您的<code>.svg</code>文件:</p>
<h3>在您的<code>pubspec.yaml</code>文件中启用集成</h3>
<p>默认情况下，FlutterGen 积分设置为<code>false</code>。要使用它们，您必须将它们的值设置为<code>true</code>。</p>
<pre class="language-dart hljs">flutter_gen:
  integrations:
    flutter_svg: true
flutter:
</pre>
<p>每当对<code>pubspec.yaml</code>进行更改时，运行以下代码:</p>
<pre class="language-bash hljs">flutter pub get

flutter packages pub run build_runner build
</pre>
<p>最后，向应用程序添加一个 SVG 图像:</p>
<pre class="language-dart hljs">// with string APIs
SvgPicture.asset(
  "assets/images/book_lover.svg",
  height: 300,
  width:300,
),

// with generated SVG class
Assets.images.bookLover.svg(width: 300, height: 300),
</pre>
<h2>使用视频</h2>
<p>对于<a href="https://blog.logrocket.com/flutter-video-player/" target="_blank" rel="noopener">视频</a>，可以从创建的字符串类中读取路径字符串:</p>
<pre class="language-dart hljs">// with string APIs
_videoController = VideoPlayerController.asset("assets/video/bee.mp4");

// with generated path string
_videoController = VideoPlayerController.asset(Assets.video.bee);
</pre>
<h2>使用动画</h2>
<p>对于动画和图像，创建了一个类:<code>rive</code>，在本例中，我们使用了一个<code>.rive</code>文件。您还必须启用<code>rive</code>集成:</p>
<pre class="language-dart hljs">flutter_gen:
  integrations:
    flutter_svg: true
    rive: true
</pre>
<p>您可以像访问图像一样访问动画:</p>
<pre class="language-dart hljs">// with string APIs
RiveAnimation.asset(
  "assets/animations/vehicles.riv",
  controllers: [_animationController],
  animations: const ['idle', 'curves'],
),

// with generated path - option 1
RiveAnimation.asset(
  Assets.animations.vehicles.path,
  controllers: [_animationController],
  animations: const ['idle', 'curves'],
),

// with generated rive class - option 2
Assets.animations.vehicles.rive(
    controllers: [_animationController],
    animations: const ['idle', 'curves'],
  ),
),
</pre>
<h2>使用字体</h2>
<p>生成的字体名称被分配给一个<code>FontFamily</code>类中的静态变量，可通过您的应用程序访问:</p>
<pre class="language-dart hljs">// with string APIs
const Text(
  "This is RobotoMono font - medium",
  style: TextStyle(fontFamily: 'RobotoMono'),
),

// with generated variable
const Text(
  "This is RobotoMono font - medium",
  style: TextStyle(fontFamily: FontFamily.robotoMono),
</pre>
<h2>使用静态数据</h2>
<p>文本和 JSON 等静态数据的路径被分配给 getters，可以从您的应用程序中读取:</p>
<pre class="language-dart hljs">// with string APIs
final String response = await rootBundle.loadString("assets/json/assets_tye.json");
final data = await json.decode(response);

// with generated path
final String response = await rootBundle.loadString(Assets.json.assetsTye);
final data = await json.decode(response);
</pre>
<h2>更改代码生成风格</h2>
<p>默认情况下，FlutterGen 包使用点分隔符样式为您的资产生成代码:<br/> <code>Assets.video.bee</code>。支持其他风格的代码生成。其中包括:</p>
<ul>
<li><code>snake-case</code> —作为<code>Assets.video_bee</code>访问的资产</li>
<li><code>camel-case</code> —作为<code>Assets.videoBee</code>访问的资产</li>
</ul>
<p>要改变代码生成风格，您必须在您的<code>pubspec.yaml</code>文件中指定<code>style</code>:</p>
<pre class="language-dart hljs">flutter_gen:
  integrations:
    flutter_svg: true
    rive: true

  assets:
    enabled: true
    # Avaliable values:
    # - camel-case
    # - snake-case
    # - dot-delimiter
    style: dot-delimiter
</pre>
<h2>结论</h2>
<p>您已经了解了资产的类型，以及在 Flutter 中如何使用字符串路径访问它们。现在，您可以安装并使用 FlutterGen 来:</p>
<ul>
<li>移除整个应用程序中对资源的字符串引用</li>
<li>生成资产类别和静态变量</li>
<li>以类型安全的方式加载资产</li>
<li>定制资产生成的风格</li>
</ul>
<p>你可以在<a href="https://github.com/FlutterGen/flutter_gen" target="_blank" rel="noopener"> GitHub </a>上查看 FlutterGen。我们希望你喜欢这个教程！</p><div class="code-block code-block-1">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket 会告诉您应用程序中实际影响用户的最具影响力的 bug 和 UX 问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket 自动聚合客户端错误、JS 异常、前端性能指标和用户交互。然后 LogRocket 使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的 bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试 LogRocket】。</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>