<html>
<head>
<title>The complete guide to toLocaleString in Node.js - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Node.js - LogRocket 博客中的 toLocaleString 完全指南</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/complete-guide-tolocalestring-node-js/#0001-01-01">https://blog.logrocket.com/complete-guide-tolocalestring-node-js/#0001-01-01</a></blockquote><div><article class="article-post">
<h2>介绍</h2>
<p>世界上使用的不同语言非常多样化。语言不仅在词汇上不同，在句子和单词结构上也不同。这些变化引发了 web 开发人员以对语言敏感的格式呈现信息的需求。</p>
<p><code>toLocaleString</code>方法是一种方便的功能，用于对日期、数字、时间、货币和数据结构(如 JavaScript 中的数组和类型化数组)进行语言敏感的格式化。<code>toLocaleString</code>方法使用环境的默认语言环境进行格式化。但是，您可以使用它来格式化不同于默认语言的语言。</p>
<p>这样做是必要的，不仅是因为上面强调的不同语言之间的差异，而且是因为同一种语言中存在的差异。同一种语言有几种方言和地区差异是很常见的，比如英语，世界各地说的都略有不同。</p>
<p>本文将向您介绍<code>toLocaleString</code>方法，并解释如何在 Node 中使用它。</p>
<h3>内容</h3>

<h2 id="introduction-tolocalestring-method"><code>toLocaleString</code>方法介绍</h2>
<p>正如在简介中已经提到的，<code>toLocaleString</code>用于将日期、数字、时间、货币以及一些数据类型和数据结构转换成对语言敏感的字符串表示。</p>
<p>不管对象是什么，都可以使用<code>toLocaleString</code>方法。它将<code>locales</code>和<code>options</code>对象作为参数。两个参数都是可选的。如果不传递它们，运行时将使用缺省值:</p>
<pre class="language-javascript hljs">toLocaleString(locales, options)
</pre>
<p>如果您想要一个不同于默认语言环境的语言环境，<code>locales</code>参数应该是一个语言标签或者是一个语言标签数组。一个语言标签，通常被称为 BCP 47 语言标签，通常是由一个连字符分隔的一个或多个子标签的序列。语言标签中唯一需要的子标签是主要语言子标签。</p>
<p>但是，有些语言具有附加属性，您可以使用这些属性来缩小由“主要语言”子标签标识的语言范围。一个典型的例子是英语，它因地区而异。英语的主要语言子标签是<code>en</code>。</p>
<p>由于地区差异，您可以使用 region 子标签将其缩小到英语的特定变体。下表显示了一些英语语言标签以及相应的主要和地区子标签。</p>
<table>
<colgroup>
<col/>
<col/>
<col/>
<col/> </colgroup>
<thead>
<tr>
<th>语言标签</th>
<th>主要语言子标签</th>
<th>区域子标签</th>
<th>地区</th>
</tr>
</thead>
<tbody>
<tr>
<td>en-GB</td>
<td>（构成动词）表示“使处于…状态”</td>
<td>千兆字节</td>
<td>联合王国</td>
</tr>
<tr>
<td>en-US</td>
<td>（构成动词）表示“使处于…状态”</td>
<td>美国</td>
<td>美国人</td>
</tr>
<tr>
<td>恩奥(奥省)</td>
<td>在中</td>
<td>你好</td>
<td>澳大利亚</td>
</tr>
</tbody>
</table>
<p>您还可以为支持它们的语言添加变体和脚本子标记。<a href="http://www.iana.org/assignments/language-subtag-registry" target="_blank" rel="noopener"> IANA 语言子标签注册表</a>包含一个子标签列表。如果您传递一个区域设置数组，请从最高优先级到最低优先级排列它们；如果支持，运行库将使用第一个区域设置，然后在列表中下移。</p>
<p><code>options</code>参数是用于定制<code>toLocaleString</code>方法行为的对象。它的属性很大程度上取决于要格式化的数据类型；格式化数字的选项不同于日期和时间对象的选项。</p>
<h2 id="how-to-use-tolocalestring-method-numbers">如何使用数字的<code>toLocaleString</code>方法</h2>
<p>正如前面几节所指出的，您可以使用<code>toLocaleString</code>方法来生成数字的区域识别字符串表示。您可以用它来表示科学和工程符号中的普通数字、追加单位、显示百分比和格式化货币。</p>
<p>如前几节所述，<code>toLocaleString</code>有两个可选参数。用它来格式化数字也不例外。</p>
<h3 id="how-to-format-currencies">如何格式化货币</h3>
<p>使用<code>toLocaleString</code>方法，您可以使用作为第一个参数传递的语言约定将数字格式化为货币。为此，您需要将第二个参数的<code>style</code>属性设置为<code>currency</code>。</p>
<p>您还必须将<code>currency</code>属性的值设置为<a href="https://www.six-group.com/en/products-services/financial-information/data-standards.html#scrollTo=currency-codes" target="_blank" rel="noopener"> ISO 4217 货币代码</a>之一，否则会出现错误。下面的代码展示了如何使用<code>toLocaleString</code>进行货币格式化:</p>
<pre class="language-javascript hljs">console.log(
  (-15000).toLocaleString("en-US", {
    style: "currency",
    currency: "USD",
    currencySign: "accounting",
  })
); // =&gt; ($15,000.00)

console.log(
  (15000).toLocaleString("en-US", { style: "currency", currency: "JPY" })
); // =&gt; ¥15,000

console.log(
  (15000).toLocaleString("fr-FR", { style: "currency", currency: "JPY" })
); // =&gt; 15 000 JPY

console.log(
  (15000).toLocaleString("fr-FR", {
    style: "currency",
    currency: "JPY",
    currencyDisplay: "name",
  })
); // =&gt; 15 000 yens japonais

console.log(
  (15000).toLocaleString("en-GB", {
    style: "currency",
    currency: "USD",
    currencyDisplay: "narrowSymbol",
    currencySign: "accounting",
  })
); // =&gt; $15,000.00
</pre>
<p>如上面代码中的第一个示例所示，将<code>currencySign</code>属性设置为<code>accounting</code>将格式化一个负数，并将其用一对括号括起来。<code>currencySign</code>属性的默认值为<code>standard</code>。</p>
<h3 id="how-to-format-numbers-scientific-engineering-notation">如何在科学和工程符号中格式化数字</h3>
<p>您还可以使用<code>toLocaleString</code>方法用简单的科学和工程符号来表示数字。可以通过将 options 参数的<code>notation</code>属性设置为<code>scientific</code>、<code>engineering</code>或<code>compact</code>来实现。默认值为<code>standard</code>，用于普通数字格式。</p>
<p>以下是如何在给定的语言环境中用简单的科学、工程和简洁的符号表示数字的示例:</p>
<pre class="language-javascript hljs">console.log(
  Math.LOG10E.toLocaleString("fr-FR", {
    notation: "scientific",
    maximumSignificantDigits: 5,
  })
); // =&gt; 4,3429E-1

console.log(
  Math.PI.toLocaleString("en-US", {
    notation: "compact",
    compactDisplay: "short",
  })
); // =&gt; 3.1

console.log(
  Math.E.toLocaleString("de-DE", {
    notation: "standard",
    maximumFractionDigits: 5,
  })
); // =&gt; 2,71828

console.log(
  (0.0034595).toLocaleString("en-US", {
    notation: "engineering",
    minimumSignificantDigits: 2,
    maximumSignificantDigits: 3,
  })
); // =&gt; 3.46E-3

console.log((2000).toLocaleString("en-US", { notation: "scientific" })); // =&gt; 2E3

console.log((2000).toLocaleString("en-US", { notation: "standard" })); // =&gt; 2,000
</pre>
<p>查看文档以获得科学和工程格式选项的完整列表。</p>
<h3 id="how-to-format-units">如何格式化单位</h3>
<p>您可以使用<code>toLocaleString</code>方法通过将第二个参数的<code>style</code>属性设置为<code>unit</code>来追加和格式化单元。这些单元可以是简单的，也可以是复合的。ECMAScript 标准有一个当前支持的简单单位的完整列表，比如英里、小时、秒、比特和字节。</p>
<p>另一方面，您可以通过使用<code>-per-</code>分隔符连接两个受支持的简单单元来生成复合单元。例如，<code>mile-per-hour</code>复合单元是<code>mile</code>和<code>hour</code>简单单元的衍生物。</p>
<p>如果您传递一个简单单元或一个由不允许在 ECMAScript 中使用的简单单元组成的复合单元，Node 将抛出一个错误:</p>
<pre class="language-javascript hljs">console.log(
  (80).toLocaleString("en-GB", {
    style: "unit",
    unit: "mile-per-hour",
    unitDisplay: "long",
  })
); // =&gt; 80 miles per hour

console.log(
  (80).toLocaleString("en-GB", {
    style: "unit",
    unit: "mile-per-hour",
    unitDisplay: "narrow",
  })
); // =&gt; 80mph

console.log(
  (80).toLocaleString("en-GB", {
    style: "unit",
    unit: "mile-per-hour",
    unitDisplay: "short",
  })
); // =&gt; 80 mph

console.log(
  (40).toLocaleString("de-DE", {
    style: "unit",
    unit: "kilobyte-per-second",
    unitDisplay: "narrow",
  })
); // =&gt; 40 kB/s

console.log(
  (80).toLocaleString("en-US", {
    style: "unit",
    unit: "megabyte",
  })
); // =&gt; 80 MB
</pre>
<p>使用 options 对象的<code>unitDisplay</code>属性来控制单位的格式。<code>unitDisplay</code>属性取值为<code>long</code>、<code>short</code>和<code>narrow</code>。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自 LogRocket 的精彩文章:</h3>

<hr/></div>
<p>将数字表示为百分比类似于追加单位。但是，您需要将<code>style</code>属性的值设置为<code>percent</code>:</p>
<pre class="language-javascript hljs">console.log(
  (0.56).toLocaleString("de-DE", {
    style: "percent",
  })
); // 56 %

console.log(
  (200).toLocaleString("en-US", {
    style: "percent",
  })
); // 20,000%
</pre>
<h2 id="how-to-use-tolocalestring-method-dates-times">如何使用带有日期和时间的<code>toLocaleString</code>方法</h2>
<p>与数字一样，您也可以使用<code>toLocaleString</code>方法进行日期和时间格式化。像往常一样，<code>locales</code>参数是 BCP 47 语言标签的一个字符串或者这样的字符串的一个数组。<code>options</code>参数是一个可以用来定制<code>toLocaleString</code>行为的对象。</p>
<p>它有几个日期和时间格式的属性。我们不会在这里一一介绍。但是，下面是一些您可能会使用的常见属性以及它们在指定语言环境下的预期输出:</p>
<pre class="language-javascript hljs">const date = new Date(2011, 3, 10, 10, 30, 10);

console.log(
  date.toLocaleString("en-US", {
    dateStyle: "long",
    timeStyle: "long",
  })
); // =&gt; April 10, 2011 at 10:30:10 AM GMT+3

console.log(
  date.toLocaleString("en-US", {
    dateStyle: "long",
    timeStyle: "long",
    calendar: "ethiopic",
  })
); // =&gt; Miazia 2, 2003 ERA1 at 10:30:10 AM GMT+3

console.log(
  date.toLocaleString("en-US", {
    timeZone: "America/Chicago",
    dayPeriod: "short",
    year: "numeric",
    month: "long",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit",
    timeZoneName: "long",
  })
); // =&gt; April 10, 2011 at 02:30:10 at night Central Daylight Time
</pre>
<p>请注意，可以同时使用的 options 对象的属性是有限制的。例如，您可以一起使用<code>dateStyle</code>和<code>timeStyle</code>属性，但不能与<code>hour</code>、<code>month</code>和<code>weekday</code>等属性一起使用。您需要查看文档以了解 options 对象的哪些属性不能一起使用。</p>
<p>除了通常的日期和时间格式，您还可以在特定的日历中设置日期格式。下面的代码显示了我在埃塞俄比亚日历中的当地日期。如果你不熟悉，埃塞俄比亚历法大约比广泛使用的公历晚八年。</p>
<p>当我写这篇文章的时候，公历是 2022 年，而埃塞俄比亚历是 2014 年。您可以在文档中查找几种受支持的日历:</p>
<pre class="language-javascript hljs">console.log(
  new Date().toLocaleString("en-US", {
    calendar: "ethiopic",
    dateStyle: 'full'
  })
); // Thursday, Sene 2, 2014 ERA1
</pre>
<h2 id="how-to-use-tolocalestring-method-arrays">如何对数组使用<code>toLocaleString</code>方法</h2>
<p>当您对数组使用<code>toLocaleString</code>时，您会得到一个表示数组元素的字符串。您可以传入前面章节中描述的<code>locales</code>和<code>options</code>参数。如果数组的元素是数字，您可以使用数字格式选项或日期和时间格式选项(如果它们是日期对象):</p>
<pre class="language-javascript hljs">const nums = [1200, 3000, 4500];
console.log(
  nums.toLocaleString("de-DE", {
    style: "unit",
    unit: "liter",
    unitDisplay: "narrow",
  })
); // 1.200 l,3.000 l,4.500 l
</pre>
<p>在上面的例子中，我们使用了<code>toLocaleString</code>方法来格式化<code>de-DE</code>地区的数字数组。</p>
<h2 id="introduction-intl-interface"><code>Intl</code>界面介绍</h2>
<p>虽然本文的重点是在<code>toLocaleString</code>方法上，但是<code>Intl</code>是另一个强大的接口，用于数字、日期和时间的语言敏感的字符串表示。它的用法非常类似于<code>toLocaleString</code>法。</p>
<p><code>Intl</code>接口有像<code>Intl.NumberFormat</code>和<code>Intl.DateTimeFormat</code>这样的构造函数，可以用来格式化数字和字符串，而不是使用<code>toLocaleString</code>方法。在使用构造函数像<code>toLocaleString</code>方法一样进行格式化之前，创建一个构造函数的实例。构造函数将区域设置和选项作为参数，如<code>toLocaleString</code>:</p>
<pre class="language-javascript hljs">const numberFormat = new Intl.NumberFormat(locale, options);
const dateTimeFormat = new Intl.DateTimeFormat(locale, options);
</pre>
<p>下面的代码说明了如何使用<code>Intl.NumberFormat</code>构造函数格式化数字:</p>
<pre class="language-javascript hljs">console.log(new Intl.NumberFormat('en-GB', { style: 'unit', unit: 'kilobyte-per-second'}).format(20)) // 20 kB/s
</pre>
<p>与<code>toLocaleString</code>方法不同，您将 locale 和 options 参数传递给构造函数并调用<code>format</code>实例方法。与<code>toLocaleString</code>一样，两者都是可选参数。</p>
<h2>结论</h2>
<p>在 JavaScript 中，<code>toLocaleString</code>方法是可以用于区分语言的数字、货币、日期和时间格式的功能之一。虽然不太常见，但也可以用它来格式化数组和类型化数组。</p>
<p>它的用法包括将区域设置或区域设置数组作为第一个参数传递，将 options 对象作为第二个参数传递，以定制<code>toLocaleString</code>方法的行为。但是，参数是可选的。如果您不传递它们，Node 将使用缺省值。</p>
<p>日期和数字<code>toLocaleString</code>方法与<code>Intl</code>接口的相应构造函数有很多共同之处。因为它们被用于相同的目的，并接受相同的参数，所以您需要阅读<code>Intl</code>接口构造函数的文档，以获得对<code>toLocaleString</code>的更多了解。</p><div class="code-block code-block-23">
<div class="blog-plug inline-plug node-plug"><h2>200 只<img src="../Images/61167b9d027ca73ed5aaf59a9ec31267.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png"/> <noscript> <img data-lazy-fallback="1" src="../Images/61167b9d027ca73ed5aaf59a9ec31267.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png"/> </noscript>显示器出现故障，生产中网络请求缓慢</h2><p>部署基于节点的 web 应用程序或网站是容易的部分。确保您的节点实例继续为您的应用程序提供资源是事情变得更加困难的地方。如果您对确保对后端或第三方服务的请求成功感兴趣，</p><a href="https://lp.logrocket.com/blg/node-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer"><img src="../Images/cae72fd2a54c5f02a6398c4867894844.png" alt="LogRocket Network Request Monitoring" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png"/><noscript><img data-lazy-fallback="1" src="../Images/cae72fd2a54c5f02a6398c4867894844.png" alt="LogRocket Network Request Monitoring" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png"/></noscript></a><a href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的 DVR，记录下用户与你的应用程序交互时发生的一切。您可以汇总并报告有问题的网络请求，以快速了解根本原因，而不是猜测问题发生的原因。</p><p>LogRocket 检测您的应用程序以记录基线性能计时，如页面加载时间、到达第一个字节的时间、慢速网络请求，还记录 Redux、NgRx 和 Vuex 操作/状态。</p><a class="signup" href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a><p>. </p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>