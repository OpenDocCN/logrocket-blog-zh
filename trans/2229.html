<html>
<head>
<title>Using React Native Chart Kit to visualize data - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用 React 本地图表工具包来可视化数据- LogRocket 博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/#0001-01-01">https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/#0001-01-01</a></blockquote><div><article class="article-post">
<p>当应用程序的力量在于数据时，以一种好的方式呈现给用户是很重要的。这就是图表库发挥作用的地方。它们允许你以一种吸引人的方式向用户展示数据，从而让他们更多地使用你的应用。</p>
<p>在本教程中，我们将了解 React Native Chart Kit，这是 React Native 的一个图表库。我们将构建一个使用它的应用程序，这样你就可以有一个实际的例子来使用。</p>

<h2 id="building-finance-tracking-app">应用概述:构建财务跟踪应用</h2>
<p>我们将要学习的应用程序是一个财务跟踪应用程序。</p>
<p>这款应用有四个屏幕。其中三个用于用户输入，而最后一个用于图表。我们将主要关注有图表的屏幕，但我们也将简要介绍其他屏幕。</p>
<p>这是三个输入屏幕:</p>
<ul>
<li>创建类别—每个事务的一般分类是一个类别。类别可以是收入，也可以是费用。例如，用户可以创建“互联网账单”作为费用类别，或者“主要工作薪金”作为收入类别</li>
</ul>
<p><img data-attachment-id="70634" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/create-category-page-rn-finance-tracker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png" data-orig-size="350,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Create category page RN finance tracker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker-139x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png" decoding="async" class="size-full wp-image-70634 aligncenter jetpack-lazy-image" src="../Images/7c2850fd732273b68d737fbe1b2ce1c6.png" alt="Create Category Page RN Finance Tracker" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker-139x300.png 139w" data-lazy-sizes="(max-width: 350px) 100vw, 350px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70634" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/create-category-page-rn-finance-tracker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png" data-orig-size="350,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Create category page RN finance tracker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker-139x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png" decoding="async" loading="lazy" class="size-full wp-image-70634 aligncenter" src="../Images/7c2850fd732273b68d737fbe1b2ce1c6.png" alt="Create Category Page RN Finance Tracker" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker-139x300.png 139w" sizes="(max-width: 350px) 100vw, 350px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-category-page-rn-finance-tracker.png"/></noscript>
<ul>
<li>创建基金—允许用户输入他们不同的基金存储。例子包括:实体钱包、电子钱包、储蓄银行账户、股票和密码</li>
</ul>
<p><img data-attachment-id="70636" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/create-fund-page-rn-finance-tracker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png" data-orig-size="350,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Create fund page RN finance tracker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker-139x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png" decoding="async" class="size-full wp-image-70636 aligncenter jetpack-lazy-image" src="../Images/041b3ae482beffbb59177cf46a1ed4d0.png" alt="Create Fund Page RN Finance Tracker" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker-139x300.png 139w" data-lazy-sizes="(max-width: 350px) 100vw, 350px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70636" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/create-fund-page-rn-finance-tracker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png" data-orig-size="350,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Create fund page RN finance tracker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker-139x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png" decoding="async" loading="lazy" class="size-full wp-image-70636 aligncenter" src="../Images/041b3ae482beffbb59177cf46a1ed4d0.png" alt="Create Fund Page RN Finance Tracker" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker-139x300.png 139w" sizes="(max-width: 350px) 100vw, 350px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-fund-page-rn-finance-tracker.png"/></noscript>
<ul>
<li>创建交易—这是用户输入所有交易的地方，以便他们可以跟踪他们的财务状况。例如，当他们在月底拿到工资时，他们可以为它创建一个交易<br/> <img data-attachment-id="70638" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/create-transaction-page-rn-finance-tracker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png" data-orig-size="350,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Create transaction page RN finance tracker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker-139x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png" decoding="async" class="size-full wp-image-70638 aligncenter jetpack-lazy-image" src="../Images/ca58ff78f11a5f13fc17c4f1d55c9a32.png" alt="Create Transaction Page RN Finance Tracker" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker-139x300.png 139w" data-lazy-sizes="(max-width: 350px) 100vw, 350px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png"/> <noscript> <img data-lazy-fallback="1" data-attachment-id="70638" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/create-transaction-page-rn-finance-tracker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png" data-orig-size="350,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Create transaction page RN finance tracker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker-139x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png" decoding="async" loading="lazy" class="size-full wp-image-70638 aligncenter" src="../Images/ca58ff78f11a5f13fc17c4f1d55c9a32.png" alt="Create Transaction Page RN Finance Tracker" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker-139x300.png 139w" sizes="(max-width: 350px) 100vw, 350px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/create-transaction-page-rn-finance-tracker.png"/> </noscript></li>
</ul>
<p>最后一个屏幕是报告屏幕，向用户显示图表:</p>
<p><img data-attachment-id="70640" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/report-screen-rn-finance-tracker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png" data-orig-size="350,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Report screen RN finance tracker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker-139x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png" decoding="async" class="size-full wp-image-70640 aligncenter jetpack-lazy-image" src="../Images/852bed295c4885c471bcace67c346179.png" alt="Report Screen RN Finance Tracker" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker-139x300.png 139w" data-lazy-sizes="(max-width: 350px) 100vw, 350px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70640" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/report-screen-rn-finance-tracker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png" data-orig-size="350,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Report screen RN finance tracker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker-139x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png" decoding="async" loading="lazy" class="size-full wp-image-70640 aligncenter" src="../Images/852bed295c4885c471bcace67c346179.png" alt="Report Screen RN Finance Tracker" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker-139x300.png 139w" sizes="(max-width: 350px) 100vw, 350px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/report-screen-rn-finance-tracker.png"/></noscript>
<h2>设置项目</h2>
<p>设置项目最简单的方法是启动一个新的 React 本地项目:</p>
<pre class="language-bash hljs">npx react-native init RNChartKitFinanceApp
</pre>
<p>完成后，从 GitHub repo 中复制文件。我用的这个 app 的 React 原生版本是<code>0.65.1</code>。如果当你读到这篇文章的时候，有一个更新的版本，一定要用那个来代替。您可以通过替换您的<code>package.json</code>文件中的相应版本来做到这一点。</p>
<p>该应用程序使用以下软件包。如果您想跟随 React Native Chart Kit 开发一个财务跟踪应用程序，请务必遵循其网站上相应的安装步骤:</p>

<p>上面只提到了具有本地依赖性的包。查看 repo 中的<code>package.json</code>文件，获取依赖项的完整列表。</p>
<h2>构建应用程序</h2>
<p>这不是你通常的从头构建教程，所以我们可以专注于主题:React 原生图表工具包。</p>
<p>我们将不再浏览创建类别、基金和交易的屏幕。我们也不会经历 React 导航和 React 原生纸的设置。你可以简单地查看回购协议。</p>
<p>相反，我们将只关注报告屏幕和获取数据的查询。</p>
<h3>SQLite 数据库</h3>
<p>让我们首先来看看我们是如何使用数据库的。如前所述，我们使用 React Native SQLite 存储库来本地管理我们自己的 SQLite 数据库。</p>
<p>我们只需要库中的三个方法:<code>enablePromise()</code>和<code>openDatabase()</code>:</p>
<pre>// data/db-service.js
import {
  enablePromise,
  openDatabase,
} from 'react-native-sqlite-storage';
</pre>
<p><code>enablePromise()</code>是为了在执行不同的方法时能够处理承诺:</p>
<pre>enablePromise(true);
</pre>
<p><code>openDatabase()</code>用于在操作系统分配给应用的本地存储上创建和打开数据库文件。如果文件已经存在，那么它将简单地打开文件:</p>
<pre>export const getDBConnection = async () =&gt; {
  return openDatabase({name: 'finance-data.db', location: 'default'});
};
</pre>
<p>创建一个表只需要知道要执行的查询，然后调用<code>db</code>对象上的<code>executeSql()</code>方法，将查询作为参数提供。下面是创建<code>transactions</code>表的代码。</p>
<p>我们使用整数数据类型来存储<code>transactionDate</code>,因为它将被存储为 Unix 时间戳。</p>
<p><code>category_id</code>是来自<code>categories</code>表的<code>rowId</code>。我们还可以向它添加一个外键，但为了简单起见，我们不会这样做:</p>
<pre>export const createTransactionsTable = async db =&gt; {
  const query = `CREATE TABLE IF NOT EXISTS transactions (transactionDate INTEGER, summary TEXT, category_id INTEGER NOT NULL, transactionType TEXT, amount FLOAT)`;
  await db.executeSql(query);
};
</pre>
<p>下面是创建新事务记录的代码。除了<code>transactionDate</code>以外，所有的交易字段都可以直接保存。</p>
<p>datepicker 库返回一个<code>Date</code>对象，所以我们必须通过调用<code>getTime()</code>然后除以<code>1000</code>来获得 Unix 时间戳。这非常重要，因为如果没有以正确的格式保存，我们就不能在 SQLite 中调用日期操作方法:</p>
<pre>export const createTransaction = async (db, transaction) =&gt; {
  const {transactionDate, summary, category, transactionType, amount} =
          transaction;
  const timestamp = parseInt((transactionDate.getTime() / 1000).toFixed(0));
  const insertQuery = `INSERT INTO transactions(transactionDate, summary, category_id, transactionType, amount) VALUES("${timestamp}", "${summary}", "${category}", "${transactionType}", "${amount}")`;
  return db.executeSql(insertQuery);
};
</pre>
<p>请务必<a href="https://github.com/anchetaWern/RNChartKitFinanceApp/blob/master/data/db-service.js" target="_blank" rel="noopener">查看回购协议中用于处理类别和基金的代码</a>，因为在本教程中我们将不再讨论这些代码。</p>
<h2 id="using-react-native-chart-kit">使用 React 本地图表工具包创建财务图表</h2>
<p>是时候继续本教程的主题了:使用 React 原生图表工具包创建图表。</p>
<p>从导入我们需要的模块开始:</p>
<pre>// src/screens/ReportsScreen.js
import React, {useState, useEffect, useCallback} from 'react';
import {ScrollView, StyleSheet} from 'react-native';

import {withTheme} from 'react-native-paper';
import {SafeAreaView} from 'react-native-safe-area-context';
</pre>
<p>还要为每种类型的图表导入自定义组件。我们稍后将创建这些:</p>
<pre>import FinancePieChart from '../components/FinancePieChart';
import FinanceLineChart from '../components/FinanceLineChart';
import FinanceBarChart from '../components/FinanceBarChart';
</pre>
<p>接下来，提取从数据库中获取我们需要的报告数据的方法。这些方法中的每一种(除了前两种)都对应于我们将向用户显示的报告类型。</p>
<p>如果你已经看过前面的截图，这些方法中的每一个都对应于每一个图表(除了最后一个图表依赖于下面的最后三个方法)。我们稍后还会添加这些内容:</p>
<pre>import {
  getDBConnection,
  createTransactionsTable,

  // pie charts
  getTransactionsGroupedByTransactionType,
  getExpenseTransactionsGroupedByCategory,
  getIncomeTransactionsGroupedByCategory,
  getSavingsTransactionsGroupedByCategory,
  getInvestmentTransactionsGroupedByCategory,

  // bar charts
  getExpenseGroupedByMonth,

  // for bar chart and line chart
  getSavingsGroupedByMonth,
  getIncomeGroupedByMonth, 

  getInvestmentsGroupedByMonth, // for line chart
} from '../../data/db-service';
</pre>
<p>接下来，创建组件并初始化我们将用来存储来自数据库的数据的状态值:</p>
<pre>const ReportsScreen = ({theme}) =&gt; {
  const {colors, fonts} = theme;

  const [byExpenseCategories, setByExpenseCategories] = useState([]);
  const [byIncomeCategories, setByIncomeCategories] = useState([]);
  const [bySavingsCategories, setBySavingsCategories] = useState([]);
  const [byInvestmentCategories, setByInvestmentCategories] = useState([]);
  const [byTransactionTypes, setByTransactionTypes] = useState([]);

  const [monthlyIncome, setMonthlyIncome] = useState([]);
  const [monthlyExpense, setMonthlyExpense] = useState([]);

  const [monthlySavings, setMonthlySavings] = useState([]);
  const [monthlyInvestments, setMonthlyInvestments] = useState([]);
}
</pre>
<p>接下来，我们现在调用这些方法并用它们返回的值更新状态:</p>
<pre>const loadDataCallback = useCallback(async () =&gt; {
  try {
    const db = await getDBConnection();
    await createTransactionsTable(db);

    const groupedByTransactionTypes =
      await getTransactionsGroupedByTransactionType(db);
    if (groupedByTransactionTypes.length) {
      setByTransactionTypes(groupedByTransactionTypes);
    }

    const groupedByExpenseCategories =
      await getExpenseTransactionsGroupedByCategory(db);
    if (groupedByExpenseCategories.length) {
      setByExpenseCategories(groupedByExpenseCategories);
    }

    const groupedByIncomeCategories =
      await getIncomeTransactionsGroupedByCategory(db);
    if (groupedByIncomeCategories.length) {
      setByIncomeCategories(groupedByIncomeCategories);
    }

    const groupedBySavingsCategories =
      await getSavingsTransactionsGroupedByCategory(db);
    if (groupedBySavingsCategories.length) {
      setBySavingsCategories(groupedBySavingsCategories);
    }

    const groupedByInvestmentCategories =
      await getInvestmentTransactionsGroupedByCategory(db);
    if (groupedByInvestmentCategories.length) {
      setByInvestmentCategories(groupedByInvestmentCategories);
    }

    const incomeMonth = await getIncomeGroupedByMonth(db);
    if (incomeMonth) {
      setMonthlyIncome(incomeMonth);
    }

    const expenseMonth = await getExpenseGroupedByMonth(db);
    if (expenseMonth) {
      setMonthlyExpense(expenseMonth);
    }

    const savingsMonth = await getSavingsGroupedByMonth(db);
    if (savingsMonth) {
      setMonthlySavings(savingsMonth);
    }

    const investmentMonth = await getInvestmentsGroupedByMonth(db);
    if (investmentMonth) {
      setMonthlyInvestments(investmentMonth);
    }
  } catch (error) {
    console.error('transaction list err: ', error);
  }
}, []);

useEffect(() =&gt; {
  loadDataCallback();
}, [loadDataCallback]);
</pre>
<p>为了让我们在每种方法的作用上保持一致，这里有一个快速的分类:</p>
<ul>
<li><code>getTransactionsGroupedByTransactionType()</code> —按交易类型(例如，费用、收入、储蓄、投资)对当月的交易进行分组，并获取每个交易的总和</li>
<li><code>getExpenseTransactionsGroupedByCategory()</code> —按费用项下的所有类别(例如，水费、电费、外出就餐)对当月的交易进行分组，并返回每项交易的总和</li>
<li><code>getIncomeTransactionsGroupedByCategory()</code> —与上一个相似，但属于收入类别(如主要收入、附带收入)</li>
<li><code>getSavingsTransactionsGroupedByCategory()</code> —与上一个类似，但交易类型仅限于储蓄(如 A 银行储蓄、B 银行储蓄)</li>
<li><code>getInvestmentTransactionsGroupedByCategory()</code> —与上一个类似，但交易类型仅限于投资(如股票、密码、房地产)</li>
<li><code>getIncomeGroupedByMonth()</code> —返回每个月的总收入</li>
<li><code>getExpenseGroupedByMonth()</code> —返回每个月的总费用</li>
<li><code>getSavingsGroupedByMonth()</code> —返回每个月的总节省额</li>
<li><code>getInvestmentsGroupedByMonth()</code> —返回每个月的总投资</li>
</ul>
<p>回到代码，我们现在添加显示每个图表的条件:</p>
<pre>const hasByTransactionTypes = byTransactionTypes.length &gt; 0;
const hasByExpenseCategories = byExpenseCategories.length &gt; 0;
const hasByIncomeCategories = byIncomeCategories.length &gt; 0;
const hasBySavingsCategories = bySavingsCategories.length &gt; 0;
const hasByInvestmentCategories = byInvestmentCategories.length &gt; 0;
const hasMonthlyIncome = monthlyIncome.length &gt; 0;
const hasMonthlyExpense = monthlyExpense.length &gt; 0;

const hasIncomeSavingsInvestment =
        monthlyIncome.length &gt; 0 ||
        monthlySavings.length &gt; 0 ||
        monthlyInvestments.length &gt; 0;
</pre>
<p>接下来，我们需要声明最终图表的设置(在一个图表中显示收入、储蓄和投资的折线图)。</p>
<p>我们实际上不能在组件本身中构造数据；这就是为什么我们在这里建造它。这些主要由 React 本机图表工具包库使用:</p>
<pre>const lineChartLegends = [
  {
    name: 'Income',
    color: '#003049',
  },
  {
    name: 'Savings',
    color: '#d62828',
  },
  {
    name: 'Investment',
    color: '#f77f00',
  },
];

// dataset for the line chart
const datasets = [];
if (monthlyIncome.length &gt; 0) {
  datasets.push({
    data: monthlyIncome.map(item =&gt; item.value),
    color: (opacity = 1) =&gt; '#003049',
    strokeWidth: 2,
  });
}

if (monthlySavings.length &gt; 0) {
  datasets.push({
    data: monthlySavings.map(item =&gt; item.value),
    color: (opacity = 1) =&gt; '#d62828',
    strokeWidth: 2,
  });
}

if (monthlyInvestments.length &gt; 0) {
  datasets.push({
    data: monthlyInvestments.map(item =&gt; item.value),
    color: (opacity = 1) =&gt; '#f77f00',
    strokeWidth: 2,
  });
}

const chartData = {
  labels: monthlyIncome.map(item =&gt; item.label),
  datasets,
};
</pre>
<p>最后，返回用户界面:</p>
<pre>return (
  &lt;SafeAreaView
    style={[styles.container, {backgroundColor: colors.background}]}
  &gt;
    &lt;ScrollView
      style={{
        flex: 1,
      }}
    &gt;
      {hasByTransactionTypes &amp;&amp; (
        &lt;FinancePieChart
          title="Transaction Types"
          data={byTransactionTypes}
        /&gt;
      )}

      {hasByExpenseCategories &amp;&amp; (
        &lt;FinancePieChart title="Expenses" data={byExpenseCategories} /&gt;
      )}

      {hasByIncomeCategories &amp;&amp; (
        &lt;FinancePieChart title="Income" data={byIncomeCategories} /&gt;
      )}

      {hasBySavingsCategories &amp;&amp; (
        &lt;FinancePieChart title="Savings" data={bySavingsCategories} /&gt;
      )}

      {hasByInvestmentCategories &amp;&amp; (
        &lt;FinancePieChart title="Investment" data={byInvestmentCategories} /&gt;
      )}

      {hasMonthlyIncome &amp;&amp; (
        &lt;FinanceBarChart
          title="Monthly Income"
          data={monthlyIncome}
          fillShadowGradient="#DF5353"
          color="#d62828"
        /&gt;
      )}

      {hasMonthlyExpense &amp;&amp; (
        &lt;FinanceBarChart
          title="Monthly Expense"
          data={monthlyExpense}
          fillShadowGradient="#00b4d8"
          color="#0077b6"
        /&gt;
      )}

      {hasIncomeSavingsInvestment &amp;&amp; (
        &lt;FinanceLineChart
          title="Income to savings to investment"
          chartData={chartData}
          fillShadowGradient="#ccc"
          legend={lineChartLegends}
        /&gt;
      )}
    &lt;/ScrollView&gt;
  &lt;/SafeAreaView&gt;
);

const styles = StyleSheet.create({
  container: {
    flex: 1,
    flexDirection: 'column',
  },
});

export default withTheme(ReportsScreen);
</pre>
<h3 id="pie-chart">圆形分格统计图表</h3>
<p><img data-attachment-id="70643" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/pie-chart-react-native-chart-kit/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png" data-orig-size="344,583" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Pie chart React Native Chart Kit" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit-177x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png" decoding="async" class="size-full wp-image-70643 aligncenter jetpack-lazy-image" src="../Images/477c475f9d22cd477b63c03edbbe5bd3.png" alt="Pie Chart React Native Chart Kit" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png 344w, https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit-177x300.png 177w" data-lazy-sizes="(max-width: 344px) 100vw, 344px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70643" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/pie-chart-react-native-chart-kit/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png" data-orig-size="344,583" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Pie chart React Native Chart Kit" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit-177x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png" decoding="async" loading="lazy" class="size-full wp-image-70643 aligncenter" src="../Images/477c475f9d22cd477b63c03edbbe5bd3.png" alt="Pie Chart React Native Chart Kit" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png 344w, https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit-177x300.png 177w" sizes="(max-width: 344px) 100vw, 344px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/pie-chart-react-native-chart-kit.png"/></noscript>
<p>现在让我们来看看图表组件的代码。首先，我们来看看<code>FinancePieChart</code>组件。这使用了 React 本地图表工具包中的<code>PieChart</code>组件。我们用它来生成交易类型、费用类型、收入类型、储蓄类型和投资类型的饼图。</p>
<p>我们从导入我们需要的模块开始。我们还导入了一个<code>Legend</code>组件来显示每个数据点的图例。</p>
<p>注意，<code>PieChart</code>组件已经有了自己的图例，但是我们不会使用它。所以我们才把<code>hasLegend={false}</code>设定为道具。这是因为它不是非常可定制的。真的很难修改它的位置。使用定制的<code>Legend</code>组件允许更多的灵活性。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自 LogRocket 的精彩文章:</h3>

<hr/></div>
<p>我们使用<code>Dimensions</code>模块来获取当前设备的屏幕宽度。然后，我们将该宽度提供给组件，使其适应屏幕宽度。请注意，它实际上不会占用设备的整个可用宽度。相反，它只会使用其中的一半:</p>
<pre>// src/components/FinancePieChart.js

import React from 'react';
import {View, Text, Dimensions, StyleSheet} from 'react-native';

import {PieChart} from 'react-native-chart-kit';

import Legend from './Legend';

const screenWidth = Dimensions.get('window').width;
</pre>
<p>接下来，初始化图表配置。这是图表的配置对象。主要用于配置一般的图表设置，如<code>strokeWidth</code>(图表的基本笔画宽度)和<code>color</code>(用于计算图表中标签和扇区的基本颜色的函数)。请注意，并非所有属性都适用于所有图表类型。</p>
<p>会有一些只适用于特定类型的。但好的一面是，所有这些属性都被赋予了默认值，因此您可以使用不适用于您正在使用的特定图表的属性:</p>
<pre>const chartConfig = {
  backgroundGradientFrom: '#1E2923',
  backgroundGradientFromOpacity: 0,
  backgroundGradientTo: '#08130D',
  backgroundGradientToOpacity: 0.5,
  color: (opacity = 1) =&gt; `rgba(26, 255, 146, ${opacity})`,
  strokeWidth: 2,
  useShadowColorFromDataset: false,
};
</pre>
<p>接下来，渲染<code>PieChart</code>组件。这接受以下属性:</p>
<ul>
<li><code>data</code> —您想要呈现的数据。我们将在稍后查看<code>src/data/db-service.js</code>文件中返回的查询和数据时看到这一点。但是一般的经验法则是，您需要一个带有标签和值的对象数组。标签是图例，而值是数据点</li>
<li><code>width</code>和<code>height</code> —图表的尺寸</li>
<li><code>chartConfig</code> —图表的一般配置对象</li>
<li><code>accessor</code>—<code>data</code>对象的属性，从中获取数值</li>
<li><code>backgroundColor</code> —应用于图表的背景颜色。如果你不想应用任何背景色，这可以是<code>transparent</code>或<code>none</code></li>
<li><code>center</code> —定位图表的偏移 x 和 y 坐标。<code>[0, 0]</code>表示我们将它定位在分配位置的最开始。请注意，这不是一个固定的位置，而是一个相对位置，因此它将始终附着在它之前的元素上</li>
<li><code>hasLegend</code> —是否显示图例</li>
</ul>
<p>您可以<a href="https://github.com/indiespirit/react-native-chart-kit#modified-pie-chart-screenshot" target="_blank" rel="noopener">查看回购协议，了解更多关于您可以指定的道具的信息</a>。</p>
<p>在图表的正下方，我们呈现了图例:</p>
<pre>function FinancePieChart({title, data}) {
  return (
    &lt;View style={styles.container}&gt;
      &lt;View style={styles.titleContainer}&gt;
        &lt;Text&gt;{title}&lt;/Text&gt;
      &lt;/View&gt;

      &lt;View style={styles.bodyContainer}&gt;
        &lt;View style={styles.chartContainer}&gt;
          &lt;PieChart
            data={data}
            width={screenWidth}
            height={200}
            chartConfig={chartConfig}
            accessor={'total'}
            backgroundColor={'transparent'}
            center={[0, 0]}
            hasLegend={false}
          /&gt;
        &lt;/View&gt;

        &lt;View style={styles.legendContainer}&gt;
          {data.map(({name, color}) =&gt; {
            return &lt;Legend key={name} name={name} color={color} /&gt;;
          })}
        &lt;/View&gt;
      &lt;/View&gt;
    &lt;/View&gt;
  );
}

const styles = StyleSheet.create({
  container: {
    marginTop: 10,
  },
  titleContainer: {
    flex: 1,
    alignItems: 'center',
  },
  bodyContainer: {
    flexDirection: 'row',
  },
  chartContainer: {
    flex: 1,
  },
  legendContainer: {
    flex: 1,
    marginTop: 20,
  },
});

export default FinancePieChart;
</pre>
<p>在我们进入下一个图表之前，让我们先来看看我们是如何获得提供给<code>FinancePieChart</code>组件的数据的。</p>
<p>下面是获取第一个饼图数据的代码。我们使用聚合函数<code>SUM()</code>对每行中的<code>amount</code>求和，然后根据<code>transactionType</code>对其分组。交易类型可以在<code>config/app.js</code>文件中找到。</p>
<p>为了获得我们需要的数据，我们循环几次结果:一次<code>forEach</code>和一次<code>for</code>循环。请注意，外部循环只执行一次，这是为了让我们可以访问包含实际结果的对象。</p>
<p>行数据不能作为普通对象使用，所以我们必须调用<code>result.rows</code>上的<code>item()</code>方法并提供当前的<code>index</code>来获得我们需要的数据。从那里，我们提取出<code>name</code>和<code>total</code>列。</p>
<p>我们还添加了一个额外的属性<code>color</code>来指定数据点的颜色。颜色都硬编码在<code>src/helpers/palette.js</code>文件中。漂亮的调色板归功于酷派:</p>
<pre>export const getTransactionsGroupedByTransactionType = async db =&gt; {
  try {
    const transactions = [];
    const results = await db.executeSql(
      `SELECT SUM(amount) AS total, transactionType AS name FROM transactions 
      WHERE strftime("%m/%Y", datetime(transactionDate, 'unixepoch', 'localtime')) = ?
      GROUP BY transactionType`,
      [monthYear],
    );
    results.forEach(result =&gt; {
      for (let index = 0; index &lt; result.rows.length; index++) {
        const {name, total} = result.rows.item(index);
        transactions.push({
          name,
          total,
          color: paletteOne[index],
        });
      }
    });
    return transactions;
  } catch (error) {
    console.error(error);
    throw Error('Failed to getTransactionsGroupedByTransactionType...');
  }
};
</pre>
<p>注意<code>monthYear</code>是在顶部附近声明的:</p>
<pre>enablePromise(true);

const monthYear = new Date().toLocaleDateString(undefined, {
  year: 'numeric',
  month: '2-digit',
});
</pre>
<p>其他饼状图使用了几乎相同的代码。只有查询发生了变化，所以我在这里只包含查询。这一次，我们使用一个<code>INNER JOIN</code>来连接<code>categories</code>表。这是因为我们需要通过<code>categoryType</code>进行过滤:</p>
<pre>const results = await db.executeSql(
  `SELECT SUM(amount) AS total, categories.name AS name FROM transactions 
  INNER JOIN categories ON categories.rowId = transactions.category_id 
  WHERE categoryType = 'expense' AND strftime("%m/%Y", datetime(transactionDate, 'unixepoch', 'localtime')) = ?
  GROUP BY transactions.category_id`,
  [monthYear],
);
</pre>
<h3 id="bar-chart">条形图</h3>
<p><img data-attachment-id="70645" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/bar-chart-rn-chart-kit/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png" data-orig-size="350,423" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Bar chart React Native Chart Kit" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit-248x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png" decoding="async" class="size-full wp-image-70645 aligncenter jetpack-lazy-image" src="../Images/d68b000a193891a8ff7904c279a35939.png" alt="Bar Chart React Native Chart Kit" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit-248x300.png 248w" data-lazy-sizes="(max-width: 350px) 100vw, 350px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70645" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/bar-chart-rn-chart-kit/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png" data-orig-size="350,423" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Bar chart React Native Chart Kit" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit-248x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png" decoding="async" loading="lazy" class="size-full wp-image-70645 aligncenter" src="../Images/d68b000a193891a8ff7904c279a35939.png" alt="Bar Chart React Native Chart Kit" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit-248x300.png 248w" sizes="(max-width: 350px) 100vw, 350px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/bar-chart-rn-chart-kit.png"/></noscript>
<p>现在让我们继续讨论<code>FinanceBarChart</code>组件。我们用它来生成用户月收入和月支出的图表。代码应该非常相似。对于<code>chartConfig</code>，我们添加了以下属性:</p>
<ul>
<li>   <ul>
<li><code>barPercentage</code> —定义图表中每个条形将占据的可用宽度的百分比。这是一个介于 0 和 1 之间的值。在这种情况下，我们指定了<code>0.5</code>来表示它将只使用一半的可用宽度</li>
<li><code>fillShadowGradient</code> —定义每个条形的颜色。请注意，将使用该值作为基础来计算背景渐变，因此它实际上不是纯色</li>
<li><code>fillShadowGradientOpacity</code>—<code>fillShadowGradient</code>的不透明度</li>
</ul>
</li>
</ul>
<ul>
<li><code>labelColor</code> —每个栏下文本标签的颜色</li>
<li><code>decimalPlaces</code> —要显示的小数位数。这默认为<code>2</code>，所以如果你不想显示任何小数，你必须指定<code>0</code></li>
</ul>
<p>我们提供给它的道具与饼状图非常相似。唯一不同的是<code>showBarTops</code>。这是一个布尔值，用于指定是否在每个条形的顶部显示线条。我们指定了<code>false</code>,因为我们并不想显示它。</p>
<p>至于您提供的数据，它允许您在<code>datasets</code>属性下添加多个对象，但是它实际上不会呈现多个条。因此，您不能将这种类型的图表用于数据比较:</p>
<pre>// src/components/FinanceBarChart.js
import React from 'react';
import {View, Text, Dimensions, StyleSheet} from 'react-native';
import {BarChart} from 'react-native-chart-kit';

const screenWidth = Dimensions.get('window').width;

function FinanceBarChart({title, fillShadowGradient, data}) {
  const chartConfig = {
    backgroundGradientFrom: '#fff',
    backgroundGradientFromOpacity: 0,
    backgroundGradientTo: '#fff',
    backgroundGradientToOpacity: 0.5,

    fillShadowGradient,
    fillShadowGradientOpacity: 1,
    color: (opacity = 1) =&gt; `#023047`,
    labelColor: (opacity = 1) =&gt; `#333`,
    strokeWidth: 2,

    barPercentage: 0.5,
    useShadowColorFromDataset: false,
    decimalPlaces: 0,
  };

  const labels = data.map(item =&gt; {
    return item.label;
  });

  const values = data.map(item =&gt; {
    return item.value;
  });

  const chartData = {
    labels,
    datasets: [
      {
        data: values,
      },
    ],
  };

  return (
    &lt;View style={styles.container}&gt;
      &lt;View style={styles.titleContainer}&gt;
        &lt;Text&gt;{title}&lt;/Text&gt;
      &lt;/View&gt;
      &lt;BarChart
        data={chartData}
        width={screenWidth}
        height={220}
        chartConfig={chartConfig}
        showBarTops={false}
      /&gt;
    &lt;/View&gt;
  );
}

const styles = StyleSheet.create({
  container: {
    marginBottom: 20,
  },
  titleContainer: {
    flex: 1,
    alignItems: 'center',
  },
});

export default FinanceBarChart;
</pre>
<p>查看<a href="https://github.com/indiespirit/react-native-chart-kit#bar-chart">文档</a> n，了解更多关于配置和你可以使用的道具的信息。</p>
<p>现在让我们来看看为该图表提供数据的查询。同样，我们使用 SQLite 中的<code>strftime</code>函数按月对交易进行分组，获得总和并仅过滤<code>income</code>交易:</p>
<pre>export const getIncomeGroupedByMonth = async (db) =&gt; {
  try {
    const transactions = [];
    const results = await db.executeSql(
      `SELECT strftime("%m-%Y", datetime(transactionDate, 'unixepoch', 'localtime')) AS monthYear,
      SUM(amount) AS total 
      FROM transactions 
      WHERE transactionType = 'income'
      GROUP BY monthYear`
    );

    results.forEach((result) =&gt; {
      for (let index = 0; index &lt; result.rows.length; index++) {
        const item = result.rows.item(index);

        transactions.push({
          value: item.total,
          label: item.monthYear,
        });
      }
    });

    return transactions;
  } catch (error) {
    console.error(error);
    throw Error("Failed to getIncomeGroupedByMonth...");
  }
};
</pre>
<p>获取每月费用的代码基本相同。你只需要把<code>transactionType</code>换成<code>expense</code>，这里就不再赘述了。</p>
<h3 id="line-chart">折线图</h3>
<p><img data-attachment-id="70647" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/line-chart-rn-chart-kit/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png" data-orig-size="350,298" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Line chart React Native Chart Kit" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit-300x255.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png" decoding="async" class="size-full wp-image-70647 aligncenter jetpack-lazy-image" src="../Images/8f539dce5ac8b5b96a0209ce0bac7c8a.png" alt="Line Chart React Native Chart Kit" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit-300x255.png 300w" data-lazy-sizes="(max-width: 350px) 100vw, 350px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70647" data-permalink="https://blog.logrocket.com/using-react-native-chart-kit-visualize-data/line-chart-rn-chart-kit/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png" data-orig-size="350,298" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Line chart React Native Chart Kit" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit-300x255.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png" decoding="async" loading="lazy" class="size-full wp-image-70647 aligncenter" src="../Images/8f539dce5ac8b5b96a0209ce0bac7c8a.png" alt="Line Chart React Native Chart Kit" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png 350w, https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit-300x255.png 300w" sizes="(max-width: 350px) 100vw, 350px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/line-chart-rn-chart-kit.png"/></noscript>
<p>我们要看的最后一种图表是折线图。我们用它来显示几个月来收入、储蓄和投资之间的对比。</p>
<p>正如您在前面的 reports 屏幕代码中看到的，它接受多个对象作为<code>datasets</code>属性，因此它最适合用于比较目的。这使用了 React 本地图表工具包库中的<code>LineChart</code>组件。</p>
<p>就<code>chartConfig</code>号而言，我们提供给它的真的没有什么不同。</p>
<p>组件并没有自己的传说。这就是我们再次引入自制<code>Legend</code>组件的原因。这将作为我们比较的每个数据点的图例，包括收入、储蓄和投资:</p>
<pre>// src/components/FinanceLineChart.js
import React from 'react';
import {View, Text, Dimensions, StyleSheet} from 'react-native';
import {LineChart} from 'react-native-chart-kit';

import Legend from './Legend';

const screenWidth = Dimensions.get('window').width;

function FinanceLineChart({title, chartData, legend, fillShadowGradient}) {
  const chartConfig = {
    backgroundGradientFrom: '#fff',
    backgroundGradientFromOpacity: 0,
    backgroundGradientTo: '#fff',
    backgroundGradientToOpacity: 0.5,

    fillShadowGradient,
    fillShadowGradientOpacity: 0,
    color: (opacity = 1) =&gt; `#023047`,
    labelColor: (opacity = 1) =&gt; `#333`,
    strokeWidth: 2,

    useShadowColorFromDataset: false,
    decimalPlaces: 0,
  };

  return (
    &lt;View style={styles.container}&gt;
      &lt;View style={styles.titleContainer}&gt;
        &lt;Text&gt;{title}&lt;/Text&gt;
      &lt;/View&gt;
      &lt;LineChart
        data={chartData}
        width={screenWidth}
        height={220}
        chartConfig={chartConfig}
      /&gt;

      &lt;View style={styles.legendContainer}&gt;
        {legend.map(({name, color}) =&gt; {
          return &lt;Legend key={name} name={name} color={color} /&gt;;
        })}
      &lt;/View&gt;
    &lt;/View&gt;
  );
}

const styles = StyleSheet.create({
  container: {
    marginBottom: 20,
  },
  titleContainer: {
    flex: 1,
    alignItems: 'center',
  },
  legendContainer: {
    flex: 1,
    marginTop: 20,
    alignItems: 'center',
  },
});

export default FinanceLineChart;
</pre>
<p>在 React Native Chart Kit 提供的图表组件中，<code>LineChart</code>是功能最强大的一个。我们在这里没有使用它，但是如果你看一下<a href="https://github.com/indiespirit/react-native-chart-kit#line-chart" target="_blank" rel="noopener">文档</a>，你会发现它比其他的有更多的可用道具。例如，它有一个<code>onDataPointClick</code>属性，允许您在图表上单击一个数据点时执行一个操作。</p>
<p>至于数据，我们是从三个独立的查询中挑选的。其中一个已经被前面的<code>FinanceBarChart</code>使用了。是那个<code>monthlyIncome</code>。所以，现在我们需要的是储蓄和投资。这是省钱的一招:</p>
<pre>export const getSavingsGroupedByMonth = async (db) =&gt; {
  try {
    const transactions = [];
    const results = await db.executeSql(
      `SELECT strftime("%m-%Y", datetime(transactionDate, 'unixepoch', 'localtime')) AS monthYear,
      SUM(amount) AS total 
      FROM transactions 
      WHERE transactionType = 'savings'
      GROUP BY monthYear`
    );

    results.forEach((result) =&gt; {
      for (let index = 0; index &lt; result.rows.length; index++) {
        const item = result.rows.item(index);

        transactions.push({
          value: item.total,
          label: item.monthYear,
        });
      }
    });

    return transactions;
  } catch (error) {
    console.error(error);
    throw Error("Failed to getSavingsGroupedByMonth...");
  }
};
</pre>
<p>我会把另一个留给你在回购中检查。</p>
<h2>结论</h2>
<p>就是这样！在本教程中，您学习了如何使用 React Native 图表工具包库在 React Native 中创建不同种类的图表。具体来说，我们在本教程中使用了饼图、条形图和折线图。你可以在其<a href="https://github.com/anchetaWern/RNChartKitFinanceApp" target="_blank" rel="noopener"> GitHub repo </a>中找到该应用的完整源代码。</p>
<p>如果您想了解更多关于 React Native 可以使用的替代图表库的信息，请查看这篇关于 React Native 图表库的文章。</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现 React 原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款 React 原生监控解决方案，可帮助您即时重现问题、确定 bug 的优先级并了解 React 原生应用的性能。</p><p>LogRocket 还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket 的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的 React 原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用 LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>