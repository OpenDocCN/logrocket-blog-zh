<html>
<head>
<title>The Web Animations API vs. CSS - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>网络动画 API 与 CSS - LogRocket 博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/the-web-animations-api-vs-css/#0001-01-01">https://blog.logrocket.com/the-web-animations-api-vs-css/#0001-01-01</a></blockquote><div><article class="article-post">
<p>网页动画是网页设计中很受欢迎的一部分，它导致了许多 JavaScript 动画库的发展，包括<a href="https://blog.logrocket.com/framer-motion-tutorial/"> Framer Motion </a>和<a href="https://blog.logrocket.com/animating-vue-with-greensock/"> GreenSock </a>。然而，许多开发人员仍然选择使用 CSS 过渡、CSS 动画或 JavaScript web 动画 API (WAAPI)从头开始创建 Web 动画。</p>
<p>在本教程中，我们将深入讨论这三种方法，通过相关演示学习如何使用每一种方法。我们将比较每种方法，并讨论在我看来使<a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API">网络动画 API </a>被低估的许多好处。我们开始吧！</p>
<h2>CSS 过渡</h2>
<p>CSS 转换允许我们无缝地将 CSS 属性从一种状态改变到另一种状态。例如，假设我们想将元素的<code>background-color</code>属性值从黑色改为红色。当然，变化会立即发生，但是，CSS 转换让我们可以控制过程的某些方面。</p>
<p>例如，我们可以决定更改何时开始，动画显示哪些属性，以及动画将运行多长时间。要制作动画，该属性必须包含在<a href="https://blog.logrocket.com/css-reference-guide-transitions/"> CSS 动画属性</a>的列表中。</p>
<h3>性能</h3>
<p>让我们回顾一下创建 CSS 过渡所需的 CSS 属性:</p>
<ul>
<li><code>transition-property</code>:我们将应用过渡的 CSS 属性</li>
<li><code>transition-duration</code>:过渡应该运行的时间长度</li>
<li>动画开始前要等多长时间</li>
<li><code>transition-timing-function</code>:过渡的速度</li>
</ul>
<p><code>transition-timing-function</code>要么是直线，要么是速度递增，要么是速度递减。通常，<code>transition-timing-function</code>要么是一个确定 CSS 属性在中间点的值的函数，要么是一个与该函数等价的关键字。</p>
<p>您可以使用<code>transition</code>速记属性来代替上述四个属性:</p>
<pre class="language-css hljs">.element {
  transition: &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt;;
}
</pre>
<h3>演示</h3>
<p>现在，让我们看看 CSS 转换的效果！在下面的代码笔中，当用户悬停在显示屏上时，背景颜色将从黑色变为红色。</p>
<p class="codepen" data-height="500" data-default-tab="css,result" data-slug-hash="PomdrEZ" data-user="idorenyinudoh">参见<a href="https://codepen.io"> CodePen </a>上 Udoh Idorenyin(<a href="https://codepen.io/idorenyinudoh">@ idorenyinudoh</a>)<br/>的<a href="https://codepen.io/idorenyinudoh/pen/PomdrEZ">笔 css 转场测试</a>。</p>
<p>多个动画</p>
<h3>在下面的演示中，您将看到我们如何在多个 CSS 属性中应用 CSS 过渡，方法是用逗号分隔过渡属性的值:</h3>
<p>参见<a href="https://codepen.io"> CodePen </a>上的笔<a href="https://codepen.io/idorenyinudoh/pen/KKmxjBX"> <br/> css 转场测试 2 </a>由 Udoh Idorenyin(<a href="https://codepen.io/idorenyinudoh">@ idorenyinudoh</a>)<br/>。</p>
<p class="codepen" data-height="500" data-default-tab="css,result" data-slug-hash="KKmxjBX" data-user="idorenyinudoh">See the Pen <a href="https://codepen.io/idorenyinudoh/pen/KKmxjBX"><br/>
css transitions test 2</a> by Udoh Idorenyin (<a href="https://codepen.io/idorenyinudoh">@idorenyinudoh</a>)<br/>
on <a href="https://codepen.io">CodePen</a>.</p>
<p>现在我们已经熟悉了 CSS 过渡，让我们来看看 CSS 动画。</p>
<p>CSS 动画</p>
<h2>CSS 动画让我们让我们的动画更有趣一点。我们将需要一个<code>@keyframes</code> CSS at-rule，它指定动画开始、结束和动画周期中的 CSS 规则。我们还需要一个初始化 CSS 动画的规则。</h2>
<p>性能</p>
<h3>让我们来看看创建 CSS 动画所需的属性:</h3>
<p><code>animation-name</code>:at 规则<code>@keyframes</code>的名称</p>
<ul>
<li><code>animation-play-state</code>:指定动画是<code>running</code>还是<code>paused</code></li>
<li><code>animation-direction</code>:指定动画的方向</li>
<li><code>animation-iteration-count</code>:动画将完成的循环数</li>
<li><code>animation-fill-mode</code>:动画如何在执行前后将样式应用到元素</li>
<li>如果<code>animation-iteration-count</code>设置为<code>infinite</code>，动画将连续播放。如果<code>animation-fill-mode</code>设置为<code>forward</code>，元素会保留最后一个关键帧的样式。如果设置为<code>backward</code>，第一个关键帧的样式将在动画开始前应用于元素。</li>
</ul>
<p><code>animation-delay</code>是应用和播放动画之间的时间。它类似于 CSS 转场中的<code>transition-delay</code>。<code>animation-duration</code>是动画完成一个循环所需的时间。它的对等物是<code>transition-duration</code>。</p>
<p>最后，<code>animation-timing-function</code>表示动画在其周期中的进展。它的对等物是<code>transition-timing-function</code>。像在 CSS 过渡中一样，CSS 动画有一个<code>animation</code>简写来处理这些属性:</p>
<p>演示</p>
<pre class="language-css hljs">.element {
  animation: &lt;name&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt; &lt;iteration-count&gt; &lt;direction&gt; &lt;fill-mode&gt;;
}
</pre>
<h3>为了了解 CSS 动画是如何工作的，让我们重新创建上面的演示，并将对象的背景色从黑色改为红色:</h3>
<p>请看<a href="https://codepen.io"> CodePen </a>上 Udoh Idorenyin(<a href="https://codepen.io/idorenyinudoh">@ idorenyinudoh</a>)<br/>的笔<a href="https://codepen.io/idorenyinudoh/pen/eYWMYrJ"> <br/> css 动画测试</a>。</p>
<p class="codepen" data-height="500" data-default-tab="css,result" data-slug-hash="eYWMYrJ" data-user="idorenyinudoh">See the Pen <a href="https://codepen.io/idorenyinudoh/pen/eYWMYrJ"><br/>
css animations test</a> by Udoh Idorenyin (<a href="https://codepen.io/idorenyinudoh">@idorenyinudoh</a>)<br/>
on <a href="https://codepen.io">CodePen</a>.</p>
<p>您可能已经注意到了 CSS 转换的一些关键差异。首先，动画会立即开始，而不是由用户初始化。CSS 动画属性可以利用<code>@keyframes</code> at-rule 来运行元素。</p>
<p>然而，在 CSS 转换中，定义动画结束状态的规则必须在不同于元素默认声明的声明中。出于这个原因，我们在第一个演示中使用了<code>:hover</code>伪类。</p>
<p>在 CSS 动画中，当动画完成时，元素会立即返回其默认样式。另一方面，默认情况下，CSS 转换是双向的。</p>
<p>例如，当我们的背景从黑色变为红色时，动画运行，反之亦然。为了用 CSS 动画实现这一功能，我们需要再次定义动画并将<code>animation-direction</code>属性设置为<code>reverse</code>。</p>
<p>多个动画</p>
<h3>要使用 CSS 动画创建多个动画，我们可以在一个<code>@keyframes</code> at-rule 中输入我们想要制作动画的所有属性，并在一个<code>animation</code>属性中使用它，如下面的代码片段所示:</h3>
<p>另一种方法是使用多个<code>@keyframes</code> at 规则，并用逗号分隔动画属性值。如果要对动画属性使用不同的值，以下方法是理想的:</p>
<pre class="language-css hljs">.element {
  animation: color-change 2s ease-in-out 1s infinite forwards;
}

@keyframes color-width-change {
  0% {
    background: black;
  }
  25% {
    width: 200px;
  }
  100% {
    background: red;
    width: 500px;
  }
}
</pre>
<p>下面的代码笔包含上面代码片段的演示:</p>
<pre class="language-css hljs">.element {
  animation: color-change 2s ease-in-out 1s infinite forwards, width-change 3s ease-in 0s infinite forwards;
}

@keyframes color-change {
  0% {
    background: black;
  }
  100% {
    background: red;
  }
}

@keyframes width-change {
  25% {
    width: 200px;
  }
  100% {
    width: 500px;
  }
}
</pre>
<p>参见<a href="https://codepen.io"> CodePen </a>上 Udoh Idorenyin(<a href="https://codepen.io/idorenyinudoh">@ idorenyinudoh</a>)<br/>的笔<a href="https://codepen.io/idorenyinudoh/pen/WNjYBgm"> <br/> css 动画测试 2 </a>。</p>
<p class="codepen" data-height="500" data-default-tab="css,result" data-slug-hash="WNjYBgm" data-user="idorenyinudoh">See the Pen <a href="https://codepen.io/idorenyinudoh/pen/WNjYBgm"><br/>
css animations test 2</a> by Udoh Idorenyin (<a href="https://codepen.io/idorenyinudoh">@idorenyinudoh</a>)<br/>
on <a href="https://codepen.io">CodePen</a>.</p>
<p>您会注意到当<code>color-change</code>动画完成时,<code>width-change</code>动画仍在运行。为了避免重复，您可以从简写中排除一些属性，而是用单个的<code>animation-*</code>属性在一个值中指定它们。</p>
<p>网络动画 API</p>
<h2>动画的 JavaScript 方法，Web Animations API，给开发者更多的控制和 CSS 动画的细微差别。尽管 Web Animations API 最初在设置时可能看起来更复杂，但是您可以将它与元素的样式分离，从而使它比 CSS 更容易编写，也更简单。</h2>
<p>为了用 Web Animations API 制作 DOM 元素的动画，我们在元素上调用了<code>animate()</code>方法。<code>animate()</code>方法有两个参数，关键帧和选项。与 CSS 过渡和 CSS 动画一样，元素必须是可动画的。</p>
<p>关键帧</p>
<h3>关键帧可以是关键帧对象的数组，也可以是以值数组作为属性的对象:</h3>
<p>在第一种方法中，关键帧对象在整个动画周期中均匀分布。例如，在上面的代码块中，默认情况下，点数将是 0%、50%和 100%。要更改点，请在关键帧对象中设置一个值在<code>0.0</code>和<code>1.0</code>之间的<code>offset</code>属性，其中<code>0.5</code>为 50%。</p>
<pre>const keyframes = [
    { opacity: 1 },
    { opacity: 0 },
    { opacity: 1 }
]

// OR

const keyframes = {
    opacity: [ 1, 0, 1 ]
}
</pre>
<p>考虑 CSS 中的以下示例:</p>
<p>使用 Web Animations API 中的第一个关键帧方法，上面的 CSS 代码如下所示:</p>
<pre class="language-css hljs">@keyframes fade-in-out {
    0% {
        opacity: 0;
    }
    60% {
        opacity: 1;
    }
    100% {
        opacity: 0;
    }
}
</pre>
<p>如果我们使用第二个关键帧方法，并使用一个值数组作为属性，我们的 CSS 代码将如下所示:</p>
<pre>const keyframes = [
    { opacity: 1 },
    { opacity: 0, offset: 0.6 },
    { opacity: 1 }
]
</pre>
<p>在 CSS 中，您可以为动画使用计时功能，但是，使用 Web Animations API，您可以为每个关键帧以及整个动画指定计时功能。</p>
<pre>const keyframes = {
  opacity: [0, 1, 0],
  offset: [0, 0.6, 1] //could also be [0, 0.6]
}
</pre>
<p>以包含<code>offset</code>属性的相同方式包含关键帧的<code>easing</code>属性。<code>easing</code>属性将从该关键帧应用到下一个指定的关键帧:</p>
<p>为了在整个动画中包含<code>easing</code>值，我们将把它包含在 options 对象中:</p>
<pre>const keyframes = [
    { opacity: 1, easing: 'ease-in' },
    { opacity: 0, offset: 0.6, easing: 'ease-out' },
    { opacity: 1, easing: 'ease-in-out' }
]

// OR

const keyframes = {
    opacity: [ 1, 0, 1 ],
    offset: [0, 0.6],
    easing: ['ease-in', 'ease-out', 'ease-in-out']
}
</pre>
<p><code>options</code></p>
<h3><code>options</code>可以是一个整数类型，以毫秒为单位指定动画的持续时间，也可以是一个<code>EffectTiming</code>对象，包含至少一个与 CSS 动画属性等效的对象。让我们回顾一下这些属性的 Web 动画 API 的等价物:</h3>
<p><span> CSS 动画属性</span></p>
<table class="tg">
<colgroup>
<col/>
<col/> </colgroup>
<thead>
<tr>
<th class="tg-0pky"><span> W </span> <span> eb 动画</span> API 等效</th>
<th class="tg-cxfx"><code>animation-name</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tg-0pky"><code>id</code></td>
<td class="tg-0pky"><code>animation-duration</code></td>
</tr>
<tr>
<td class="tg-0pky"><code>duration</code></td>
<td class="tg-0pky"><code>animation-timing-function</code></td>
</tr>
<tr>
<td class="tg-0pky"><code>easing</code></td>
<td class="tg-0pky"><code>animation-fill-mode</code></td>
</tr>
<tr>
<td class="tg-0pky"><code>fill</code></td>
<td class="tg-0pky"><code>animation-iteration-count</code></td>
</tr>
<tr>
<td class="tg-0pky"><code>iterations</code></td>
<td class="tg-0pky"><code>animation-direction</code></td>
</tr>
<tr>
<td class="tg-0lax"><code>direction</code></td>
<td class="tg-0lax"><code>animation-delay</code></td>
</tr>
<tr>
<td class="tg-0lax"><code>delay</code></td>
<td class="tg-0lax">我们将很快介绍与<code>animation-play-state</code> CSS 属性等价的内容。然而，您可以在<code>options</code>对象中包含几个没有 CSS 对等物的属性:</td>
</tr>
</tbody>
</table>
<p><code>endDelay</code>指定动画结束后的延迟时间，这在我们希望连续播放动画时很有帮助。</p>
<p><code>iterationStart</code>指定动画应该开始的迭代点，范围从<code>0.0</code>到<code>1.0</code>。例如，<code>0.3</code>的值意味着动画应该从 30%的关键帧点开始。</p>
<p>更多来自 LogRocket 的精彩文章:</p><div class="code-block code-block-54">
<hr/>
<h3><code>composite</code>指定动画的值如何与没有<code>composite</code>属性的其他动画组合。例如，值<code>add</code>会将下一个动画添加到上一个动画中。很自然，之前的那个会被覆盖。</h3>

<hr/></div>
<p><code>iterationComposite</code>指定如何在动画中从一次迭代到另一次迭代构建值。</p>
<p><code>animate()</code></p>
<h3><code>animate()</code>方法返回一个<code>Animation</code>对象。让我们考虑对象提供的属性和方法。</h3>
<p>性能</p>
<h4><code>currentTime</code>:动画的当前点，以毫秒为单位</h4>
<ul>
<li><code>effect</code>:<code>AnimationEffect</code>对象，它是一个<code>KeyframeEffect</code>对象</li>
<li>当动画结束时，返回一个解决的承诺</li>
<li><code>id</code>:用于标识动画的<code>id</code></li>
<li><code>pending</code>:动画正在等待操作完成</li>
<li><code>playbackRate</code>:动画的播放速度</li>
<li><code>ready</code>:返回一个承诺，当动画准备好播放时，这个承诺就生效</li>
<li><code>replaceState</code>:返回动画的替换状态</li>
<li><code>startTime</code>:动画预定开始的时间</li>
<li><code>timeline</code>:与动画相关的时间线</li>
<li><code>playState</code>:指定动画是否播放</li>
<li>方法</li>
</ul>
<h4><code>cancel()</code>:清除动画创建的<code>KeyframeEffect</code>，结束播放</h4>
<ul>
<li><code>finish()</code>:前进到动画的结尾</li>
<li><code>pause()</code>:暂停动画</li>
<li><code>persist()</code>:当浏览器已经移除动画时，将动画保留在元素中</li>
<li><code>play()</code>:开始或恢复动画</li>
<li><code>reverse()</code>:从头到尾播放动画</li>
<li><code>updatePlaybackRate()</code>:设定动画开始后的速度</li>
<li><code>commitStyles()</code>:将动画结束状态的样式提交给元素</li>
<li>该对象的其他事件包括<code>cancel</code>、<code>finish</code>和<code>remove</code>事件。</li>
</ul>
<p>演示</p>
<h3>让我们使用 Web Animations API 的属性、方法和选项重新创建之前的动画。我们的 JavaScript 文件应该类似于下面的代码块:</h3>
<p>为了连续播放动画，我们使用 JavaScript 关键字<code>Infinity</code>作为<code>options</code>对象中<code>iterations</code>属性的值。</p>
<pre>const element = document.querySelector('div');

const keyframes = {
    background: [ 'black', 'red' ]
}

const options = {
    id: "color-change",
    duration: 2000,
    delay: 1000,
    easing: "ease-in-out",
    iterations: Infinity,
    fill: "forwards"
}

element.animate(keyframes, options);
</pre>
<p>参见<a href="https://codepen.io"> CodePen </a>上 Udoh Idorenyin(<a href="https://codepen.io/idorenyinudoh">@ idorenyinudoh</a>)<br/>的 Pen <a href="https://codepen.io/idorenyinudoh/pen/wvdmXKz"> <br/>网页动画 api 测试</a>。</p>
<p class="codepen" data-height="500" data-default-tab="css,result" data-slug-hash="wvdmXKz" data-user="idorenyinudoh">See the Pen <a href="https://codepen.io/idorenyinudoh/pen/wvdmXKz"><br/>
web animations api test</a> by Udoh Idorenyin (<a href="https://codepen.io/idorenyinudoh">@idorenyinudoh</a>)<br/>
on <a href="https://codepen.io">CodePen</a>.</p>
<p>要创建多个动画，我们可以在一个关键帧对象中包含多个属性。为了在<code>options</code>对象中使用不同的属性值，我们可以创建多个关键帧和<code>options</code>对象，并在一个元素上多次使用<code>animate()</code>方法。</p>
<p>参见<a href="https://codepen.io"> CodePen </a>上 Udoh Idorenyin(<a href="https://codepen.io/idorenyinudoh">@ idorenyinudoh</a>)<br/>的 Pen <a href="https://codepen.io/idorenyinudoh/pen/bGWOEqg"> <br/>网页动画 api 测试 2 </a>。</p>
<p class="codepen" data-height="500" data-default-tab="css,result" data-slug-hash="bGWOEqg" data-user="idorenyinudoh">See the Pen <a href="https://codepen.io/idorenyinudoh/pen/bGWOEqg"><br/>
web animations api test 2</a> by Udoh Idorenyin (<a href="https://codepen.io/idorenyinudoh">@idorenyinudoh</a>)<br/>
on <a href="https://codepen.io">CodePen</a>.</p>
<p>使用 WAAPI 制作动画的优势</p>
<h2>现在我们已经了解了如何使用 CSS 过渡、CSS 动画和 Web 动画 API 制作动画，让我们注意一下使用 Web 动画 API 的一些经常被忽略的主要优点。</h2>
<p>首先，使用 CSS，我们只能为整个动画使用一个计时函数。然而，使用 Web Animations API，我们可以在<code>options</code>对象中为不同的关键帧和整个动画指定<code>easing</code>属性。</p>
<p>通过 Web Animations API，我们可以使用<code>Animation</code>对象的<code>currentTime</code>和<code>startTime</code>属性以及<code>Animation</code>事件向一个元素添加几个动画。在 CSS 中，您必须用一个动画覆盖另一个动画，一起播放所有动画，或者使用 JavaScript 向同一元素添加另一个动画。</p>
<p>Web 动画 API 中的<code>options</code>对象的<code>composite</code>属性允许我们向浏览器指示我们希望连续的动画如何在一个元素上运行。CSS 没有对等物。</p>
<p>结论</p>
<h2>web 动画 API 中的属性、方法和事件使得在 Web 上自定义动画变得很容易。根据我的经验，不复杂的动画最好用 CSS 实现，而复杂的动画最好用 JavaScript。</h2>
<p>诚然，从头开始制作动画会变得非常困难。你可能想考虑第三方动画工具，比如<a href="https://createwithflow.com"> Flow </a>，它可以将动画导出为 Web Animations API 之类的格式。</p>
<p>我希望你喜欢这个教程。快乐动画！</p>
<p>你的前端是否占用了用户的 CPU？</p><div class="code-block code-block-25">
<div class="blog-plug inline-plug css-plug"><h2>随着 web 前端变得越来越复杂，资源贪婪的特性对浏览器的要求越来越高。如果您对监控和跟踪生产环境中所有用户的客户端 CPU 使用、内存使用等感兴趣，</h2><p>.</p><a target="_blank" href="https://lp.logrocket.com/blg/css-signup">try LogRocket</a><p>LogRocket 就像是网络和移动应用的 DVR，记录你的网络应用或网站上发生的一切。您可以汇总和报告关键的前端性能指标，重放用户会话和应用程序状态，记录网络请求，并自动显示所有错误，而不是猜测问题发生的原因。</p><a class="signup" href="https://lp.logrocket.com/blg/css-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/dacb06c713aec161ffeaffae5bd048cd.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/12/cpu-memory-usage.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/cpu-memory-usage.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/dacb06c713aec161ffeaffae5bd048cd.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/cpu-memory-usage.png"/></noscript></a><a href="https://lp.logrocket.com/blg/css-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>现代化您调试 web 和移动应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/css-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p><p>Modernize how you debug web and mobile apps — <a class="signup" href="https://lp.logrocket.com/blg/css-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a>.</p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>