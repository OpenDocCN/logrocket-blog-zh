<html>
<head>
<title>Getting started with SolidStart: A SolidJS framework </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>SolidStart入门:SolidJS框架</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/getting-started-solidstart-solid-js-framework/#0001-01-01">https://blog.logrocket.com/getting-started-solidstart-solid-js-framework/#0001-01-01</a></blockquote><div><article class="article-post">
<p>前端框架之间的创新竞赛已经发展了一段时间。React创新了像<a href="https://blog.logrocket.com/million-js-build-apps-jsx-faster-react-preact/"> JSX这样的特性，使得表达UI逻辑更具声明性</a>，而Svelte引入了编译来减少客户端包的大小。另一方面，SolidJS结合了这些思想，以及对可组合原语和可观察对象的巧妙使用。</p>
<p>与这些框架的创新并行的是建立在它们之上的元框架的发展，如React的Next.js，Svelte的SvelteKit，以及最近SolidJS的T2 solid start。在本文中，我们将探索SolidStart，考虑它的特性和用例，并最终构建一个简单的应用程序。为了跟进，你可以在GitHub上访问教程的<a href="https://github.com/AlexMercedCoder/lockrocket-solidjs-trips">完整代码。我们开始吧！</a></p>
<h2 id="tableofcontents">目录</h2>

<h2 id="solidstart-features">SolidStart功能</h2>
<p>SolidJS提供了许多你期望从元框架中得到的特性，包括基于文件的路由、API端点以及对服务器端、客户端和静态渲染的支持。</p>
<p>SolidStart还配备了一些令人惊叹的独特功能，比如能够<a href="https://blog.logrocket.com/guide-to-remix-react-framework/">使用表单触发服务器动作，类似于RemixJS </a>，以及能够使用其<code>$server</code>函数轻松定义RPC函数。</p>
<p>需要注意的是，在撰写本文时，SolidStart仍处于实验状态，许多功能可能会缺失或不完整。建议使用SolidStart，风险自担。尽管如此，我们仍然可以使用SolidStart来设置一个简单的应用程序。</p>
<h2 id="setting-up-solidstart-app">设置我们的SolidStart应用程序</h2>
<p>在本教程中，我们将构建一个简单的应用程序来存储商务旅行的数据，包括里程和位置。首先，您的计算机上应该已经安装了Node.js。</p>
<p>首先，打开代码编辑器，打开一个空文件夹。如果您还没有安装pnpm，运行<code>npm install -g pnpm</code>。然后，运行<code>pnpm create solid</code>。</p>
<p>当提示添加服务器端渲染时，选择<strong>是</strong>。为打字稿选择<strong>否</strong>，然后选择一个裸模板。app生成后，运行<code>pnpm install</code>。</p>
<h2 id="folder-structure">文件夹结构</h2>
<p>当使用SolidStart时，您将使用的代码将保存在<code>/src</code>文件夹中，它本身包含一些您应该熟悉的文件和文件夹。</p>
<ul>
<li><code>/components</code>:将非页面的所有组件存储在<code>/components</code>文件夹中</li>
<li><code>/routes</code>:存储<code>/routes</code>中页面的组件。页面将是该文件的默认导出</li>
<li>存储处理应用程序启动的文件，我们不需要接触这些文件</li>
</ul>
<p>创建一个<code>/lib</code>文件夹，您将使用它来创建支持文件，例如，许多我们的API实现细节、支持函数等等。</p>
<h2 id="defining-our-business-trips-data">定义我们的商务旅行数据</h2>
<p>我们将使用数组来更简单地演示如何使用我们的数据模型，而不是使用数据库。如果你更愿意使用MongoDB，你可以看看这篇文章。</p>
<p>创建一个名为<code>src/lib/trips.js</code>的文件:</p>
<pre>// The Trips Array
const trips = [
  {
    location: "Miami, FL",
    mileage: 80,
  },
  {
    location: "Savannah, GA",
    mileage: 120,
  },
];


// functions for working with trips we can then convert into API routes or RPC calls
export function getTrips(){
    return trips
}

export function createTrip(newTrip){
    trips.push(newTrip)
    return trips
}

export function updateTrip(id, updatedTrip){
    trips[id] = updatedTrip
    return trips
}

export function deleteTrip(id){
    trips.splice(id, 1)
    return trips
}
</pre>
<p>在这个文件中，我们创建了一个<code>trip</code>数组来保存我们的数据，以及处理数组的函数:</p>
<ul>
<li><code>getTrips</code>:返回行程数组，类似于SQL中的<code>SELECT * FROM table</code></li>
<li><code>createTrip</code>:接受一个对象，并通过将它推入一个数组来创建一个新的旅程，模拟数据库中的一个<code>INSERT INTO table VALUES (…)</code>查询</li>
<li><code>updateTrip</code>:更新数组中的行程，类似于<code>UPDATE table WHERE conditions SET updates</code>查询</li>
<li><code>deleteTrip</code>:删除数组中的一个行程，类似于<code>DELETE FROM table WHERE conditions</code>查询</li>
</ul>
<p>这些函数本质上将模拟拥有来自数据库ORM的数据模型。</p>
<p>现在，我们可以通过两种方式使这些函数可用于我们的应用程序。首先，我们可以编写使用这些函数的API路由。或者，在相关组件中，我们可以使用这些函数和<code>$server</code>函数来定义RPC调用。请记住，远程过程调用RPC指的是从客户端的函数调用中调用服务器上运行的函数。</p>
<h2 id="using-api-routes-solidstart">通过SolidStart使用API路线</h2>
<p>任何路由都可以是API端点。路由文件只需要导出一个异步<code>GET</code> / <code>POST</code> / <code>PUT</code> / <code>DELETE</code>函数来处理该路由的请求类型。如果路由通过导出默认组件来呈现页面，那么您不能为该路由定义一个额外的<code>GET</code>。</p>
<p>为了展示这个例子，我们将创建一个名为<code>src/routes/api/trips/(trips).js</code>的文件。请注意，文件名周围有括号。这是SolidStart的一个功能，允许您在路径的文件夹中表示主文件。因此，这个文件将处理<code>/api/trips</code> URL。通常情况下，我们会将文件命名为<code>index.jsx</code>。过了一段时间，有这么多同名文件会让人感到困惑。</p>
<p>将以下代码放在<code>index.jsx</code>文件中:</p>
<pre>// json function for sending json responses
import { json } from "solid-start";
import { getTrips, createTrip } from "~/lib/trips";
export async function GET(){
    // return the array of trips
    return json(getTrips())
}
export async function POST({request}){
    // get the request body
    const body = await new Response(request.body).json()
    // create new trip
    createTrip(body)
    // return all trips
    return json(getTrips())
}
</pre>
<p>现在，用<code>npm run dev</code>启动您的服务器，您应该能够使用类似Postman或失眠症这样的工具来测试路线。</p>
<p>向<code><a href="http://localhost:3000/api/trips/" rel="nofollow">http://localhost:3000/api/trips/</a></code>发出一个<code>GET</code>请求，你应该可以得到你所有的旅行:</p>
<p><img data-attachment-id="154310" data-permalink="https://blog.logrocket.com/getting-started-solidstart-solid-js-framework/attachment/get-request-solidstart-app-trips-returned/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png" data-orig-size="730,324" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="get-request-solidstart-app-trips-returned" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned-300x133.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png" decoding="async" class="aligncenter wp-image-154310 size-full jetpack-lazy-image" src="../Images/463f1e9d6d7b1a356455ce6a59e7d8c5.png" alt="Get Request Solidstart App Trips Returned" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned-300x133.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="154310" data-permalink="https://blog.logrocket.com/getting-started-solidstart-solid-js-framework/attachment/get-request-solidstart-app-trips-returned/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png" data-orig-size="730,324" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="get-request-solidstart-app-trips-returned" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned-300x133.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png" decoding="async" loading="lazy" class="aligncenter wp-image-154310 size-full" src="../Images/463f1e9d6d7b1a356455ce6a59e7d8c5.png" alt="Get Request Solidstart App Trips Returned" srcset="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned-300x133.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/01/get-request-solidstart-app-trips-returned.png"/></noscript>
<p>使用如下所示的JSON主体向<code><a href="http://localhost:3000/api/trips/" rel="nofollow">http://localhost:3000/api/trips/</a></code>发出一个<code>POST</code>请求，您应该会看到行程被添加:</p>
<pre>{
    "location": "Manchester,ct",
    "mileage": 1000
}
</pre>
<p><img data-attachment-id="154313" data-permalink="https://blog.logrocket.com/getting-started-solidstart-solid-js-framework/attachment/trip-added-solidstart-example-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png" data-orig-size="743,330" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="trip-added-solidstart-example-app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app-300x133.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png" decoding="async" class="aligncenter wp-image-154313 size-full jetpack-lazy-image" src="../Images/e12da61a0ca58dfadbcb91306a345965.png" alt="Trip Added Solidstart Example App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png 743w, https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app-300x133.png 300w" data-lazy-sizes="(max-width: 743px) 100vw, 743px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="154313" data-permalink="https://blog.logrocket.com/getting-started-solidstart-solid-js-framework/attachment/trip-added-solidstart-example-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png" data-orig-size="743,330" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="trip-added-solidstart-example-app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app-300x133.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png" decoding="async" loading="lazy" class="aligncenter wp-image-154313 size-full" src="../Images/e12da61a0ca58dfadbcb91306a345965.png" alt="Trip Added Solidstart Example App" srcset="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png 743w, https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app-300x133.png 300w" sizes="(max-width: 743px) 100vw, 743px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/01/trip-added-solidstart-example-app.png"/></noscript>
<p>太棒了，我们现在有了可以工作的API端点，多简单啊！</p>
<h2 id="bringing-trips-data-route">将行程数据引入路线</h2>
<p>在SolidStart中，我们可以预取可用于<code>page</code>路线和所有子组件的路线数据。</p>
<p>我们导出<code>routeData</code>，它的返回值通过<code>useRouteData</code>钩子对页面和子组件可用。</p>
<p>让我们设置我们的主页<code>src/routes/index.jsx</code>来创建路由数据，作为对我们的API路由的API调用的结果:</p>
<pre>import { createRouteData } from "solid-start";


// define our route data, server provided data to frontend
export function routeData() {
return createRouteData(async () =&gt; {
  // fetch data from api endpoint
  const response = await fetch("http://localhost:3000/api/trips")
  const data = await response.json()
  return data
});
}

export default function Home() {
  return (
    &lt;main&gt;

    &lt;/main&gt;
  );
}
</pre>
<p>注意，我们使用了<code>createRouteData</code>函数。这个函数的工作方式很像React Query，我们可以用以下好处包装异步操作:</p>
<ul>
<li>每当路由操作发生时，异步函数将再次运行，更新我们的数据</li>
<li>如果我们在多个路径中使用相同的数据，可以给数据一个唯一的名称来帮助缓存</li>
</ul>
<p>我们将在<code>trip</code>组件中看到如何使用动作和路由数据。</p>
<h2 id="trips-component"><code>Trips</code>组件</h2>
<p>现在，我们将创建一个文件，将所有这些放在<code>src/components/Trips.jsx</code>中:</p>
<pre>import { createRouteAction, useRouteData} from "solid-start";
import { createTrip } from "~/lib/trips";
import server$ from "solid-start/server";
export default function Trips() {
  // bring the route data into our component
  const trips = useRouteData();
  // Define an RPC call of what we want to run on the server
  const makeTrip = server$(async (trip) =&gt; createTrip(trip))
  // define a form for creating a trip using solid-states action system
  const [_, { Form }] = createRouteAction(async (formData) =&gt; {
    // create the new trip object
    const trip = {
        location: formData.get("location"),
        mileage: formData.get("mileage")
    }
    // pass object RPC call to create new trip on server
    makeTrip(trip)
  });
  return (
    &lt;div&gt;
      &lt;ul&gt;
        {trips()?.map((trip) =&gt; (
          &lt;li&gt;{trip.location} - mileage: {trip.mileage}&lt;/li&gt;
        ))}
      &lt;/ul&gt;
      &lt;Form&gt;
          &lt;input type="input" name="location" placeholder="location"/&gt;
          &lt;input type="number" name="mileage" placeholder="mileage"/&gt;
          &lt;input type="submit"/&gt;
      &lt;/Form&gt;
    &lt;/div&gt;
  );
}
</pre>
<p>在这个组件中，我们使用了许多SolidStart特性；首先，我们使用<code>useRouteData</code>来获得在<code>page</code>组件中定义的<code>routeData</code>。<code>server$</code>定义一个只在服务器上运行的功能。在这种情况下，我们希望创建<code>Trips</code>的函数只在服务器上运行，因为它不能在客户端运行。</p>
<p>最后，<code>createRouteAction</code>创建一个函数和相应的<code>Form</code>组件。<code>Form</code>组件调用作为动作的函数，触发<code>routeData</code>的重取。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<h2 id="displaying-trips-component">显示<code>Trips</code>组件</h2>
<p>如下编辑您的<code>src/routes/index.jsx</code>:</p>
<pre>import { createRouteData } from "solid-start";
import Trips from "~/components/Trips";

// define our route data, server provided data to frontend
export function routeData() {
return createRouteData(async () =&gt; {
  // fetch data from api endpoint
  const response = await fetch("http://localhost:3000/api/trips")
  const data = await response.json()
  return data
});
}

export default function Home() {
  return (
    &lt;main&gt;
      &lt;Trips/&gt;
    &lt;/main&gt;
  );
}
</pre>
<p>使用<code>useRouteData</code>钩子，我们导出<code>routeData()</code>函数，它允许我们预取页面及其子组件使用的数据。</p>
<p><code>createRouteData</code>创建了一个资源，每当我们的表单在<code>submit</code>上触发的动作发生时，这个资源就会重新提取。最后，<code>&lt;Trips/&gt;</code>组件显示我们的旅行和表单。</p>
<h2 id="conclusion">结论</h2>
<p>希望您已经了解了SolidStart框架的强大之处。虽然在撰写本文时它仍处于试验阶段，但SolidStart有着光明的未来。如果您想了解SolidStart的其他功能，请查看以下版本:</p>

<p> </p><div class="code-block code-block-28">
<div class="blog-plug inline-plug js-libraries-plug"><h2>您是否添加了新的JS库来提高性能或构建新特性？如果他们反其道而行之呢？</h2><p>毫无疑问，前端变得越来越复杂。当您向应用程序添加新的JavaScript库和其他依赖项时，您将需要更多的可见性，以确保您的用户不会遇到未知的问题。</p>
<p>LogRocket 是一个前端应用程序监控解决方案，可以让您回放JavaScript错误，就像它们发生在您自己的浏览器中一样，这样您就可以更有效地对错误做出反应。</p><a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/e8a0ab42befa3b3b1ae08c1439527dc6.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/e8a0ab42befa3b3b1ae08c1439527dc6.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png"/></noscript></a>
<a href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p><a href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>可以与任何应用程序完美配合，不管是什么框架，并且有插件可以记录来自Redux、Vuex和@ngrx/store的额外上下文。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。LogRocket还可以监控应用的性能，报告客户端CPU负载、客户端内存使用等指标。</p><p>自信地构建— <a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>