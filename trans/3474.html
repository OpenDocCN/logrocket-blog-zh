<html>
<head>
<title>Build a web application with Hono - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用Hono - LogRocket博客构建一个web应用程序</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/build-web-application-hono/#0001-01-01">https://blog.logrocket.com/build-web-application-hono/#0001-01-01</a></blockquote><div><article class="article-post">
<p>给定大量的可用选项，为web应用程序选择正确的工具可能是一项挑战。在选择框架时，速度通常是首要考虑的因素。快速加载是web应用程序的一个优先考虑的问题，因为用户不喜欢过长的等待时间。</p>
<p>本文介绍了<a href="https://honojs.dev" target="_blank" rel="noopener"> Hono </a>，这是一个新的、灵活的web应用程序框架，速度非常快。根据框架网站公布的<a href="https://honojs.dev" target="_blank" rel="noopener">测试结果，Hono比Cloudflare Workers的其他路由器快，如</a><a href="https://sunderjs.com" target="_blank" rel="noopener"> Sunder </a>、<a href="https://itty-router.dev/#/" target="_blank" rel="noopener"> Itty Router </a>和<a href="https://github.com/lukeed/worktop#readme" target="_blank" rel="noopener"> Worktop </a>，也比Deno和Bun的其他框架快。</p>
<p>在本文的教程部分，我们将演示如何使用Cloudflare Workers和Hono制作博客应用程序。</p>
<h2 id="contents">内容</h2>

<h2 id="prerequisites">先决条件</h2>
<p>要充分利用本教程，请确保您具备以下条件:</p>

<h2 id="what-is-hono">Hono是什么？</h2>
<p>Hono是一个轻量级、简单、快速的web框架，适用于Cloudflare Workers、Deno、Bun和其他应用程序。这是一个既快速又灵活的现代web应用程序。它提供了对TypeScript的内置支持，并且易于在本地环境中开发。使用Hono，很容易用Deno、Bun和Cloudflare Workers创建可发布的web应用程序。</p>
<h2 id="why-use-hono">为什么用Hono？</h2>
<p>Hono有很多很酷的特性，这也是它受到很多开发者喜爱和使用的原因。以下是Hono的一些特点:</p>
<ul>
<li>无线性环路的超快速路由器</li>
<li>对类型脚本的内置支持</li>
<li>使用服务人员和Web标准API，没有依赖性</li>
<li>允许使用内置中间件、定制中间件和第三方中间件</li>
<li>与多个平台集成，如Cloudflare Workers、Fastfly、<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e0a38f8d90959485a0a5848785">【电子邮件保护】</a>、Deno和Bun</li>
</ul>
<h2 id="demo-building-a-blog-app-with-hono">演示:用Hono构建博客应用程序</h2>
<p>让我们在探索Hono特性的同时创建一个web应用程序。我们将使用Cloudflare Workers设置项目，创建待办事项API，执行CRUD操作，实现身份验证，并添加中间件。</p>
<h3 id="getting-started">入门指南</h3>
<p>首先，让我们用Cloudflare Workers创建第一个Hono应用程序。</p>
<p>首先，为项目创建一个新文件夹，如下所示:</p>
<pre class="language-typescript hljs">mkdir hono-app &amp;&amp; cd hono-app
</pre>
<p>然后，使用Cloudflare Workers命令行工具<a href="https://developers.cloudflare.com/workers/wrangler/" target="_blank" rel="noopener"> Wrangler </a>初始化一个新项目:</p>
<pre class="language-typescript hljs">npx wrangler init -y
</pre>
<p>上述命令将生成以下文件夹结构:</p>
<pre>hono-example
 ┣ src
 ┃ ┗ index.ts
 ┣ .gitignore
 ┣ package-lock.json
 ┣ package.json
 ┣ tsconfig.json
 ┗ wrangler.toml
</pre>
<h3 id="installing-hono">安装荣誉</h3>
<p>要设置应用程序，首先运行以下命令安装Hono包:</p>
<pre class="language-typescript hljs">npm install hono
</pre>
<p>接下来，创建一个Hono服务器，如下所示:</p>
<pre class="language-typescript hljs">import { Hono } from 'hono'
const app = new Hono()

app.get('/', (c) =&gt; c.text('Hello from Hono'))

app.fire()
</pre>
<p>在上面的代码中，我们导入了Hono包并初始化了一个新的Hono app实例。有了这个应用程序实例，我们可以访问Hono的所有可用功能。我们还导出了应用程序实例，以便Cloudflare工作人员可以在服务工作人员模式下运行该应用程序。</p>
<p>接下来，在项目根目录中运行以下命令来启动应用程序:</p>
<pre class="language-typescript hljs">npx wrangler dev
</pre>
<p>该命令将在<code>localhost:8787</code>运行应用程序。你可以在你的浏览器上测试一下。</p>
<h3 id="creating-routes">创建路线</h3>
<p>Hono让路由尽可能的灵活直观；这与使用Express.js这样的框架处理路由的方式非常相似。</p>
<p>让我们创建一个API路由来执行一些CRUD操作。我们将创建一个博客API来阅读和创建博客。</p>
<p>我们将首先为博客创建一个类型和一个变量。将以下代码添加到<code>index.ts</code>文件中:</p>
<pre class="language-typescript hljs">type BLOG = {
  id: number,
  title: string,
  content: string
}

const blogs: BLOG[] = []
</pre>
<p>接下来，我们将使用以下代码定义API路由:</p>
<pre class="language-typescript hljs">app.get('/api/blogs', (c) =&gt; c.json(blogs))

app.get('/api/blogs/:id', (c) =&gt; {
  const { id } = c.req.param()
  const blog = blogs.filter(data =&gt; data.id === parseInt(id))
  return c.json(blog)
})

app.post('/api/blogs', async (c) =&gt; {
  const body = await c.req.parseBody() as BLOG;
  if (!body) return c.json({ status: 401, message: "The request payload is required" })
  const newBlog = {
    id: blogs.length + 1,
    title: body.title,
    content: body.content
  }
  blogs.push(newBlog)
  return c.json({ data: newBlog })
})
</pre>
<p>和Express.js一样，Hono提供了几种方法(例如<code>get</code>、<code>post</code>、<code>update</code>、<code>delete</code>)供我们进行操作。这些方法中的每一个都有一个将<code>c</code>作为参数的回调。<code>c</code>参数为用户提供了访问请求参数和有效负载以及响应请求所需的方法。</p>
<h3 id="adding-authentication">添加身份验证</h3>
<p>Hono提供了中间件来为我们的应用程序快速添加身份验证。Hono提供了三种认证中间件:基本认证、承载认证和JWT认证。可以在<a href="https://honojs.dev/docs/builtin-middleware/" target="_blank" rel="noopener">这里</a>找到每种认证类型的详细信息。</p>
<p>在本演示中，我们将实现基本身份验证。首先，从Hono导入<code>basicAuth</code>中间件，并使用以下代码:</p>
<pre class="language-typescript hljs">import { basicAuth } from 'hono/basic-auth'
...

app.use(
  '/api/*',
  basicAuth({
    username: 'clinton',
    password: '1234',
  })
)
</pre>
<p>这个中间件将防止未经授权的用户请求任何以<code>/api</code>开头的端点。此外，它将显示一个登录用户界面，用户必须登录该界面才能获得访问权限:</p>
<p><img data-attachment-id="137049" data-permalink="https://blog.logrocket.com/build-web-application-hono/attachment/sign-in-ui/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png" data-orig-size="324,235" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sign-in UI" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui-300x218.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png" decoding="async" class="aligncenter size-full wp-image-137049 jetpack-lazy-image" src="../Images/219de3d48c4e9bf350a42a36deb25a66.png" alt="Sign-in UI" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png 324w, https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui-300x218.png 300w" data-lazy-sizes="(max-width: 324px) 100vw, 324px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137049" data-permalink="https://blog.logrocket.com/build-web-application-hono/attachment/sign-in-ui/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png" data-orig-size="324,235" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sign-in UI" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui-300x218.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-137049" src="../Images/219de3d48c4e9bf350a42a36deb25a66.png" alt="Sign-in UI" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png 324w, https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui-300x218.png 300w" sizes="(max-width: 324px) 100vw, 324px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/sign-in-ui.png"/></noscript>
<p>如果用户输入的用户名和密码与中间件中的用户名和密码匹配，Hono将创建一个会话，并允许在后续请求中访问路由。</p>
<h3 id="rendering-static-files">呈现静态文件</h3>
<p>Hono提供了<code>serveStatic</code>中间件，允许呈现位于中间件根选项中指定的目录中的静态文件。</p>
<p>首先，在项目的根目录下创建一个<code>assets</code>文件。然后，更新<code>wrangler.toml</code>文件以指定资产目录，如下所示:</p>
<pre class="language-typescript hljs">[site]
bucket = "./assets"
</pre>
<p>接下来，我们需要创建资产文件或将资产文件添加到资产文件夹中。</p>
<p>在这个演示中，我们将呈现一个HTML页面。因此，在assets文件夹中用下面的标记创建一个<code>index.html</code>文件:</p>
<pre class="language-xml hljs">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Document&lt;/title&gt;
    &lt;link rel="stylesheet" href="/static/style.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h4&gt;Hello from Hono &lt;/h4&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<p>现在，在<code>index.ts</code>文件中设置静态中间件，如下所示:</p>
<pre class="language-typescript hljs">app.use('/static/*', serveStatic({ root: './' }))
app.get('/', serveStatic({ path: './index.html' }));
</pre>
<p>在上面的代码中，我们创建了一个Hono中间件，它将在<code>/static</code>端点上提供静态内容。我们还使用了<code>serverStatic</code>中间件来指定我们的资产目录的根位置。</p>
<h3 id="handling-cors">处理CORS</h3>
<p>为了让我们的应用程序与前端框架交互，我们需要实现CORS。Hono为我们提供了一个<code>cors</code>中间件。</p>
<p>在<code>index.ts</code>文件中导入并设置中间件:</p>
<pre class="language-typescript hljs">import { cors } from 'hono/cors'
app.use('/api/*', cors())
</pre>
<p>在上面的代码中，我们在应用程序中以<code>/api</code>开头的所有端点上实现了CORS。通过这样做，当用户向这些端点发出请求时，不会有任何CORS阻塞。</p>
<h3 id="deploying-the-application">部署应用程序</h3>
<p>现在，让我们通过运行以下命令将应用程序部署到Cloudflare:</p>
<pre class="language-typescript hljs">npx wrangler publish ./src/index.ts
</pre>
<p>上述命令将提示您授权应用程序访问您的Cloudflare帐户。</p>
<p>授权应用程序后，等待部署完成。部署完成后，您将看到应用程序的worker URL，如下所示:</p>
<p><img data-attachment-id="137052" data-permalink="https://blog.logrocket.com/build-web-application-hono/attachment/worker-url/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png" data-orig-size="717,120" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Worker URL" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url-300x50.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png" decoding="async" class="aligncenter size-full wp-image-137052 jetpack-lazy-image" src="../Images/320304bc59bfb5ee29c910d4182090d3.png" alt="Worker URL" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png 717w, https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url-300x50.png 300w" data-lazy-sizes="(max-width: 717px) 100vw, 717px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="137052" data-permalink="https://blog.logrocket.com/build-web-application-hono/attachment/worker-url/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png" data-orig-size="717,120" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Worker URL" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url-300x50.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-137052" src="../Images/320304bc59bfb5ee29c910d4182090d3.png" alt="Worker URL" srcset="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png 717w, https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url-300x50.png 300w" sizes="(max-width: 717px) 100vw, 717px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/10/worker-url.png"/></noscript>
<p>复制链接并进行测试。</p>
<h2 id="conclusion">结论</h2>
<p>在本教程中，我们探索了如何用Hono构建一个web应用程序。我们讨论了Hono是什么以及为什么开发者应该考虑使用这个框架。为了说明这一点，我们展示了如何使用Cloudflare Workers和Hono构建一个博客应用程序。</p>
<p>要了解更多关于Hono的特性，请访问官方文档。</p>
<p>现在你已经被介绍给Hono了，你将如何在你的下一个项目中使用它？</p><div class="code-block code-block-4">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket会告诉您应用程序中实际影响用户的最具影响力的bug和UX问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket自动聚合客户端错误、JS异常、前端性能指标和用户交互。然后LogRocket使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试LogRocket】。</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>