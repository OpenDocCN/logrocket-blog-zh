<html>
<head>
<title>E2E testing in Next.js with Cypress and TypeScript </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用Cypress和TypeScript在Next.js中进行E2E测试</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/#0001-01-01">https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/#0001-01-01</a></blockquote><div><article class="article-post">
<p>写好代码是一回事；对你的代码有信心完全是另一回事！端到端测试通过模拟真实场景，帮助您测试应用的用户体验。这可以让您更全面地了解应用程序的性能，因为您已经从头到尾运行了应用程序，以确保应用程序流的行为符合预期。</p>
<p>在本文中，我们将介绍您需要了解的关于使用Next.js应用程序进行端到端测试的知识，以及如何使用Cypress和Typescript进行测试。</p>
<p><em>向前跳转:</em></p>

<h2 id="what-end-to-end-testing"><strong>什么是</strong>端到端测试？</h2>
<p>在我们开始使用Cypress之前，我们需要快速给出什么是端到端测试以及它给我们的项目带来什么好处的上下文。</p>
<p>如上所述，端到端测试，也称为E2E测试，通过从头到尾模拟真实世界的用户场景和用例，确保应用程序按照预期运行。</p>
<p>端到端测试中采取的一些步骤包括:</p>
<ul>
<li>转到特定的URL</li>
<li>点击登录按钮</li>
<li>填写您的用户名和密码</li>
<li>导航用户设置</li>
<li>注销</li>
</ul>
<p>在这个例子中，您可以看到上面的过程是如何模拟用户如何登录到一个应用程序，然后注销，这是一个常见的场景。</p>
<h2 id="end-to-end-vs-unit-testing"><strong>端到端测试与单元测试</strong></h2>
<p>端到端测试和<a href="https://blog.logrocket.com/unit-testing-react-cypress/">单元测试</a>都是非常重要的测试手段；有些开发人员两种都用，而有些人特别喜欢其中一种方法。让我们简单了解一下它们之间的区别。</p>
<ul>
<li>单元测试:一种测试类型，其中测试应用程序的单个单元、功能或组件(例如，当您在React应用程序中测试组件时)</li>
<li>端到端测试:E2E测试多个组件的组合如何相互交互，以满足预期目标(例如，登录或更改设置)</li>
</ul>
<p>编写单元测试比编写E2E测试简单，因为您可以在构建每个组件时编写它们。相比之下，E2E测试是在所有必要的组件都已经构建和集成之后编写的。</p>
<h2 id="why-end-to-end-testing"><strong>为什么</strong> <strong>要用e </strong> nd去- <strong> e </strong> nd测试<strong>？</strong></h2>
<ol>
<li>它确保了整个应用程序生产的效率</li>
<li>轻松测试应用程序的业务逻辑</li>
<li>满足您可能有的任何端到端测试要求</li>
<li>确保应用程序流程针对最终用户的体验进行了优化</li>
<li>减少bug</li>
<li>增强对整个应用程序功能的信心</li>
</ol>
<h2 id="setting-next-js-application"><strong>设定</strong> <strong> u </strong> p下一个<strong>。js</strong>T6】应用</h2>
<p>在本教程中，您将看到如何借助TypeScript在您的<a href="https://nextjs.org/"> Next.js </a>应用程序中实现<a href="https://www.cypress.io/"> Cypress </a>。</p>
<p>我们将使用我构建的一个简单的Next.js应用程序。使用以下说明启动并运行Next.js应用程序:</p>
<pre class="language-shell hljs"># clone the repository
git clone https://github.com/damiisdandy/employee-inventory-learn-cypress-with-typescript.git

# install all dependencies
yarn install

# setting up the database with docker-compose
yarn docker-compose

# create the .env file based on the template.env and put the database URL for your prisma client

# run application
yarn dev
</pre>
<p>正如你在上面看到的，我们简单地克隆了应用程序，安装了所有的依赖项，然后使用<a href="https://docs.docker.com/compose/"> docker-compose </a> ( <a href="https://docs.docker.com/compose/install/">了解更多关于安装docker-compose的</a>)。我们用它来创建一个PostgreSQL数据库，供我们的应用程序使用。</p>
<blockquote><p><strong> N.B. </strong>，这个repo已经安装并配置了Cypress，您可以在关注本文时以此为参考。</p></blockquote>
<h2 id="understanding-app"><strong>了解app </strong></h2>
<p>这是一个简单的应用程序，通过允许我们上传员工基本信息，如姓名、电子邮件和职业，让我们管理员工数据库。它还允许我们删除员工并搜索特定员工。</p>
<p><img data-attachment-id="144357" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/employee-inventory-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png" data-orig-size="730,405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="employee-inventory" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1-300x166.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png" decoding="async" class="aligncenter wp-image-144357 size-full jetpack-lazy-image" src="../Images/d0cad20f674fef807bea863f464a8c24.png" alt="Employee Inventory" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1-300x166.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144357" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/employee-inventory-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png" data-orig-size="730,405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="employee-inventory" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1-300x166.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png" decoding="async" loading="lazy" class="aligncenter wp-image-144357 size-full" src="../Images/d0cad20f674fef807bea863f464a8c24.png" alt="Employee Inventory" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1-300x166.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-inventory-1.png"/></noscript>
<p><img data-attachment-id="144359" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/employee-profile/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png" data-orig-size="730,405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="employee-profile" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile-300x166.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png" decoding="async" class="aligncenter wp-image-144359 size-full jetpack-lazy-image" src="../Images/75fe393bf1f70e919ea9ddeb1539f573.png" alt="Employee Profile" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile-300x166.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144359" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/employee-profile/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png" data-orig-size="730,405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="employee-profile" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile-300x166.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png" decoding="async" loading="lazy" class="aligncenter wp-image-144359 size-full" src="../Images/75fe393bf1f70e919ea9ddeb1539f573.png" alt="Employee Profile" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile-300x166.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/employee-profile.png"/></noscript>
<h2 id="setting-cypress"><strong>立柏</strong></h2>
<p>Cypress是一个JavaScript库，帮助你编写<a href="https://blog.logrocket.com/real-confidence-with-cypress-e2e-tests/">端到端测试</a>和单元测试。你可以在<a href="https://www.cypress.io/">官方网站</a>上了解更多关于赛普拉斯的信息。</p>
<p>让我们在Next.js应用程序中设置Cypress。</p>
<h3 id="installing-cypress">安装Cypress</h3>
<p>要安装Cypress，请运行:</p>
<pre class="language-shell hljs">yarn add cypress #npm install cypress
</pre>
<h3 id="running-cypress">奔跑的柏树</h3>
<p>完成后，您可以使用以下命令运行Cypress:</p>
<pre class="language-shell hljs">yarn cypress open #npx cypress open
</pre>
<p>在repo中，我创建了一个简单的脚本，使用以下命令来完成此任务:</p>
<pre class="language-shell hljs">yarn cypress:open
</pre>
<p>这将运行柏树应用程序——您会看到下面的屏幕。</p>
<p><img data-attachment-id="144361" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/cypress-greeting-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png" data-orig-size="730,488" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cypress-greeting-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen-300x201.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png" decoding="async" class="aligncenter wp-image-144361 size-full jetpack-lazy-image" src="../Images/33dfd7846a2043aed44cbb64255175ba.png" alt="Cypress Greeting Screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen-300x201.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144361" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/cypress-greeting-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png" data-orig-size="730,488" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cypress-greeting-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen-300x201.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png" decoding="async" loading="lazy" class="aligncenter wp-image-144361 size-full" src="../Images/33dfd7846a2043aed44cbb64255175ba.png" alt="Cypress Greeting Screen" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen-300x201.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-greeting-screen.png"/></noscript>
<p>点击<strong> E2E测试</strong>，你会看到这个屏幕:</p>
<p><img data-attachment-id="144363" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/browser-e2e-testing/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png" data-orig-size="730,486" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="browser-e2e-testing" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png" decoding="async" class="aligncenter wp-image-144363 size-full jetpack-lazy-image" src="../Images/327cc0ed71b4827693aa2fdca6770f9d.png" alt="Browser For E2E Testing" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing-300x200.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144363" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/browser-e2e-testing/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png" data-orig-size="730,486" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="browser-e2e-testing" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png" decoding="async" loading="lazy" class="aligncenter wp-image-144363 size-full" src="../Images/327cc0ed71b4827693aa2fdca6770f9d.png" alt="Browser For E2E Testing" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing-300x200.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/browser-e2e-testing.png"/></noscript>
<p>选择<strong>Chrome</strong>——因为E2E测试需要模拟用户的体验，我们需要在浏览器上运行测试，而不是像单元测试那样直接在终端上运行。完成后，关闭它。</p>
<p>现在，我们来配置Cypress！🚀</p>
<h3 id="config-file">创建配置文件</h3>
<p>在应用程序的根目录下，创建一个名为<code>cypress.config.ts</code>的文件——我们将使用这个文件来配置Cypress的运行方式。你可以在他们的<a href="https://docs.cypress.io/api/plugins/configuration-api#Usage">文件</a>中读到更多相关信息。</p>
<p>在配置文件中写入以下内容:</p>
<pre class="language-typescript hljs">import { loadEnvConfig } from '@next/env';
import { defineConfig } from 'cypress';

const { combinedEnv } = loadEnvConfig(process.cwd());
export default defineConfig({
  env: combinedEnv,
  e2e: {
    baseUrl: 'http://localhost:3000',
    retries: {
      runMode: 3,
    },
    viewportHeight: 1080,
    viewportWidth: 1920,
    video: false,
    screenshotOnRunFailure: false,
    experimentalSessionAndOrigin: true,
  },
});
</pre>
<p>我们现在已经从<code>cypress</code>导入了<code>defineConfig</code>，用于在Cypress中编写配置。其中，我们指定了应用程序的基本URL、我们将使用的Chrome浏览器的宽度和高度，以及其他一些配置。</p>
<h3 id="test-environment-variables">设置测试环境变量</h3>
<p>您可能不希望使用开发环境的数据库运行测试，因为您可能会执行删除数据库或播种等操作。因此，我们需要指定一个单独的<code>.env</code>文件，它将在测试环境<code>NODE_ENV=test</code>中使用。</p>
<p>令人欣慰的是，Next.js <a href="https://nextjs.org/docs/basic-features/environment-variables">让我们可以根据测试环境</a>轻松地指定环境变量。</p>
<p>正如我们在应用程序设置中看到的，我们创建了一个<code>.env</code>，它将包含一个名为<code>DATABASE_URL</code>的变量，该变量包含用于我们的Prisma客户端的数据库的URL。</p>
<p>为了测试，我们将创建另一个名为<code>.env.test</code>的<code>.env</code>文件。当我们运行Cypress测试时，只有这些环境变量会被获取。</p>
<h3 id="cypress-directory">柏树目录</h3>
<p>一旦运行了<code>yarn cypress open</code>命令，就会自动创建一个名为<code>cypress</code>的目录。如果没有，自己创建一个目录，并在其中放置以下目录:</p>
<ol>
<li>这就是我们编写E2E测试的地方</li>
<li>稍后我们将回到这个话题；Cypress并不要求这样，但是我们将使用它来组织我们的代码</li>
<li>这是我们用TypeScript编写自定义命令的地方</li>
<li>这是我们编写自定义任务的地方</li>
</ol>
<p>完成后，您的文件结构应该如下所示:</p>
<p><img data-attachment-id="144365" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/cypress-directory/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png" data-orig-size="730,297" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cypress-directory" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory-300x122.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png" decoding="async" class="aligncenter wp-image-144365 size-full jetpack-lazy-image" src="../Images/8a25b61f8eab40f86bdc74f5ff78f9b4.png" alt="Cypress Directory" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory-300x122.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144365" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/cypress-directory/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png" data-orig-size="730,297" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cypress-directory" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory-300x122.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png" decoding="async" loading="lazy" class="aligncenter wp-image-144365 size-full" src="../Images/8a25b61f8eab40f86bdc74f5ff78f9b4.png" alt="Cypress Directory" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory-300x122.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/cypress-directory.png"/></noscript>
<h2 id="cypress-tasks">Cypress任务</h2>
<p>Cypress任务帮助我们在测试中执行Node.js命令。我们将创建两个任务；一个用来重置数据库，另一个用来播种数据库(播种是指用一些默认的测试数据填充数据库)。</p>
<p>在任务目录中，我们将创建两个名为<code>resetDB.ts</code>和<code>seedDB.ts</code>的文件，并分别在其中编写以下代码:</p>
<pre class="language-typescript hljs">// /cypress/tasks/resetDB.ts

import { prisma } from '../../pages/api/employees';

export default async function resetDB() {
  return prisma.employee.deleteMany({});
};


// /cypress/tasks/seedDB.ts

import { prisma } from '../../pages/api/employees';
import { DEFAULT_EMPLOYEES } from '../constants';

export default async function seedDB() {
  return await prisma.employee.createMany({
    data: DEFAULT_EMPLOYEES,
  });
};
</pre>
<p>您会注意到我们在数据库播种文件中导入了一个名为<code>constants</code>的文件；这是Cypress目录根目录下的一个文件，我们用它来存储Cypress测试的常量。</p>
<p>在这个文件中，您将看到以下代码:</p>
<pre class="language-typescript hljs">// /cypress/constants.ts

import { Employee } from "@prisma/client";
export const DEFAULT_EMPLOYEES: Omit&lt;Employee, 'id'&gt;[] = [
  {
    email: '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="086c69656164676469486f65696164266b6765">[email protected]</a>',
    name: 'damilola jerugba',
    occupation: 'DEVELOPER'
  },
  {
    email: '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e68a8794949fa6818b878f8ac885898b">[email protected]</a>',
    name: 'james larry',
    occupation: 'ACCOUNTANT'
  },
  {
    email: '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cba9aea58ba3a4bfa6aaa2a7e5a8a4a6">[email protected]</a>',
    name: 'ben tobi',
    occupation: 'DOCTOR'
  },
  {
    email: '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="14607b79796d547e7160667b7a797578783a777b79">[email protected]</a>',
    name: 'tommy hedgeson',
    occupation: 'ENGINEER'
  },
  {
    email: '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6004010d090c0f0c014e0a051215070201200a0514120f0e0d010c0c4e030f0d">[email protected]</a>',
    name: 'damiisdandy',
    occupation: 'DEVELOPER'
  },
];
export const NEW_EMPLOYEE: Omit&lt;Employee, 'id'&gt; = {
  name: "Fiyin Jerugba",
  email: "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5e38372737301e39333f3732703d3133">[email protected]</a>",
  occupation: "DOCTOR",
}
</pre>
<p>因此，现在，我们应该有以下文件结构:</p>
<p><img data-attachment-id="144367" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/tasks-file-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png" data-orig-size="730,202" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="tasks-file-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png" decoding="async" class="aligncenter wp-image-144367 size-full jetpack-lazy-image" src="../Images/c7129c272f9964b379803768d251dd51.png" alt="Tasks File Structure" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure-300x83.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144367" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/tasks-file-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png" data-orig-size="730,202" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="tasks-file-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png" decoding="async" loading="lazy" class="aligncenter wp-image-144367 size-full" src="../Images/c7129c272f9964b379803768d251dd51.png" alt="Tasks File Structure" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure-300x83.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/tasks-file-structure.png"/></noscript>
<p>现在，是时候将我们的任务导入到Cypress中了！为此，我们只需转到Cypress配置文件，并向其中添加以下内容:</p>
<pre class="language-typescript hljs">// /cypress.config.ts
// ... previous code imports
import resetDB from './cypress/tasks/resetDB';
import seedDB from './cypress/tasks/seedDB';

const { combinedEnv } = loadEnvConfig(process.cwd());
export default defineConfig({
    // .... previous code
    setupNodeEvents(on, config) {
      on('task', {
        resetDB,
        seedDB,
      });
    },
  },
});
</pre>
<p>好的；现在我们已经添加了任务，让我们测试一下。</p>
<p>在<code>cypress</code>目录的<code>e2e</code>目录中，我们将创建第一个名为<code>main.cy.ts</code>的测试文件，在这里我们将编写所有的端到端测试。</p>
<p><img data-attachment-id="144369" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/e2e-directory/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png" data-orig-size="730,195" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="e2e-directory" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory-300x80.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png" decoding="async" class="aligncenter wp-image-144369 size-full jetpack-lazy-image" src="../Images/5cc9a548a03d975331b1d7b37dacce46.png" alt="E2E Directory" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory-300x80.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144369" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/e2e-directory/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png" data-orig-size="730,195" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="e2e-directory" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory-300x80.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png" decoding="async" loading="lazy" class="aligncenter wp-image-144369 size-full" src="../Images/5cc9a548a03d975331b1d7b37dacce46.png" alt="E2E Directory" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory-300x80.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-directory.png"/></noscript>
<p>现在让我们编写第一个测试:</p>
<pre class="language-typescript hljs">// /cypress/e2e/main.cy.ts

describe('E2E Test', () =&gt; {
  beforeEach(() =&gt; {
    cy.task('resetDB');
    cy.task('seedDB');
    cy.visit('/');
  });
})
</pre>
<p>这里，我们只是使用<code>cy.task()</code>函数来指定我们想要运行的任务；我们使用了<code>beforeEach</code>函数，因为我们希望在每次测试后运行以下所有任务。</p>
<p>添加完毕后，运行<code>yarn cypress open</code>并点击<strong>在Chrome </strong>中开始E2E测试。您应该看到以下内容:</p>
<p><img data-attachment-id="144374" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/e2e-testing-chrome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png" data-orig-size="730,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="e2e-testing-chrome" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png" decoding="async" class="aligncenter wp-image-144374 size-full jetpack-lazy-image" src="../Images/febe643757ec0497318b2bbcce4e4297.png" alt="E2E Testing In Chrome" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144374" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/e2e-testing-chrome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png" data-orig-size="730,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="e2e-testing-chrome" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png" decoding="async" loading="lazy" class="aligncenter wp-image-144374 size-full" src="../Images/febe643757ec0497318b2bbcce4e4297.png" alt="E2E Testing In Chrome" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/e2e-testing-chrome.png"/></noscript>
<p>点击<strong> main.cy.ts </strong>，应该会看到这样一个屏幕:</p>
<p><img data-attachment-id="144378" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/no-tests-found-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png" data-orig-size="730,433" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="no-tests-found-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png" decoding="async" class="aligncenter wp-image-144378 size-full jetpack-lazy-image" src="../Images/e05a1ed95a69fcfab6f64a682a7fdcbc.png" alt="&quot;No Tests Found&quot; Screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144378" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/no-tests-found-screen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png" data-orig-size="730,433" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="no-tests-found-screen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png" decoding="async" loading="lazy" class="aligncenter wp-image-144378 size-full" src="../Images/e05a1ed95a69fcfab6f64a682a7fdcbc.png" alt="&quot;No Tests Found&quot; Screen" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/no-tests-found-screen.png"/></noscript>
<p>我们看到“没有找到测试”,因为我们没有列出任何测试，但是我们已经设置了测试环境。</p>
<h2 id="custom-commands-typescript">使用TypeScript的自定义命令</h2>
<p>现在，是时候使用TypeScript的强大功能来创建一些方便的命令，以帮助使用自动完成功能更容易地编写测试了。</p>
<p>让我们在Cypress文件夹中创建一个<code>tsconfig.json</code>文件，它扩展了Next.js应用程序中使用的文件:</p>
<pre class="language-json hljs">// /cypress/tsconfig.json

{
  "extends": "../tsconfig.json",
  "compilerOptions": {
    "types": ["cypress", "node", "./support"]
  },
  "include": ["**/*.ts"],
  "exclude": []
}
</pre>
<p>与数组<code>"compilerOptions.types"</code>一起列出，可以看到我们从相对目录<code>./support</code>中声明了一个类型。</p>
<p>在<code>support</code>目录中，我们将列出我们的定制命令和它们各自的类型(<a href="https://docs.cypress.io/api/cypress-api/custom-commands">阅读更多</a>)。</p>
<p>在该目录中，我们将创建三个文件:</p>
<ol>
<li><code>commands.ts</code>:自定义命令的功能</li>
<li><code>e2e.ts</code>:导入我们命令的必需文件</li>
<li>我们将在这里编写类型声明</li>
</ol>
<p>您的文件夹结构应该如下所示:</p>
<p><img data-attachment-id="144380" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/folder-structure-8/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png" data-orig-size="730,201" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="folder-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png" decoding="async" class="aligncenter wp-image-144380 size-full jetpack-lazy-image" src="../Images/da32baf83466423050e53d236d76225b.png" alt="Folder Structure" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure-300x83.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144380" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/folder-structure-8/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png" data-orig-size="730,201" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="folder-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png" decoding="async" loading="lazy" class="aligncenter wp-image-144380 size-full" src="../Images/da32baf83466423050e53d236d76225b.png" alt="Folder Structure" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure-300x83.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/folder-structure.png"/></noscript><br/>
We’ll create two custom commands: one to easily select DOM elements and another to intercept API calls.
<p>在<code>commands.ts</code>文件中，编写以下内容:</p>
<pre class="language-typescript hljs">// /cypress/support/commands.ts

Cypress.Commands.add('dataCy', (value) =&gt; {
  cy.get(`[data-cy=${value}]`)
});
Cypress.Commands.add('interceptRequest', (method) =&gt; {
  cy.intercept({ method, path: '/api/employees' }, (req) =&gt; {
    req.alias = method;
  })
})
export { };
</pre>
<p>第一个命令的名字叫做<code>dataCy</code>。这是一个方便的命令，允许我们选择具有<code>data-cy</code>属性的DOM元素；我们需要为我们的测试选择DOM元素来触发点击、键入、选择等事件。</p>
<p>下面是一个具有该属性的html/jsx lemon示例:</p>
<pre><code>&lt;button data-cy="modal-open-button" className="..."&gt;Upload Employee&lt;/button&gt;
</code></pre>
<p>第二个命令<a href="https://docs.cypress.io/api/commands/intercept">帮助我们拦截请求</a>。</p>
<h3>在TypeScript中声明类型</h3>
<p>在<code>index.d.ts</code>文件中，让我们编写以下内容:</p>
<pre class="language-typescript hljs">// /cypress/support/index.d.ts
/// &lt;reference  types="cypress" /&gt;
import './commands';

type Method = 'POST' | 'GET' | 'DELETE';

declare global {
  namespace Cypress {
    interface Chainable {
      dataCy(value: string): Chainable&lt;Element&gt;;
      interceptRequest(method: Method): Chainable&lt;null&gt;;
    }
  }
}
</pre>
<p>然后，在<code>e2e.ts</code>文件中，我们简单地导入定制命令:</p>
<pre class="language-typescript hljs">// /cypress/support/e2e.ts

import './commands';
export { };
</pre>
<p>我们已经正式编写了自定义命令！现在，是时候写一些实际的测试了。</p>
<h2 id="writing-end-to-end-tests">编写端到端测试</h2>
<p>我们将编写一个E2E测试，根据应用程序执行以下操作:</p>
<ol>
<li>搜索员工</li>
<li>上传员工</li>
<li>删除员工</li>
</ol>
<h3 id="search-employees">搜索员工</h3>
<p>这将是一个简单的测试，自动在搜索框中键入员工的姓名，并检查该员工是否在应用程序中列出。</p>
<p>在<code>main.cy.ts</code>文件中，我们将编写以下内容:</p>
<pre class="language-typescript hljs">// cypress/e2e/main.cy.ts

import { slugify } from '../../helper';
import { DEFAULT_EMPLOYEES, } from "../constants";

describe('E2E Test', () =&gt; {
  beforeEach(() =&gt; {
    cy.task('resetDB');
    cy.task('seedDB');
    cy.visit('/');
  });
  it('Search for Employees', () =&gt; {
    cy.dataCy("search-bar").click().type(DEFAULT_EMPLOYEES[0].name);
    cy.dataCy("employee").first()
      .dataCy(`employee-name-${slugify(DEFAULT_EMPLOYEES[0].email)}`)
      .contains(DEFAULT_EMPLOYEES[0].name, { matchCase: false });
  });
})
</pre>
<p>我们正在导入两个文件。第一个是名为<code>helper</code>的文件，它位于我们应用程序的根目录，用于<a href="https://itnext.io/whats-a-slug-f7e74b6c23e0">编辑</a>一个员工的电子邮件，这样我们就可以很容易地识别它。你可能想知道为什么我们不仅仅使用ID。我们不能使用ID，因为删除和植入数据库会使其不可预测。</p>
<p>显然，在我们的React代码中，我们将使用相同的<code>slugify()</code>函数动态设置<code>data-cy</code>。</p>
<pre class="language-jsx hljs">&lt;p data-cy={`employee-name-${slugify(email)}`} className="text-center capitalize"&gt;
  {name}
&lt;/p&gt;
</pre>
<h3>测试步骤:</h3>
<ol>
<li>点击搜索栏并输入员工姓名</li>
<li>选择具有属性<code>data-cy="employee"</code>的<code>first</code> DOM元素</li>
<li>找到具有该属性的DOM元素(例如，<code>data-cy="employee-name-damilolagmail.com"</code>)</li>
<li>请检查它是否存在以及是否具有正确的名称</li>
</ol>
<p>使用<code>yarn cypress open</code>运行Cypress测试应显示以下内容:</p>
<p><img data-attachment-id="144382" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/running-cypress-test-search-for-employee/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="running-cypress-test-search-for-employee" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png" decoding="async" class="aligncenter wp-image-144382 size-full jetpack-lazy-image" src="../Images/40858693a308cecbe51b1a1f0c4d6df3.png" alt="Running Cypress Test To Search For Employees" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144382" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/running-cypress-test-search-for-employee/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="running-cypress-test-search-for-employee" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png" decoding="async" loading="lazy" class="aligncenter wp-image-144382 size-full" src="../Images/40858693a308cecbe51b1a1f0c4d6df3.png" alt="Running Cypress Test To Search For Employees" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/running-cypress-test-search-for-employee.png"/></noscript>
<h3 id="upload-employee">上传员工</h3>
<p>这个测试打开模型来上传一个员工，填写表单，然后最后上传这个员工。</p>
<p>在<code>main.cy.ts</code>文件中，我们将编写以下内容:</p>
<pre class="language-typescript hljs">import { slugify } from '../../helper';
import { DEFAULT_EMPLOYEES, NEW_EMPLOYEE } from "../constants";
import Modal from '../interface/Modal';

describe('E2E Test', () =&gt; {
// ...previous code
  it('Create employee', () =&gt; {
    cy.interceptRequest('POST').as('createEmployee');
    const modal = new Modal();
    modal.openModal().selectInputandType('name', NEW_EMPLOYEE.name)
      .selectInputandType('email', NEW_EMPLOYEE.email)
      .selectOccupation(NEW_EMPLOYEE.occupation)
      .clickUpload();
    cy.wait('@createEmployee');
    cy.dataCy('employee').last()
      .dataCy(`employee-name-${slugify(NEW_EMPLOYEE.email)}`).contains(NEW_EMPLOYEE.name, { matchCase: false })
      .dataCy(`employee-email-${slugify(NEW_EMPLOYEE.email)}`).contains(NEW_EMPLOYEE.email, { matchCase: false })
      .dataCy(`employee-occupation-${slugify(NEW_EMPLOYEE.email)}`).contains(NEW_EMPLOYEE.occupation, { matchCase: false })
  });
})
</pre>
<p>您会注意到我们在<code>interface</code>目录中导入了一个名为<code>Modal</code>的类；这是一个简单的类，它帮助我们创建一个模态用户界面的模型，这样我们就可以编写更简洁、更具描述性的代码。</p>
<p>在<code>interface</code>目录中，使用以下类创建一个<code>Modal.ts</code>文件:</p>
<pre class="language-typescript hljs">// cypress/interface/Modal.ts

import { Occupation, Employee } from "@prisma/client";

export default class Modal {
  openModal() {
    cy.dataCy('modal-open-button').click();
    return this;
  }
  selectInputandType(name: keyof Omit&lt;Employee, 'id' | 'occupation'&gt;, value: string) {
    cy.dataCy(`modal-input-${name}`).click().type(value);
    return this;
  }
  selectOccupation(value: Occupation) {
    cy.dataCy(`modal-input-occupation`).select(value);
    return this;
  }
  clickUpload() {
    cy.dataCy('modal-button').click();
    return this;
  }
}
</pre>
<p>这个类有一些助手方法，它们与模态的UI交互——我们返回<code>this</code>,这样我们可以链接这些方法。</p>
<h3><strong>测试步骤:</strong></h3>
<ol>
<li>我们首先用自定义命令拦截任何<code>POST</code>请求</li>
<li>打开模式并填写员工的详细信息</li>
<li>点击上传按钮，等待请求完成</li>
<li>请求完成后，检查上传的新员工是否存在于列出的员工中</li>
</ol>
<p>注意这里TypeScript如何帮助我们自动完成定制命令的参数。</p>
<p><img data-attachment-id="144384" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/custom-command-parameters-typescript/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png" data-orig-size="730,254" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="custom-command-parameters-typescript" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript-300x104.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png" decoding="async" class="aligncenter wp-image-144384 size-full jetpack-lazy-image" src="../Images/2fe51f292ba0e5774f95ceaf4fdcffa6.png" alt="Custom Command Parameters In TypeScript" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript-300x104.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144384" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/custom-command-parameters-typescript/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png" data-orig-size="730,254" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="custom-command-parameters-typescript" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript-300x104.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png" decoding="async" loading="lazy" class="aligncenter wp-image-144384 size-full" src="../Images/2fe51f292ba0e5774f95ceaf4fdcffa6.png" alt="Custom Command Parameters In TypeScript" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript-300x104.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/custom-command-parameters-typescript.png"/></noscript>
<h3 id="remove-employee">删除员工</h3>
<p>这个测试只是删除一个雇员，并通过检查删除后列出的雇员数量来验证这一点。</p>
<pre class="language-typescript hljs">import { slugify } from '../../helper';
import { DEFAULT_EMPLOYEES, NEW_EMPLOYEE } from "../constants";
import Modal from '../interface/Modal';

describe('E2E Test', () =&gt; {
// ...previous code
  it('Delete employee', () =&gt; {
    cy.dataCy('employee-delete-button').last().click();
    cy.dataCy('employees').children().should('have.length', DEFAULT_EMPLOYEES.length - 1)
  })
})
</pre>
<h3><strong>测试步骤:</strong></h3>
<ol>
<li>点击最后一个删除按钮</li>
<li>检查员工列表的长度，并确保其递减1</li>
</ol>
<p>用<code>yarn cypress open</code>运行Cypress测试应该会显示:</p>
<p><img data-attachment-id="144386" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/running-test-remove-employee/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png" data-orig-size="730,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="running-test-remove-employee" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png" decoding="async" class="aligncenter wp-image-144386 size-full jetpack-lazy-image" src="../Images/9d876e51d580e29d9e38bc9685499170.png" alt="Running Test To Remove Employee." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="144386" data-permalink="https://blog.logrocket.com/end-to-end-testing-next-js-apps-cypress-typescript/attachment/running-test-remove-employee/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png" data-orig-size="730,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="running-test-remove-employee" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png" decoding="async" loading="lazy" class="aligncenter wp-image-144386 size-full" src="../Images/9d876e51d580e29d9e38bc9685499170.png" alt="Running Test To Remove Employee." srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/running-test-remove-employee.png"/></noscript>
<p>祝贺您，您已经用Cypress编写了一个端到端的测试！</p>
<h2 id="conclusion">结论</h2>
<p>在本文中，我们看到了使用Cypress和Typescript进行端到端测试的强大功能。</p>
<p>E2E测试允许我们测试应用程序的整个流程，以模拟实际用户的流程，这给了我们在测试应用程序时所需的信心。</p>
<p>凭借TypeScript的强大功能，我们在自动完成类型和捕捉错误的速度方面获得了更好的开发经验。</p><div class="code-block code-block-30">
<div class="blog-plug inline-plug next-plug"><h2><a href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank"> LogRocket </a>:全面了解生产Next.js应用</h2><p>调试下一个应用程序可能会很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪状态、自动显示JavaScript错误、跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" data-lazy-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/></noscript></a><a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a><p>LogRocket 就像是网络和移动应用的DVR，记录下你的Next.js应用上发生的一切。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。LogRocket还可以监控应用程序的性能，报告客户端CPU负载、客户端内存使用等指标。</p><p>LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p><p>让您调试Next.js应用的方式现代化— <a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>