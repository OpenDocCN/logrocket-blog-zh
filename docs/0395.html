<html>
<head>
<title>Using Vue.js event emitters to modify component data - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用Vue.js事件发射器修改组件数据</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/use-vue-js-event-emitters-modify-component-data/#0001-01-01">https://blog.logrocket.com/use-vue-js-event-emitters-modify-component-data/#0001-01-01</a></blockquote><div><article class="article-post">
<p><em> <strong>编者按:</strong>本文更新于2022年4月4日，演示使用Vue.js v.3和Composition API修改组件数据。</em></p>
<p>本文将演示如何使用事件发射器在<a href="https://blog.logrocket.com/how-to-make-your-components-dynamic-in-vue-js/"> Vue.js </a>中将数据及其状态从子组件传递到父组件。我们将从回顾通过组件传递数据开始，然后进入我们的演示。我们的演示将涵盖以下内容:</p>

<h2 id="before-you-start">开始之前…</h2>
<p>这篇文章适合所有阶段的开发者，包括初学者。在阅读本文之前，您应该已经具备了以下几点:</p>
<ul>
<li><a href="https://blog.logrocket.com/web-analytics-with-node-js/" target="_blank" rel="noopener"> Node.js </a>版本10.x及以上安装。您可以使用下面的命令来验证您是否已经准备好了:<br/> node -v</li>
<li>代码编辑器——我强烈推荐VS代码</li>
<li>Vue的最新版本，全球安装在您的机器上</li>
<li>Vue CLI 3.0，安装在您的机器上</li>
</ul>
<p>如果您的计算机上没有Vue CLI，请使用以下命令安装它:</p>
<pre class="language-bash hljs">npm install -g @vue/cli
</pre>
<p>接下来，创建一个新项目<code>event-emitters</code>，如下所示:</p>
<pre class="language-bash hljs">vue create event-emitters
</pre>
<p>确保在创建应用程序时选择Vue 3。</p>
<p>然后，将cd放入应用程序文件夹，并使用以下命令启动应用程序:</p>
<pre class="language-bash hljs">cd event-emitters
</pre>
<pre class="language-bash hljs">npm run serve
</pre>
<p>在本文中，我们将使用<a href="https://vuejs.org/guide/extras/composition-api-faq.html">C</a>T4】组合API 来演示如何通过事件向父组件发送数据。这允许我们在事件触发时将某些数据传递给父组件，例如<code>onClick</code>或<code>keyup</code>。</p>
<h2 id="passing-data-through-components">通过组件传递数据</h2>
<p>为了将数据值从父组件(如<code>app.vue</code>)传递到app组件内部的子组件(如嵌套组件)，Vue.js为我们提供了一个名为props的平台。道具是我们可以在组件上注册的自定义属性。使用props，我们可以在父组件中定义数据，给它一个值，然后将该值传递给一个prop属性，该属性可以在子组件中被向下引用。</p>
<p>这篇文章将展示这个过程的反向过程。在本教程中，我们将从子组件更新父组件中的数据值。我们将使用emit构造来处理事件发射和数据更新。</p>
<h2 id="demo-passing-data-from-child-component-to-parent-component">演示:将数据从子组件传递到父组件</h2>
<p>我们将介绍从子组件发出事件的过程，在父组件上设置监听以便传递来自子组件的数据，然后最终更新数据值。</p>
<p>入门指南</p>
<p>在文件夹中，您会发现两个组件:<code>parentComponent.vue</code>和<code>childComponent.vue</code>，根组件是<code>app.vue</code>文件。您的<code>childComponent.vue</code>文件应该如下所示:</p>
<pre class="language-javascript hljs">&lt;template&gt;
  &lt;input v-model="inputValue" @keyup="inputChange"/&gt;
&lt;/template&gt;
&lt;script&gt;
import {ref} from "vue"
export default {
  name: "ChildComponent",
  setup(props, context) {
    const inputValue = ref("")
    const inputChange = ()=&gt; {
      context.emit("newValue", inputValue.value);
    };
    return {
      inputChange,
      inputValue
    };
  },
  emits:["newValue"]
};
&lt;/script&gt;
</pre>
<h3 id="setting-the-emitter">设置发射器</h3>
<p>对于这个演示，我们希望将子组件的行为传递给父组件，这样在单击时，嵌套在父组件中的每个标题都会改变。</p>
<p>为此，我们需要创建一个发射器，该发射器将在子组件中发出一个事件，父组件可以监听该事件并做出反应。这与组件的事件侦听器逻辑相同。</p>
<p>我们有一个绑定到<code>inputValue</code>的<code>input</code>元素。接下来，我们使用<code>@keyup</code>事件来触发我们的<code>inputChange</code>函数。我们使用这个函数通过<code>inputValue</code>实时发出我们的输入值。为此，我们将<code>context</code>传递到我们的<code>setup</code>中，并发出如下数据:</p>
<pre class="language-javascript hljs">context.emit("newValue", inputValue.value);
</pre>
<p>通过这样做，我们将事件命名为<code>newValue</code>，并将其添加到我们的<code>emits</code>数组中:</p>
<pre class="language-javascript hljs">emits:["newValue"]
</pre>
<p>现在，我们可以使用<code>newValue</code>将输入值传递给<code>keyup</code>上的父组件。</p>
<h3 id="listening-to-the-emitted-event">侦听发出的事件</h3>
<p>事件创建后要做的下一件事是监听它并做出响应。</p>
<p>我们去看看你的<code>parentComponent.vue</code>文件。它应该是这样的:</p>
<pre class="language-javascript hljs">&lt;template&gt;
  &lt;div&gt;
    &lt;h3&gt;Input: {{ title }}&lt;/h3&gt;
    &lt;child-component @newValue="changeTitle" /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import ChildComponent from "./childComponent.vue";
import {ref} from "vue"
export default {
  name: "ParentComponent",
  components: {
    ChildComponent
  },
  setup() {
    const title = ref("");
    const changeTitle = (newTitle) =&gt; {
      console.log("fire")
      title.value = newTitle;
    };
    return { title, changeTitle };
  },
};
&lt;/script&gt;
</pre>
<p>在上面的代码中，我们将<code>child-component</code>导入到父组件中。</p>
<p>然后，我们添加<code>@newValue="changeTitle"</code>来告诉组件监听子组件的变化，并用新数据触发我们的<code>changeTitle</code>。</p>
<h3 id="updating-the-data-value">更新数据值</h3>
<p>接下来，我们使用<code>ref</code>声明<code>title</code>,并在用户输入时将新的子输入数据分配给<code>title</code>:</p>
<pre class="language-javascript hljs">const title = ref("");
const changeTitle = (newTitle) =&gt; {
      console.log("fire")
      title.value = newTitle;
    };
</pre>
<p>最后，我们使用<code>title</code>在父组件中显示用户输入。</p>
<pre class="language-javascript hljs">&lt;h3&gt;Input: {{ title }}&lt;/h3&gt;
</pre>
<p>值得注意的是，当数据通过发射器传递到父组件时，嵌套在父组件中的任何组件中的数据也会重新呈现和更新。</p>
<p>如果你从一开始就关注这篇文章，你可以下载或者用VS代码克隆演示项目。完成项目的演示如下所示:</p>
<p><img data-attachment-id="102069" data-permalink="https://blog.logrocket.com/use-vue-js-event-emitters-modify-component-data/vue-js-event-emitter-demo-project/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project.gif" data-orig-size="600,497" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Vue.js event emitter demo project" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project-300x249.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project.gif" decoding="async" class="aligncenter wp-image-102069 size-full jetpack-lazy-image" src="../Images/ddbc21a23371387d6ec12e6e5c3ae9e5.png" alt="Vue.js Event Emitter Demo Project" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="102069" data-permalink="https://blog.logrocket.com/use-vue-js-event-emitters-modify-component-data/vue-js-event-emitter-demo-project/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project.gif" data-orig-size="600,497" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Vue.js event emitter demo project" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project-300x249.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project.gif" decoding="async" loading="lazy" class="aligncenter wp-image-102069 size-full" src="../Images/ddbc21a23371387d6ec12e6e5c3ae9e5.png" alt="Vue.js Event Emitter Demo Project" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/08/vue-js-event-emitter-demo-project.gif"/></noscript>
<h2 id="conclusion">结论</h2>
<p>希望本文向您介绍了在Vue中使用带有发射器的事件的另一个有趣的方面:在一个组件中创建一个事件，在另一个组件中监听并响应它。这可以有许多用例，将真正有益于您的工作流程。编码快乐！</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>