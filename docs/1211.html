<html>
<head>
<title>How to consume APIs with Vuex, Pinia, and Axios - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何使用Vuex、Pinia和Axios使用API</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/#0001-01-01">https://blog.logrocket.com/consume-apis-vuex-pinia-axios/#0001-01-01</a></blockquote><div><article class="article-post">
<p><strong> <em>编者按:</em> </strong> <em>本帖最后一次更新于2022年11月2日，增加了关于用Vuex和Axios消费API的信息，并根据Vuex的最新版本(v5，撰写时)回答了关于使用Pinia和Vuex的热门搜索查询。</em></p>
<p>应用程序编程接口(API)是一组用于访问应用程序的编程标准。这意味着有了API，你的后端和前端应用程序可以在用户不知情的情况下互相通信。</p>
<p>“使用”API意味着通过API接收请求和发送响应。在本文中，您将了解如何使用Vuex、Pinia和Axios从服务器消费API。我们将涵盖以下部分:</p>

<h2 id="using-axios-vue">将Axios与Vue配合使用</h2>
<p>有些框架，比如Angular、JQuery、<a href="https://vuejs.org/"> Vue.js </a>的1.0版本，自带了内置的HTTP APIs。从Vue 2.0开始，开发者已经决定内置的HTTP客户端模块，<a href="https://github.com/pagekit/vue-resource"> Vue-resource </a>不再是必不可少的，可以被第三方库取代。现在最推荐的库是<a href="https://github.com/axios/axios"> Axios </a>。</p>
<p>Axios是一个灵活的HTTP客户端库，默认情况下使用promises，同时在客户端和服务器端运行，这使得它适合在服务器端呈现期间获取数据。用Vue.js很好用。</p>
<h2 id="understanding-state-management">了解状态管理如何工作</h2>
<p>状态管理是一种设计模式的实现，用于管理将在给定应用程序的各个组件之间共享的数据，这有助于确保呈现给用户的数据的一致性。</p>
<p>在Vue.js单页应用程序(SPA)中，在将数据发送回服务器之前，多个组件可以在任何给定的时间与数据交互并更改数据。因此，开发人员需要一种方法来管理这些变化——“状态”——这可以通过状态管理库来完成，如<a href="https://blog.logrocket.com/pinia-vs-vuex/"> Vuex或Pinia </a>。</p>
<p>状态管理库允许你从组件中提取共享状态，在一个全局单例中管理它，或者提供组件对状态的访问，或者触发动作，不管它们在树中的什么位置。</p>
<h3 id="when-to-use-state-management-library">何时使用状态管理库</h3>
<p>如果你从来没有建过大规模的SPA，用库来进行状态管理可能会觉得太复杂，没必要。但是，如果您正在构建一个中型到大型的SPA，那么您可能会遇到这样的情况，即您必须再三考虑如何更好地处理和共享组件之间的状态。如果是这样，Vuex或Pinia就是适合你的工具！</p>
<p><strong>为什么应该使用状态管理库</strong> <br/>通常，在以下情况下，您会希望使用库来管理状态:</p>
<ul>
<li>您的组件需要共享和更新状态</li>
<li>它们为数据/状态提供了单一的真实来源</li>
<li>有了状态管理，就不需要将事件从一个组件传递到多个组件</li>
<li>全局状态是反应性的，这意味着改变状态允许它在使用它的每个其他组件中被更新</li>
</ul>
<h2 id="vuex">什么是Vuex？</h2>
<p>对于深度嵌套的组件来说，传递属性可能很困难，甚至几乎不可能。使用对父/子实例的直接引用，或者试图通过事件改变和同步状态的多个副本，这可能很有诱惑力。但是这两个选项都不推荐，因为它们可能会产生不可维护的代码和错误。</p>
<p>Vuex是Vue.js应用程序的状态管理模式和库。它充当应用程序中所有组件的集中存储:</p>
<p><img data-attachment-id="142317" data-permalink="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/attachment/vuex-state-management-cycle/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle.gif" data-orig-size="730,411" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="The Vuex state management cycle" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle-300x169.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle.gif" decoding="async" class="aligncenter size-full wp-image-142317 jetpack-lazy-image" src="../Images/56163dc1a995306a95d9a17957eddc23.png" alt="The Vuex State Management Cycle" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="142317" data-permalink="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/attachment/vuex-state-management-cycle/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle.gif" data-orig-size="730,411" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="The Vuex state management cycle" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle-300x169.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-142317" src="../Images/56163dc1a995306a95d9a17957eddc23.png" alt="The Vuex State Management Cycle" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/vuex-state-management-cycle.gif"/></noscript>
<h2 id="pinia">皮尼亚是什么？</h2>
<p>与Vuex类似，<a href="https://blog.logrocket.com/complex-vue-3-state-management-pinia/"> Pinia </a>是另一个设计用于Vue框架的状态管理库。Pinia的一些基本概念和原则与Vuex的非常相似，只有几个概念区分了这些库，例如开箱即用的模块化和语法上的微小差异。有了足够的Vuex知识，如果你刚刚开始，学习使用Pinia应该是一件容易的事情。</p>
<p>事实上，Pinia现在被认为是Vuex 5，是推荐给Vue应用的默认状态管理库。然而，这并不意味着不再支持Vuex。此外，尽管设计时考虑了组合API和Vue 3，但Pinia与Vue 2和Vue 3都兼容，不管您打算使用组合API还是选项API。</p>
<h2 id="pinia-vs-vuex">pinia诉Vuex案</h2>
<p>Vuex的一个主要缺点是创建动作和突变的复杂性和重复性；例如，当处理大规模应用程序时，您需要创建触发突变的动作，这变成了一个费力且重复的过程。Pinia受到这种Vuex限制的启发，这种限制通常会消除突变，同时也为全局状态管理提供了一种更加模块化的方式。</p>
<h2 id="new-vue-project-axios">用Axios建立一个新的Vue项目</h2>
<p>对于本教程，我们将使用最新的默认Vue版本3.0和复合API。如果您尚未安装Vue CLI，请在您的终端中运行以下命令:</p>
<pre class="language-bash hljs">npm install -g @vue/cli
</pre>
<p>要查看您的系统上是否已经安装了Vue CLI，请执行以下代码。如果已经安装了Vue，应该会出现Vue CLI版本:</p>
<pre class="language-bash hljs">vue --version
// 5.0.1
</pre>
<p>现在，通过在终端中运行以下代码来创建一个Vue项目:</p>
<pre class="language-bash hljs">vue create my-app
</pre>
<p>接下来，您将收到选择Vue版本的提示。选择Vue 3:</p>
<p><img data-attachment-id="142326" data-permalink="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/attachment/selecting-appropriate-vue-version/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png" data-orig-size="730,189" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Selecting the appropriate Vue version" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version-300x78.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png" decoding="async" class="aligncenter size-full wp-image-142326 jetpack-lazy-image" src="../Images/2a17ef9f2f0e94e7926ff40d032aea51.png" alt="Selecting The Appropriate Vue Version" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version-300x78.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="142326" data-permalink="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/attachment/selecting-appropriate-vue-version/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png" data-orig-size="730,189" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Selecting the appropriate Vue version" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version-300x78.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-142326" src="../Images/2a17ef9f2f0e94e7926ff40d032aea51.png" alt="Selecting The Appropriate Vue Version" srcset="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version-300x78.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/selecting-appropriate-vue-version.png"/></noscript>
<p>一旦我们的应用程序准备就绪，按照命令进入应用程序目录并启动服务器:</p>
<p><img data-attachment-id="142330" data-permalink="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/attachment/starting-server-in-app-directory/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Starting the server in the app directory" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png" decoding="async" class="aligncenter size-full wp-image-142330 jetpack-lazy-image" src="../Images/986159485866a9b52ce2a4b7c0a16334.png" alt="Starting The Server In The App Directory" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory-300x154.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="142330" data-permalink="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/attachment/starting-server-in-app-directory/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Starting the server in the app directory" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-142330" src="../Images/986159485866a9b52ce2a4b7c0a16334.png" alt="Starting The Server In The App Directory" srcset="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory-300x154.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/starting-server-in-app-directory.png"/></noscript>
<p>然后，您可以安装和设置Axios，我们将使用以下代码从API获取数据:</p>
<pre class="language-bash hljs">yarn add axios
# OR
npm install axios
</pre>
<h2 id="install-vuex-store">安装并设置Vuex商店</h2>
<p>使用以下代码安装和设置Vuex:</p>
<pre class="language-bash hljs">yarn add vuex
# OR
npm install vuex
</pre>
<p>接下来，在您的<code>src</code>文件夹中创建一个文件夹，并将其命名为<code>store</code>。在您的<code>store</code>文件夹中，创建一个新的<code>index.js</code>，这样您的项目文件夹将具有类似于下面的结构:</p>
<pre class="language-html hljs">├── index.html
└── src
    ├── components
    ├── App.vue
    └──store
       └── index.js        # where we assemble modules and export the store
</pre>
<p>接下来，在您的<code>store/index.js</code>文件中，输入以下代码:</p>
<pre class="language-javascript hljs">//import the createStore object from Vuex
import { createStore } from 'vuex'
// Import axios to make HTTP requests
import axios from "axios"
export default createStore({
    state: {},
    getters: {},
    actions: {},
    mutations: {}
})
/** we have just created a boiler plate for our vuex store module**/
</pre>
<p>通过更新您的<code>main.js</code>文件来注册您的商店，以匹配以下内容:</p>
<pre class="language-javascript hljs">import { createApp } from "vue";
import App from "./App.vue";
import store from "./store";

createApp(App).use(store).mount("#app");
</pre>
<h2 id="consuming-apis-vuex-axios">使用Vuex和Axios使用API</h2>
<p>在我们继续之前，如果您想进一步了解Vuex 中的动作、突变和getters，我建议查看LogRocket关于这个主题的非常简洁的文章。</p>
<p>为了正确理解如何使用Vuex动作、状态、突变和getters创建Vuex存储和使用Axios的API，我们将创建一个简单的Vuex应用程序，它从我们的假JSON后端获取用户信息并填充我们的模板。要继续，用以下代码更新<code>store/index.js</code>文件:</p>
<pre class="language-javascript hljs">// store/index.js

import { createStore } from "vuex";
import axios from "axios";
export default createStore({
  state: {
    users: [],
  },
  getters: {
    getUsers: (state) =&gt; state.users,
  },
  actions: {
    async fetchUsers({ commit }) {
      try {
        const data = await axios.get(
          "https://jsonplaceholder.typicode.com/users"
        );
        commit("SET_USERS", data.data);
      } catch (error) {
        alert(error);
        console.log(error);
      }
    },
  },
  mutations: {
    SET_USERS(state, users) {
      state.users = users;
    },
  },
});
</pre>
<p>我们使用async/await格式从端点获取数据，并使用Axios发出HTTP请求。</p>
<p>我们将向<code>actions</code>对象内部的API表单发出请求。在<code>try</code>块中，我们将一个<code>data</code>变量赋给我们的HTTP请求。当返回一个响应时，提交一个变异，更新应用程序的状态。</p>
<p>我们还可以在控制台的<code>catch</code>块中警告错误或记录错误。</p>
<p>在您的<code>HelloWorld.vue</code>文件中，粘贴以下代码:</p>
<pre class="language-javascript hljs">&lt;template&gt;
  &lt;div class="hello"&gt;
    &lt;h1&gt;{{ msg }}&lt;/h1&gt;
    &lt;h1&gt;Made By Getters&lt;/h1&gt;
    &lt;div v-for="user in getUsers" :key="user.id"&gt;
      {{ user.id }} {{ user.name }} {{ user.address }}
    &lt;/div&gt;
    &lt;h1&gt;Made By Actions&lt;/h1&gt;
    &lt;div v-for="user in users" :key="user.id"&gt;
      {{ user.id }} {{ user.name }} {{ user.address }}
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted, computed } from "vue";
import { useStore } from "vuex";
const store = useStore();
const msg = ref("Welcome to my Vuex Store");
const getUsers = computed(() =&gt; {
  return store.getters.getUsers;
});
const users = computed(() =&gt; {
  return store.state.users;
});
onMounted(() =&gt; {
  store.dispatch("fetchUsers");
});
&lt;/script&gt;
</pre>
<p>在您的浏览器上导航回<code>localhost:8080</code>，查看我们所做的更改:</p>
<p><img data-attachment-id="142337" data-permalink="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/attachment/view-changes-in-browser/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png" data-orig-size="730,464" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="View changes in browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser-300x191.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png" decoding="async" class="aligncenter size-full wp-image-142337 jetpack-lazy-image" src="../Images/9466147d899d0894bd065f429eb06816.png" alt="View Changes In Browser" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser-300x191.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="142337" data-permalink="https://blog.logrocket.com/consume-apis-vuex-pinia-axios/attachment/view-changes-in-browser/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png" data-orig-size="730,464" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="View changes in browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser-300x191.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-142337" src="../Images/9466147d899d0894bd065f429eb06816.png" alt="View Changes In Browser" srcset="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser-300x191.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/03/view-changes-in-browser.png"/></noscript>
<h2 id="install-pinia-store">安装和设置Pinia商店</h2>
<p>要安装和设置Pinia，请遵循以下步骤:</p>
<pre class="language-bash hljs">yarn add pinia
# OR
npm install pinia
</pre>
<p>接下来，将Pinia导入到应用程序的根文件<code>main.js</code>中，并将其实例化如下:</p>
<pre class="language-bash hljs">import { createApp } from 'vue'
import App from './App.vue'

//Import Pinia into your config file
import { createPinia } from 'pinia'

createApp(App)
//Add the line below to the file to instantiate it
.use(createPinia())
.mount('#app')
</pre>
<p>接下来，在<code>src</code>文件夹的根目录下创建一个<code>stores</code>文件夹，并添加一个名为<code>users.js</code>的文件。</p>
<pre class="language-javascript hljs">// stores/users.js
import { defineStore } from 'pinia'
// Import axios to make HTTP requests
import axios from "axios"

export const useUserStore = defineStore("user",{
    state: () =&gt; ({}),
    getters: {},
    actions: {},
})
</pre>
<p>我们已经成功建立了我们的Vuex和Pinia商店！现在，让我们使用我们的存储从API获取数据来填充我们的模板。</p>
<h2 id="consuming-apis-pinia-axios">使用Pinia和Axios消费API</h2>
<p>我们将使用Pinia和Axios复制Vuex示例中的输出。用下面的代码更新我们之前创建的<code>users.js</code>文件:</p>
<pre class="language-javascript hljs">//stores/users.js

import { defineStore } from 'pinia'
// Import axios to make HTTP requests
import axios from "axios"
export const useUserStore = defineStore("user", {
    state: () =&gt; ({
        users: [],
    }),
    getters: {
      getUsers(state){
          return state.users
        }
    },
    actions: {
      async fetchUsers() {
        try {
          const data = await axios.get('https://jsonplaceholder.typicode.com/users')
            this.users = data.data
          }
          catch (error) {
            alert(error)
            console.log(error)
        }
      }
    },
})
</pre>
<p>将<code>HelloWorld.vue</code>文件中的代码替换为:</p>
<pre class="language-javascript hljs">&lt;template&gt;
  &lt;div class="hello"&gt;
    &lt;h1&gt;{{ msg }}&lt;/h1&gt;
    &lt;h1&gt;Made By Getters&lt;/h1&gt;
    &lt;div v-for="user in getUsers" :key="user.id"&gt;
      {{ user.id }} {{ user.name }} {{ user.address }}
    &lt;/div&gt;
    &lt;h1&gt;Made By Actions&lt;/h1&gt;
    &lt;div v-for="user in users" :key="user.id"&gt;
      {{ user.id }} {{ user.name }} {{ user.address }}
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted, computed } from "vue";
import { useUserStore } from "../store/users";
const store = useUserStore();
const msg = ref("Welcome to my Vuex Store");
const getUsers = computed(() =&gt; {
  return store.getUsers;
});
const users = computed(() =&gt; {
  return store.users;
});
onMounted(() =&gt; {
  store.fetchUsers();
});
&lt;/script&gt;
</pre>
<p>在Pinia，商店默认是模块化的。对于每个创建的商店，我们需要将它导入到要使用的组件中。因此，我们导入了我们的<code>useUserStore</code>并将其赋给了<code>store</code>变量，这样就可以在整个组件中轻松地访问它。</p>
<p>与Vuex中的<code>store.dispatch("fetchUsers")</code>方法不同，在Pinia中，动作被视为一个函数，可以使用<code>store.fetchUsers()</code>方法从声明的<code>store</code>变量中访问。</p>
<h2 id="different-vuex-store-structures">不同的Vuex商店结构</h2>
<p>下面是最简单的Vuex存储结构，其中动作、getters、状态和突变在<code>index.js file</code>中被调用和导出。</p>
<p><strong> <em> NB </em> </strong> : Pinia是开箱即用的模块化产品，因此这些Vuex示例可能不适用:</p>
<pre class="language-html hljs">├── index.html
└── src
    ├── components
    ├── App.vue
    └──store
       └── index.js         # where we assemble modules and export the store
</pre>
<p>随着您的应用程序变得越来越大，您可能需要将您的操作、变异、getters和状态模块分离到它们自己的不同文件中:</p>
<pre class="language-html hljs">├── index.html
└── src
    ├── components
    ├── App.vue
    └──store
       ├── index.js        # where we assemble modules and export the
       ├── actions.js      # root actions
       ├── mutations.js    # root mutation
       ├── getters.js      # root getters
       └── state
</pre>
<p>应用程序中的所有状态都包含在一个大对象中，因为我们使用的是单个状态树。这并不理想，因为我们的应用程序随着我们的动作、突变和状态变得更大而增长，使得存储变得更大成为可能，以至于我们可能无法跟上它。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>一个很好的解决方案是将我们的商店分成模块。每个模块都可以包含自己的状态、突变、动作和getter——它们甚至可以包含嵌套模块，为可伸缩性提供了更多的选择:</p>
<pre class="language-html hljs">├── index.html
├── main.js
├── api
│   └── ... # abstractions for making API requests
├── components
│   ├── App.vue
│   └── ...
└── store
    ├── index.js          # where we assemble modules and export the store
    ├── actions.js        # root actions
    ├── mutations.js      # root mutations
    └── modules
        ├── cart.js       # cart module
        └── products.js
</pre>
<h2 id="vuex-pinia-faqs">常见问题</h2>
<h3 id="does-pina-replace-vuex">皮尼亚会取代Vuex吗？</h3>
<p>Pinia被认为是Vuex5的替代品，现在是Vue应用程序的推荐状态管理库。然而，这并不意味着旧版本的Vuex不能正常工作。</p>
<h3 id="using-pinia-vuex-together">我可以一起使用Pinia和Vuex吗？</h3>
<p>可以在同一个应用中使用Vuex和Pinia但是，不建议这样做，因为最好坚持使用单一的状态管理库。使用多个可能会导致性能问题。</p>
<p>根据我们之前的配置，以下是如何在entry <code>main.js</code>文件中初始化Pinia和Vuex存储:</p>
<pre class="language-javascript hljs">import { createApp } from "vue";
import App from "./App.vue";

import store from "./store";
import { createPinia } from "pinia";

createApp(App).use(createPinia()).use(store).mount("#app");
</pre>
<p>然后，您可以像我们之前所做的那样，继续在您的组件中使用存储。</p>
<h2 id="conclusion">结论</h2>
<p>在本教程中，我们已经了解了什么是状态管理，以及为什么需要像Vuex/Pinia这样的库来处理Vue应用程序的状态。</p>
<p>此外，我们创建了一个简单的Vue应用程序来演示Vuex/Pinia，并学习了不同的商店结构，以便您可以决定哪一个最适合您的应用程序。</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>