<html>
<head>
<title>Deno 1.0: What you need to know - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Deno 1.0:你需要知道的</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/#0001-01-01">https://blog.logrocket.com/deno-1-0-what-you-need-to-know/#0001-01-01</a></blockquote><div><article class="article-post">
<p>将近两年后，等待即将结束。API已经冻结，正式定于5月13日发布的Deno 1.0倒计时已经开始。</p>
<p>由于其著名的创作者和前瞻性的视野，Deno肯定会成为近年来最令人兴奋和最有争议的JavaScript相关版本。</p>
<p>Deno是一个通用的JavaScript/TypeScript编程环境。它汇集了许多最好的开源技术，并在一个小的可执行文件中提供了一个全面的解决方案。</p>
<p>Deno由Ryan Dahl创建，他以Node.js的幕后策划者而闻名，Deno利用了自Node.js于2009年发布以来一直可用的JavaScript特性。它还解决了Ryan在他的“<a href="https://www.youtube.com/watch?v=M3BM9TB-8yA" target="_blank" rel="noopener noreferrer">关于Node.js </a>我后悔的10件事”讲座中谈到的设计缺陷。有些人称之为Node.js的续集，尽管作者本人并没有这样说。</p>
<p>与用C++编写的Node.js不同，Deno是用Rust编写的。它建立在<a href="https://tokio.rs/" target="_blank" rel="noopener noreferrer"> Tokio </a>平台之上，像Node.js一样，使用V8引擎执行JavaScript。一个突出的特点是内置了TypeScript。虽然它仍然需要编译成JavaScript才能运行，但它是在内部完成的，因此TypeScript对用户的行为就好像它是本机支持的一样。</p>
<h2 id="gettingstarted">入门指南</h2>
<p>要下载Deno，请遵循<a href="https://deno.land/" target="_blank" rel="noopener noreferrer">主页</a>上的说明。要更新到未来版本，请使用<code>deno upgrade</code>。</p>
<p>要获得任何Deno子命令的帮助，请使用以下命令之一。</p>
<ul>
<li><code>deno [subcommand] -h</code>进行总结</li>
<li><code>deno [subcommand] --help</code>了解全部详情</li>
</ul>
<p>在本指南中，我们将涵盖Deno 1.0必须提供的所有杀手级特性，并提供如何使用最新语法的示例。我将尽可能使用TypeScript，但是JavaScript的等价物应该是显而易见的。</p>
<p>我相信当我们结束的时候你会爱上Deno的。这本指南应该给你入门所需的一切。</p>
<h2 id="security">安全性</h2>
<p>Deno在默认情况下是安全的。相比之下，Node.js可以完全访问您的文件系统和网络。</p>
<p>要运行没有权限的程序，请使用:</p>
<pre>deno run file-needing-to-run-a-subprocess.ts
</pre>
<p>如果代码需要权限设置，您会收到警告。</p>
<pre>error: Uncaught PermissionDenied: access to run a subprocess, run again with the --allow-run flag
</pre>
<p>Deno使用命令行选项显式地允许访问系统的不同部分。最常用的包括:</p>
<ul>
<li>环境访问</li>
<li>网络存取</li>
<li>文件系统读/写访问</li>
<li>运行子流程</li>
</ul>
<p>要查看带有示例的完整权限列表，请键入<code>deno run -h</code>。</p>
<p>对<code>read</code>、<code>write</code>和<code>net</code>使用许可白名单是一个最佳实践。这些允许你更具体的知道Deno可以访问什么。例如，要允许Deno读取<code>/etc</code>目录中的只读文件，请使用:</p>
<pre>deno --allow-read=/etc
</pre>
<h3 id="shortcutsforusingpermissions">使用权限的快捷方式</h3>
<p>您可能很快就会厌倦每次运行应用程序时都显式启用权限。要解决这个问题，您可以采用以下任何一种方法。</p>
<h4 id="1allowallpermissions">1.允许所有权限</h4>
<p>您可以使用<code>--allow-all</code>或其快捷方式<code>-A</code>启用所有权限。不建议这样做，因为它会消除拥有特定权限的安全优势。</p>
<h4 id="2makeabashscript">2.制作bash脚本</h4>
<p>使用运行程序所需的最小权限创建一个bash脚本。</p>
<pre>#!/bin/bash

// Allow running subprocesses and file system write access
deno run --allow-run --allow-write mod.ts
</pre>
<p>这里的缺点是，对于运行、测试和捆绑之类的事情，您可能需要一些这样的工具。</p>
<h4 id="3useataskrunner">3.使用任务执行程序</h4>
<p>您可以使用GNU工具<code>make</code>用一组Deno命令创建一个文件，并完成权限。你也可以使用Deno特有的版本，<a href="https://deno.land/x/drake/" target="_blank" rel="noopener noreferrer"> Drake </a>。</p>
<h4 id="4installanexecutabledenoprogram">4.安装可执行的Deno程序</h4>
<p>使用<code>deno install</code>到<a href="https://deno.land/manual/tools/script_installer#script-installer" target="_blank" rel="noopener noreferrer">安装一个Deno程序</a>，完成它需要执行的所有权限。安装后，您可以从<code>$PATH</code>的任何地方访问该程序。</p>
<h2 id="thestandardlibrary">标准图书馆</h2>
<p><a href="https://deno.land/std/" target="_blank" rel="noopener noreferrer"> Deno标准库</a>是由Deno项目维护的常用模块的集合，保证与Deno一起工作。它涵盖了用户执行常见任务时最常需要的代码，并大致基于Go编程语言提供的标准库。</p>
<p>JavaScript一直受到缺乏标准库的困扰。用户被迫一次又一次地重新发明轮子，开发人员必须经常在npm中搜索第三方模块，以解决平台的制造者应该提供的常见问题。</p>
<p>由React这样的库解决复杂问题的第三方包是一件好事，但是对于简单的东西，如<a href="https://en.wikipedia.org/wiki/Universally_unique_identifier" target="_blank" rel="noopener noreferrer"> UUID </a>代，使用官方标准库要好得多。这些小的库可以作为更大的库的构建模块，使得开发更快，更少焦虑。有多少次一个曾经流行的库被放弃了，让用户自己去维护它或者找一个新的？事实上，10%到20%的常用OSS软件包<a href="https://blog.tidelift.com/up-to-20-percent-of-your-application-dependencies-may-be-unmaintained" target="_blank" rel="noopener noreferrer">没有被积极维护</a>。</p>
<h3 id="availablemodulesandtheirnpmequivalents">可用模块及其npm等价物</h3>
<table>
<thead>
<tr>
<th>Deno模块</th>
<th>描述</th>
<th>npm当量</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://deno.land/std/fmt/colors.ts" target="_blank" rel="noopener noreferrer">颜色</a></td>
<td>为终端添加颜色</td>
<td>粉笔、颜料和颜色</td>
</tr>
<tr>
<td><a href="https://deno.land/std/datetime/README.md" target="_blank" rel="noopener noreferrer"> datetime </a></td>
<td>帮助使用JavaScript <code>Date</code>对象</td>
<td/>
</tr>
<tr>
<td><a href="https://deno.land/std/encoding/README.md" target="_blank" rel="noopener noreferrer">编码</a></td>
<td>增加了对外部数据结构的支持，如base32、binary、csv、toml和yaml</td>
<td/>
</tr>
<tr>
<td><a href="https://deno.land/std/flags/README.md" target="_blank" rel="noopener noreferrer">标志</a></td>
<td>帮助使用命令行参数</td>
<td>迷你小姐</td>
</tr>
<tr>
<td><a href="https://deno.land/std/fs/README.md" target="_blank" rel="noopener noreferrer"> fs </a></td>
<td>帮助操作文件系统</td>
<td/>
</tr>
<tr>
<td><a href="https://deno.land/std/http/README.md" target="_blank" rel="noopener noreferrer"> http </a></td>
<td>允许通过HTTP提供本地文件</td>
<td>http-服务器</td>
</tr>
<tr>
<td><a href="https://deno.land/std/log/README.md" target="_blank" rel="noopener noreferrer">日志</a></td>
<td>用于创建日志</td>
<td>温斯顿</td>
</tr>
<tr>
<td><a href="https://deno.land/std/testing/README.md" target="_blank" rel="noopener opener noreferrer">测试</a></td>
<td>对于单元测试断言和基准测试</td>
<td>恰依茶</td>
</tr>
<tr>
<td><a href="https://deno.land/std/uuid/README.md" target="_blank" rel="noopener noreferrer"> uuid </a></td>
<td>UUID一代</td>
<td>uuid</td>
</tr>
<tr>
<td><a href="https://deno.land/std/ws/README.md" target="_blank" rel="noopener noreferrer"> ws </a></td>
<td>帮助创建WebSocket客户端/服务器</td>
<td>《华盛顿明星报》</td>
</tr>
</tbody>
</table>
<h2 id="typescriptisbuiltintodeno">Typescript内置于Deno中</h2>
<p><img data-attachment-id="17882" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/ts_logo/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png" data-orig-size="100,100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="TypeScript logo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png" decoding="async" class="alignleft wp-image-17882 jetpack-lazy-image" src="../Images/059bb75b063d92ecc5dbece9f83c7872.png" alt="TypeScript Logo" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="17882" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/ts_logo/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png" data-orig-size="100,100" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="TypeScript logo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png" decoding="async" loading="lazy" class="alignleft wp-image-17882" src="../Images/059bb75b063d92ecc5dbece9f83c7872.png" alt="TypeScript Logo" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/ts_logo.png"/></noscript>TypeScript is JavaScript but with added explicit types. Any valid JavaScript is also valid TypeScript, so converting your code to TypeScript is painless. Just change the extension to <code>.ts</code> and start adding the types.
<p>要在Deno中使用TypeScript，您不需要做任何事情。没有Deno，TypeScript必须编译成JavaScript才能运行。Deno在内部为您完成了这项工作，使得TypeScript更容易被采用。</p>
<h3 id="usingyourowntsconfigjson">使用您自己的<code>tsconfig.json</code></h3>
<p>对于那些熟悉TypeScript的人来说，您将习惯于使用一个<code>tsconfig.json</code>文件来提供编译器选项。当您使用Deno时，这是可选的，因为它已经有了自己的默认配置。如果用自己的<code>tsconfig.json</code>和Deno冲突，会报警。</p>
<p>该功能需要<code>-c</code>选项和您的<code>tsconfig.json</code>。</p>
<pre>deno run -c tsconfig.json [file-to-run.ts]
</pre>
<p>如果你像大多数开发人员一样，你会欣喜若狂地得知Deno默认使用<code>strict</code>模式。除非某个恶棍覆盖了它，否则Deno会正当地提醒用户尽可能多的草率编码实践。</p>
<h2 id="denouseswebstandardswherepossible">Deno尽可能使用网络标准</h2>
<p><img data-attachment-id="17884" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/w3_logo/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png" data-orig-size="150,71" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="w3 logo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png" decoding="async" class="size-full wp-image-17884 alignleft jetpack-lazy-image" src="../Images/a2a3fbab6886441238c37fd17034b92e.png" alt="w3 Logo" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="17884" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/w3_logo/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png" data-orig-size="150,71" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="w3 logo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png" decoding="async" loading="lazy" class="size-full wp-image-17884 alignleft" src="../Images/a2a3fbab6886441238c37fd17034b92e.png" alt="w3 Logo" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/w3_logo.png"/></noscript>It takes a long time to create a web standard, and once it’s set in stone, it’s unwise to ignore it. While frameworks come and go, web standards will remain. Time spent invested in learning a standardized API is never wasted because nobody dares break the web; it could well be in use for decades, maybe even the rest of your career.
<p>web API提供了一个获取资源的接口。浏览器中提供了一个JavaScript <code>fetch()</code>方法。如果你想在Node.js中使用这个标准，你需要到达第三方库<a href="https://github.com/node-fetch/node-fetch" target="_blank" rel="noopener noreferrer">节点获取</a>。在Deno中，它是内置的，就像浏览器版本一样，开箱即用。</p>
<p>Deno 1.0提供了以下web兼容的API。</p>
<ul>
<li><code>addEventListener</code></li>
<li><code>atob</code></li>
<li><code>btoa</code></li>
<li><code>clearInterval</code></li>
<li><code>clearTimeout</code></li>
<li><code>dispatchEvent</code></li>
<li><code>fetch</code></li>
<li><code>queueMicrotask</code></li>
<li><code>removeEventListener</code></li>
<li><code>setInterval</code></li>
<li><code>setTimeout</code></li>
<li><code>AbortSignal</code></li>
<li><code>Blob</code></li>
<li><code>File</code></li>
<li><code>FormData</code></li>
<li><code>Headers</code></li>
<li><code>ReadableStream</code></li>
<li><code>Request</code></li>
<li><code>Response</code></li>
<li><code>URL</code></li>
<li><code>URLSearchParams</code></li>
<li><code>console</code></li>
<li><code>isConsoleInstance</code></li>
<li><code>location</code></li>
<li><code>onload</code></li>
<li><code>onunload</code></li>
<li><code>self</code></li>
<li><code>window</code></li>
<li><code>AbortController</code></li>
<li><code>CustomEvent</code></li>
<li><code>DOMException</code></li>
<li><code>ErrorEvent</code></li>
<li><code>Event</code></li>
<li><code>EventTarget</code></li>
<li><code>MessageEvent</code></li>
<li><code>TextDecoder</code></li>
<li><code>TextEncoder</code></li>
<li><code>Worker</code></li>
<li><code>ImportMeta</code></li>
<li><code>Location</code></li>
</ul>
<p>这些都可以在程序的顶级作用域中找到。这意味着如果你避免在<code>Deno()</code>名称空间上使用任何方法，你的代码应该同时兼容Deno和浏览器。虽然并非所有这些Deno APIs都100%符合它们的等效web规范，但这对前端开发人员来说仍然是一个巨大的好处。</p>
<h2 id="ecmascriptmodules">ECMAScript模块</h2>
<p>Node.js中Deno的主要突破性变化之一是Deno使用官方的ECMAScript模块标准，而不是遗留的CommonJS。Node.js直到2019年底才在13.2.0版本中启用ECMAScript模块，但即使在那时，支持也是半生不熟的，它仍然包括有争议的<code>.mjs</code>文件扩展名。</p>
<p>Deno通过为其模块系统使用现代网络标准，打破了过去的束缚。使用URL或文件路径引用该模块，并且该模块包含一个强制文件扩展名。例如:</p>
<pre>import * as log from "https://deno.land/std/log/mod.ts";
import { outputToConsole } from "./view.ts";
</pre>
<h3 id="theproblemwithusingfileextensions">使用文件扩展名的问题是</h3>
<p>Deno期望模块有文件扩展名，但TypeScript没有。</p>
<p><img data-attachment-id="17883" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/ts-extension-problem/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem.png" data-orig-size="1145,91" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="TypeScript extension problem" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-300x24.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-1024x81.png" decoding="async" class="aligncenter size-full wp-image-17883 jetpack-lazy-image" src="../Images/bf0b1ec98b761b9451cb6d3224470ebf.png" alt="TypeScript Extension Problem" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem.png 1145w, https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-300x24.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-1024x81.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-768x61.png 768w" data-lazy-sizes="(max-width: 1145px) 100vw, 1145px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="17883" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/ts-extension-problem/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem.png" data-orig-size="1145,91" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="TypeScript extension problem" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-300x24.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-1024x81.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-17883" src="../Images/bf0b1ec98b761b9451cb6d3224470ebf.png" alt="TypeScript Extension Problem" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem.png 1145w, https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-300x24.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-1024x81.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem-768x61.png 768w" sizes="(max-width: 1145px) 100vw, 1145px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/ts-extension-problem.png"/></noscript>
<p>在任何地方使用文件扩展名都是合乎逻辑的，似乎是显而易见的方法。不幸的是，实际上事情要比这复杂得多。现在，您可以使用<a href="https://github.com/denoland/vscode_deno" target="_blank" rel="noopener noreferrer"> Visual Studio代码扩展</a>来解决仅Deno项目的这个问题。</p>
<p>对于TypeScript的创建者来说，这个问题似乎是有争议的。在我们最终摆脱共性之前，我看不到一个快速简单的解决方案。</p>
<p>让我们花点时间向睿智而古老的编程之神祈祷。让他们推翻这些传统格式，惩罚那些坚持这些格式、损害我们所有人的人。</p>
<h2 id="packagemanagement">包装管理</h2>
<p><img data-attachment-id="17878" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/dog-parcels/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels.png" data-orig-size="500,333" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Dog sitting in front of cardboard boxes" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels.png" decoding="async" class="wp-image-17878 size-medium alignright jetpack-lazy-image" src="../Images/00f66492f768aefbbf1b1ce34fc96451.png" alt="Dog Sitting in Front of Cardboard Boxes" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels-300x200.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels.png 500w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels-300x200.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels-300x200.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="17878" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/dog-parcels/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels.png" data-orig-size="500,333" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Dog sitting in front of cardboard boxes" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels.png" decoding="async" loading="lazy" class="wp-image-17878 size-medium alignright" src="../Images/00f66492f768aefbbf1b1ce34fc96451.png" alt="Dog Sitting in Front of Cardboard Boxes" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels-300x200.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels.png 500w" sizes="(max-width: 300px) 100vw, 300px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/dog-parcels-300x200.png"/></noscript>There has been a radical rethink regarding the way package management works in Deno. Rather than relying on a central repository, it is decentralized. Anyone can host a package just like anyone can host any type of file on the web.
<p>使用像npm这样的集中式存储库有优点也有缺点，Deno的这一方面肯定是最有争议的。</p>
<h3 id="howdenosnewpackagemanagementworks">Deno的新包管理是如何工作的</h3>
<p>它如此彻底地简化，可能会让你震惊。</p>
<pre>import { assertEquals } from "https://deno.land/std/testing/asserts.ts";
</pre>
<p>我们来分解一下变化。</p>
<ul>
<li>不再有集中的包管理器。您可以直接从web导入ECMAScript模块</li>
<li>不再有“神奇”的Node.js模块解析。现在，语法是显式的，这使得事情更容易推理</li>
<li>没有更多的<code>node_modules</code>目录。相反，依赖项被下载并隐藏在你的硬盘上，看不见。如果您想刷新缓存并再次下载它们，只需在您的命令中添加<code>--reload</code></li>
</ul>
<p>如果你想下载依赖项和项目代码，而不是使用全局缓存，使用<code>$DENO_DIR</code> env变量。</p>
<h3 id="findingcompatible3rdpartylibraries">查找兼容的第三方库</h3>
<p>有一个<a href="https://deno.land/x/" target="_blank" rel="noopener noreferrer">用户区</a>用于Deno兼容的第三方模块，但在编写时导航非常基础。例如，没有按流行度或下载次数进行搜索的功能。我预测用户区域将会扩大，或者为贡献的模块创建其他替代站点。</p>
<p>尽管没有对Node.js向后兼容性的官方支持，但仍然有许多可用的库和应用程序可以很好地与Deno一起工作。有些是开箱即用的，而有些则需要一点努力才能工作。</p>

<h3 id="installing3rdpartymodules">安装第三方模块</h3>
<p>Deno还很新，周围的生态系统还在形成中。在写这篇文章的时候，我推荐<a href="https://www.pika.dev/cdn" target="_blank" rel="noopener noreferrer"> Pika </a>作为开始寻找兼容模块的第一个地方，在标准库和用户库之后。NPM上的任何可用包也应该在Pika CDN上，并且已经自动转换为与<code>import</code>一起工作。</p>
<p>Pika背后的开发人员与Deno合作，通过名为<a href="https://dev.to/pika/introducing-pika-cdn-deno-p8b" target="_blank" rel="noopener noreferrer"> X-TypeScript-Types </a>的ECMAScript模块提供类型脚本类型。你可以通过简单地使用他们的CDN平台来利用这一点。</p>
<h3>超越<code>Package.Json</code></h3>
<p>JavaScript生态系统的大部分仍然围绕着使用<code>package.json</code>。它已经扩大到包括许多职责，例如:</p>
<ul>
<li>保存关于项目的元数据</li>
<li>使用版本控制列出项目依赖关系</li>
<li>将依赖关系分类为<code>dependencies</code>或<code>devDependencies</code></li>
<li>定义程序的入口点</li>
<li>存储与项目相关的shell脚本</li>
<li>定义一个类型类别，最近引入来改进ECMAScript模块支持</li>
</ul>
<pre>{
  "name": "Project Name", // metadata
  "version": "1.0.0", // metadata
  "description": "My application", // metadata
  "type": "module", // module functionality
  "main": "src/mod.ts", // module functionality
  "scripts": {
    "build": "npm run _copy-build-files &amp;&amp; rollup -c",
    "build-watch": "npm run _copy-build-files &amp;&amp; rollup -cw"
  }, // scripting functionality
  "license": "gpl-3.0", // metadata
  "devDependencies": {
    "@rollup/plugin-typescript": "^3.1.1",
    "rollup": "^1.32.1",
    "typescript": "^3.8.3"
  }, // versioning and categorizing functionality
  "dependencies": {
    "tplant": "^2.3.3"
  } // versioning and categorizing functionality
}
</pre>
<p>随着时间的推移，所有这些实践走到了一起，现在代表了JavaScript生态系统工作的标准方式。很容易忘记这不是一个官方标准；它只是在这些功能成为必需品时才被想象出来的。现在JavaScript已经赶上来了，是时候进行一次重大的反思了。</p>
<p>Deno还不能取代<code>package.json</code>的所有功能，但目前有一些解决方案。</p>
<h3 id="usingdepstsandurlsforversioning">使用<code>deps.ts</code>和URL进行版本控制</h3>
<p>包版本控制有一个Deno约定，那就是使用一个叫做<code>deps.ts</code>的特殊文件。在内部，依赖项被重新导出。这允许应用程序中的不同模块都引用同一个源。</p>
<p>不是告诉npm下载哪个版本的模块，而是在<code>deps.ts</code>中的URL中引用。</p>
<pre>export { assert } from "https://deno.land/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9cefe8f8dceaacb2afa5b2ac">[email protected]</a>/testing/asserts.ts";
export { green, bold } from "https://deno.land/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="245750406452140a171d0a14">[email protected]</a>/fmt/colors.ts";
</pre>
<p>如果您想更新任何模块，您可以更改<code>deps.ts</code>中的URL。比如把<code>@v0.39.0</code>换成<code>@v0.41.0</code>，新版本就到处用了。如果您将<code><a href="https://deno.land/std@v0.39.0/fmt/colors.ts" rel="nofollow">https://deno.land/<span class="__cf_email__" data-cfemail="92e1e6f6d2e4a2bca1abbca2">[email protected]</span>/fmt/colors.ts</a></code>直接导入到每个模块中，您将不得不费力地浏览整个应用程序并更改每个引用。</p>
<p>假设您之前下载的模块不会在之后被篡改，这将是一个安全风险。这就是为什么还有一个创建<a href="https://deno.land/std/manual.md#lock-file" target="_blank" rel="noopener noreferrer">锁文件</a>的选项。这将确保新下载的模块与您最初下载的模块相同。</p>

<p>JSDoc发布于21年前的1999年。这是目前最常用和受支持的JavaScript和TypeScript文档化方法。虽然不是官方的web标准，但它是您的<code>package.json</code>中所有元数据的完美替代品。</p>
<pre>/**
 * @file Manages the configuration settings for the widget
 * @author Lucio Fulci
 * @copyright 2020 Intervision
 * @license gpl-3.0
 * @version 1.0
 *
</pre>
<p>Deno支持JSDoc开箱即用，并将其用于其内置的文档系统。虽然它目前不使用上面的元数据，但是命令<code>deno doc</code>读取函数的描述及其参数的描述。</p>
<pre>/**
 * Returns a value of (true?) if the rule is to be included
 *
 * @param key Current key name of rule being checked
 * @param val Current value of rule being checked
 **/
</pre>
<p>你可以使用<code>deno doc &lt;filename&gt;</code>来查看你程序的文档。</p>
<pre>deno doc mod.ts

function rulesToRemove(key: string, val: any[]): boolean
  Returns a value of if the rule is to be included
</pre>
<p>当您的程序在线托管时，使用<a href="https://doc.deno.land/" target="_blank" rel="noopener noreferrer">在线文档查看器</a>查看更多细节。</p>

<p><img data-attachment-id="17881" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/tool-scream-500/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png" data-orig-size="500,333" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Woman screaming surrounded by software logos" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png" decoding="async" class="size-full wp-image-17881 aligncenter jetpack-lazy-image" src="../Images/2c7fb453938abd6caa2e70548e5b3edf.png" alt="Woman Screaming Surrounded by Software Logos" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png 500w, https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500-300x200.png 300w" data-lazy-sizes="(max-width: 500px) 100vw, 500px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="17881" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/tool-scream-500/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png" data-orig-size="500,333" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Woman screaming surrounded by software logos" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png" decoding="async" loading="lazy" class="size-full wp-image-17881 aligncenter" src="../Images/2c7fb453938abd6caa2e70548e5b3edf.png" alt="Woman Screaming Surrounded by Software Logos" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png 500w, https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500-300x200.png 300w" sizes="(max-width: 500px) 100vw, 500px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/tool-scream-500.png"/></noscript>
<p>这是对前端开发人员影响最大的领域。JavaScript工具的现状是混乱不堪。当您添加TypeScript工具时，复杂性会进一步增加。</p>
<p>JavaScript最好的一点是它不需要编译，所以可以直接在浏览器中运行。这使得立即获得关于你的编码的反馈变得非常容易。进入门槛很低；编写软件只需要一个文本编辑器和一个浏览器。</p>
<p>不幸的是，这种简单性和可访问性被过度工具化的狂热所破坏。它将JavaScript开发变成了一场复杂的噩梦。我甚至看到了一整门专门介绍Webpack配置的课程。这种无聊的事情需要结束了——人生苦短。</p>
<p>工具的混乱已经发展到许多开发人员不顾一切地回去实际编写代码，而不是摆弄配置文件，为他们应该采用多个竞争标准中的哪一个而苦恼。一个解决这个问题的新兴项目是脸书的罗马。在撰写本文时，这还处于起步阶段。虽然它可能证明是有益的，但Deno有可能成为一个更实际的解决方案。</p>
<p>Deno本身就是一个完整的生态系统，包括运行时和它自己的模块/包管理系统。这给了它更大的空间来内置所有自己的工具。让我们看看1.0中有哪些工具，以及如何使用它来减少对第三方库的依赖并简化开发。</p>
<p>现在还不可能替换Deno中的整个前端构建管道，但是用不了多久，你就可以做到了。</p>
<h3 id="testing">测试</h3>
<p>使用<code>Deno.test()</code>函数将测试运行器内置到Deno的内核中。标准库中提供了<a href="https://deno.land/std/testing/" target="_blank" rel="noopener noreferrer">断言库</a>。所有你喜欢的，比如<code>assertEquals()</code>和<code>assertStrictEq()</code>，都包括在内，还有一些不太常见的断言，比如<code>assertThrowsAsync()</code>。</p>
<p>在撰写本文时，还没有测试覆盖特性，需要使用第三方工具如<a href="https://deno.land/x/denon/" target="_blank" rel="noopener noreferrer"> Denon </a>来设置观察模式。</p>
<p>要查看所有测试运行器选项，请使用<code>deno test --help</code>。虽然它们非常有限，但有许多功能你可能对像Mocha这样的程序很熟悉。例如，<code>--failfast</code>将在遇到第一个错误时停止，而<code>--filter</code>可以用来过滤要运行的测试。</p>
<h4 id="usingthetestrunner">使用测试转轮</h4>
<p>最基本的语法是<code>deno test</code>。这将运行工作目录中所有以<code>_test</code>或<code>.test</code>结尾，扩展名为<code>.js</code>、<code>.ts</code>、<code>.jsx</code>或<code>.tsx</code>(如<code>example_test.ts</code>)的文件</p>
<pre>import { assertEquals } from "https://deno.land/std/testing/asserts.ts";

Deno.test({
  name: "testing example",
  fn(): void {
    assertEquals("world", "world");
    assertEquals({ hello: "world" }, { hello: "world" });
  },
});
</pre>
<p>如果您的代码使用DOM，您将需要为自己的<code>tsconfig.json</code>提供<code>lib: ["dom", "esnext"]</code>。我们将在下面详细讨论。</p>
<div class="blog-plug cro21">
<h2>测试只是开始。试试<a class="signup" href="https://logrocket.com/signup/" target="_blank" rel="noopener noreferrer"> LogRocket </a>，这是一款针对生产应用的主动监控解决方案</h2>
<p><a class="signup" href="https://logrocket.com/signup/" target="_blank" rel="noopener noreferrer"> <img data-attachment-id="46" data-permalink="https://blog.logrocket.com/vuex-showdown-mutations-vs-actions/1d0cd-1s_rmyo6nbrasp-xtvbaxfg/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg-e1565635879164.png" data-orig-size="730,412" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="LogRocket dashboard free trial banner" data-image-description="&lt;p&gt;LogRocket is working on the perfect frontend bug report. Try it free today.&lt;/p&gt;&#10;" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg-e1565635879164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg-e1565635879164.png" decoding="async" class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/> <noscript> <img data-lazy-fallback="1" data-attachment-id="46" data-permalink="https://blog.logrocket.com/vuex-showdown-mutations-vs-actions/1d0cd-1s_rmyo6nbrasp-xtvbaxfg/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg-e1565635879164.png" data-orig-size="730,412" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="LogRocket dashboard free trial banner" data-image-description="&lt;p&gt;LogRocket is working on the perfect frontend bug report. Try it free today.&lt;/p&gt;&#10;" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg-e1565635879164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg-e1565635879164.png" decoding="async" loading="lazy" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/> </noscript></a></p>
<p>LogRocket 是一个前端应用程序监控解决方案，可以让您回放问题，就像问题发生在您自己的浏览器中一样。LogRocket不需要猜测错误发生的原因，也不需要向用户询问截图和日志转储，而是让您重放会话以快速了解哪里出错了。它可以与任何应用程序完美配合，不管是什么框架，并且有插件可以记录来自Redux、Vuex和@ngrx/store的额外上下文。</p>
<p>除了记录Redux操作和状态，LogRocket还记录控制台日志、JavaScript错误、堆栈跟踪、带有头+正文的网络请求/响应、浏览器元数据和自定义日志。它还使用DOM来记录页面上的HTML和CSS，甚至为最复杂的单页面应用程序重新创建像素级完美视频。</p>
<p><a class="signup" href="https://logrocket.com/signup/" target="_blank" rel="noopener noreferrer">免费试用</a>。</p>
</div>
<h3 id="formatting">格式化</h3>
<p>格式化是由<a href="https://github.com/dsherret/dprint" target="_blank" rel="noopener noreferrer"> dprint </a>提供的，它是beauty的一个非常快的替代品，可以复制所有已建立的beauty 2.0规则。</p>
<p>要格式化一个或多个文件，可以使用<code>deno fmt &lt;files&gt;</code>或<a href="https://marketplace.visualstudio.com/items?itemName=axetroy.vscode-deno" target="_blank" rel="noopener noreferrer"> Visual Studio代码</a>扩展(稍后会详细介绍)。</p>
<h3 id="compilingandbundling">编译和捆绑</h3>
<p>Deno可以使用<code>deno bundle</code>从命令行创建一个简单的包，但它也公开了一个<a href="https://deno.land/std/manual.md#compiler-api" target="_blank" rel="noopener noreferrer">内部编译器API </a>，因此用户可以创建自己的输出，这是可以为前端使用定制的东西。这个API目前被标记为不稳定，所以您需要使用<code>--unstable</code>标志。</p>
<p>虽然Deno有一些web兼容的API，但它们并不完整。如果您想编译任何引用DOM的前端TypeScript，您需要在编译或捆绑时告诉Deno这些类型。可以使用编译器API选项<code>lib</code>。</p>
<pre>index.html
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;title&gt;Document&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1 id="greeter"&gt;Replace me&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;
test-dom.ts
let greeter: HTMLElement | null = document.getElementById("greeter")!; // Please forgive the Non-Null Assertion Operator

greeter.innerText = "Hello world!";
compile.ts
const [errors, emitted] = await Deno.compile("test-dom.ts", undefined, {
  lib: ["dom", "esnext"], // include "deno.ns" for deno namespace
  outDir: "dist",
});

if (errors) {
  console.log("There was an error:");
  console.error(errors);
} else {
  console.log(emitted); // normally we would write the file
}
</pre>
<p>下面是终端中生成的发射贴图输出。</p>
<pre>{
 dist/test-dom.js.map: "{"version":3,"file":"test-dom.js","sourceRoot":"","sources":["file:///home/david/Downloads/deno-arti...",
 dist/test-dom.js: ""use strict";nlet greeter = document.getElementById("greeter");ngreeter.innerText = "Hello world!";n..."
}
</pre>
<p>在上面的例子中，我们编译了引用DOM的<code>test-dom.ts</code>文件。使用<code>Deno.compile()</code>中的<code>lib</code>选项会覆盖Deno使用的任何<code>lib</code>默认选项，因此您需要添加回<code>esnext</code>，并且可选地添加<code>deno.ns</code>来使用Deno名称空间。</p>
<p>这还只是一个实验，但是我希望<code>bundle</code>命令能够进化到处理像树摇晃这样的事情，并且表现得更像<code>Rollup.js</code>。</p>
<h3 id="debugging">排除故障</h3>
<p>Deno有内置调试，但在编写本文时，Visual Studio代码扩展不支持它。要进行调试，请手动使用以下代码。</p>
<ul>
<li><code>deno run -A --inspect-brk fileToDebug.ts</code>(注意:对您的模块使用最小权限)</li>
<li>在铬合金或铬合金中打开<code>chrome://inspect</code>。你会看到一个类似于下面的屏幕<br/> <img data-attachment-id="17879" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/inspect-with-chrome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png" data-orig-size="515,354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Inspect with Chrome" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome-300x206.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png" decoding="async" class="aligncenter size-full wp-image-17879 jetpack-lazy-image" src="../Images/7fbef85700ee0fc497b96ec350cd16bc.png" alt="Inspect With Chrome" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png 515w, https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome-300x206.png 300w" data-lazy-sizes="(max-width: 515px) 100vw, 515px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png"/> <noscript> <img data-lazy-fallback="1" data-attachment-id="17879" data-permalink="https://blog.logrocket.com/deno-1-0-what-you-need-to-know/inspect-with-chrome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png" data-orig-size="515,354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Inspect with Chrome" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome-300x206.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-17879" src="../Images/7fbef85700ee0fc497b96ec350cd16bc.png" alt="Inspect With Chrome" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png 515w, https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome-300x206.png 300w" sizes="(max-width: 515px) 100vw, 515px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/inspect-with-chrome.png"/> </noscript></li>
<li>单击“检查”连接并开始调试您的代码</li>
</ul>
<h3 id="filewatching">文件观看</h3>
<p>Deno通过<code>Deno.watchFs()</code> API使用Rust <a href="https://github.com/notify-rs/notify" target="_blank" rel="noopener noreferrer"> notify </a>库内置了文件监控。Deno喜欢用它的API在幕后提供繁重的工作，让用户以他们喜欢的方式实现他们的代码。您需要创建自己的实现或使用第三方模块，而不是提供一个<code>--watch</code>标志。</p>
<p>制作你自己的文件监视器的唯一重要的方面是去抖动。API可以快速连续地触发多个事件，您可能不希望多次运行您的操作。用户Caesar2011使用<code>Date.now()</code>解决了<a href="https://github.com/Caesar2011/rhinoder/blob/master/mod.ts" target="_blank" rel="noopener noreferrer"> 23行打字稿</a>中的问题。</p>
<p>还有一个更高级的Deno文件观看解决方案叫做<a href="https://deno.land/x/denon/" target="_blank" rel="noopener noreferrer"> Denon </a>。相当于<code>nodemon</code>。如果您想观察您的工作区的变化并重新运行您的测试，这很简单:</p>
<pre>denon test
</pre>
<h2 id="visualstudiocodeplugin">Visual Studio代码插件</h2>
<p>目前最好的扩展是axetroy的，可以从<a href="https://marketplace.visualstudio.com/items?itemName=axetroy.vscode-deno" target="_blank" rel="noopener noreferrer"> Visual Studio市场</a>获得。安装后，在您的项目文件夹中创建一个文件<code>.vscode/settings.json</code>,并基于每个项目启用扩展。</p>
<pre>// .vscode/settings.json
{
  "deno.enable": true,
}
</pre>
<p>现在，您将可以获得完整的智能感知支持以及编码所需的一切。</p>
<h2 id="conclusion">结论</h2>
<p>JavaScript生态系统的快速变化被证明是一件喜忧参半的事情。从积极的一面来看，从未有过如此高质量的工具可用。消极的一面是，对于不断涌现的新框架和库，人们普遍感到愤世嫉俗和厌倦。</p>
<p>Deno成功地消除了JavaScript开发中的许多缺点。下面只是几个。</p>
<ul>
<li>通过使用网络标准，Deno的API经得起未来的考验。这给了开发人员信心，他们不会浪费时间去学习那些很快就会过时的东西</li>
<li>除了JavaScript之外还有TypeScript消除了编译的负担，并允许更紧密的集成</li>
<li>内置工具意味着没有必要浪费时间去寻找现成的东西</li>
<li>分散的包管理将用户从npm中解放出来，与使用陈旧的CommonJS相比，ECMAScript模块带来了新鲜空气</li>
</ul>
<p>虽然Deno可能还不能完全取代Node.js，但它已经是一个非常棒的日常编程环境。</p>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>