<html>
<head>
<title>Introduction to React Motion - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>React Motion - LogRocket博客简介</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/introduction-to-react-motion/#0001-01-01">https://blog.logrocket.com/introduction-to-react-motion/#0001-01-01</a></blockquote><div><article class="article-post">
<p>React Motion是React应用程序的动画库，可以轻松创建和实现逼真的动画。在本指南中，我们将演示如何安装该库，并分享一些基本技巧来帮助您为React项目构建<a href="https://blog.logrocket.com/5-react-motion-use-cases-with-examples-78fc07104d58/" target="_blank" rel="noopener noreferrer">看起来自然、基于物理的动画</a>。</p>
<h2 id="installingreactmotion">安装反应运动</h2>
<p>通过运行以下命令创建一个新的React项目:</p>
<pre>npx create-react-app intro-react-motion
</pre>
<p>要安装React Motion，请在项目根目录下运行以下命令。</p>
<pre>npm i react-motion
</pre>
<h2 id="understandingtheexports">了解出口</h2>
<p><code>react-motion</code>库导出了以下内容。</p>
<ul>
<li><code>spring</code> —一个帮助器函数，指示组件如何动画化</li>
<li><code>presets</code> —预定义动画属性的对象</li>
<li><code>Motion</code> —一个用于动画组件的组件</li>
<li><code>StaggeredMotion</code> —一个组件，用于动画化那些动画相互依赖的组件</li>
<li><code>TransitionMotion</code> —用于动画显示组件安装和卸载的组件</li>
</ul>
<p>为了简洁起见，本指南将集中于<code>spring</code>、<code>presets</code>和<code>Motion</code>。</p>
<h2 id="helpersspringandpresets">助手:<code>spring()</code>和<code>presets</code></h2>
<p><code>spring()</code>辅助函数定义如何从初始样式值到目标值制作动画。它接受两个参数:值和一个选项动画配置参数。</p>
<p>例如，<code>spring(10, { stiffness: 130, damping: 42 })</code>将该值设置为10，刚度为130，阻尼为42。<code>stiffness</code>和<code>damping</code>是定义动画行为的动画属性。不要担心，不理解这些属性是如何工作的是正常的。</p>
<p><code>presets</code>属性被用作动画配置。比如<code>spring(25, presets.wobbly)</code>。其他预设值包括<code>presets.gentle</code>、<code>presets.noWobble</code>、<code>presets.stiff</code>。</p>
<h2 id="themotioncomponent"><code>&lt;Motion /&gt;</code>组件</h2>
<p><code>&lt;Motion /&gt;</code>组件接受两个道具:<code>defaultStyle</code>和<code>style</code>。<code>defaultStyle</code>属性定义了样式对象的初始值。<code>style</code>道具是一个定义任意给定点的样式值的对象。使用<code>spring()</code>辅助函数确定<code>style</code>属性的值。如果<code>defaultStyle</code>是原始样式，那么<code>style</code>是组件动画的最终样式。</p>
<p>组件期望一个函数作为它的子道具，这意味着它使用渲染道具模式。该函数接收一个插值样式对象，该对象包含动画完成前任何给定时间的样式值。</p>
<pre>&lt;&lt;Motion
  defaultStyle={{
    scale: 0,
    translateX: -300
  }}
  style={{
    scale: spring(1),
    translateX: spring(0, presets.stiff)
  }}
&gt;
  {interpolatesStyles =&gt; &lt;&gt;{/* React Component */}&lt;/&gt;}
&lt;/Motion&gt;
</pre>
<h2>对动作做出反应</h2>
<p id="letslookatabasicexample">让我们看一个基本的例子。</p>
<p>在组件文件的顶部，从<code>react-motion</code>库中导入<code>Motion</code>、<code>spring</code>和<code>presets</code>，以便在组件中使用它们。</p>
<pre>import { Motion, spring, presets } from "react-motion";
</pre>
<p>在组件中创建一个<code>&lt;h1&gt;</code>元素，它将在<code>App.js</code>中被动画化。</p>
<pre>// ...
function App() {
  return (
    &lt;div className="App"&gt;
      &lt;div&gt;
        &lt;h1&gt;Basic Animation Example&lt;/h1&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
// ...
</pre>
<p>现在用<code>&lt;Motion /&gt;</code>组件包装你的组件，并从render prop函数返回<code>&lt;h1&gt;</code>组件。通过<code>defaultStyle</code>道具中的<code>{ opacity: 0, translateY: 30 }</code>。在<code>style</code>道具中，使用<code>spring()</code>辅助函数插入样式值。</p>
<pre>// ...
&lt;Motion
  defaultStyle={{
    opacity: 0,
    translateY: 30
  }}
  style={{
    opacity: spring(1),
    translateY: spring(0, presets.wobbly)
  }}
&gt;
  {interpolatedStyles =&gt; (
    &lt;div
      style={{
        transform: `translateY(${interpolatedStyles.translateY}px)`,
        opacity: interpolatedStyles.opacity
      }}
    &gt;
      &lt;h1&gt;Basic Animation Example&lt;/h1&gt;
    &lt;/div&gt;
  )}
&lt;/Motion&gt;
// ...
</pre>
<p>下面是最终的代码:</p>
<pre>import React from "react";
import "./styles.css";
import { Motion, spring, presets } from "react-motion";

function App() {
  return (
    &lt;div className="App"&gt;
      &lt;Motion
        defaultStyle={{
          opacity: 0,
          translateY: 30
        }}
        style={{
          opacity: spring(1),
          translateY: spring(0, presets.wobbly)
        }}
      &gt;
        {interpolatedStyles =&gt; (
          &lt;div
            style={{
              transform: `translateY(${interpolatedStyles.translateY}px)`,
              opacity: interpolatedStyles.opacity
            }}
          &gt;
            &lt;h1&gt;Basic Animation Example&lt;/h1&gt;
          &lt;/div&gt;
        )}
      &lt;/Motion&gt;
    &lt;/div&gt;
  );
}

export default App;
</pre>
<p>运行下面的命令来查看上面的代码。</p>
<pre>npm start
</pre>
<p>一旦组件装载到DOM上，动画就会开始。现在，让我们看看如何通过点击按钮来触发动画。</p>
<h2 id="triggeranimationusingabutton">使用按钮触发动画</h2>
<p>使用state，您可以动态添加样式来插入样式值。在变量中，存储动画的初始样式。</p>
<pre>function App() {
  const [startAnimation, setAnimation] = useState(false);
  const initialStyle = { opacity: 0, translateY: 30 };
  // ...
}
</pre>
<p>在<code>&lt;Motion /&gt;</code>组件中，您不必指定<code>defaultStyle</code>属性，因为<code>style</code>属性将动态变化。</p>
<pre>// ...
&lt;Motion
  style={
    startAnimation
      ? {
          opacity: spring(1),
          translateY: spring(0, presets.wobbly)
        }
      : initialStyle
  }
&gt;
  {interpolatedStyles =&gt; (
    &lt;div
      style={{
        transform: `translateY(${interpolatedStyles.translateY}px)`,
        opacity: interpolatedStyles.opacity
      }}
    &gt;
      &lt;h1&gt;Triggered Animation&lt;/h1&gt;
    &lt;/div&gt;
  )}
&lt;/Motion&gt;
// ...
</pre>
<p>添加两个按钮:一个触发动画，另一个重置动画。</p>
<pre>// ...
&lt;button onClick={() =&gt; setAnimation(true)}&gt;Trigger Animation&lt;/button&gt;
&lt;button onClick={() =&gt; setAnimation(false)}&gt;Reset Animation&lt;/button&gt;
// ...
</pre>
<p>当<code>startAnimation</code>状态设置为<code>true</code>时，<code>style</code>道具将获得初始样式值。当设置为<code>false</code>时，<code>style</code>道具将拥有最终值。</p>
<p>您的<code>App.js</code>应该如下所示。</p>
<pre>import React, { useState } from "react";
import "./styles.css";
import { Motion, spring, presets } from "react-motion";

export default function App() {
  const [startAnimation, setAnimation] = useState(false);
  const initialStyle = { opacity: 0, translateY: 30 };
  return (
    &lt;div className="App"&gt;
      &lt;Motion
        style={
          startAnimation
            ? {
                opacity: spring(1),
                translateY: spring(0, presets.wobbly)
              }
            : initialStyle
        }
      &gt;
        {interpolatedStyles =&gt; (
          &lt;div
            style={{
              transform: `translateY(${interpolatedStyles.translateY}px)`,
              opacity: interpolatedStyles.opacity
            }}
          &gt;
            &lt;h1&gt;Triggered Animation&lt;/h1&gt;
          &lt;/div&gt;
        )}
      &lt;/Motion&gt;
      &lt;button onClick={() =&gt; setAnimation(true)}&gt;Trigger Animation&lt;/button&gt;
      &lt;button onClick={() =&gt; setAnimation(false)}&gt;Reset Animation&lt;/button&gt;
    &lt;/div&gt;
  );
}
</pre>
<h2 id="usagewithstyledcomponents">通过<code>styled-components</code>使用反应运动</h2>
<p>您可以将<code>react-motion</code>与React的任何其他UI库一起使用。让我们看看如何将<code>react-motion</code>用于<code>styled-components</code>库。</p>
<p>通过在项目根目录下运行以下命令来安装<code>styled-components</code>。</p>
<pre>npm i styled-components
</pre>
<p>如下创建样式化的<code>&lt;Title /&gt;</code>组件。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<pre>// ..
import styled from "styled-components";

const Title = styled.h1`
  color: #007bff;
  font-size: 32px;
  ${props =&gt;
    `transform: translateY(${props.translateY}px); 
   opacity: ${props.opacity};
  `}
`;

// ..
</pre>
<p>与上面的例子类似，从render prop函数返回<code>&lt;Title /&gt;</code>组件。将插值作为道具传递给<code>&lt;Title /&gt;</code>组件。</p>
<pre>&lt;Motion
  style={
    startAnimation
      ? {
          opacity: spring(1),
          translateY: spring(0, presets.wobbly)
        }
      : initialStyle
  }
&gt;
  {interpolatedStyles =&gt; (
    &lt;Title
      opacity={interpolatedStyles.opacity}
      translateY={interpolatedStyles.translateY}
    &gt;
      Triggered Animation
    &lt;/Title&gt;
  )}
&lt;/Motion&gt;
</pre>
<p>您完成的<code>App.js</code>应该如下所示。</p>
<pre>import React, { useState } from "react";
import "./styles.css";
import { Motion, spring, presets } from "react-motion";
import styled from "styled-components";

const Title = styled.h1`
  color: #007bff;
  font-size: 32px;
  ${props =&gt;
    `transform: translateY(${props.translateY}px); 
   opacity: ${props.opacity};
  `}
`;

export default function App() {
  const [startAnimation, setAnimation] = useState(false);
  const initialStyle = { opacity: 0, translateY: 30 };
  return (
    &lt;div className="App"&gt;
      &lt;Motion
        style={
          startAnimation
            ? {
                opacity: spring(1),
                translateY: spring(0, presets.wobbly)
              }
            : initialStyle
        }
      &gt;
        {interpolatedStyles =&gt; (
          &lt;Title
            opacity={interpolatedStyles.opacity}
            translateY={interpolatedStyles.translateY}
          &gt;
            Triggered Animation
          &lt;/Title&gt;
        )}
      &lt;/Motion&gt;
      &lt;button onClick={() =&gt; setAnimation(true)}&gt;Trigger Animation&lt;/button&gt;
      &lt;button onClick={() =&gt; setAnimation(false)}&gt;Reset Animation&lt;/button&gt;
    &lt;/div&gt;
  );
}
</pre>
<p>无论您使用哪个库，<code>react-motion</code>都将工作，只要该库支持自定义样式。</p>
<p>如果您遇到错误、贬值警告或不能按预期运行的情况，通过用以下版本替换您在<code>package.json</code>文件中的依赖项，恢复到这些库的原始版本。</p>
<pre>//...

"dependencies": {
    "@testing-library/jest-dom": "^4.2.4",
    "@testing-library/react": "^9.5.0",
    "@testing-library/user-event": "^7.2.1",
    "react": "^16.13.0",
    "react-dom": "^16.13.0",
    "react-motion": "^0.5.2",
    "react-scripts": "3.4.0",
    "styled-components": "^5.0.1"
 }

//...
</pre>
<p>然后运行:</p>
<pre>npm i
</pre>
<p>这将安装与测试这些示例时完全相同的依赖项。</p>
<h2 id="conclusion">结论</h2>
<p>React Motion是React中最容易制作组件动画的动画库之一。这只是对<code>react-motion</code>库的简单介绍。下一步，我会推荐看看像<code>&lt;StaggeredMotion /&gt;</code>和<code>&lt;TransitionMotion /&gt;</code>这样的组件，它们类似于<code>&lt;Motion /&gt;</code>组件，但是有一个更复杂动画的高级实现。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产React应用</h2><p>调试React应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪Redux状态、自动显示JavaScript错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的web和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试React应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>