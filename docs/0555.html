<html>
<head>
<title>Jank-free page loading with media aspect ratios - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>邱建-免费页面加载与媒体纵横比-日志火箭博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/#0001-01-01">https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/#0001-01-01</a></blockquote><div><article class="article-post">
<p>响应式网页通常会在加载时重新排列内容。当用户正在阅读的文本突然被移出屏幕时，这会给用户带来相当大的挫败感。在本文中，我们将研究几种新的和现有的方法来解决这个性能问题。</p>
<h2>RWD之前的布局</h2>
<p>从蒂姆·伯纳斯·李爵士开发出第一个网络浏览器(以及HTML、页面编辑器、网络服务器、HTTP和DNS)的那一刻起，流畅的布局就成为可能。Web内容仅受浏览器视窗宽度的限制。</p>
<p>在拨号上网的时代，开发人员虔诚地给每个<code>img</code>标签添加宽度和高度属性。这确保了在图像开始下载之前在页面上分配了适当的空间，并且避免了回流。</p>
<pre>&lt;img src="myimage.jpg" width="400" height="300" alt="my image" /&gt;</pre>
<p>无单位尺寸指的是像素。在这种情况下，将保留400×300的区域，图像将被拉伸或挤压到该空间中，即使实际尺寸不匹配。</p>
<p>随着web的发展，设计人员和开发人员转向了固定宽度的布局，这样更容易理解、设计和编码。当用于确定布局尺寸时，图像宽度和高度属性变得更加重要。</p>
<p>不幸的是，只有当浏览器足够宽以容纳设计时，固定布局才有效。960px宽度的布局设计在1024×768的显示器上看起来不错，但在大屏幕上有点稀疏，并且需要在较小的设备上进行笨拙的水平滚动。</p>
<p>智能手机革命——尤其是iPhone的发布——改变了一切。小屏幕迅速变得重要，虽然这些设备能够呈现标准网页，但平移和缩放以阅读文本是费力的。Web开发人员最初解决这个问题的方法是将内容复制到不同的移动网站上，通常带有一个“m”子域。</p>
<h2>后RWD时代的布局</h2>
<p>Ethan Marcotte在2010年发表的题为“<a href="https://alistapart.com/article/responsive-web-design/" target="_blank" rel="noopener noreferrer">响应式网页设计</a>”的文章解释了如何使用<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media" target="_blank" rel="noopener noreferrer"> CSS媒体查询</a>来创建适应视窗尺寸的单一网站布局。出现了各种技术，在过去的十年中，开发人员被鼓励省略<code>img width</code>和<code>height</code>属性，而使用CSS尺寸。例如，您可以将图像的大小调整为其容器的宽度。</p>
<pre>img {
  width: 100%;
  height: auto;
}</pre>
<p>您还可以确保图像宽度不超过其实际像素宽度。</p>
<pre>img {
  max-width: 100%;
  height: auto;
}</pre>
<p>这种技术有一个不幸的后果:页面空间只能在图像开始下载并且浏览器可以确定其尺寸时分配。当每个图像开始出现时，内容必须重新编排。您正在阅读的文本可能会突然移动或消失在屏幕之外，尤其是在移动设备上。</p>
<p id="gdcalert1"><img data-attachment-id="10547" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/sizing-image-width-container/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container.gif" data-orig-size="661,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sizing an image to the width of a container" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container-294x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container.gif" decoding="async" class="aligncenter size-full wp-image-10547 jetpack-lazy-image" src="../Images/1474f600c9c7662f8e66c8dcd1d1d176.png" alt="Sizing an Image to the Width of a Container" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10547" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/sizing-image-width-container/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container.gif" data-orig-size="661,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sizing an image to the width of a container" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container-294x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10547" src="../Images/1474f600c9c7662f8e66c8dcd1d1d176.png" alt="Sizing an Image to the Width of a Container" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/sizing-image-width-container.gif"/></noscript>
<p>视频、iframes和广告的加载问题也很明显。</p>
<p>在web代码中没有简单的方法来解决这个问题。确定一个资产是否已经开始加载和无意中回流的内容目前是不可能的。浏览器已经实现了<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/overflow-anchor/Guide_to_scroll_anchoring" target="_blank" rel="noopener noreferrer">滚动锚定</a>，试图阻止内容跳转，但是恼人的事情还是发生了。</p>
<h2>纵横比分辨率</h2>
<p>纵横比定义了元素的宽度和高度之间的关系。考虑一个典型的16:9屏幕:每16个单位宽，屏幕就有9个单位深。</p>
<p><img data-attachment-id="10548" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/aspect-ratio-resolution/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png" data-orig-size="410,229" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Aspect ratio resolution" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png" decoding="async" class="aligncenter size-full wp-image-10548 jetpack-lazy-image" src="../Images/4349751f6d46d0c8281d2fb10f5ad863.png" alt="Aspect Ratio Resolution" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png 410w, https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution-300x168.png 300w" data-lazy-sizes="(max-width: 410px) 100vw, 410px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10548" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/aspect-ratio-resolution/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png" data-orig-size="410,229" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Aspect ratio resolution" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10548" src="../Images/4349751f6d46d0c8281d2fb10f5ad863.png" alt="Aspect Ratio Resolution" srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png 410w, https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution-300x168.png 300w" sizes="(max-width: 410px) 100vw, 410px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/aspect-ratio-resolution.png"/></noscript><br/>
If we know one dimension, we can calculate the other.
<ul>
<li>给定800像素的宽度，高度是800 x 9/16 = 450像素</li>
<li>给定450像素的高度，宽度为450 x 16/9 = 800像素</li>
</ul>
<p>注意:电视和显示器通常使用对角线尺寸做广告。使用一个小毕达哥拉斯，一个85英寸，16:9的屏幕将是74.1×41.7英寸。屏幕尺寸计算器为你做了艰苦的工作。</p>
<p>在浏览器呈现的情况下，HTML元素的宽度通常可以立即知道，因为它可以在初始布局时确定。如果能提供高宽比，就可以计算并保留高度和相应的面积。</p>
<h2>Firefox 71纵横比确定</h2>
<p>当宽度和高度属性在一个<code>img</code>标签中定义时，Firefox 71和更高版本计算纵横比。</p>
<pre>&lt;!-- set a 400:300 - or 4:3 - aspect ratio --&gt;
&lt;img src="myimage.jpg" width="400" height="300" alt="my image" /&gt;</pre>
<p>CSS可以用来将图像的大小调整到其包含元素的宽度。</p>
<pre>img {
  width: 100%;
  height: auto;
}</pre>
<p><code>height: auto</code>对于确保图像高度不固定在300像素至关重要。</p>
<p>因此，如果在200px宽的父容器中显示4:3的图像，则在图像开始下载之前，会计算其相应的高度，并保留200px乘150px的区域。结果是一个免费的加载体验。</p>
<p><img data-attachment-id="10550" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/firefox-71-aspect-ratio-determination/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination.gif" data-orig-size="661,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Firefox 71 aspect ratio determination" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination-294x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination.gif" decoding="async" class="aligncenter size-full wp-image-10550 jetpack-lazy-image" src="../Images/b239ea152a3a3447b172bf629c4e740a.png" alt="Firefox 71 Aspect Ratio Determination" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10550" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/firefox-71-aspect-ratio-determination/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination.gif" data-orig-size="661,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Firefox 71 aspect ratio determination" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination-294x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10550" src="../Images/b239ea152a3a3447b172bf629c4e740a.png" alt="Firefox 71 Aspect Ratio Determination" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/firefox-71-aspect-ratio-determination.gif"/></noscript><br/>
Any appropriate <code>img</code> width and height can be used since the image is resized by CSS (e.g., <code>width="4" height="3"</code>. However, it is best to set a reasonable size to ensure the image remains visible in very old browsers, if CSS fails to load, or when a user style sheet is defined.
<p>Firefox 71将于2019年12月发布，Chrome将在不久后支持纵横比计算。但是，您现在可以添加<code>img</code>宽度和高度属性。旧的浏览器和不支持的浏览器将不会保留空间，但图像的大小将和以前一样。</p>
<h3>响应图像(srcset和大小属性)</h3>
<p><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images" target="_blank" rel="noopener noreferrer">响应图像</a>使用<code>srcset</code>和<code>sizes</code>属性定义一组带宽高效的备选方案。这通常用于高原生分辨率屏幕(HiDPI或Retina ),以确保下载最佳质量的图像。例如，仅在4x DPI设备上使用最高分辨率的<code>img-400.jpg</code>。</p>
<pre> &lt;img width="100" height="100"
      alt="responsive image"
        src="img-100.jpg"
     srcset="img-100.jpg 1x,
             img-200.jpg 2x,
             img-300.jpg 3x,
             img-400.jpg 4x" /&gt;</pre>
<p>它还可以用于为可用空间加载适当的图像。例如，当浏览器视窗宽度接近400像素时，使用<code>img-400.jpg</code>。</p>
<pre>&lt;img width="100" height="100"
       alt="responsive image"
       src="img-100.jpg"
    srcset="img-100.jpg 100w,
            img-200.jpg 200w,
            img-300.jpg 300w,
            img-400.jpg 400w" /&gt;</pre>
<p>每个图像应该使用相同的纵横比，这样就可以设置<code>img</code>的宽度和高度。</p>
<h3>艺术指导(图片元素)</h3>
<p>HTML <code>picture</code>元素根据浏览器支持和条件请求它的一个子元素。根据设备的尺寸和方向，可以使用不同的图像。例如，当视窗宽度大于高度时，下载<code>landscape.jpg</code>，否则返回<code>portrait.jpg</code>。</p>
<pre>&lt;picture&gt;
  &lt;source srcset="landscape.jpg"
           media="(min-aspect-ratio:1/1)" /&gt;
  &lt;img src="portrait.jpg" alt="portrait image" /&gt;
&lt;/picture&gt;</pre>
<p>每个图像可以具有不同的纵横比。在撰写本文时，浏览器供应商正在考虑最佳解决方案。最有可能的选项是所有<code>source</code>和<code>img</code>子元素的宽度和高度属性。</p>
<pre>&lt;picture&gt;
  &lt;source srcset="landscape.jpg"
           media="(min-aspect-ratio:1/1)"
           width="800" height="450" /&gt;
  &lt;img src="portrait.jpg" alt="portrait image"
           width="450" height="800" /&gt;
&lt;/picture&gt;</pre>
<h2>其他元素的纵横比</h2>
<p>当为<code>iframe</code>、<code>video</code>或任何其他元素定义了<code>width</code>和<code>height</code>属性时，不会计算纵横比。这将是有用的，因此已经提出了两个建议，但是在撰写本文时都没有在浏览器中实现:</p>
<ol>
<li><code><a href="https://drafts.csswg.org/css-sizing-4/#ratios" target="_blank" rel="noopener noreferrer">CSS aspect-ratio property</a></code>，例如<code>aspect-ratio: 16/9</code></li>
<li><code><a href="https://github.com/WICG/intrinsicsize-attribute" target="_blank" rel="noopener noreferrer">HTML intrinsicsize attribute</a></code>(这似乎不太可能获得支持，因为<code>width</code>和<code>height</code>属性有效地做了同样的事情)</li>
</ol>
<p>让我们来看一些在大多数浏览器中都可以使用的可选长宽比选项。</p>
<h3>拉伸和裁剪</h3>
<p>我们的海雀图像是1600×1200，所以它的比例是4:3。</p>
<pre>&lt;img src="puffin.jpg" width="1600" height="1200" alt="a puffin" /&gt;</pre>
<p>如果我们试图把它放在一个不同长宽比的区域，比如200×300，浏览器会拉伸或压缩图像以适应。</p>
<pre>img {
  width: 200px;
  height: 300px;
  border: 2px solid #000;
}</pre>
<p><img data-attachment-id="10552" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/stretching-cropping-aspect-ratio/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png" data-orig-size="201,300" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Stretching and cropping an image with aspect ratios" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png" decoding="async" class="aligncenter size-full wp-image-10552 jetpack-lazy-image" src="../Images/08d68f91020db906d0df3880edb1194f.png" alt="Stretching and Cropping an Image With Aspect Ratios" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10552" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/stretching-cropping-aspect-ratio/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png" data-orig-size="201,300" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Stretching and cropping an image with aspect ratios" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10552" src="../Images/08d68f91020db906d0df3880edb1194f.png" alt="Stretching and Cropping an Image With Aspect Ratios" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/stretching-cropping-aspect-ratio.png"/></noscript><br/>
The CSS <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit" target="_blank" rel="noopener noreferrer"><code>object-fit</code></a> property provides further options. <code>object-fit: fill</code> is the default and is identical to the image shown above.
<p><code>object-fit: contain</code>确保缩放整个图像以适合可用空间。纵横比保持不变，因此边框将出现在水平或垂直边缘。</p>
<pre>img {
  width: 200px;
  height: 300px;
  object-fit: contain;
  border: 2px solid #000;
}</pre>
<p><img data-attachment-id="10554" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/image-scaled-aspect-ratio/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png" data-orig-size="200,300" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Image scaled to fit the available space with aspect ratios" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png" decoding="async" class="aligncenter size-full wp-image-10554 jetpack-lazy-image" src="../Images/30c34fe3026fe6c7d2fb33f521c2016f.png" alt="Image Scaled to Fit the Available Space With Aspect Ratios" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10554" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/image-scaled-aspect-ratio/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png" data-orig-size="200,300" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Image scaled to fit the available space with aspect ratios" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10554" src="../Images/30c34fe3026fe6c7d2fb33f521c2016f.png" alt="Image Scaled to Fit the Available Space With Aspect Ratios" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-scaled-aspect-ratio.png"/></noscript><br/>
<code>object-fit: cover</code> resizes the image to fit the area without showing borders. Its aspect ratio is maintained so cropping can occur.
<p><img data-attachment-id="10556" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/image-resized-fit-area-no-borders/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png" data-orig-size="202,302" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Image resized to fit the area without showing borders" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders-201x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png" decoding="async" class="aligncenter size-full wp-image-10556 jetpack-lazy-image" src="../Images/3f1a3399632ea717899c1b332eb07222.png" alt="Image Resized to Fit the Area Without Showing Borders" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png 202w, https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders-201x300.png 201w" data-lazy-sizes="(max-width: 202px) 100vw, 202px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10556" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/image-resized-fit-area-no-borders/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png" data-orig-size="202,302" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Image resized to fit the area without showing borders" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders-201x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10556" src="../Images/3f1a3399632ea717899c1b332eb07222.png" alt="Image Resized to Fit the Area Without Showing Borders" srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png 202w, https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders-201x300.png 201w" sizes="(max-width: 202px) 100vw, 202px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-resized-fit-area-no-borders.png"/></noscript><br/>
This may not be ideal, so <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/object-position" target="_blank" rel="noopener noreferrer"><code>object-position</code></a> can be used to specify the horizontal and vertical alignment, e.g., <code>object-position: 20% 50%</code>.
<p><img data-attachment-id="10558" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/image-aligned-with-object-position/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png" data-orig-size="203,302" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Image aligned with object position" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position-202x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png" decoding="async" class="aligncenter size-full wp-image-10558 jetpack-lazy-image" src="../Images/fcaff55ac30dbd348d00adedc152888d.png" alt="Image Aligned With Object Position" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png 203w, https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position-202x300.png 202w" data-lazy-sizes="(max-width: 203px) 100vw, 203px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10558" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/image-aligned-with-object-position/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png" data-orig-size="203,302" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Image aligned with object position" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position-202x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10558" src="../Images/fcaff55ac30dbd348d00adedc152888d.png" alt="Image Aligned With Object Position" srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png 203w, https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position-202x300.png 202w" sizes="(max-width: 203px) 100vw, 203px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/image-aligned-with-object-position.png"/></noscript><br/>
<code>object-fit: none</code> does not resize the image, so in this case, only a small portion will be shown.
<p><img data-attachment-id="10559" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/portion-image-not-resized/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png" data-orig-size="202,301" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Portion of an image not resized" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png" decoding="async" class="aligncenter size-full wp-image-10559 jetpack-lazy-image" src="../Images/262d2c7d70ea30a47799095b975f11fa.png" alt="Portion of an Image Not Resized" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10559" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/portion-image-not-resized/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png" data-orig-size="202,301" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Portion of an image not resized" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10559" src="../Images/262d2c7d70ea30a47799095b975f11fa.png" alt="Portion of an Image Not Resized" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/portion-image-not-resized.png"/></noscript><br/>
Finally, <code>object-fit: scale-down</code> resizes the image as if <code>none</code> or <code>contain</code> were specified and chooses whichever results in the smallest size. Since our image is larger than the containing space, <code>contain</code> is effectively chosen.
<p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/background-size" target="_blank" rel="noopener noreferrer"> <code>CSS background-size</code> </a>属性为背景图片提供了类似的选项。</p>
<p>虽然这些方法可能适用于某些图像，但它们会将内容强制放入一个大小合适的容器中。如果该容器与纵横比不匹配，则该内容的一部分可能会被隐藏，例如，<code>video</code>元素上的回放控件。</p>
<h3>纵横比填充技巧</h3>
<p>幸运的是，有一种不寻常的方法可以使用CSS <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/padding-top" target="_blank" rel="noopener noreferrer"> <code>padding-top</code> </a>或<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/padding-bottom" target="_blank" rel="noopener noreferrer"> <code>padding-bottom</code> </a>属性来定义任何元素的纵横比。当任一项以百分比表示时，产生的填充与元素的宽度成比例，而不是与高度成比例。</p>
<p>由于<code>padding-top</code>被设置为宽度的56.25%(9/16 x 100%)，下面的元素将是一个完美的16:9比率。实际高度设置为零，因为它通常会添加到填充中。</p>
<pre>.container-16-9 {
  position: relative;
  width: 100%;
  height: 0;
  padding-top: calc(9 / 16 * 100%);
}</pre>
<p>如果宽度为400像素，垂直填充为400像素的56.25%，即225像素。高度会随着宽度的增加或减少而变化。</p>
<p>因此，我们可以在容器中放置任何元素，比如16:9的视频。</p>
<pre>&lt;div class="container-16-9"&gt;
  &lt;video controls preload="none"&gt;
    &lt;source src="video.mp4" type='video/mp4' /&gt;
  &lt;/video&gt;
&lt;/div&gt;</pre>
<p>我们也可以绝对定位它来保持长宽比。</p>
<pre>.container-16-9 {
  position: relative;
  width: 100%;
  height: 0;
  padding-top: calc(9 / 16 * 100%);
}

.container-16-9 &gt; :first-child {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
}</pre>
<p><img data-attachment-id="10561" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/video-placed-inside-container/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png" data-orig-size="643,361" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Video placed inside a container" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png" decoding="async" class="aligncenter size-full wp-image-10561 jetpack-lazy-image" src="../Images/43508602be7d3729e8b01128b0a2ec23.png" alt="Video Placed Inside a Container" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png 643w, https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container-300x168.png 300w" data-lazy-sizes="(max-width: 643px) 100vw, 643px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="10561" data-permalink="https://blog.logrocket.com/jank-free-page-loading-with-media-aspect-ratios/attachment/video-placed-inside-container/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png" data-orig-size="643,361" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Video placed inside a container" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-10561" src="../Images/43508602be7d3729e8b01128b0a2ec23.png" alt="Video Placed Inside a Container" srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png 643w, https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container-300x168.png 300w" sizes="(max-width: 643px) 100vw, 643px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/video-placed-inside-container.png"/></noscript><br/>
It would be great if we could extract the container’s <code>width</code> and <code>height</code> attributes as <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/attr" target="_blank" rel="noopener noreferrer"><code>CSS attr()</code></a> values, then use them in a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/calc" target="_blank" rel="noopener noreferrer"><code>calc()</code></a>, but that is not possible because the <code>attr()</code> function only returns a string for use in <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/content" target="_blank" rel="noopener noreferrer"><code>content</code></a> properties. However, browser vendors are considering casting.
<p>因此，我们可以定义一系列已知的比率。</p>
<pre>.aspect {
  position: relative;
  width: 100%;
  height: 0;
  padding-top: 100%; /* default 1:1 */
}

.aspect.ratio-16-9 {
  padding-top: calc(9 / 16 * 100%);
}

.aspect.ratio-9-16 {
  padding-top: calc(16 / 9 * 100%);
}

.aspect.ratio-4-3 {
  padding-top: calc(3 / 4 * 100%);
}

.aspect.ratio-3-4 {
  padding-top: calc(4 / 3 * 100%);
}

.aspect &gt; :first-child {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
}</pre>
<p>然后，在容器上设置一个<code>aspect</code>和适当的<code>ratio</code>类。</p>
<pre>&lt;div class="aspect ratio-16-9"&gt;
  &lt;video controls preload="none"&gt;
    &lt;source src="video.mp4" type='video/mp4' /&gt;
  &lt;/video&gt;
&lt;/div&gt;</pre>
<p>像Sass这样的CSS预处理器可能是一个更容易的选择，因为所有的纵横比都可以在一个列表中定义，并在构建时计算。</p>
<pre>// define all known ratios
$ratio:
  (w: 16, h:  9 ),
  (w:  9, h: 16 ),
  (w:  4, h:  3 ),
  (w:  3, h:  4)
;

.aspect {
  position: relative;
  width: 100%;
  height: 0;
  padding-top: 100%; /* default 1:1 */
}

.aspect &gt; :first-child {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
}

@each $r in $ratio {
  $w: map-get($r, w);
  $h: map-get($r, h);
  .aspect.ratio-#{$w}-#{$h} {
    padding-top: $h / $w * 100%;
  }
}</pre>
<p>预定义这些类的主要缺点是，您不能像使用<code>width</code>和<code>height</code>属性那样在HTML中设置任何纵横比。但是，自定义属性(CSS变量)提供了一个选项，因为纵横比可以在样式属性中定义。</p>
<pre>&lt;!-- define a 21:9 container --&gt;
&lt;div style="--aspect-ratio: 21/9;"&gt;
  &lt;video...&gt;&lt;/video&gt;
&lt;/div&gt;</pre>
<p>它的值在CSS中可用，并可以相应地使用:</p>
<pre>@supports (--custom:property) {

  [style*="--aspect-ratio"] {
    position: relative;
    width: 100%;
    height: 0;
    padding-top: calc( 100% / (var(--aspect-ratio)) );
  }

  [style*="--aspect-ratio"] &gt; :first-child {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
  }

}</pre>
<p>这更短也更灵活，但是在没有自定义属性支持的旧浏览器中会失败(<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@supports" target="_blank" rel="noopener noreferrer"> <code>@supports</code> </a>规则确保这些浏览器甚至不会尝试)。</p>
<p>填充技巧的主要缺陷是大小元素必须包装在一个定义了纵横比的容器中。像<a href="https://github.com/rosszurowski/fitvids" target="_blank" rel="noopener noreferrer"> fitvids </a>这样的JavaScript选项可以自动处理这个问题，但是在计算长宽比和添加容器时，仍然会有一些页面回流。</p>
<h2>结论</h2>
<p>通过页面加载时的重排来移动文本内容已经困扰用户好几年了，但是在隧道的尽头出现了一点曙光。</p>
<p>在不久的将来，记得给所有的<code>img</code>标签添加<code>width</code>和<code>height</code>属性。考虑在<code>video</code>和<code>iframe</code>容器上使用填充百分比技巧，如果它们可能导致回流的话。</p>
<p>随着浏览器的发展，CSS <a href="https://drafts.csswg.org/css-sizing-4/#ratios" target="_blank" rel="noopener noreferrer"> <code>aspect-ratio</code> </a>属性可能会成为保留页面空间的必要方式，janky页面加载的时代将会结束。</p><div class="code-block code-block-25">
<div class="blog-plug inline-plug css-plug"><h2>你的前端是否占用了用户的CPU？</h2><p>随着web前端变得越来越复杂，资源贪婪的特性对浏览器的要求越来越高。如果您对监控和跟踪生产环境中所有用户的客户端CPU使用、内存使用等感兴趣，</p><a target="_blank" href="https://lp.logrocket.com/blg/css-signup">try LogRocket</a><p>.</p><a class="signup" href="https://lp.logrocket.com/blg/css-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/dacb06c713aec161ffeaffae5bd048cd.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/12/cpu-memory-usage.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/cpu-memory-usage.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/dacb06c713aec161ffeaffae5bd048cd.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/cpu-memory-usage.png"/></noscript></a><a href="https://lp.logrocket.com/blg/css-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用的DVR，记录你的网络应用或网站上发生的一切。您可以汇总和报告关键的前端性能指标，重放用户会话和应用程序状态，记录网络请求，并自动显示所有错误，而不是猜测问题发生的原因。</p><p>现代化您调试web和移动应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/css-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>