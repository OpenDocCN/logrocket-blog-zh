<html>
<head>
<title>FormGroup and FormControl in Angular - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Angular - LogRocket博客中的表单组和表单控件</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/reactive-form-controls-form-groups-angular/#0001-01-01">https://blog.logrocket.com/reactive-form-controls-form-groups-angular/#0001-01-01</a></blockquote><div><article class="article-post">
<p>使用JavaScript框架时，最好避免使用集群模板，因为表单逻辑位于组件类中。<a href="https://angular.io/guide/reactive-forms" target="_blank" rel="noopener">Angular</a>中的反应式表单允许你创建干净的表单，而不需要使用太多的指令。它们还减少了端到端测试的需要，因为验证表单非常容易。</p>
<p>简而言之，Angular中的表单控件给了开发人员所有的控制权，没有任何东西是隐式的——关于输入和控件的每一个选择都必须是有意的，当然也是显式的。</p>
<p>在本教程中，我们将向您展示如何按表单组划分表单控件，以创建群集，从而提供一个平台来轻松地按组访问模板元素。我们将详细介绍以下内容:</p>

<p>为了说明Angular中表单组的概念，我们将介绍构建反应式表单的过程，以便您可以完全掌握如何使用表单组来设置它。</p>
<p>接下来，在<a href="https://github.com/viclotana/ng-reactive" target="_blank" rel="noopener"> GitHub </a>上下载starter项目，并在VS代码中打开它。如果你还没有，你会想更新到最新版本，<a href="https://angular.io/guide/updating-to-version-11" target="_blank" rel="noopener"> Angular 11 </a>。</p>
<h2 id="whatareformcontrolsinangular">Angular中的形状控制是什么？</h2>
<p>在<a href="https://angular.io/" target="_blank" rel="noopener"> Angular </a>中，表单控件是可以保存任何表单元素的数据值和验证信息的类。反应式表单中的每个表单输入都应该被表单控件绑定。这些是组成反应形式的基本单位。</p>
<h2 id="whatisaformgroupinangular">什么是Angular中的形群？</h2>
<p>表单组包装表单控件的集合。就像控件使您可以访问元素的状态一样，组也提供了相同的访问权限，但访问的是包装控件的状态。初始化时，表单组中的每个表单控件都由名称标识。</p>
<h2 id="formcontrolandformgroupinangular"><code>FormControl</code>和<code>FormGroup</code>在角度</h2>
<p>是Angular中的一个类，用于跟踪单个表单控件的值和验证状态。Angular表单中的三个基本构件之一——与<code>FormGroup</code>和<code>FormArray</code> — <code>FormControl</code>一起——扩展了<code>AbstractControl</code>类，使其能够访问值、验证状态、用户交互和事件。</p>
<p><code>FormGroup</code>与<code>FormControl</code>一起使用，用于跟踪值并验证表单控制的状态。实际上，<code>FormGroup</code>将每个子控件<code>FormControl</code>的值聚合到一个对象中，使用每个控件名作为键。它通过减少其子级的状态值来计算其状态，这样，如果一个组中的一个控件无效，则整个组都无效。</p>
<h2 id="registeringformgroupsinangular">在Angular中注册表单组</h2>
<p>第一步是告诉Angular，您希望通过将表单组导入到适当的组件中来使用它。</p>
<p>要查看这是如何工作的，导航到<code>employee.component.ts</code>文件并粘贴到下面的代码块中:</p>
<pre>import { Component, OnInit } from '@angular/core';
import { FormControl, FormGroup } from '@angular/forms'
@Component({
  selector: 'app-employee',
  templateUrl: './employee.component.html',
  styleUrls: ['./employee.component.css']
})
export class EmployeeComponent implements OnInit {
  bioSection = new FormGroup({
    firstName: new FormControl(''),
    lastName: new FormControl(''),
    age: new FormControl('')
  });
constructor() { }
ngOnInit() {
  }
}</pre>
<p>在这里，表单组被导入并初始化，以便将构成表单bio部分的一些表单控件组合在一起。为了反映这个组，您必须将模型与带有表单组名称的视图相关联，如下所示:</p>
<pre>// copy inside the employee.component.html file
&lt;form [formGroup]="bioSection" (ngSubmit)="callingFunction()"&gt;

  &lt;label&gt;
    First Name:
    &lt;input type="text" formControlName="firstName"&gt;
  &lt;/label&gt;
&lt;label&gt;
    Last Name:
    &lt;input type="text" formControlName="lastName"&gt;
  &lt;/label&gt;
&lt;label&gt;
    Age:
    &lt;input type="text" formControlName="age"&gt;
  &lt;/label&gt;
&lt;button type="submit"&gt;Submit Application&lt;/button&gt;
&lt;/form&gt;</pre>
<p>就像表单控件一样，表单组名用来标识视图中的表单组，提交时会触发<code>callingFunction</code>。</p>
<p>您的<code>app.component.html</code>文件应该如下所示:</p>
<pre>&lt;div style="text-align:center"&gt;
  &lt;h2&gt;Angular Job Board &lt;/h2&gt;
  &lt;app-employee&gt;&lt;/app-employee&gt;
&lt;/div&gt;</pre>
<p>现在使用以下命令运行开发中的应用程序:</p>
<pre>ng serve</pre>
<p>应该是这样的:<br/> <img data-attachment-id="5388" data-permalink="https://blog.logrocket.com/reactive-form-controls-form-groups-angular/angular-job-board-form/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png" data-orig-size="730,208" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Angular job board form" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-300x85.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png" decoding="async" class="aligncenter size-full wp-image-5388 jetpack-lazy-image" src="../Images/b9ee9add91ee3c8f1f4d9d6d668ab771.png" alt="Angular Job Board Form" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png 730w, https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-300x85.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="5388" data-permalink="https://blog.logrocket.com/reactive-form-controls-form-groups-angular/angular-job-board-form/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png" data-orig-size="730,208" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Angular job board form" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-300x85.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-5388" src="../Images/b9ee9add91ee3c8f1f4d9d6d668ab771.png" alt="Angular Job Board Form" srcset="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png 730w, https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-300x85.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form.png"/></noscript>
<pre/>
<h2 id="nestingformgroupsinangular">成角度地嵌套形成组</h2>
<p>Angular reactive forms API可以将一个表单组嵌套在另一个表单组中。</p>
<p>将下面的代码块复制到<code>employee.component.ts</code>文件中:</p>
<pre>import { Component, OnInit } from '@angular/core';
import { FormControl, FormGroup } from '@angular/forms'
@Component({
  selector: 'app-employee',
  templateUrl: './employee.component.html',
  styleUrls: ['./employee.component.css']
})
export class EmployeeComponent implements OnInit {
  bioSection = new FormGroup({
    firstName: new FormControl(''),
    lastName: new FormControl(''),
    age: new FormControl(''),
    stackDetails: new FormGroup({
      stack: new FormControl(''),
      experience: new FormControl('')
    }),
    address: new FormGroup({
        country: new FormControl(''),
        city: new FormControl('')
    })
  });
constructor() { }
ngOnInit() {
  }
  callingFunction() {
    console.log(this.bioSection.value);
   }
}</pre>
<p>主要的表单组包装器是bio部分，其中嵌套了堆栈细节组和地址组。如您所见，嵌套表单组不是由赋值语句定义的，而是用冒号定义的，就像表单控件一样。</p>
<p>在视图中反映出来会是这样的:</p>
<pre>// copy inside the employee.component.html file
&lt;form [formGroup]="bioSection" (ngSubmit)="callingFunction()"&gt;
    &lt;h3&gt;Bio Details
&lt;/h3&gt;

  &lt;label&gt;
    First Name:
    &lt;input type="text" formControlName="firstName"&gt;
  &lt;/label&gt; &lt;br&gt;
&lt;label&gt;
    Last Name:
    &lt;input type="text" formControlName="lastName"&gt;
  &lt;/label&gt; &lt;br&gt;
&lt;label&gt;
    Age:
    &lt;input type="text" formControlName="age"&gt;
  &lt;/label&gt;
&lt;div formGroupName="stackDetails"&gt;
    &lt;h3&gt;Stack Details&lt;/h3&gt;

    &lt;label&gt;
      Stack:
      &lt;input type="text" formControlName="stack"&gt;
    &lt;/label&gt; &lt;br&gt;

    &lt;label&gt;
      Experience:
      &lt;input type="text" formControlName="experience"&gt;
    &lt;/label&gt;
  &lt;/div&gt;
&lt;div formGroupName="address"&gt;
    &lt;h3&gt;Address&lt;/h3&gt;

    &lt;label&gt;
      Country:
      &lt;input type="text" formControlName="country"&gt;
    &lt;/label&gt; &lt;br&gt;

    &lt;label&gt;
      City:
      &lt;input type="text" formControlName="city"&gt;
    &lt;/label&gt;
  &lt;/div&gt;
&lt;button type="submit"&gt;Submit Application&lt;/button&gt;
&lt;/form&gt;</pre>
<p>模型和视图中的每个名称都匹配是至关重要的，所以要确保不要拼错表单控件的名称。当您保存并运行应用程序时，如果您确实遇到了任何错误，请阅读错误消息并纠正您一定使用的拼写错误。</p>
<p>您可以使用下面的样式说明来设置组件的样式:</p>
<pre>input[type=text] {
    width: 30%;
    padding: 8px 14px;
    margin: 2px;
    box-sizing: border-box;
  }
  button {
      font-size: 12px;
      margin: 2px;
      padding: 8px 14px;
  }</pre>
<p>如果您运行该应用程序，您应该会在浏览器中看到类似这样的内容:<br/> <img data-attachment-id="5389" data-permalink="https://blog.logrocket.com/reactive-form-controls-form-groups-angular/angular-job-board-form-bio/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-e1567003921989.png" data-orig-size="730,456" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Angular job board form bio" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-1024x640.png" decoding="async" class="aligncenter wp-image-5389 size-full jetpack-lazy-image" src="../Images/c4e9ea5d0d7eb4e1d17fac63d2c286aa.png" alt="Angular Job Board Form Bio" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-e1567003921989.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-e1567003921989.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="5389" data-permalink="https://blog.logrocket.com/reactive-form-controls-form-groups-angular/angular-job-board-form-bio/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-e1567003921989.png" data-orig-size="730,456" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Angular job board form bio" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-1024x640.png" decoding="async" loading="lazy" class="aligncenter wp-image-5389 size-full" src="../Images/c4e9ea5d0d7eb4e1d17fac63d2c286aa.png" alt="Angular Job Board Form Bio" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/08/angular-job-board-form-bio-e1567003921989.png"/></noscript><br/>
When you use the form and submit, you will see your input results returned in the browser console. The complete code used in this tutorial is available on <a href="https://github.com/viclotana/ng-group">GitHub</a>.
<h2 id="howtoaddaformcontroltoaformgroup">如何给一个<code>FormGroup</code>加上一个<code>FormControl</code></h2>
<p>要在<code>FormGroup</code> 中<a href="https://www.concretepage.com/angular/angular-formgroup-addcontrol-removecontrol" target="_blank" rel="noopener">添加、更新或删除控件，使用以下命令:</a></p>
<ul>
<li><code>addControl()</code>添加控制并更新其值和有效性</li>
<li><code>removeControl()</code>删除控件</li>
<li><code>setControl()</code>替换现有控件</li>
<li><code>contains()</code>检查与给定名称相关联的已启用控件</li>
<li>注册一个控件，但与其他方法不同的是，不更新它的值和有效性</li>
</ul>
<h2 id="howtosetaformgroupvalue">如何设置<code>FormGroup</code>值</h2>
<p>在Angular中，您可以<a href="https://stackoverflow.com/questions/38655613/angular2-set-value-for-formgroup" target="_blank" rel="noopener">设置单个表单组</a>的值，或者一次设置所有<code>FormGroup</code>的值。</p>
<p>使用<code>patchValue</code>仅设置一些值:</p>
<pre>this.myFormGroup.patchValue({
  formControlName1: myValue1, 
  // formControlName2: myValue2
});</pre>
<p>您不需要在此提供所有值；未设置值的字段将不受影响。</p>
<p>要同时设置所有的<code>FormGroup</code>值，使用<code>setValue</code>:</p>
<pre>this.myFormGroup.setValue({
  formControlName1: myValue1, 
  formControlName2: myValue2
});</pre>
<h2 id="whatisformbuilderinangular">什么是<code>FormBuilder</code>有角？</h2>
<p>设置表单控件可能会很繁琐，尤其是在处理很长的表单时。Angular的<a href="https://angular.io/api/forms/FormBuilder#description" target="_blank" rel="noopener"> <code>FormBuilder</code> </a>帮助您简化构建高级表单的过程，同时避免重复。</p>
<p>简而言之，<code>FormBuilder</code>提供了语法上的好处，减轻了创建<code>FormControl</code>、<code>FormGroup</code>或<code>FormArray</code>实例的负担，并减少了构建复杂表单所需的样板文件的数量。</p>
<p>关于如何构建复杂形状的更深入的探究和例子，请阅读我们全面的<a href="https://blog.logrocket.com/form-builders-angular-8-validate-reactive-forms/" target="_blank" rel="noopener">角形构建器教程</a>。</p>
<h2 id="conclusion">结论</h2>
<p>在本教程中，我们涵盖了Angular中你需要知道的关于表单控件的一切，包括如何使用<code>FormControl</code>，如何用<code>FormGroup</code>对表单控件进行分组，以及为什么一次捕获控件的集合实例很重要。</p><div class="code-block code-block-19">
<div class="blog-plug inline-plug angular-plug"><h2>像用户一样体验Angular应用程序</h2><p>调试Angular应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪生产中所有用户的角度状态和动作感兴趣，</p><a href="https://lp.logrocket.com/blg/angular-signup">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/angular-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/2794ac39244976f37c4941d9a910be23.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/610d6a7-687474703a2f2f692e696d6775722e636f6d2f696147547837412e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/610d6a7-687474703a2f2f692e696d6775722e636f6d2f696147547837412e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/2794ac39244976f37c4941d9a910be23.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/610d6a7-687474703a2f2f692e696d6775722e636f6d2f696147547837412e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/angular-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你网站上发生的一切，包括网络请求、JavaScript错误等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket NgRx插件将角度状态和动作记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化调试Angular应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/angular-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>
 
</div>    
</body>
</html>