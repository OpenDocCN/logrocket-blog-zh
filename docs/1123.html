<html>
<head>
<title>Getting started with Vendure - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Vendure - LogRocket博客入门</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/getting-started-with-vendure/#0001-01-01">https://blog.logrocket.com/getting-started-with-vendure/#0001-01-01</a></blockquote><div><article class="article-post">
<h2>Vendure是什么？</h2>
<p>Vendure是一个用TypeScript和Node.js构建的无头电子商务框架。</p>
<h2>vendre功能</h2>
<ul>
<li>产品和变体</li>
<li>库存管理</li>
<li>支付提供商集成</li>
<li>运输提供商集成</li>
</ul>
<h2>“无头”是什么意思？</h2>
<p>您可能听说过“API优先”或“无头”这样的术语。综上所述，它提供了你的内容(博文、产品等。)作为API上的数据。这提供了很大的灵活性，因为它允许您使用自己选择的技术堆栈。相比之下，传统的CMS(内容管理系统)需要您安装一个软件，并让您使用特定的技术子集。</p>
<h2>简单介绍一下我们的技术选择</h2>
<p>在本教程中，我将使用Next.js、GraphQL和Apollo客户端。以下是关于每一个的一些信息:</p>
<ul>
<li>next . js——一个React框架，提供零配置、静态生成、服务器端呈现和文件系统路由等等</li>
<li><a href="https://graphql.org/" target="_blank" rel="noopener noreferrer"> GraphQL </a> —一种API的查询语言。在查询中，您描述了您想要的数据类型，它就返回这样的数据。仅此而已。GraphQL提供了多种特性，包括能够在单个请求中获得多个资源、类型系统等等！</li>
<li><a href="https://www.apollographql.com/docs/react/" target="_blank" rel="noopener noreferrer"> Apollo Client </a> —一个状态管理库，使您能够使用GraphQL管理远程和本地数据。它允许我们在自动更新UI的同时获取、缓存和修改我们的应用程序。一些特性包括声明性数据获取，能够使用现代的React特性(比如钩子)，并且它是通用兼容的</li>
</ul>
<h2>风险投资入门</h2>
<h3>要求:</h3>
<ul>
<li><a href="https://nodejs.org/en/blog/release/v10.13.0/" target="_blank" rel="noopener noreferrer"> Node.js v10.13.0 </a>或以上版本</li>
<li><a href="https://docs.npmjs.com/cli/version" target="_blank" rel="noopener noreferrer"> NPM v5.2 </a>以上或<a href="https://classic.yarnpkg.com/en/docs/cli/version/" target="_blank" rel="noopener noreferrer">纱v0.25 </a>以上</li>
<li>如果在Windows上，请确保安装了如下窗口构建工具:<ul>
<li><code>npm install --global --production windows-build-tools</code></li>
</ul>
</li>
</ul>
<pre># NPM
npx @vendure/create name-of-your-app
# Yarn
yarn create @vendure my-app</pre>
<p>这将运行<a href="https://github.com/vendure-ecommerce/vendure/tree/master/packages/create" target="_blank" rel="noopener noreferrer"> Vendure Create </a>,并询问您一些关于您的项目的问题。为此，我选择不使用TypeScript，而选择SQLite作为数据库。如果您只想测试Vendure，Vendure建议您使用SQLite，因为它不需要任何外部要求。</p>
<h2>在本地运行</h2>
<p>安装完成后，<code>cd</code>(更改目录)进入你的项目并运行以下命令:</p>
<pre>npm run start</pre>
<p>运行该命令后，让我们转到<a href="http://localhost:3000/admin/" target="_blank" rel="noopener noreferrer">http://localhost:3000/admin/</a>以管理员身份登录并添加/查看我们的产品。</p>
<p><img data-attachment-id="24489" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/vendure-admin-login/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login.png" data-orig-size="1422,782" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vendure-admin-login" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-300x165.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-1024x563.png" decoding="async" class="aligncenter wp-image-24489 size-full jetpack-lazy-image" src="../Images/510f99cc806b63b253957dfa1c4d2b99.png" alt="vendure admin login page, form inputs for username and email" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login.png 1422w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-300x165.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-1024x563.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-768x422.png 768w" data-lazy-sizes="(max-width: 1422px) 100vw, 1422px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24489" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/vendure-admin-login/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login.png" data-orig-size="1422,782" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vendure-admin-login" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-300x165.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-1024x563.png" decoding="async" loading="lazy" class="aligncenter wp-image-24489 size-full" src="../Images/510f99cc806b63b253957dfa1c4d2b99.png" alt="vendure admin login page, form inputs for username and email" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login.png 1422w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-300x165.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-1024x563.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login-768x422.png 768w" sizes="(max-width: 1422px) 100vw, 1422px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-admin-login.png"/></noscript>
<p>使用您在安装过程中创建的管理员用户名和密码登录。如果您忘记了这些是什么，在文本编辑器中打开应用程序，进入<code>src &gt; vendure-config.js</code>文件，在<code>authOptions</code>下，您应该会看到您的用户名和密码。</p>
<p>登录后，您应该会看到仪表板。现在让我们添加一些产品。</p>
<h2>创建我们的商店</h2>
<p>在仪表盘的目录下，点击<code>Products</code>:</p>
<p><img data-attachment-id="24491" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/products-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/products.png" data-orig-size="1249,729" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="products" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/products-300x175.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/products-1024x598.png" decoding="async" class="aligncenter size-full wp-image-24491 jetpack-lazy-image" src="../Images/dfb50107c5064cee222b17814cb7bb39.png" alt="vendure dashboard with menu on left side, the menu item 'product' is circled in red " data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/products.png 1249w, https://blog.logrocket.com/wp-content/uploads/2020/09/products-300x175.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/products-1024x598.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/products-768x448.png 768w" data-lazy-sizes="(max-width: 1249px) 100vw, 1249px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/products.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/products.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24491" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/products-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/products.png" data-orig-size="1249,729" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="products" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/products-300x175.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/products-1024x598.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24491" src="../Images/dfb50107c5064cee222b17814cb7bb39.png" alt="vendure dashboard with menu on left side, the menu item 'product' is circled in red " srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/products.png 1249w, https://blog.logrocket.com/wp-content/uploads/2020/09/products-300x175.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/products-1024x598.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/products-768x448.png 768w" sizes="(max-width: 1249px) 100vw, 1249px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/products.png"/></noscript>
<p>如果您选择了用数据填充的选项，那么它应该看起来像这样:</p>
<p><img data-attachment-id="24493" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/vendure-products/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products.png" data-orig-size="1419,733" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vendure-products" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-300x155.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-1024x529.png" decoding="async" class="aligncenter size-full wp-image-24493 jetpack-lazy-image" src="../Images/2bce0f0961302f42976437813153786e.png" alt="vendure products page populated with items" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products.png 1419w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-300x155.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-1024x529.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-768x397.png 768w" data-lazy-sizes="(max-width: 1419px) 100vw, 1419px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24493" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/vendure-products/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products.png" data-orig-size="1419,733" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vendure-products" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-300x155.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-1024x529.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24493" src="../Images/2bce0f0961302f42976437813153786e.png" alt="vendure products page populated with items" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products.png 1419w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-300x155.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-1024x529.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products-768x397.png 768w" sizes="(max-width: 1419px) 100vw, 1419px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/vendure-products.png"/></noscript>
<p>如果没有，那么继续点击显示<code>New Product</code>的按钮并填写信息。</p>
<h2>将Next.js &amp; GraphQL与Vendure集成</h2>
<p>首先，我们来看看数据。为此，请访问http://localhost:3000/shop-api。</p>
<p>这将打开GraphQL playground，在这里可以查看所有可用的查询和变化。</p>
<p><img data-attachment-id="24495" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/venduregraphqldata/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata.png" data-orig-size="1431,670" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="venduregraphqldata" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-300x140.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-1024x479.png" decoding="async" class="aligncenter size-full wp-image-24495 jetpack-lazy-image" src="../Images/48bd8e89feafb1b7dcb6d75c8a9c1545.png" alt="vendure graphql data" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata.png 1431w, https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-300x140.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-1024x479.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-768x360.png 768w" data-lazy-sizes="(max-width: 1431px) 100vw, 1431px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24495" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/venduregraphqldata/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata.png" data-orig-size="1431,670" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="venduregraphqldata" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-300x140.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-1024x479.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24495" src="../Images/48bd8e89feafb1b7dcb6d75c8a9c1545.png" alt="vendure graphql data" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata.png 1431w, https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-300x140.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-1024x479.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata-768x360.png 768w" sizes="(max-width: 1431px) 100vw, 1431px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/venduregraphqldata.png"/></noscript>
<h2>设置Next.js</h2>
<pre>npx create-next-app
# or
yarn create next-app</pre>
<p>安装完成后，当您尝试运行命令<code>npm run dev</code>时，您将在终端中得到一个错误，提示“端口3000已经在使用中”</p>
<p>在文本编辑器中打开您的项目，进入<code>package.json</code>文件，在<code>scripts &gt; dev</code>下添加以下内容:</p>
<pre>next -p 8080</pre>
<p>现在回到终端，运行以下命令:</p>
<pre>npm run dev</pre>
<p>转到<a href="http://localhost:8080/" target="_blank" rel="noopener noreferrer"> localhost:8080 </a>，您应该会看到:</p>
<p><img data-attachment-id="24497" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/nextjswelcome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome.png" data-orig-size="1385,697" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="next.js welcome" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-300x151.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-1024x515.png" decoding="async" class="aligncenter size-full wp-image-24497 jetpack-lazy-image" src="../Images/40463472afecc604d92e41eb8e9a5fb4.png" alt="welcome page for next js, sign saying next.js" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome.png 1385w, https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-300x151.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-1024x515.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-768x386.png 768w" data-lazy-sizes="(max-width: 1385px) 100vw, 1385px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24497" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/nextjswelcome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome.png" data-orig-size="1385,697" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="next.js welcome" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-300x151.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-1024x515.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24497" src="../Images/40463472afecc604d92e41eb8e9a5fb4.png" alt="welcome page for next js, sign saying next.js" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome.png 1385w, https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-300x151.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-1024x515.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome-768x386.png 768w" sizes="(max-width: 1385px) 100vw, 1385px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/nextjswelcome.png"/></noscript>
<h2>设置Apollo客户端</h2>
<p>让我们安装GraphQL和Apollo所需的一切:</p>
<pre>npm i apollo-boost graphql react-apollo @apollo/react-hooks -S</pre>
<p>我们将使用<code>next-with-apollo</code>，它是Next.js的高阶组件:</p>
<pre>npm install next-with-apollo
# or with yarn:
yarn add next-with-apollo</pre>
<p>在项目的根目录下，创建一个名为<code>lib</code>的文件夹和一个名为<code>apollo.js</code>的文件，并添加以下内容:</p>
<pre>lib &gt; apollo.js

import withApollo from 'next-with-apollo';
import ApolloClient, { InMemoryCache } from 'apollo-boost';
import { ApolloProvider } from '@apollo/react-hooks';

export default withApollo(
  ({ initialState }) =&gt; {
    return new ApolloClient({
      uri: '&lt;http://localhost:3000/shop-api&gt;',
      cache: new InMemoryCache().restore(initialState || {})
    });
  },
  {
    render: ({ Page, props }) =&gt; {
      return (
        &lt;ApolloProvider client={props.apollo}&gt;
          &lt;Page {...props} /&gt;
        &lt;/ApolloProvider&gt;
      );
    }
  }
);</pre>
<p>现在，我们需要将整个应用程序包装在Apollo的高阶组件中。在<code>pages</code>中，进入<code>_app.js</code>并添加以下内容:</p>
<pre>import '../styles/globals.css';
import withApollo from '../lib/apollo';
function MyApp({ Component, pageProps }) {
  return &lt;Component {...pageProps} /&gt;;
}
export default withApollo(MyApp);</pre>
<p>有了这个，我们现在可以查询我们所有的产品。在<code>pages</code> &gt; <code>index.js</code>文件中，删除内容，并添加以下内容:</p>
<pre>pages &gt; index.js

import Head from 'next/head';
import styles from '../styles/Home.module.css';

import gql from 'graphql-tag';
import { useQuery } from '@apollo/react-hooks';

const QUERY = gql`
  {
    products {
      items {
        slug
        description
        assets {
          source
        }
      }
    }
  }
`;

function Home() {
  const { loading, data } = useQuery(QUERY);
  console.log(data);
  return &lt;div className={styles.container}&gt;home&lt;/div&gt;;
}

export default Home;</pre>
<p>在浏览器的控制台中，您应该会看到如下所示的内容:</p>
<p><img data-attachment-id="24501" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/apiresponse/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse.png" data-orig-size="1087,683" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="apiresponse" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-300x189.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-1024x643.png" decoding="async" class="aligncenter size-full wp-image-24501 jetpack-lazy-image" src="../Images/fa04b756875350fd0d8c2290281a25ea.png" alt="api response listing product items" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse.png 1087w, https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-300x189.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-1024x643.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-768x483.png 768w" data-lazy-sizes="(max-width: 1087px) 100vw, 1087px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24501" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/apiresponse/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse.png" data-orig-size="1087,683" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="apiresponse" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-300x189.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-1024x643.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24501" src="../Images/fa04b756875350fd0d8c2290281a25ea.png" alt="api response listing product items" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse.png 1087w, https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-300x189.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-1024x643.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse-768x483.png 768w" sizes="(max-width: 1087px) 100vw, 1087px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/apiresponse.png"/></noscript>
<h2>添加CSS和构建商店主页</h2>
<p>在本教程中，我将使用<a href="https://material-ui.com" target="_blank" rel="noopener noreferrer">材质-UI </a>。让我们继续安装:</p>
<pre># NPM
npm install @material-ui/core
# Yarn
yarn add @material-ui/core</pre>
<p>在项目的根目录下，创建一个名为<code>components</code>的文件夹，并添加一个名为<code>ProductCard.js</code>的文件。</p>
<p>这将允许我们使用材料UI组件和我们自己的样式表来集中一切。</p>
<p>添加以下内容:</p>
<pre>import styles from '../styles/ProductCard.module.css';

import { makeStyles } from '@material-ui/core/styles';
import Card from '@material-ui/core/Card';
import CardActionArea from '@material-ui/core/CardActionArea';
import CardActions from '@material-ui/core/CardActions';
import CardContent from '@material-ui/core/CardContent';
import CardMedia from '@material-ui/core/CardMedia';
import Button from '@material-ui/core/Button';
import Typography from '@material-ui/core/Typography';</pre>
<p>这将控制材质UI组件的CSS。这里我们定义了卡片组件中图像的最大宽度和高度:</p>
<pre>const useStyles = makeStyles({
  root: {
    maxWidth: 345,
  },
  media: {
    height: 140,
  },
});</pre>
<p>这里我们正在析构通过<code>pages &gt; index.js</code>中的<code>Home</code>组件传入的名为<code>data</code>的道具:</p>
<pre>function ProductCard({ data }) {
  const classes = useStyles();
  const { items } = data.products;
  . . .
}</pre>
<p>在这里，我们循环遍历我们的items数组并创建我们的产品卡，在其中我们传递图像URL、产品名称等。，到我们的材质UI组件:</p>
<pre>return (
    &lt;section className={styles.container}&gt;
      {items.map((item) =&gt; {
        const imgUrl = item.assets[0].source;

        return (
          &lt;div key={item.slug}&gt;
            &lt;Card className={classes.root}&gt;
              &lt;CardActionArea&gt;
                &lt;CardMedia
                  className={classes.media}
                  image={imgUrl}
                  title={item.slug}
                /&gt;
                &lt;CardContent&gt;
                  &lt;Typography gutterBottom variant='h5' component='h2'&gt;
                    {item.name}
                  &lt;/Typography&gt;
                  &lt;Typography
                    variant='body2'
                    color='textSecondary'
                    component='p'
                  &gt;
                    {item.description}
                  &lt;/Typography&gt;
                &lt;/CardContent&gt;
              &lt;/CardActionArea&gt;
              &lt;CardActions&gt;
                &lt;Button variant='outlined' color='primary'&gt;
                  Add To Cart
                &lt;/Button&gt;
                &lt;Button variant='outlined' color='secondary'&gt;
                  Details
                &lt;/Button&gt;
              &lt;/CardActions&gt;
            &lt;/Card&gt;
          &lt;/div&gt;
        );
      })}
    &lt;/section&gt;
  );

export default ProductCard;</pre>
<p>现在，让我们把我们的产品卡放在中间，使它具有响应性。在<code>styles</code>文件夹中，创建一个名为<code>ProductCard.module.css</code>的文件，并添加以下内容:</p>
<pre>styles &gt; ProductCard.module.css

.container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  grid-gap: 1rem;
}</pre>
<p>如果您保存它，它现在应该看起来像这样:</p>
<p><img data-attachment-id="24505" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/productspage/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png" data-orig-size="730,381" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="productspage" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage-300x157.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png" decoding="async" class="aligncenter size-full wp-image-24505 jetpack-lazy-image" src="../Images/b0f858fc7b55d7356d88eb7f54f8cb75.png" alt="products page listing a laptop, a tablet, and mouse" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/productspage-300x157.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24505" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/productspage/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png" data-orig-size="730,381" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="productspage" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage-300x157.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24505" src="../Images/b0f858fc7b55d7356d88eb7f54f8cb75.png" alt="products page listing a laptop, a tablet, and mouse" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/productspage-300x157.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/productspage.png"/></noscript>
<h2>构建我们的购物车/结账流程</h2>
<p>GraphQL很酷的一点是，它不仅允许我们查询数据，还允许我们更新数据。我们可以用一种叫做突变的东西来做到这一点。在Apollo客户机中，我们将使用<code>useMutation</code>钩子来更新我们的数据，并获得加载状态、错误和成功状态。</p>
<p>为了使用它，我们提供了一个GraphQL查询的<code>useMutation</code>钩子，然后它返回下面的两个:</p>
<ul>
<li>一个可以调用来执行变异的变异函数</li>
<li>反映变异执行的当前状态的对象</li>
</ul>
<p>如果我们返回到<a href="http://localhost:3000/shop-api" target="_blank" rel="noopener noreferrer">http://localhost:3000/shop-API</a>并点击<code>DOCS</code> &gt; <code>Mutations</code>，您可以看到所有可用的变体:</p>
<p><img data-attachment-id="24507" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/graphqlmutations/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png" data-orig-size="345,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="graphqlmutations" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations-153x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png" decoding="async" class="aligncenter size-full wp-image-24507 jetpack-lazy-image" src="../Images/8bcdce09519ce3d19b3f6b9da0d70871.png" alt="list of graphql mutations" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png 345w, https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations-153x300.png 153w" data-lazy-sizes="(max-width: 345px) 100vw, 345px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24507" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/graphqlmutations/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png" data-orig-size="345,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="graphqlmutations" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations-153x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24507" src="../Images/8bcdce09519ce3d19b3f6b9da0d70871.png" alt="list of graphql mutations" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png 345w, https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations-153x300.png 153w" sizes="(max-width: 345px) 100vw, 345px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/graphqlmutations.png"/></noscript>
<p>首先，我将看看<code>addItemToOrder</code>突变，开始构建我们的结账流程。</p>
<p>在GraphQL playground中，打开一个新的选项卡并粘贴以下变体:</p>
<pre>mutation {
  addItemToOrder(productVariantId: 3 quantity: 1) {
    lines {
      productVariant {
        id
        name
      }
      unitPrice
      quantity
      totalPrice
    }
  }
}</pre>
<p>这将使产品成为活动订单。如果我们查询<code>activeOrder</code>，我们应该会看到最近添加的产品:</p>
<pre>{
  activeOrder {
    // Details you want to see
  }
}</pre>
<p>现在，让我们看看运输以及如何使用<code>setOrderShippingAddress</code>突变:</p>
<pre>fragment ActiveShippingOrder on Order {
  id
  createdAt
  updatedAt
  code
  state
  active
}

mutation AddAddressToOrder($input: CreateAddressInput!) {
  setOrderShippingAddress(input: $input) {
    ...ActiveShippingOrder
  }
}</pre>
<p>片段就像一个函数，它是可重用的逻辑。在<code>ActiveShippingOrder</code>中，我们定义了当我们调用<code>setOrderShippingAddress</code>函数时我们想要返回什么数据。在<code>AddAddressToOrder</code>变异中，我们创建了一个名为<code>input</code>的查询变量，并将其传递给我们的<code>setOrderShippingAddress</code>函数。然后，在query variables选项卡中，我只传入一个带有两个必需参数的对象。输入参数只需要街道地址和国家代码。要查看完整的参数列表，可在<code>DOCS &gt; setOrderShippingAddress &gt; input</code>查看。</p>
<p><img data-attachment-id="24512" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/queryvariableslistingaddress/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress.png" data-orig-size="1374,1184" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="queryvariableslistingaddress" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-300x259.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-1024x882.png" decoding="async" class="aligncenter size-full wp-image-24512 jetpack-lazy-image" src="../Images/e747a75920a4fbd491fa7f4285733b3a.png" alt="query variables listing address" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress.png 1374w, https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-300x259.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-1024x882.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-768x662.png 768w" data-lazy-sizes="(max-width: 1374px) 100vw, 1374px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24512" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/queryvariableslistingaddress/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress.png" data-orig-size="1374,1184" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="queryvariableslistingaddress" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-300x259.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-1024x882.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24512" src="../Images/e747a75920a4fbd491fa7f4285733b3a.png" alt="query variables listing address" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress.png 1374w, https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-300x259.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-1024x882.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress-768x662.png 768w" sizes="(max-width: 1374px) 100vw, 1374px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/queryvariableslistingaddress.png"/></noscript>
<p>要查看结果，您需要将一个产品添加到活动订单状态。为此，您可以在GraphQL playground中打开一个新选项卡，编写<code>addItemToOrder</code>变异，然后返回到<code>setOrderShippingAddress</code>变异并运行它，您应该会看到以下内容:</p>
<p><img data-attachment-id="24514" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/shippingaddressingraphql/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png" data-orig-size="730,354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="shippingaddressingraphql" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql-300x145.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png" decoding="async" class="aligncenter size-full wp-image-24514 jetpack-lazy-image" src="../Images/b53cce23c852809a41a76509f3e37928.png" alt="shipping address shown in graphql playground" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql-300x145.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24514" data-permalink="https://blog.logrocket.com/getting-started-with-vendure/shippingaddressingraphql/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png" data-orig-size="730,354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="shippingaddressingraphql" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql-300x145.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-24514" src="../Images/b53cce23c852809a41a76509f3e37928.png" alt="shipping address shown in graphql playground" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql-300x145.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/shippingaddressingraphql.png"/></noscript>
<p>如果您没有将产品添加到活动订单状态，那么当您尝试运行您的<code>setOrderShippingAddress</code>变异时，它将返回null。</p>
<p>最后，我们来看看付款。为此，我们将使用<code>addPaymentToOrder</code>突变:</p>
<pre>mutation {
 addPaymentToOrder(method: "", metadata: {})
}</pre>
<blockquote><p>注意:</p></blockquote>
<ul>
<li><blockquote> <p> <code>method:</code> —该字段对应<code>PaymentMethodHandler</code> </p> </blockquote>的<code>code</code>属性</li>
<li><blockquote> <p> <code>metadata:</code> —该字段应该包含作为“元数据”参数传递给指定的<code>PaymentMethodHandler</code>的<code>createPayment()</code>方法的任意数据。例如，它可以包含支付提供商生成的支付ID和其他数据</p> </blockquote></li>
</ul>
<p>在Next.js中，我们可以使用<code>useMutation</code>钩子来应用我们的突变。例如，让我们尝试添加一个产品。首先，我们定义突变<code>gql</code>:</p>
<pre>const ORDER_FRAGMENT = gql`
  fragment ActiveOrder on Order {
    id
    code
    state
    total
    currencyCode
    lines {
      id
      productVariant {
        id
        name
        currencyCode
      }
      unitPriceWithTax
      quantity
      totalPrice
      featuredAsset {
        id
        preview
      }
    }
  }
`;
const ADD_TO_CART = gql`
  mutation AddItemToOrder($productVariantId: ID!, $quantity: Int!) {
    addItemToOrder(productVariantId: $productVariantId, quantity: $quantity) {
      ...ActiveOrder
    }
  }
  ${ORDER_FRAGMENT}
`;</pre>
<p>类似于GraphQL playground，我们使用查询变量将其传递给我们的<code>addItemToOrder</code>变异，并使用<code>ActiveOrder</code>片段来定义我们想要返回的数据。</p>
<p>此外，我们还需要一个查询来获取所有活动订单，我们来定义一下:</p>
<pre>const GET_ACTIVE_ORDER = gql`
  {
    activeOrder {
      ...ActiveOrder
    }
  }
  ${ORDER_FRAGMENT}
`;</pre>
<p>现在，我们将两个<code>gql</code>都传递给我们的<code>useMutation</code>钩子:</p>
<pre>const [addItemToOrder] = useMutation(ADD_TO_CART, {
    update: (cache, mutationResult) =&gt; {
      const { activeOrder } = cache.readQuery({
        query: GET_ACTIVE_ORDER,
      });
      cache.writeQuery({
        query: GET_ACTIVE_ORDER,
        data: {
          activeOrder: mutationResult.data.addItemToOrder,
        },
      });
    },
  });</pre>
<p>我们希望能够更新我们的查询，以便当我们试图查询<code>GET_ACTIVE_ORDER</code>时，它不会返回null。为此，您可以向<code>useMutation</code>钩子提供第二个参数。<code>update</code>属性接受一个带有两个参数的方法来获取缓存和结果。我们将在缓存上使用一个名为<code>writeQuery</code>的方法，它将把来自<code>mutationResults</code>的结果添加到我们的<code>GET_ACTIVE_ORDER</code>查询中。</p>
<p>现在，我们可以在一个<code>onClick</code>处理程序上调用<code>addItemToOrder</code>函数。这可以在用户点击“添加到购物车”按钮时使用。它会将我们选择的产品移动到活动状态，然后我们可以查询所有活动订单。</p>
<p>要添加一个送货地址，它类似于<code>addItemToOrder</code>过程，其中您将<code>gql</code>传递给<code>useMutation</code>钩子，然后传递给<code>onSubmit</code>处理程序。然后，您可以将表单中的数据传递给变异函数。</p>
<p>要添加支付，类似于<code>addItemToOrder</code>流程，您可以使用<code>addPaymentToOrder</code>变体，这取决于您想要如何处理支付，也就是说，如果您想要使用Stripe或其他服务，那么您可以在方法参数中进行配置。</p>
<h2>如何部署</h2>
<p>本质上，Vendure应用程序只是一个Node.js应用程序，它可以部署在任何支持Node.js的地方。</p>
<p>如果您想在服务器上运行这篇文章，并使用nginx作为反向代理将请求定向到您的Vendure应用程序，那么文档推荐这篇文章。</p>
<h2>结论</h2>
<p>总之，Vendure为成为下一个现代的基于GraphQL的电子商务框架提供了另一个视角。它是分离的和灵活的，这意味着它选择关注开发人员的生产力和定制的便利性。虽然它仍处于测试阶段，但Vendure提供了广泛的开箱即用功能，如客人结账、内置管理界面、与支付和运输提供商的集成等等。对于任何需要启动和运行电子商务网站的小型企业来说，这是一个完美的选择。</p><div class="code-block code-block-22">
<div class="blog-plug inline-plug ecomm-plug"><h2><a href="https://lp.logrocket.com/blg/ecommerce-signup"> LogRocket </a>:看看用户为什么不完成你的电子商务流程中的一个步骤的技术和UX原因。</h2><a class="signup" href="https://lp.logrocket.com/blg/ecommerce-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d60d88871d85e76e0dcca90f4bbaf78c.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/12/insights-step-2-lg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/insights-step-2-lg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d60d88871d85e76e0dcca90f4bbaf78c.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/insights-step-2-lg.png"/></noscript></a><p>LogRocket 就像是一个网络和移动应用程序和网站的DVR，记录你的电子商务应用程序上发生的一切。LogRocket没有猜测用户不转化的原因，而是主动揭示了阻止你转化的根本原因，比如JavaScript错误或死点击。LogRocket还可以监控应用的性能，报告客户端CPU负载、客户端内存使用等指标。</p><p>开始主动监控您的电子商务应用程序— <a class="signup" href="https://lp.logrocket.com/blg/ecommerce-signup" target="_blank" rel="noopener noreferrer">免费试用</a>。</p><div class="code-block code-block-28">
<div class="blog-plug inline-plug js-libraries-plug"><h2>您是否添加了新的JS库来提高性能或构建新特性？如果他们反其道而行之呢？</h2><p>毫无疑问，前端变得越来越复杂。当您向应用程序添加新的JavaScript库和其他依赖项时，您将需要更多的可见性，以确保您的用户不会遇到未知的问题。</p>
<p>LogRocket 是一个前端应用程序监控解决方案，可以让您回放JavaScript错误，就像它们发生在您自己的浏览器中一样，这样您就可以更有效地对错误做出反应。</p><a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/e8a0ab42befa3b3b1ae08c1439527dc6.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/e8a0ab42befa3b3b1ae08c1439527dc6.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png"/></noscript></a>
<a href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p><a href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>可以与任何应用程序完美配合，不管是什么框架，并且有插件可以记录来自Redux、Vuex和@ngrx/store的额外上下文。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。LogRocket还可以监控应用的性能，报告客户端CPU负载、客户端内存使用等指标。</p><p>自信地构建— <a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>