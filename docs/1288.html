<html>
<head>
<title>Component testing in Nuxt.js with Jest - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用Jest - LogRocket博客在Nuxt.js中进行组件测试</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/component-testing-nuxt-js-jest/#0001-01-01">https://blog.logrocket.com/component-testing-nuxt-js-jest/#0001-01-01</a></blockquote><div><article class="article-post">
<p><em> <strong>编者按</strong>:这篇文章最后一次更新是在2022年11月15日，增加了作为UI框架的<a href="https://blog.logrocket.com/getting-started-is-vuetify-right-for-you/"> Vuetify。</a></em></p>
<p>Vue在过去几年越来越受欢迎，这引发了人们对Nuxt.js的兴趣，这是一个用于使用Vue构建健壮的通用应用程序的框架。构建应用程序时，提供清晰的测试路径很重要，这将减少调试和重构代码所花费的时间。</p>
<p>在本文中，我们将学习如何用Nuxt.js建立一个游戏商店应用程序，并测试其组件。要理解这篇文章，你应该有关于Vue和Nuxt.js的基础知识。你也可以在<a href="https://github.com/fullstackmafia/nuxt-store-demo"> GitHub </a>上查看完整的资源库。我们开始吧！</p>

<h2 id="setting-up-nuxt-js-application">设置Nuxt.js应用程序</h2>
<p>要用Nuxt.js创建一个新的应用程序，我们首先必须安装它。在终端中，导航到您的项目文件夹并输入以下命令:</p>
<pre class="language-bash hljs">npm install nuxt
</pre>
<p>仍然使用终端，在我们的项目文件夹中，我们将通过npx创建我们的应用程序，npx是NPM v 5 . 2 . 0以后默认提供的:</p>
<pre class="language-bash hljs">npx create-nuxt-app game-store
</pre>
<p>运行此命令将带我们浏览选项列表，在此过程中，您的选项可能会有所不同。选择<strong> Vuetify </strong>作为UI框架，选择<a href="https://blog.logrocket.com/jest-testing-top-features/">T3】Jest作为测试框架</a>选项。下面的指南详细介绍了我们在创建将要使用的应用程序时所选择的内容:</p>
<pre class="language-javascript hljs">? Project name: game-store
? Programming language: JavaScript
? Package manager: NPM
? UI Framework: Vuetify
? Nuxt.js modules: None
? Linting tools: None
? Testing framework: Jest
? Rendering mode: Single Page App
? Deployment target: Static
? Development tools: jsconfig.json
? Version Control System: Git
</pre>
<p>创建完应用程序后，我们可以通过终端导航到它，并在浏览器中启动它:</p>
<pre class="language-bash hljs">cd game-stores
npm run dev
</pre>
<p>应该会出现以下窗口:</p>
<p><img data-attachment-id="142180" data-permalink="https://blog.logrocket.com/nuxy-js-game-store-window/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png" data-orig-size="730,457" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nuxt-js-game-store-window" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png" decoding="async" class="aligncenter wp-image-142180 size-full jetpack-lazy-image" src="../Images/02862d6a1c5e32a06d5c5bcf14e7735a.png" alt="Nuxtjs Game Store Window" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window-300x188.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="142180" data-permalink="https://blog.logrocket.com/nuxy-js-game-store-window/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png" data-orig-size="730,457" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nuxt-js-game-store-window" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png" decoding="async" loading="lazy" class="aligncenter wp-image-142180 size-full" src="../Images/02862d6a1c5e32a06d5c5bcf14e7735a.png" alt="Nuxtjs Game Store Window" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window-300x188.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxy-js-game-store-window.png"/></noscript>
<p>我们还应该有一个类似于下面的项目文件夹结构:</p>
<p><img data-attachment-id="142185" data-permalink="https://blog.logrocket.com/nuxt-js-project-folder-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png" data-orig-size="465,574" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nuxt-js-project-folder-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure-243x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png" decoding="async" class="aligncenter wp-image-142185 size-full jetpack-lazy-image" src="../Images/649642a2112ff96d5b47be3e43f19a66.png" alt="Nuxtjs Project Folder Structure" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png 465w, https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure-243x300.png 243w" data-lazy-sizes="(max-width: 465px) 100vw, 465px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="142185" data-permalink="https://blog.logrocket.com/nuxt-js-project-folder-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png" data-orig-size="465,574" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nuxt-js-project-folder-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure-243x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png" decoding="async" loading="lazy" class="aligncenter wp-image-142185 size-full" src="../Images/649642a2112ff96d5b47be3e43f19a66.png" alt="Nuxtjs Project Folder Structure" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png 465w, https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure-243x300.png 243w" sizes="(max-width: 465px) 100vw, 465px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-project-folder-structure.png"/></noscript>
<h2 id="configuring-our-store">配置我们的商店</h2>
<p>为了有效地管理状态，Nuxt.js利用了<a href="https://vuex.vuejs.org/"> Vuex </a>的能力。因此，在<code>/store</code>目录<a href="https://blog.logrocket.com/managing-multiple-store-modules-vuex/">中创建的每个文件都可以被视为一个Vuex模块</a>，这意味着它包含其状态、突变、动作和getters。</p>
<p>我们将使用商店目录作为应用程序的起点。让我们从包括我们需要的数据开始。在现有的<code>/store</code>目录下创建一个新的<code>games/games.js</code>文件，并将以下代码粘贴到其中:</p>
<pre class="language-javascript hljs">// store/games/games.js

const games = [
  {
    title: "Star Wars Battlefront 2",
    console: "PlayStation 4",
    rating: 7,
    price: 15.3,
    photo:
      "https://res.cloudinary.com/fullstackmafia/image/upload/v1604990005/SWBF2_box_or6x8s.jpg",
  },
  {
    title: "BioShock: The Collection",
    console: "PlayStation 4",
    rating: 9,
    price: 16.0,
    photo:
      "https://res.cloudinary.com/fullstackmafia/image/upload/v1604990078/220px-BioShock-_The_Collection_tix1ol.jpg",
  },
  {
    title: "Call of Duty: Black Ops 4",
    console: "PlayStation 4",
    rating: 9,
    price: 11.7,
    photo:
      "https://res.cloudinary.com/fullstackmafia/image/upload/v1604990123/220px-Call_of_Duty_Black_Ops_4_official_box_art_vvhd7w.jpg",
  },
  {
    title: "Tom Clancy's Rainbow Six: Siege",
    console: "PlayStation 5",
    rating: 9,
    price: 13.9,
    photo:
      "https://res.cloudinary.com/fullstackmafia/image/upload/v1604990231/56c494ad88a7e300458b4d5a_qeyro6.jpg",
  },
];
</pre>
<p>接下来，我们将配置我们的<code>games</code>存储的状态、变异、动作和getters。为了执行这个操作，在我们之前创建的<code>games.js</code>文件中，将下面的代码粘贴到前面的代码片段之后:</p>
<pre class="language-javascript hljs">// store/games/games.js

const state = () =&amp;gt; {
  return games;
};

const mutations = {};
const actions = {};
const getters = {
  bestGames(state) {
    return state.filter(({ rating }) =&amp;gt; {
      return rating === 9;
    });
  },
  playstationfour(state) {
    return state.filter(({ console }) =&amp;gt; {
      return console === "PlayStation 4";
    });
  },
  consoleType(state) {
    return (consoleName) =&amp;gt; {
      return state.filter(({ console }) =&amp;gt; {
        return console === consoleName;
      });
    };
  },
  cheapGames(state) {
    return state.filter(({ price }) =&amp;gt; {
      return price === 15.3;
    });
  },
};

export default { state, mutations, actions, getters };
</pre>
<p>让我们通过使用<code>v-for</code>指令遍历每个条目<a href="https://blog.logrocket.com/make-form-elements-dynamic-vue-js/#creating-dynamic-forms-vue-js">，在主页上显示我们的<code>games</code>商店数据。用以下代码替换<code>pages/index.vue</code>中的代码:</a></p>
<pre>&lt;!-- pages/index.vue --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;v-container&gt;
      &lt;v-row&gt;
        &lt;v-col xs4 v-for="game in psfourGames" :key="game.title"&gt;
          &lt;v-card&gt;
            &lt;v-img :src="game.photo" aspect-ratio="1"&gt;&lt;/v-img&gt;
            &lt;v-card-title primary-title&gt;
              &lt;div&gt;
                &lt;h3&gt;{{ game.title }}&lt;/h3&gt;
                &lt;h4&gt;Rating: {{ game.rating }}&lt;/h4&gt;
                &lt;h4&gt;Price: ${{ game.price }}&lt;/h4&gt;
              &lt;/div&gt;
            &lt;/v-card-title&gt;
          &lt;/v-card&gt;
        &lt;/v-col&gt;
      &lt;/v-row&gt;
    &lt;/v-container&gt;
  &lt;/div&gt;
&lt;/template&gt;
</pre>
<p>然后，我们将使用Vuex的<code>MapGetter</code>助手将之前在<code>games.js</code>中定义的getter映射到我们的<code>index.vue</code>文件中的一个计算属性:</p>
<pre>&lt;!-- pages/index.vue --&gt;
&lt;script&gt;
import { mapGetters } from "vuex";
export default {
  computed: {
    ...mapGetters({
      consoleType: "games/games/consoleType",
    }),
    psfourGames() {
      return this.consoleType("PlayStation 4");
    },
  },
};
&lt;/script&gt;
</pre>
<p>让我们看看这是如何出现在浏览器中的。导航到您的终端并运行<code>npm run dev</code>。您的浏览器视图应该类似于下图:</p>
<p><img data-attachment-id="142187" data-permalink="https://blog.logrocket.com/nuxt-js-browser-view-games/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png" data-orig-size="730,435" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nuxt-js-browser-view-games" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games-300x179.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png" decoding="async" class="aligncenter wp-image-142187 size-full jetpack-lazy-image" src="../Images/4d0eec41d929178a7b9d5b17355d30c5.png" alt="Nuxtjs Browser View Games" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games-300x179.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="142187" data-permalink="https://blog.logrocket.com/nuxt-js-browser-view-games/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png" data-orig-size="730,435" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nuxt-js-browser-view-games" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games-300x179.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png" decoding="async" loading="lazy" class="aligncenter wp-image-142187 size-full" src="../Images/4d0eec41d929178a7b9d5b17355d30c5.png" alt="Nuxtjs Browser View Games" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games-300x179.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/nuxt-js-browser-view-games.png"/></noscript>
<h2 id="configuring-testing-framework">配置我们的测试框架</h2>
<p>对于我们的应用程序的测试框架，我们使用Jest，它是我们之前在设置时选择的。正如我们之前提到的，Nuxt.js将我们商店的所有内容构建到Vuex模块中。我们的目标是拥有负责不同功能的各种存储，并以在我们的组件中使用的相同方式测试这些存储，这意味着我们选择我们想要测试的特定存储。</p>
<p>为了实现这一点，我们将配置Jest使用它的<code><a href="https://jestjs.io/docs/configuration">globalSetup</a></code>模块，该模块导出一个异步函数，在所有测试运行之前触发一次。因此，我们可以选择想要测试的特定商店。要执行此操作，请用以下代码替换<code>jest.config.js</code>文件中的代码:</p>
<pre class="language-javascript hljs">// jest.config.js

module.exports = {
  globalSetup: "&amp;lt;rootDir&amp;gt;/jest.setup.js",
  moduleNameMapper: {
    "^@/(.*)$": "&amp;lt;rootDir&amp;gt;/$1",
    "^~/(.*)$": "&amp;lt;rootDir&amp;gt;/$1",
    "^vue$": "vue/dist/vue.common.js",
  },
  moduleFileExtensions: ["js", "vue", "json"],
  transform: {
    "^.+\\.js$": "babel-jest",
    ".*\\.(vue)$": "vue-jest",
  },
  collectCoverage: true,
  collectCoverageFrom: [
    "&amp;lt;rootDir&amp;gt;/components/**/*.vue",
    "&amp;lt;rootDir&amp;gt;/pages/**/*.vue",
  ],
};
</pre>
<p>在上面的Jest配置文件中，我们已经将<code>globalSetup</code>模块配置为在运行任何测试之前首先运行Jest设置文件。</p>
<p>接下来，我们将创建<code>jest.setup.js</code>文件，在这里我们将通过一个流程变量公开我们的存储目录:</p>
<pre class="language-javascript hljs">import { Nuxt, Builder } from "nuxt";
import nuxtConfig from "./nuxt.config";

const resetConfig = {
  loading: false,
  loadingIndicator: false,
  fetch: {
    client: false,
    server: false,
  },
  features: {
    store: true,
    layouts: false,
    meta: false,
    middleware: false,
    transitions: false,
    deprecations: false,
    validate: false,
    asyncData: false,
    fetch: false,
    clientOnline: false,
    clientPrefetch: false,
    clientUseUrl: false,
    componentAliases: false,
    componentClientOnly: false,
  },
  build: {
    indicator: false,
    terser: false,
  },
};
const config = Object.assign({}, nuxtConfig, resetConfig, {
  srcDir: nuxtConfig.srcDir,
  ignore: ["**/components/**/*", "**/layouts/**/*", "**/pages/**/*"],
});
const buildNuxt = async () =&amp;gt; {
  const nuxt = new Nuxt(config);
  await new Builder(nuxt).build();
  return nuxt;
};
module.exports = async () =&amp;gt; {
  const nuxt = await buildNuxt();
  process.env.buildDir = nuxt.options.buildDir;
};
</pre>
<p>在上面的设置文件中，<code>resetConfig</code>确保在运行构建过程时只构建商店。然后，我们使用<code>process.env.buildDir</code>来展示我们商店的路径。</p>
<p>完成后，让我们为我们的商店编写测试。在现有的<code>/test</code>目录中创建一个新的<code>games.test.js</code>文件，并向其中添加以下代码:</p>
<pre class="language-javascript hljs">// test/games.test.js

import _ from "lodash";
import Vuex from "vuex";
import { createLocalVue } from "@vue/test-utils";

describe("store/games/games", () =&amp;gt; {
  const localVue = createLocalVue();
  localVue.use(Vuex);
  let NuxtStore;
  let store;
  beforeAll(async () =&amp;gt; {
    const storePath = `${process.env.buildDir}/store.js`;
    NuxtStore = await import(storePath);
  });
  beforeEach(async () =&amp;gt; {
    store = await NuxtStore.createStore();
  });
// ...
});
</pre>
<p>在上面的测试中，我们使用Jest的<code>beforeAll</code>块来导入构建的商店。<code>beforeEach</code>块确保每次运行单独的测试时都会创建一个新的存储。</p>
<p>接下来，我们将写出我们的应用程序需要的特定测试。假设我们需要以下一组特定的标准:</p>
<ul>
<li>视频游戏<em>使命召唤:黑色行动4 </em>只出现在PlayStation 4游戏中</li>
<li>视频游戏《星球大战前线2》的价格正好是15.30美元</li>
<li>商店只展示分级为<code>9</code>的电子游戏</li>
</ul>
<p>我们的测试代码如下所示:</p>
<pre class="language-javascript hljs">describe("consoleType", () =&amp;gt; {
  let playstationfour;
  beforeEach(() =&amp;gt; {
    playstationfour = store.getters["games/games/playstationfour"];
  });
  test("Call of Duty: Black Ops 4 should be on only playStation 4", () =&amp;gt; {
    expect(playstationfour).toEqual(
      expect.arrayContaining([
        expect.objectContaining({
          console: "PlayStation 4",
          title: "Call of Duty: Black Ops 4",
        }),
      ])
    );
  });
});

describe("cheapGames", () =&amp;gt; {
  let cheapGames;
  beforeEach(() =&amp;gt; {
    cheapGames = store.getters["games/games/cheapGames"];
  });
  test(`StarWars BattleFront must cost exactly ${15.3}`, () =&amp;gt; {
    expect(cheapGames).toEqual(
      expect.arrayContaining([
        expect.objectContaining({
          price: 15.3,
        }),
      ])
    );
  });
});

describe("bestGames", () =&amp;gt; {
  let bestGames;
  beforeEach(() =&amp;gt; {
    bestGames = store.getters["games/games/bestGames"];
  });
  test("Display only the best titles we have", () =&amp;gt; {
    expect(bestGames).toEqual(
      expect.arrayContaining([
        expect.objectContaining({
          rating: 9,
        }),
      ])
    );
  });
});
</pre>
<p>但是，您必须确保测试代码是紧接在<code>beforeEach</code>块之后编写的，这样我们才能继续访问我们的store实例。有了这些新的变化，我们的<code>games.test.js</code>文件的完整代码将如下所示:</p>
<pre class="language-javascript hljs">// test/games.test.js

import _ from "lodash";
import Vuex from "vuex";
import { createLocalVue } from "@vue/test-utils";

describe("store/games/games", () =&amp;gt; {
  const localVue = createLocalVue();
  localVue.use(Vuex);
  let NuxtStore;
  let store;
  beforeAll(async () =&amp;gt; {
    const storePath = `${process.env.buildDir}/store.js`;
    NuxtStore = await import(storePath);
  });
  beforeEach(async () =&amp;gt; {
    store = await NuxtStore.createStore();
  });

  describe("consoleType", () =&amp;gt; {
    let playstationfour;
    beforeEach(() =&amp;gt; {
      playstationfour = store.getters["games/games/playstationfour"];
    });
    test("Call of Duty: Black Ops 4 should be on only playStation 4", () =&amp;gt; {
      expect(playstationfour).toEqual(
        expect.arrayContaining([
          expect.objectContaining({
            console: "PlayStation 4",
            title: "Call of Duty: Black Ops 4",
          }),
        ])
      );
    });
  });

  describe("cheapGames", () =&amp;gt; {
    let cheapGames;
    beforeEach(() =&amp;gt; {
      cheapGames = store.getters["games/games/cheapGames"];
    });
    test(`StarWars BattleFront must cost exactly ${15.3}`, () =&amp;gt; {
      expect(cheapGames).toEqual(
        expect.arrayContaining([
          expect.objectContaining({
            price: 15.3,
          }),
        ])
      );
    });
  });

  describe("bestGames", () =&amp;gt; {
    let bestGames;
    beforeEach(() =&amp;gt; {
      bestGames = store.getters["games/games/bestGames"];
    });
    test("Display only the best titles we have", () =&amp;gt; {
      expect(bestGames).toEqual(
        expect.arrayContaining([
          expect.objectContaining({
            rating: 9,
          }),
        ])
      );
    });
  });
});
</pre>
<p>让我们试一试。导航到您的终端并运行<code>npm test</code>；这将运行所有指定的测试并交付预期的结果，读数为<code>All default components and routes have been deleted before running this test</code>:</p>
<figure id="attachment_142189" aria-describedby="caption-attachment-142189" class="wp-caption aligncenter"><img data-attachment-id="142189" data-permalink="https://blog.logrocket.com/game-tests-nuxt-js-pass/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png" data-orig-size="730,273" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="game-tests-nuxt-js-pass" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass-300x112.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png" decoding="async" class="wp-image-142189 size-full jetpack-lazy-image" src="../Images/a8ae2ac349a21cc9fef71f99cb17a1e5.png" alt="Game Tests Nuxtjs Pass" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass-300x112.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="142189" data-permalink="https://blog.logrocket.com/game-tests-nuxt-js-pass/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png" data-orig-size="730,273" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="game-tests-nuxt-js-pass" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass-300x112.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png" decoding="async" loading="lazy" class="wp-image-142189 size-full" src="../Images/a8ae2ac349a21cc9fef71f99cb17a1e5.png" alt="Game Tests Nuxtjs Pass" srcset="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass-300x112.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/11/game-tests-nuxt-js-pass.png"/></noscript><figcaption id="caption-attachment-142189" class="wp-caption-text">game.test.js pass</figcaption></figure>
<h2 id="conclusion">结论</h2>
<p>为通用应用程序编写测试似乎很麻烦。一个通用的经验法则是总是保持测试简单和简洁。在本文中，我们探索了用Jest测试我们的Nuxt.js组件。我们还探讨了Vuetify和Vuex。我希望你喜欢这篇文章，如果你有问题，一定要留下评论。编码快乐！</p><div class="code-block code-block-1">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket会告诉您应用程序中实际影响用户的最具影响力的bug和UX问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket自动聚合客户端错误、JS异常、前端性能指标和用户交互。然后LogRocket使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试LogRocket】。</a></p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>