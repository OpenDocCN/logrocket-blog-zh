<html>
<head>
<title>Everything you need to know about react-scripts - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>关于react-scripts - LogRocket博客你需要知道的一切</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/everything-you-need-know-about-react-scripts/#0001-01-01">https://blog.logrocket.com/everything-you-need-know-about-react-scripts/#0001-01-01</a></blockquote><div><article class="article-post">
<p><em> <strong>编者按</strong>:本文最后一次更新是在2022年3月30日，以反映关于react-scripts的更多更新和高级信息，包括环境变量。</em></p>
<h2>什么是反应脚本？</h2>
<p>在过去，创建一个React应用程序是一个痛苦的过程。在你动手开发有意义的东西之前，你必须努力完成大量的配置，尤其是webpack和Babel。</p>
<p>幸运的是，今天我们有<a href="https://blog.logrocket.com/getting-started-with-create-react-app-d93147444a27/" target="_blank" rel="noopener"> Create React App </a>，这是一个方便的模块，具有出色的配置，以及一个名为react-scripts的脚本命令，使构建React应用程序变得更加容易。</p>
<p>在本指南中，我们将概述react脚本，比较几种不同类型的脚本，并描述Create React App如何显著简化React开发流程。让我们开始吧！</p>
<h3 id="h3contents">内容</h3>

<h2 id="what-script">什么是剧本？</h2>
<p>在编程中，脚本是一个指令列表，它指示对另一个程序做什么；React也不例外。Create React应用程序附带了四个主要脚本，我们稍后将对每个脚本进行探讨。</p>
<p>但是现在，我们将关注在哪里可以找到这些脚本。</p>
<p>首先，使用以下命令创建一个新的React应用程序来查找预定义的脚本:</p>
<pre class="language-shell hljs">npx create-react-app my-app
</pre>
<p>上面的命令用<a href="https://github.com/facebook/create-react-app/tree/main/packages/cra-template" target="_blank" rel="noopener"> cra模板</a>和所有需要的配置创建了一个新的React应用程序。React应用程序所需的每个配置都来自react-scripts包。现在，检查新创建项目的<code>package.json</code>文件。</p>
<p>在React应用中，脚本位于<code>package.json</code>文件的<code>script</code>部分，如下所示:</p>
<pre class="language-json hljs"> "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test",
    "eject": "react-scripts eject"
  }
</pre>
<p>在前面的JSON代码片段中，<code>package.json</code>文件有一些默认脚本，但是仍然可以编辑它们。您可以使用首选的节点程序包管理器CLI执行这些脚本。</p>
<p>正如你所看到的，一个新的React应用程序附带了四个脚本，它们使用了react-scripts包。现在我们知道了脚本是什么以及在哪里可以找到它们，让我们深入每一个脚本并解释它对React应用程序有什么作用。</p>
<h2 id="start"><code>start</code></h2>
<p>React在开发时使用Node.js来打开<code><a href="http://localhost:3000" rel="nofollow">http://localhost:3000</a></code>上的应用程序，因此<code>start</code>脚本使您能够启动webpack开发服务器。</p>
<p>您可以使用<code>npm</code>或<code>yarn</code>在终端上运行<code>start</code>脚本命令:</p>
<pre class="language-shell hljs">yarn start
npm start
</pre>
<p>该命令不仅会启动开发服务器，而且每当webpack的<a href="https://webpack.js.org/guides/hot-module-replacement/" target="_blank" rel="noopener">热模块替换(HMR) </a>功能<a href="https://webpack.js.org/guides/hot-module-replacement/">发生变化时，它还会做出反应并显示最新版本。</a>另外，如果无法启动服务器，会以有意义的错误信息的形式在终端上显示lint错误。</p>
<h2 id="test"><code>test</code></h2>
<p>Create React应用程序使用<a href="https://blog.logrocket.com/testing-react-apps-jest-react-testing-library/" target="_blank" rel="noopener"> Jest </a>作为测试运行程序。<code>test</code>脚本使您能够在交互式观察模式下启动test runner，让您用键盘控制Jest。</p>
<p>可以使用以下命令在终端上运行<code>test</code>脚本:</p>
<pre class="language-shell hljs">yarn test
npm test
</pre>
<p>默认的React模板为示例应用程序接口提供了一个预定义的测试用例。打开<code>src/App.test.js</code>文件，找到下面的示例测试用例:</p>
<pre class="language-shell hljs">test('renders learn react link', () =&gt; {
  render(&lt;App /&gt;);
  const linkElement = screen.getByText(/learn react/i);
  expect(linkElement).toBeInTheDocument();
});
</pre>
<p>上述测试案例检查应用程序是否呈现“learn react”(不区分大小写)。输入<code>npm test</code>(或<code>yarn test</code>)命令，按<strong> a </strong>键运行所有测试用例，如下图所示:</p>
<p><img data-attachment-id="101327" data-permalink="https://blog.logrocket.com/everything-you-need-know-about-react-scripts/running-react-app-tests-with-the-test-script/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script.gif" data-orig-size="689,300" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Running React app tests with the test script" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script-300x131.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script.gif" decoding="async" class="size-full wp-image-101327 aligncenter jetpack-lazy-image" src="../Images/51e900e7e042abedcdb68e3b11933ae5.png" alt="Running React app tests with the test script" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="101327" data-permalink="https://blog.logrocket.com/everything-you-need-know-about-react-scripts/running-react-app-tests-with-the-test-script/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script.gif" data-orig-size="689,300" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Running React app tests with the test script" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script-300x131.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script.gif" decoding="async" loading="lazy" class="size-full wp-image-101327 aligncenter" src="../Images/51e900e7e042abedcdb68e3b11933ae5.png" alt="Running React app tests with the test script" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/Running-React-app-tests-with-the-test-script.gif"/></noscript>
<p>我不会深入到<a href="https://blog.logrocket.com/testing-react-apps-jest-react-testing-library/" target="_blank" rel="noopener">测试React应用</a>，但是请记住，任何带有<code>.test.js</code>或<code>.spec.js</code>扩展名的文件都将在脚本启动时执行。</p>
<h2 id="build"><code>build</code></h2>
<p>React是模块化的，这就是为什么如果你愿意，你可以创建几个文件或组件。准确地说，这些独立的文件需要合并或捆绑成一个文件。这是<code>build</code>脚本的主要好处之一。</p>
<p>另一个是性能；如您所知，开发模式并不适合生产环境。React使用<code>build</code>脚本来确保完成的项目按照部署的最佳实践进行捆绑、缩小和优化。</p>
<p>可以使用以下命令运行该脚本。</p>
<pre class="language-shell hljs">yarn build
npm run build
</pre>
<p>运行<code>build</code>脚本后，您可以在<code>build</code>目录中找到所有可部署的优化静态资源。</p>
<p>有一些额外的选项可以传递给<code>build</code>脚本。例如，您可以使用<code>--stats</code>选项来生成一个bundle stats文件，您可以使用<a href="https://github.com/webpack-contrib/webpack-bundle-analyzer" target="_blank" rel="noopener"> webpack-bundle-analyzer </a>工具来可视化该文件。</p>
<p>查看<a href="https://create-react-app.dev/docs/production-build/" target="_blank" rel="noopener">文档</a>，深入了解如何增强您的<code>build</code>脚本。</p>
<h2 id="eject"><code>eject</code></h2>
<p>Create React App文档将此脚本描述为“单向操作”，并警告“一旦弹出，就无法返回！”Create React App附带了一个出色的配置，可以帮助您根据最佳实践来构建React应用程序，并对其进行优化。</p>
<p>但是，在一些高级场景中，我们可能需要使用额外的配置来定制预构建的react脚本。<code>eject</code>脚本让您可以完全控制React应用程序的配置。例如，您可以通过弹出React应用程序，根据特定需求自定义webpack或Babel配置。</p>
<p>运行<code>eject</code>脚本将从您的项目中移除单个构建依赖项。这意味着它将复制配置文件和可传递的依赖项(例如，webpack、Babel等)。)作为<code>package.json</code>文件中的依赖项。如果这样做，您必须确保在构建项目之前安装了依赖项。</p>
<p>运行完<code>eject</code>命令后，就不可能再运行它了，因为除了<code>eject</code>之外，所有的脚本都是可用的。仅在需要时使用此命令。否则，坚持使用默认配置。反正这样更好。</p>
<p>要在终端上运行命令，请键入以下命令。</p>
<pre class="language-shell hljs">yarn eject
npm run eject
</pre>
<p>弹出可以帮助您定制react配置中的任何内容，但是弹出可能会创建不同版本的React脚本。然后，您必须为每个react项目维护定制的React脚本。因此，创建一个react-scripts分支是一个更好的想法，可以进行可重用的定制react应用程序配置。</p>
<p>您可以通过以下命令使用分叉的react-scripts模块:</p>
<pre class="language-shell hljs">npx create-react-app my-app --scripts-version react-scripts-fork
</pre>
<p>上面的命令通过使用react-scripts-fork包作为react-scripts源来构建一个新的React应用程序。</p>
<h2 id="using-environment-variables-react-scripts">为react脚本使用环境变量</h2>
<p>预配置的React脚本通常不接受许多CLI选项来定制它们的默认行为。但是，react-scripts允许开发人员通过环境变量进行各种高级配置，您可以通过终端设置这些环境变量。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>例如，您可以使用<code>PORT</code>环境变量更改开发服务器端口，如下所示:</p>
<pre class="language-shell hljs">PORT=5000 yarn start
PORT=5000 npm start
</pre>
<p>此外，您可以通过如下设置<code>BUILD_PATH</code>来更改默认的应用程序构建目录:</p>
<pre class="language-shell hljs">BUILD_PATH=./dist yarn build
BUILD_PATH=./dist npm run build
</pre>
<p>如果您愿意，也可以用环境变量更新现有的脚本定义。例如，如果您在<code>package.json</code>中使用下面的JSON片段，那么您总是可以在<code>start</code>脚本中使用端口<code>5000</code>:</p>
<pre class="language-json hljs">"scripts": {
  "start": "PORT=5000 react-scripts start", // port 5000 
  "build": "react-scripts build",
  "test": "react-scripts test",
  "eject": "react-scripts eject"
}
</pre>
<p>所有支持的环境变量都可以在<a href="https://create-react-app.dev/docs/advanced-configuration" target="_blank" rel="noopener">官方文档</a>中找到。</p>
<h2 id="conclusion">结论</h2>
<p>我希望这篇指南能对Create React应用程序的惊人配置有所启发。它不仅附带了有用的脚本，可以帮助任何开发人员的生活变得更加轻松，而且一些命令附带了灵活的选项，使您能够根据项目的独特需求来调整脚本。</p>
<p>尽管Create React App提供了四个预配置的脚本，但是您可以像任何其他JavaScript项目一样，通过更新您的<code>package.json</code>文件来添加更多脚本。react团队基于社区反馈开发了带有通用配置的react脚本，因此许多React开发团队使用React脚本时无需额外的定制。因此，如果你觉得你的需求可以解决每个人的问题，考虑在<a href="https://www.github.com/facebook/create-react-app" target="_blank" rel="noopener">官方知识库</a>中为特性请求打开一个问题或讨论线程。</p>
<p>否则，您可以通过为高级和独特的用例弹出或分叉来定制react脚本。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>