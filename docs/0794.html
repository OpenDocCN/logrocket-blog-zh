<html>
<head>
<title>Handling authentication in your GraphQL-powered Vue app - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在你的GraphQL支持的Vue应用中处理认证</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/#0001-01-01">https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/#0001-01-01</a></blockquote><div><article class="article-post">
<p>身份验证的主要目标是识别请求资源的人。在开发应用程序时，这是一个非常棘手的问题，因为在我们的应用程序中没有处理身份验证的“一刀切”的规则。</p>
<p>在基于web的应用程序中，在客户端处理身份验证甚至更加棘手，因为存在诸如跨站点脚本(XSS)之类的安全问题，在跨站点脚本中，攻击者访问存储在浏览器中的信息，并使用它来伪装成用户。大多数spa实现基于令牌的身份验证，因为令牌是无状态的，并且它们很容易扩展，因为它消除了服务器跟踪会话状态的压力。</p>
<p>现代应用程序中的用户认证流程通常是这样的:</p>
<ul>
<li>客户端向身份验证路由发送一个请求，其中包含电子邮件地址和密码等用户信息</li>
<li>服务器检查用户的身份，创建一个JSON web令牌(JWT ),并将其发送回浏览器</li>
<li>客户端将令牌存储到浏览器存储介质(API)之一中</li>
<li>客户端将令牌附加到授权头，以便向服务器发出后续请求</li>
</ul>
<p><img data-attachment-id="16897" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/modern-apps-authentication-flow/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow.png" data-orig-size="2161,1536" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Modern apps authentication flow" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-300x213.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-1024x728.png" decoding="async" class="aligncenter size-full wp-image-16897 jetpack-lazy-image" src="../Images/08ee546a852184e6a8cc196bfe80f024.png" alt="Modern apps authentication flow" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow.png 2161w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-300x213.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-1024x728.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-768x546.png 768w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-1536x1092.png 1536w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-2048x1456.png 2048w" data-lazy-sizes="(max-width: 2161px) 100vw, 2161px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="16897" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/modern-apps-authentication-flow/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow.png" data-orig-size="2161,1536" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Modern apps authentication flow" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-300x213.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-1024x728.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-16897" src="../Images/08ee546a852184e6a8cc196bfe80f024.png" alt="Modern apps authentication flow" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow.png 2161w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-300x213.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-1024x728.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-768x546.png 768w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-1536x1092.png 1536w, https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow-2048x1456.png 2048w" sizes="(max-width: 2161px) 100vw, 2161px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/Modern-apps-authentication-flow.png"/></noscript>
<p>有三个存储选项可用于在客户端上保存令牌，它们包括:</p>
<ul>
<li>局部存储器</li>
<li>会话存储</li>
<li>饼干</li>
</ul>
<p>在本教程中，我们将了解如何在连接到GraphQL API的Vue应用程序中处理认证，我们将通过构建一个迷你应用程序来实现这一点。我们将利用本地存储来存储我们的令牌。</p>
<p>我们将要连接的API可以在<a href="https://bloggr-api.herokuapp.com/" target="_blank" rel="noopener noreferrer">这里</a>找到。</p>
<h2>先决条件</h2>
<p>本教程假设读者具备以下条件:</p>

<p>您可以使用Yarn通过以下命令安装Vue CLI:</p>
<pre>yarn global add @vue/cli</pre>
<p>我们将用于构建应用的工具包括:</p>
<p>Vue-Apollo  —这是Vue.js的Apollo客户端集成，它有助于将GraphQL集成到我们的Vue.js应用中！</p>
<p>Vuex是Vue.js应用程序的状态管理模式库，它是应用程序中所有组件的集中存储。它深受由<a href="https://facebook.github.io/flux/" target="_blank" rel="noopener noreferrer">脸书</a>创造的<a href="https://facebook.github.io/flux/docs/in-depth-overview/" target="_blank" rel="noopener noreferrer">通量建筑模式</a>的影响。</p>
<p><a href="https://router.vuejs.org/" target="_blank" rel="noopener noreferrer"> Vue Router </a> —这是<a href="http://vuejs.org/" target="_blank" rel="noopener noreferrer"> Vue.js </a>的官方路由库，它使我们的Vue.js应用程序中的路由更容易。</p>
<h2>入门指南</h2>
<p>我们将使用Vue CLI工具来引导一个新的Vue项目，该工具帮助我们不必担心开始使用我们的应用程序的配置，因为我们可以手动选择我们的应用程序所需的包。</p>
<p>首先，我们使用<code>create</code>命令创建一个新项目:</p>
<pre>vue create blogr</pre>
<p>将向下箭头键移动到“手动选择功能”，按enter并选择以下功能:</p>
<p><img data-attachment-id="16905" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/clioptions/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png" data-orig-size="597,239" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="clioptions" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions-300x120.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png" decoding="async" class="aligncenter size-full wp-image-16905 jetpack-lazy-image" src="../Images/de850994c75930277938e8239d3acd41.png" alt="cli options " data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png 597w, https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions-300x120.png 300w" data-lazy-sizes="(max-width: 597px) 100vw, 597px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="16905" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/clioptions/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png" data-orig-size="597,239" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="clioptions" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions-300x120.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-16905" src="../Images/de850994c75930277938e8239d3acd41.png" alt="cli options " srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png 597w, https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions-300x120.png 300w" sizes="(max-width: 597px) 100vw, 597px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/clioptions.png"/></noscript>
<p>接下来，使用以下命令将目录切换到项目文件夹:</p>
<pre>cd blogr</pre>
<p>使用命令启动您的项目:</p>
<pre>yarn serve</pre>
<p>在运行yarn serve命令后，您应该看到您的应用程序在<a href="http://localhost:8080" target="_blank" rel="noopener noreferrer"> http://localhost:8080 </a>上运行。</p>
<p><img data-attachment-id="16941" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/vuerunningapp/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp.png" data-orig-size="1320,710" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vuerunningapp" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-300x161.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-1024x551.png" decoding="async" class="aligncenter size-full wp-image-16941 jetpack-lazy-image" src="../Images/2bfe5c05a554dfa8631d408db47eeb10.png" alt="vue running app" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp.png 1320w, https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-300x161.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-1024x551.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-768x413.png 768w" data-lazy-sizes="(max-width: 1320px) 100vw, 1320px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="16941" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/vuerunningapp/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp.png" data-orig-size="1320,710" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vuerunningapp" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-300x161.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-1024x551.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-16941" src="../Images/2bfe5c05a554dfa8631d408db47eeb10.png" alt="vue running app" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp.png 1320w, https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-300x161.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-1024x551.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp-768x413.png 768w" sizes="(max-width: 1320px) 100vw, 1320px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/vuerunningapp.png"/></noscript>
<h2>创建用户界面</h2>
<p>打开位于<code>src</code>文件夹中的<code>App.vue</code>文件，删除以下代码行:</p>
<pre>&lt;div id="nav"&gt;
  &lt;router-link to="/"&gt;Home&lt;/router-link&gt; |
  &lt;router-link to="/about"&gt;About&lt;/router-link&gt;
&lt;/div&gt;</pre>
<p>用以下内容替换删除的内容:</p>
<pre>&lt;header class="header"&gt;
  &lt;div class="app-name"&gt;Blogr&lt;/div&gt;
    &lt;div v-if="authStatus" id="nav"&gt;
      &lt;div&gt;{{user.name}}&lt;/div&gt;
      &lt;button class="auth-button" @click="logOut" &gt; Log Out&lt;/button&gt;
    &lt;/div&gt;
&lt;/header&gt;</pre>
<p>我们正在获取经过身份验证的用户的名字，并创建了一个触发<code>logOut</code>方法的注销按钮。</p>
<p>接下来，导航到<code>src/views</code>并创建一个<code>Register.vue</code>文件，并在文件中包含以下代码行:</p>
<pre>&lt;template&gt;
  &lt;div class="auth"&gt;
    &lt;h3&gt;Sign Up&lt;/h3&gt;
    &lt;form action="POST" @submit.prevent="registerUser"&gt;
      &lt;label for="name"&gt; Name&lt;/label&gt;
      &lt;input type="text" name="name"  placeholder="John Doe" v-model="authDetails.name" /&gt;
      &lt;label for="email"&gt;Email Address&lt;/label&gt;
      &lt;input type="email" name="email"  placeholder="<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d8a1b7adaabcb7a8bdbdb5b9b1b498abb7b5bdacb0b1b6bff6bbb7b5">[email protected]</a>" v-model="authDetails.email" /&gt;
      &lt;label for="password"&gt;Password&lt;/label&gt;
      &lt;input type="password" name="password" placeholder="password" v-model="authDetails.password" /&gt;
      &lt;button class="auth-submit"&gt;submit&lt;/button&gt;
     &lt;p class="auth-text"&gt; Already have an account? &lt;router-link to="/login"&gt; Login &lt;/router-link&gt; &lt;/p&gt;
    &lt;/form&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import { mapActions } from 'vuex'
export default {
  name: 'Register',
  data () {
    return {
      authDetails: {
        name: '',
        email: '',
        password: ''
      }
    }
  },
  methods: {
    registerUser: function () {

    }
  }
}
&lt;/script&gt;</pre>
<p>在这个代码块中，我们创建了一个没有任何功能的注册页面，单击submit按钮触发了<code>registerUser</code>方法，它现在什么都不做。</p>
<p>我们使用v-model在我们的输入框中创建一个到<code>authDetails</code>的双向数据绑定，如果表单的值改变了，那么<code>authDetails</code>中的值也会随之改变。</p>
<p>让我们给我们的应用程序添加一些样式，在<code>/src/assets</code>中创建一个<code>styles</code>文件夹。在<code>src</code>文件夹中创建一个<code>index.css</code>文件，包括以下内容:</p>
<pre>.header {
    display: flex;
    justify-content: space-between;
    background-color: fuchsia;
    height: 25%;
    padding: 1rem;
}
.app-name {
    font-weight: 900;
    font-size: 3rem;
}
.auth {
    display: flex;
    flex-direction: column;
    align-items: center;
}
.auth h3 {
    margin-top: 2rem;
}
form {
    max-width: 50%;
    margin-top: 1rem;
    padding: 4rem;
    border: 1px solid #c4c4ce;
}
form input {
    display: block;
    margin-bottom: 1.2rem;
    padding: 0.4rem 1.2rem;
    background-color: white;
}
.auth-submit {
    margin-top: .5rem;
    padding: .5rem 1rem;
    border: none;
    background-color: fuchsia;
    color: white;
    font-weight: bold;
    text-transform: capitalize;
    border-radius: 0.3rem;
}
.auth-text a {
    color: black;
    text-decoration: none;
}
.auth-text a:visited {
    color: inherit;
}
.auth-text a:hover {
    text-decoration: underline;
}
.auth-text {
    margin-top: .5rem;
}
.auth-button{
    margin: .7rem 2rem 0 0;
    padding: .5rem 2rem;
    background-color: white;
    border: none;
    border-radius: .3rem;
}
main{
    margin-top: 5rem;
    display: flex;
    justify-content: center;
}</pre>
<p>接下来，让我们构建登录页面，在<code>src/views</code>中创建一个<code>Login.vue</code>文件，并在其中包含以下内容:</p>
<pre>&lt;template&gt;
  &lt;div class="auth"&gt;
    &lt;h3&gt;Log In&lt;/h3&gt;
    &lt;form action="POST" @submit.prevent="loginUser"&gt;
      &lt;label for="email"&gt;Email Address&lt;/label&gt;
      &lt;input type="email" name="email"  placeholder="<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="156c7a6067717a65707078747c7955667a7870617d7c7b723b767a78">[email protected]</a>" v-model="authDetails.email" /&gt;
      &lt;label for="password"&gt;Password&lt;/label&gt;
      &lt;input type="password" name="password" placeholder="password" v-model="authDetails.password" /&gt;
      &lt;button class="auth-submit"&gt;submit&lt;/button&gt;
     &lt;p class="auth-text"&gt; Don't have an account? &lt;router-link to="/"&gt; Register &lt;/router-link&gt; &lt;/p&gt;
    &lt;/form&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import { mapActions } from 'vuex'
export default {
  name: 'Login',
  data () {
    return {
      authDetails: {
        email: '',
        password: ''
      }
    }
  },
  methods: {
    loginUser: function () {

    }
  }
}
&lt;/script&gt;</pre>
<p>这个页面类似于我们的<code>Register.vue</code>页面，点击提交按钮触发<code>loginUser</code>方法，它现在不做任何事情。</p>
<p>接下来，用以下内容替换<code>Home.vue</code>的内容:</p>
<pre>&lt;template&gt;
  &lt;div class="home"&gt;
    &lt;main&gt;
     Yaay! User authenticated!
    &lt;/main&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
// @ is an alias to /src

export default {
  name: 'Home',
  components: {
  },
  computed: {

  }
}
&lt;/script&gt;</pre>
<p>该页面将作为我们的仪表板页面，在用户通过身份验证后向他们显示:</p>
<p><img data-attachment-id="16913" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/homevue/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue.png" data-orig-size="1320,641" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="homevue" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-300x146.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-1024x497.png" decoding="async" class="aligncenter size-full wp-image-16913 jetpack-lazy-image" src="../Images/8406c1c65b8d566214963fc07f80632f.png" alt="home vue" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue.png 1320w, https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-300x146.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-1024x497.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-768x373.png 768w" data-lazy-sizes="(max-width: 1320px) 100vw, 1320px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="16913" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/homevue/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue.png" data-orig-size="1320,641" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="homevue" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-300x146.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-1024x497.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-16913" src="../Images/8406c1c65b8d566214963fc07f80632f.png" alt="home vue" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue.png 1320w, https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-300x146.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-1024x497.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/homevue-768x373.png 768w" sizes="(max-width: 1320px) 100vw, 1320px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/homevue.png"/></noscript>
<h2>配置路线</h2>
<p>接下来，让我们在位于<code>src/router/</code>的路由器文件中包含登录、注册和仪表板页面的路由。</p>
<p>删除<code>routes</code>数组中的内容，并将以下内容添加到<code>index.js</code>文件中:</p>
<pre>{
   path: '/dashboard',
   name: 'Home',
   component: () =&gt; import('@/views/Home.vue'),
 },
 {
   path: '/login',
   name: 'Login',
   // route level code-splitting
   // this generates a separate chunk (login.[hash].js) for this route
   // which is lazy-loaded when the route is visited.
   component: () =&gt; import(/* webpackChunkName: "login" */ '@/views/Login.vue')
 },
 {
   path: '/',
   name: 'Register',
   // route level code-splitting
   // this generates a separate chunk (register.[hash].js) for this route
   // which is lazy-loaded when the route is visited.
   component: () =&gt; import(/* webpackChunkName: "register" */ '@/views/Register.vue')
 },
 {
   path: '*',
   redirect: 'login'
 }</pre>
<p>这些路线利用了Webpack的代码分割和延迟加载，这本质上提高了我们的应用程序性能。</p>
<p>我们还添加了一个<code>*</code>——这就是所谓的通配符路由器。如果请求的URL与任何定义的路由都不匹配，路由器将选择此路由，用户将被重定向到登录页面。</p>
<p>当您访问<code>localhost:8080</code>时，我们的应用程序现在看起来应该与此类似:</p>
<p><img data-attachment-id="16917" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/registervue/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue.png" data-orig-size="1320,641" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="registervue" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-300x146.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-1024x497.png" decoding="async" class="aligncenter size-full wp-image-16917 jetpack-lazy-image" src="../Images/6851c56e0d8b56ab4a3e63b44181c9e1.png" alt="registervue" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue.png 1320w, https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-300x146.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-1024x497.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-768x373.png 768w" data-lazy-sizes="(max-width: 1320px) 100vw, 1320px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="16917" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/registervue/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue.png" data-orig-size="1320,641" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="registervue" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-300x146.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-1024x497.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-16917" src="../Images/6851c56e0d8b56ab4a3e63b44181c9e1.png" alt="registervue" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue.png 1320w, https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-300x146.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-1024x497.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/04/registervue-768x373.png 768w" sizes="(max-width: 1320px) 100vw, 1320px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/registervue.png"/></noscript>
<h2>使用Vue-Apollo安装Apollo客户端</h2>
<p>Apollo Client是一个完整的GraphQL客户端，用于您的UI框架，它帮助您连接到GraphQL服务器，检索数据，并修改数据。</p>
<p>要将Apollo集成到我们的Vue应用程序中，我们必须为vue-cli安装vue-apollo插件:</p>
<pre>vue add apollo</pre>
<p><img data-attachment-id="16919" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/vueinstallplugin/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png" data-orig-size="540,136" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vueinstallplugin" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin-300x76.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png" decoding="async" class="aligncenter wp-image-16919 size-full jetpack-lazy-image" src="../Images/66fdce62a2de2684402044ac9caafbb2.png" alt="vue install plugin" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png 540w, https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin-300x76.png 300w" data-lazy-sizes="(max-width: 540px) 100vw, 540px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="16919" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/vueinstallplugin/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png" data-orig-size="540,136" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vueinstallplugin" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin-300x76.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png" decoding="async" loading="lazy" class="aligncenter wp-image-16919 size-full" src="../Images/66fdce62a2de2684402044ac9caafbb2.png" alt="vue install plugin" srcset="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png 540w, https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin-300x76.png 300w" sizes="(max-width: 540px) 100vw, 540px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/vueinstallplugin.png"/></noscript>
<p>这个插件创建了两个文件，在项目根目录下的<code>apollo.config.js</code>和在<code>src</code>文件夹下的<code>vue-apollo.js</code>，它还在<code>main.js</code>的Vue实例中注入了Apollo provider。</p>
<p>这个提供者使得在我们的Vue组件中使用Apollo客户端实例成为可能。接下来，让我们对位于<code>/src</code>文件夹中的<code>vue-apollo.js</code>文件进行一些配置。</p>
<p>在文件内容的顶部包括以下内容:</p>
<pre>import { setContext } from 'apollo-link-context'</pre>
<p>这有助于我们在向HTTP请求添加<code>authorization</code>头时利用<code>setContext</code>方法。</p>
<p>接下来，我们更改将要连接的<code>httpEndpoint</code>。用以下内容替换您的<code>httpEndpoint</code>变量的值:</p>
<pre>const httpEndpoint = process.env.VUE_APP_GRAPHQL_HTTP || 'https://bloggr-api.herokuapp.com/'</pre>
<p>定义<code>httpEndpoint</code>后，立即添加以下内容:</p>
<pre>const authLink = setContext(async (_, { headers }) =&gt; {
  // get the authentication token from local storage if it exists
  const token = JSON.parse(localStorage.getItem('apollo-token'))
  // Return the headers to the context so httpLink can read them
  return {
    headers: {
      ...headers,
      authorization: token || ''
    }
  }
})</pre>
<p>接下来，我们用<code>authLink</code>覆盖默认的Apollo链接，在<code>defaultOptions</code>对象中放置以下内容:</p>
<pre>link: authLink</pre>
<p><code>defaultOptions</code>对象为<code>apolloClient</code>设置应用程序范围的默认值。</p>
<p>让我们继续用我们的<code>defaultOptions</code>对象作为值创建我们的<code>apolloClient</code>实例，我们用<code>export</code>导出它，这样我们就可以在我们的<code>vuex</code>商店中访问<code>apolloClient</code>:</p>
<pre>export const { apolloClient, wsClient } = createApolloClient({
  ...defaultOptions
  // ...options
})</pre>
<p>接下来，用以下内容替换<code>createProvider</code>功能:</p>
<pre>export function createProvider () {
  // Create vue apollo provider
  const apolloProvider = new VueApollo({
    defaultClient: apolloClient,
    defaultOptions: {
      $query: {
        fetchPolicy: 'cache-and-network'
      }
    },
    errorHandler (error) {
      // eslint-disable-next-line no-console
      console.log('%cError', 'background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;', error.message)
    }
  })
  return apolloProvider
}</pre>
<p>一旦我们的应用程序被初始化，<code>createProvider</code>函数就在<code>main.js</code>文件中被调用，它将Apollo客户端实例注入到我们的Vue应用程序中，并使得在我们的组件中使用Apollo成为可能。</p>
<h2>查询和突变</h2>
<p>在你的<code>/src</code>文件夹中创建一个名为<code>graphql</code>的文件夹，在里面用下面的命令创建两个文件:</p>
<pre>touch queries.js mutations.js</pre>
<p><code>queries.js</code>文件将包含对我们的GraphQL服务器的查询，<code>Query</code>是对API检索数据的请求。查询类似于<a href="https://blog.logrocket.com/the-essential-guide-for-designing-a-production-ready-developer-friendly-restful-api/" target="_blank" rel="noopener noreferrer">REST API</a>中的<code>HTTP GET</code>请求。</p>
<p><code>mutations.js</code>文件包含对GraphQL服务器的修改，<code>Mutations</code>是改变Apollo服务器中数据状态的查询。突变类似于<a href="https://blog.logrocket.com/the-essential-guide-for-designing-a-production-ready-developer-friendly-restful-api/" target="_blank" rel="noopener noreferrer">REST API</a>中的<code>HTTP PUT</code>、<code>POST</code>或<code>DELETE</code>请求。</p>
<p>接下来，在我们的<code>mutations.js</code>文件中添加以下代码行:</p>
<pre>import gql from 'graphql-tag'
export const LOGIN_USER = gql`
mutation login ($email: String! $password: String! ){
  login(email: $email password: $password ){
    token
  }
}
`
export const REGISTER_USER = gql`
mutation createUser($name: String! $email: String! $password: String! ) {
    createUser( name: $name, email: $email, password: $password) {
      token
    }
}
`</pre>
<p><code>gql</code>帮助我们编写GraphQL查询，我们已经为登录和创建新用户创建了变异，我们表单的内容作为变异的变量。</p>
<p>在我们的<code>queries.js</code>文件中，包含以下查询，该查询获取当前经过身份验证的用户:</p>
<pre>import gql from 'graphql-tag'

export const LOGGED_IN_USER = gql`
  query {
    me {
      id
      name
      email
    }
  }
`</pre>
<h2>配置Vuex</h2>
<p>首先，让我们导入我们的<code>Mutations</code>、<code>Queries</code>和<code>apolloClient</code>实例:</p>
<pre>import { apolloClient } from '@/vue-apollo'
import { LOGGED_IN_USER } from '@/graphql/queries'
import { LOGIN_USER, REGISTER_USER } from '@/graphql/mutations'</pre>
<p>导入<code>apolloClient</code>实例使我们能够在商店中执行Apollo操作。</p>
<p>接下来，设置我们将在<code>state</code>中需要的数据，将以下内容放入<code>state</code>对象中:</p>
<pre>token: null,
user: {},
authStatus: false</pre>
<p><a href="https://vuex.vuejs.org/guide/state.html" target="_blank" rel="noopener noreferrer">状态对象</a>是将在应用程序范围内使用的数据的中央存储。它代表了“真理的单一来源”。</p>
<p><code>authStatus</code>是一个布尔值，它告诉用户是否通过了身份验证，用户对象将包含通过身份验证的用户的详细信息。</p>
<p>接下来，我们配置我们的<code>getters</code>，在<code>getters</code>对象中包含以下内容:</p>
<pre>isAuthenticated: state =&gt; !!state.token,
authStatus: state =&gt; state.authStatus,
user: state =&gt; state.user</pre>
<p><a href="https://vuex.vuejs.org/guide/getters.html" target="_blank" rel="noopener noreferrer"> Getters </a>帮助在我们的状态对象中检索项目，getter的结果基于它的依赖关系被缓存，并且只有当它的一些依赖关系改变时才会重新评估。</p>
<p>继续创建新的<a href="https://vuex.vuejs.org/guide/mutations.html" target="_blank" rel="noopener noreferrer">突变</a>，在<code>mutations</code>对象中:</p>
<pre>SET_TOKEN (state, token) {
  state.token = token
},
LOGIN_USER (state, user) {
  state.authStatus = true
  state.user = { ...user }
},
LOGOUT_USER (state) {
  state.authStatus = ''
  state.token = '' &amp;&amp; localStorage.removeItem('apollo-token')
}</pre>
<p>我们创建了突变来改变Vuex存储中的状态，突变函数是同步的，它们通常采用两个参数——状态对象和有效载荷，有效载荷可以是变量或对象。</p>
<p>最后，让我们配置我们的<code>actions</code>、<a href="https://vuex.vuejs.org/guide/actions.html" target="_blank" rel="noopener noreferrer">动作</a>是用于提交突变的异步函数。用<code>store.dispatch</code>方法触发动作:</p>
<pre>async register ({ commit, dispatch }, authDetails) {
     try {
       const { data } = await apolloClient.mutate({ mutation: REGISTER_USER, variables: { ...authDetails } })
       const token = JSON.stringify(data.createUser.token)
       commit('SET_TOKEN', token)
       localStorage.setItem('apollo-token', token)
       dispatch('setUser')
     } catch (e) {
       console.log(e)
     }
   },
   async login ({ commit, dispatch }, authDetails) {
     try {
       const { data } = await apolloClient.mutate({ mutation: LOGIN_USER, variables: { ...authDetails } })
       const token = JSON.stringify(data.login.token)
       commit('SET_TOKEN', token)
       localStorage.setItem('apollo-token', token)
       dispatch('setUser')
     } catch (e) {
       console.log(e)
     }
   },
   async setUser ({ commit }) {
     const { data } = await apolloClient.query({ query: LOGGED_IN_USER })
     commit('LOGIN_USER', data.me)
   },
   async logOut ({ commit, dispatch }) {
     commit('LOGOUT_USER')
   }</pre>
<p>现在我们的商店已经配置好了，让我们向我们的登录和注册表单添加功能，在您的<code>Register.vue</code>文件的<code>script</code>部分包含以下内容:</p>
<pre>&lt;script&gt;
import { mapActions } from 'vuex'
  ....
  methods: {
    ...mapActions(['register']),
    registerUser: function () {
      this.register(this.authDetails)
        .then(() =&gt; this.$router.push('/dashboard'))
    }
  }
...</pre>
<p>为了在我们的组件中分派动作，我们使用了将组件方法映射到<code><em>this</em>.$store.dispatch</code>的<code>mapActions</code>助手。</p>
<p>上面的代码将表单细节作为有效载荷发送给Vuex存储中的<code>register</code>动作，然后将路由更改为<code>/dashboard</code>。</p>
<p>在您的<code>Login.vue</code>文件中包含以下内容:</p>
<pre>&lt;script&gt;
import { mapActions } from 'vuex'
....
  methods: {
    ...mapActions(['login']),
    loginUser: function () {
      this.login(this.authDetails)
        .then(() =&gt; this.$router.push('/dashboard'))
    }
  }
...</pre>
<p>在您的<code>Home.vue</code>文件的<code>script</code>部分包含以下内容，以获取用户详细信息:</p>
<pre>&lt;script&gt;

import { mapGetters } from 'vuex'
....
  computed: {
    ...mapGetters(['user'])
  }
....
&lt;/script&gt;</pre>
<p><code>mapGetters</code>助手只是将存储getters映射到本地计算属性。</p>
<h2>守卫路线</h2>
<p>在您的<code>router</code>文件的顶部导入<code>vuex</code>存储:</p>
<pre>import store from '../store'</pre>
<p>给我们的<code>/dashboard</code>路线添加一个<code>meta</code>字段，这个<code>meta</code>帮助我们定义我们的路线导航守卫中间件。我们的仪表板路线记录看起来如下:</p>
<pre>{
  path: '/dashboard',
  name: 'Home',
  component: () =&gt; import('@/views/Home.vue'),
  meta: { requiresAuth: true }
},</pre>
<p>在<code>export default router</code>之前包括以下内容:</p>
<pre>router.beforeEach((to, from, next) =&gt; {
    // Check if the user is logged i
  const isUserLoggedIn = store.getters.isAuthenticated
  if (to.matched.some(record =&gt; record.meta.requiresAuth)) {
    if (!isUserLoggedIn) {
      store.dispatch('logOut')
      next({
        path: '/login',
        query: { redirect: to.fullPath }
      })
    } else {
      next()
    }
  } else {
    next()
  }
})</pre>
<p>这为我们的路线记录定义了导航保护。当我们使用<code>requiresAuth</code>元字段导航到任何路由时，它会检查用户是否已经过身份验证并被授权访问该路由，如果用户没有被授权，它会将用户重定向到登录页面。</p>
<p>我们完成的应用程序应该如下所示:</p>
<p><img data-attachment-id="16936" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/finishedvue/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue.gif" data-orig-size="730,353" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="finishedvue" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue-300x145.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue.gif" decoding="async" class="aligncenter size-full wp-image-16936 jetpack-lazy-image" src="../Images/f1bd09fb0f74c6e9efcf066a55c891f4.png" alt="vue app finished" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="16936" data-permalink="https://blog.logrocket.com/handling-authentication-in-your-graphql-powered-vue-app/finishedvue/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue.gif" data-orig-size="730,353" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="finishedvue" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue-300x145.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-16936" src="../Images/f1bd09fb0f74c6e9efcf066a55c891f4.png" alt="vue app finished" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/04/finishedvue.gif"/></noscript>
<h2>结论</h2>
<p>在这篇文章中，我们看到了如何用vue-router、vue-apollo和Vuex处理我们的GraphQL APIs的认证。你可以在这里了解更多关于Apollo GraphQL的信息，你也可以在<a href="https://blog.logrocket.com/tag/graphql/" target="_blank" rel="noopener noreferrer"> LogRocket </a>博客上了解更多关于GraphQL的信息。在GitHub上查看这个教程的<a href="https://github.com/Jolaolu/graphql-vue-auth" target="_blank" rel="noopener noreferrer">库</a>，它可以作为模板来搭建你的应用。您还可以查看GraphQL API <a href="https://github.com/Jolaolu/graphql-blog-api" target="_blank" rel="noopener noreferrer">库</a>和我们的<a href="https://blogr.jola.now.sh/" target="_blank" rel="noopener noreferrer">应用</a>的部署版本。</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>