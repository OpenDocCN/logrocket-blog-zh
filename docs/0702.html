<html>
<head>
<title>Dynamic and async functionality in JAMstack - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>JAMstack - LogRocket博客中的动态和异步功能</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/#0001-01-01">https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/#0001-01-01</a></blockquote><div><article class="article-post">
<p>JAMstack网站是由通过CDN提供的静态文件组成的，但这是否意味着它们给了你一种静态的体验？答案是一个大大的否定。</p>
<p>有一种常见的误解，认为“静态网站”一词描述的是一个不灵活或固定的网站。它真正的意思是，不需要服务器来服务站点。</p>
<p>JAMstack站点的核心是由预先呈现的文件组成的，这些文件是静态提供的，并通过使用JavaScript的API逐步增强。不像WordPress这样的HP项目，我们不需要一个中间步骤来为每个浏览器请求生成HTML文件。文件已经被存储，因为它们应该在浏览器上呈现。这些静态文件通常包含调用API来完成大部分动态工作的JavaScript代码。</p>
<p>但这不就意味着我们在造服务器吗？不完全是。由于我们使用无服务器功能，我们不需要创建真正意义上的服务器。</p>
<p>在本教程中，我们将展示JAMstack站点如何处理动态内容和交互。我们将演示JAMstack站点需要执行的一些最常见的动态操作，包括:</p>
<ol>
<li>异步加载数据——我们将创建一个页面，您可以在其中键入神奇宝贝的名称，从而异步获取它的详细信息</li>
<li>读取和写入数据库—我们将使用无服务器功能和数据库即服务(DBaaS)解决方案来动态读取和写入数据库</li>
<li>向上述应用程序添加登录页面(即用户验证)</li>
</ol>
<p> </p>
<h2 id="1loadingdataasynchronously">1.<strong>同步加载</strong>ing d<strong>ATA</strong>T4】a</h2>
<p>假设您正在从一个API请求一些数据。根据具体情况，服务器可能需要一些时间来处理请求，同时阻塞主线程，导致网页无响应。</p>
<p>我们可以使用回调、承诺和async/await(即异步JavaScript特性)来执行长时间的网络请求，而不会阻塞主线程。</p>
<p>JavaScript包含许多异步库。我们将使用<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank" rel="noopener noreferrer">获取API </a>来加载我们的数据。</p>
<p>现在让我们构建一个页面，使用户能够使用<a href="https://pokeapi.co/" target="_blank" rel="noopener noreferrer"> PokéAPI </a>按名称搜索神奇宝贝的详细信息。</p>
<ol>
<li>创建一个带有输入字段和搜索按钮<img data-attachment-id="14695" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-form-input-field-search-button-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png" data-orig-size="730,198" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAMstack app search form input field and button" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1-300x81.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png" decoding="async" class="aligncenter size-full wp-image-14695 jetpack-lazy-image" src="../Images/bfae7faa0579ccb351079f1bc1f138f0.png" alt="JAMstack App Search Form Input Field and Button" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1-300x81.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png"/> <noscript> <img data-lazy-fallback="1" data-attachment-id="14695" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-form-input-field-search-button-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png" data-orig-size="730,198" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAMstack app search form input field and button" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1-300x81.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-14695" src="../Images/bfae7faa0579ccb351079f1bc1f138f0.png" alt="JAMstack App Search Form Input Field and Button" srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1-300x81.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-form-input-field-search-button-1.png"/> </noscript> <pre>&lt;form&gt;    &lt;label for="name"&gt;Get Pokemon Details&lt;/label&gt;    &lt;input type="text" id="name" name="name" required /&gt;    &lt;button type="submit"&gt;Search&lt;/button&gt; &lt;/form&gt; </pre>的表单</li>
<li>Listen for the submit event on the button, call the API with the data in the input field, and cache the result
<pre>&lt;script type = "module" &gt;
  import displayResult from './displayResult.js';
  const form = document.querySelector('form');
  const handleSubmit = async event =&gt; {
  event.preventDefault();
  const name = form.elements['name'].value;
  let character;
  const fromCache = localStorage.getItem(name);
  if (fromCache) {
    character = JSON.parse(fromCache);
  } else {
    character = await fetch(
        `https://pokeapi.co/api/v2/pokemon/${name}`
      )
      .then(response =&gt; response.json())
      .catch(error =&gt; console.error(error));
    localStorage.setItem(name, JSON.stringify({
      name: character.name,
      moves: character.moves,
      weight: character.weight,
      height: character.height,
      types: character.types,
      sprites: character.sprites,
    }));
  }
  displayResult(character);
};
form.addEventListener('submit', handleSubmit);
&lt;/script&gt;</pre>
<p>注意:我们使用一个名为displayResult的辅助函数，它从我们的API结果中形成数据的形状，并对DOM进行更多的检查。</p>
<pre>const createResultRow = container =&gt; character =&gt; {
  if (!'content' in document.createElement('template')) {
    console.error('your browser does not support the template element');
  }
// load the template for a result row
  const template = document.getElementById('search-result-template');
  const result = document.importNode(template.content, true);
  const types = character.types.map(({
    type
  }) =&gt; type.name).join(', ');
  const moves = character.moves.map(({
    move
  }) =&gt; move.name).join(', ');
// update the template content
  result.querySelector('.name').textContent = character.name;
  result.querySelector('.type').textContent = types;
  result.querySelector('.weight').textContent = character.weight;
  result.querySelector('.height').textContent = character.height;
  result.querySelector('.moves').textContent = moves;
// update the character image and add alt text
  const img = result.querySelector('.image');
  img.src = character.sprites.front_default;
  img.alt = character.name;
// add the new row to the results container
  container.appendChild(result);
};
export default character =&gt; {
  const searchResult = document.getElementById('search-result');
// remove any existing search results
  while (searchResult.firstChild) {
    searchResult.removeChild(searchResult.firstChild);
  }
// loop through the results and create a new listing for each character
  [character].map(createResultRow(searchResult));
};
</pre>
</li>
<li>最后，在DOM上显示结果<img data-attachment-id="14696" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-pokemon-app-result-dom/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png" data-orig-size="730,425" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAMstack app search results" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom-300x175.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png" decoding="async" class="aligncenter size-full wp-image-14696 jetpack-lazy-image" src="../Images/cd4933f7895cf457e36accd29a2574dd.png" alt="JAMstack App Search Results" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom-300x175.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png"/> <noscript> <img data-lazy-fallback="1" data-attachment-id="14696" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-pokemon-app-result-dom/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png" data-orig-size="730,425" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAMstack app search results" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom-300x175.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-14696" src="../Images/cd4933f7895cf457e36accd29a2574dd.png" alt="JAMstack App Search Results" srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom-300x175.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-pokemon-app-result-dom.png"/> </noscript></li>
</ol>
<p>这就是我们如何在静态下异步加载数据。查看<a href="https://codesandbox.io/s/naughty-chebyshev-d4gb6" target="_blank" rel="noopener noreferrer"> CodeSandbox </a>上的演示。</p>
<h2 id="2readingandwritingtoadatabase">2.<strong>读作</strong> ing和w<strong>rit</strong>ing t<strong>o</strong>T6】ad<strong>atabase</strong></h2>
<p>您可能想知道，如果我们没有建立数据库，我们将如何读写数据库呢？简而言之，<a href="https://www.g2.com/categories/database-as-a-service-dbaas" target="_blank" rel="noopener noreferrer">数据库即服务(DBaaS)解决方案</a>消除了设置或托管数据库的需求。</p>
<p>DBaaS工具通过简单地上传或创建我们想要存储的数据类型，自动生成API来对数据库执行CRUD操作。在本教程中，我们将使用动物群创建一个小型电子邮件订阅应用程序(在继续以下步骤之前，您需要创建一个<a href="https://fauna.com/" target="_blank" rel="noopener noreferrer">动物群</a>帐户)。</p>
<ol>
<li>创建一个数据库，并将其命名为<code>Email</code></li>
<li>点击左侧导航栏中的<code>Security</code>，选择我们刚刚创建的数据库<img data-attachment-id="14689" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/email-subscriber-app-fauna/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png" data-orig-size="730,600" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Creating a database in Fauna" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna-300x247.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png" decoding="async" class="aligncenter size-full wp-image-14689 jetpack-lazy-image" src="../Images/d04fbea8929ac8ece05326f67d7ce83c.png" alt="Creating a Database in Fauna" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna-300x247.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png"/> <noscript> <img data-lazy-fallback="1" data-attachment-id="14689" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/email-subscriber-app-fauna/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png" data-orig-size="730,600" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Creating a database in Fauna" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna-300x247.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-14689" src="../Images/d04fbea8929ac8ece05326f67d7ce83c.png" alt="Creating a Database in Fauna" srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna-300x247.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/email-subscriber-app-fauna.png"/> </noscript></li>
<li>保存后，将密钥存放在某个地方，因为它只显示一次</li>
<li>接下来，创建一个扩展名为<code>.gql</code>的文件，将其命名为<code>schema.gql</code>，并添加以下代码<pre>type Email {   id: String! } type Query {   emails: [Email!] ! }</pre></li>
<li>在GraphQL选项卡中上传这个文件，我们就可以执行CRUD了</li>
</ol>
<p>现在，我们有了一个数据库和一个高度可扩展的、安全的GraphQL API，而且是免费的。</p>
<p>我们可以使用带有密钥的自定义URL来执行读写操作，密钥是由客户端的Fauna提供的。但是由于我们不能将敏感密钥放在客户端代码中，所以我们将使用无服务器函数将私有服务器密钥传递给Fauna，以便对数据库进行读写访问。无服务器功能对于保持私有密钥的私有性至关重要，它们可以轻松地从客户端处理昂贵的计算任务。</p>
<p>下图显示了我们的应用程序的最终结构。我们将调用无服务器函数(Lambda)——在我们的例子中，我们将使用来自JAMstack应用程序(部署在CDN上的HTML)的<a href="https://docs.netlify.com/functions/overview/" target="_blank" rel="noopener noreferrer"> Netlify函数</a>。无服务器函数将负责保存我们的私钥并调用我们的数据库。</p>
<p><img data-attachment-id="14690" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/final-structure-pokemon-app-jamstack/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png" data-orig-size="730,464" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Final Structure of JAMstack App" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack-300x191.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png" decoding="async" class="aligncenter size-full wp-image-14690 jetpack-lazy-image" src="../Images/8c592e9f880eff2edbddea73ca60bd04.png" alt="Final Structure of JAMstack App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack-300x191.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="14690" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/final-structure-pokemon-app-jamstack/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png" data-orig-size="730,464" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Final Structure of JAMstack App" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack-300x191.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-14690" src="../Images/8c592e9f880eff2edbddea73ca60bd04.png" alt="Final Structure of JAMstack App" srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack-300x191.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/final-structure-pokemon-app-jamstack.png"/></noscript>
<p>下面是我们的无服务器函数的代码，它将电子邮件的详细信息存储到数据库中。</p>
<pre>/* Import faunaDB sdk */
const faunadb = require('faunadb');
const key = 'your faunadb key goes here';
// your faunaDB key
const q = faunadb.query;
const client = new faunadb.Client({
  secret: key
});
// These are required for CORS
const headers = {
  'Access-Control-Allow-Origin': '*',
  'Content-Type': 'application/json',
  'Access-Control-Allow-Methods': '*',
};
exports.handler = (event, context, callback) =&gt; {
  return client.query(
    q.Create(
        q.Collection("Email"),
        { 
            data: {
                id: event.queryStringParameters.email
            }
        }
      )
  ).then((response) =&gt; {
    console.log("success", response)

    return callback(null, {
      statusCode: 200,
      headers,
      body: JSON.stringify(response)
    })
  }).catch((error) =&gt; {
    return callback(null, {
      statusCode: 400,
      headers,
      body: JSON.stringify(error)
    })
  })
}
</pre>
<p>将此功能部署到任何无服务器支持服务。有关在Netlify中部署无服务器功能的更多信息，请参见<a href="https://www.netlify.com/blog/2018/07/09/building-serverless-crud-apps-with-netlify-functions-faunadb/" target="_blank" rel="noopener noreferrer">官方文档</a>。</p>
<p><img data-attachment-id="14694" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-email-form-test-dbaas/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png" data-orig-size="730,246" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Email form to test DBaaS app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-300x101.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png" decoding="async" class="aligncenter size-full wp-image-14694 jetpack-lazy-image" src="../Images/4044a32cf2887f419ceca406ba1f8d4c.png" alt="Email Form to Test DBaaS App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-300x101.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="14694" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-email-form-test-dbaas/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png" data-orig-size="730,246" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Email form to test DBaaS app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-300x101.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-14694" src="../Images/4044a32cf2887f419ceca406ba1f8d4c.png" alt="Email Form to Test DBaaS App" srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-300x101.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas.png"/></noscript>
<p>HTML代码将类似于我们创建的第一个应用程序；只有脚本代码会改变。</p>
<pre>&lt;script&gt;
 const form = document.querySelector('form');
const handleSubmit = async event =&gt; {
 event.preventDefault();
 const email = form.elements['email'].value;
 fetch(`http://localhost:9000/.netlify/functions/create?email=${email}`)
  .then(res =&gt; res.json())
  .then(data =&gt; {
   const successHTML =
    document.querySelector('.email-msg').innerHTML = `
            Your email is sucessfully added ${data.data.id}!
            Thanks for being a part of testing! Cheers :) 
          `;
  });
}
form.addEventListener('submit', handleSubmit); 
&lt;/script&gt;
</pre>
<p>在上面的函数中，用localhost URL替换服务提供的URL，并将其添加到HTML代码中。</p>
<p>与第一个应用程序的唯一变化是传递的查询字符串，这是我们来自客户端的电子邮件。如果成功，应用程序将在<code>email-msg</code>类中显示一条消息。</p>
<p><img data-attachment-id="14693" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-email-form-test-dbaas-success/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png" data-orig-size="730,360" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Successfully submitted email form to test DBaaS app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success-300x148.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png" decoding="async" class="aligncenter size-full wp-image-14693 jetpack-lazy-image" src="../Images/8027dedd07763c782c6c04b87dc9e208.png" alt="Successfully Submitted Email Form to Test DBaaS App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success-300x148.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="14693" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-email-form-test-dbaas-success/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png" data-orig-size="730,360" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Successfully submitted email form to test DBaaS app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success-300x148.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-14693" src="../Images/8027dedd07763c782c6c04b87dc9e208.png" alt="Successfully Submitted Email Form to Test DBaaS App" srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success-300x148.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-email-form-test-dbaas-success.png"/></noscript>
<p>查看<a href="https://codesandbox.io/s/pedantic-water-ng1ji" target="_blank" rel="noopener noreferrer"> CodeSandbox </a>上的演示。</p>
<h2 id="3userauthentication">3.用户认证</h2>
<p>让我们研究一下在JAMstack中用户认证是如何完成的。</p>
<ol>
<li>使用OAuth、<a href="https://blog.logrocket.com/aws-services-cheat-sheet/" target="_blank" rel="noopener noreferrer"> AWS Cognito </a>或Netlify Identity等第三方服务来帮助实现认证系统</li>
<li>使用JSON Web令牌(JWT)在服务之间交换和验证用户信息</li>
<li>使用无服务器功能验证令牌并允许用户登录应用程序(我们也可以使用无服务器功能或Auth0创建委托令牌，或者使用委托令牌授权从客户端直接访问服务)</li>
<li>编写客户端代码来管理登录和注销</li>
</ol>
<p>为了简单起见，我们将使用OAuth的内置脚本。我们将调用Google的授权服务器(假设它是我们的无服务器功能)，它将:</p>
<ul>
<li>处理重定向回您的应用程序</li>
<li>验证访问令牌</li>
<li>存储授权服务器发送给应用程序并在应用程序随后进行授权API调用时检索的访问令牌</li>
</ul>
<p>让我们为我们创建的第一个神奇宝贝应用程序添加一个登录页面(我们可以简单地重用这个阶段的代码)。</p>
<p>对于google身份验证，创建一个名为<code>google-authentication.js</code>的文件，并添加以下代码。</p>
<pre>var GoogleAuth;
const SCOPE = 'https://www.googleapis.com/auth/userinfo.email';
function handleClientLoad() {
  // Load the API's client and auth2 modules.
  // Call the initClient function after the modules load.
  gapi.load('client:auth2', initClient);
}
function initClient() {
  // Initialize the gapi.client object, which app uses to make API requests.
  // Get API key and client ID from API Console.
  // 'scope' field specifies space-delimited list of access scopes.
  gapi.client.init({
      'apiKey': 'your api key',
      'clientId': 'your client id',
      'scope': SCOPE
  }).then(function () {
    GoogleAuth = gapi.auth2.getAuthInstance();
// Listen for sign-in state changes.
    GoogleAuth.isSignedIn.listen(updateSigninStatus);
// Handle initial sign-in state. (Determine if user is already signed in.)
    var user = GoogleAuth.currentUser.get();
    setSigninStatus();
// Call handleAuthClick function when user clicks on
    //      "Sign In/Authorize" button.
    $('#sign-in-or-out-button').click(function() {
      handleAuthClick();
    });
    $('#revoke-access-button').click(function() {
      revokeAccess();
    });
  });
}
function handleAuthClick() {
  if (GoogleAuth.isSignedIn.get()) {
    // User is authorized and has clicked "Sign out" button.
    GoogleAuth.signOut();
  } else {
    // User is not signed in. Start Google auth flow.
    GoogleAuth.signIn();
  }
}
function revokeAccess() {
  GoogleAuth.disconnect();
}
function setSigninStatus(isSignedIn) {
  var user = GoogleAuth.currentUser.get();
  var isAuthorized = user.hasGrantedScopes(SCOPE);
  if (isAuthorized) {
    $('#sign-in-or-out-button').html('Sign out');
    $('#revoke-access-button').css('display', 'inline-block');
    $('#auth-status').html(`Welcome to the app - ${user.Qt.Ad}`);  
    document.getElementById('app').style.display = 'block';
} else {
    $('#sign-in-or-out-button').html('Sign In/Authorize');
    $('#revoke-access-button').css('display', 'none');
    $('#auth-status').html('You need to be authorised to use the app');
    document.getElementById('app').style.display = 'none';
  }
}
function updateSigninStatus(isSignedIn) {
  setSigninStatus();
}var GoogleAuth;
const SCOPE = 'https://www.googleapis.com/auth/userinfo.email';
function handleClientLoad() {
  // Load the API's client and auth2 modules.
  // Call the initClient function after the modules load.
  gapi.load('client:auth2', initClient);
}
function initClient() {
  // Initialize the gapi.client object, which app uses to make API requests.
  // Get API key and client ID from API Console.
  // 'scope' field specifies space-delimited list of access scopes.
  gapi.client.init({
      'apiKey': 'AIzaSyDJM2tpYAm_9za_sZHBajTKCezSoRalNtg',
      'clientId': '1021021275901-8fqh15chm5lgkfpc98m2iuu0n8iiq2j5.apps.googleusercontent.com',
      'scope': SCOPE
  }).then(function () {
    GoogleAuth = gapi.auth2.getAuthInstance();
// Listen for sign-in state changes.
    GoogleAuth.isSignedIn.listen(updateSigninStatus);
// Handle initial sign-in state. (Determine if user is already signed in.)
    var user = GoogleAuth.currentUser.get();
    setSigninStatus();
// Call handleAuthClick function when user clicks on
    //      "Sign In/Authorize" button.
    $('#sign-in-or-out-button').click(function() {
      handleAuthClick();
    });
    $('#revoke-access-button').click(function() {
      revokeAccess();
    });
  });
}
function handleAuthClick() {
  if (GoogleAuth.isSignedIn.get()) {
    // User is authorized and has clicked "Sign out" button.
    GoogleAuth.signOut();
  } else {
    // User is not signed in. Start Google auth flow.
    GoogleAuth.signIn();
  }
}
function revokeAccess() {
  GoogleAuth.disconnect();
}
function setSigninStatus(isSignedIn) {
  var user = GoogleAuth.currentUser.get();
  var isAuthorized = user.hasGrantedScopes(SCOPE);
  if (isAuthorized) {
    $('#sign-in-or-out-button').html('Sign out');
    $('#revoke-access-button').css('display', 'inline-block');
    $('#auth-status').html(`Welcome to the app - ${user.Qt.Ad}`);  
    document.getElementById('app').style.display = 'block';
} else {
    $('#sign-in-or-out-button').html('Sign In/Authorize');
    $('#revoke-access-button').css('display', 'none');
    $('#auth-status').html('You need to be authorised to use the app');
    document.getElementById('app').style.display = 'none';
  }
}
function updateSigninStatus(isSignedIn) {
  setSigninStatus();
}
</pre>
<p>不要担心代码；这只是来自谷歌的修改样本。我们简单地替换了作用域、API键和<code>clientId</code>。</p>
<p>对于客户端代码，我们将编辑<code>index.html</code>文件。</p>
<ol>
<li>在HTML代码<div> <pre class="listtype-code listindent1 list-code1 lang-xml" spellcheck="false"><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxuz87z94em5z81zz80z5emryz70z0z73zz83znhz82zz65zm2nwsvz90zz68zq">&lt;script src="./google-authentication.js"&gt;&lt;/script&gt;</span></pre> </div>中包含上述脚本</li>
<li>在<code>main</code>标签上方的正文中添加登录按钮<div> <div> <pre class="listtype-code listindent1 list-code1 lang-xml" spellcheck="false">&lt;center style="margin-top: 100px"&gt; &lt;button class="loginBtn loginBtn--google" id='sign-in-or-out-button'&gt; &lt;/button&gt; &lt;button id="revoke-access-button" style="display: none; margin-left: 25px"&gt;Revoke access&lt;/button&gt; &lt;/center&gt;</pre> </div> </div></li>
<li>将应用程序的显示设置为<code>none</code>，并使其在登录后出现，这发生在我们添加的<div> <pre class="listtype-code listindent1 list-code1 lang-xml" spellcheck="false"><span class=" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxuz87z94em5z81zz80z5emryz70z0z73zz83znhz82zz65zm2nwsvz90zz68zq">&lt;main id='app' style="display: none;"&gt;</span></pre> </div>的谷歌认证脚本中</li>
</ol>
<p><main id="app"/>注意:我们可以在使用令牌或用户数据进行认证后进行无服务器函数调用，以获得我们需要的认证数据。上面的过程只是一个小的测试应用程序，用来演示身份验证是如何工作的。</p>
<p><img data-attachment-id="14745" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-authentication-before-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png" data-orig-size="732,330" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAMstack app authentication before login" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1-300x135.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png" decoding="async" class="aligncenter size-full wp-image-14745 jetpack-lazy-image" src="../Images/898011ea4fdf7a426e69f33572e2cf56.png" alt="JAMstack App Authentication Before Login" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png 732w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1-300x135.png 300w" data-lazy-sizes="(max-width: 732px) 100vw, 732px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="14745" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-authentication-before-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png" data-orig-size="732,330" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAMstack app authentication before login" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1-300x135.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-14745" src="../Images/898011ea4fdf7a426e69f33572e2cf56.png" alt="JAMstack App Authentication Before Login" srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png 732w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1-300x135.png 300w" sizes="(max-width: 732px) 100vw, 732px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-before-1.png"/></noscript>
<p><img data-attachment-id="14744" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-authentication-after-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png" data-orig-size="732,383" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAMstack app authentication after login" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1-300x157.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png" decoding="async" class="aligncenter size-full wp-image-14744 jetpack-lazy-image" src="../Images/60b799b6720e27a27332a2383eddad5d.png" alt="JAMstack App Authentication After Login" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png 732w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1-300x157.png 300w" data-lazy-sizes="(max-width: 732px) 100vw, 732px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="14744" data-permalink="https://blog.logrocket.com/dynamic-and-async-functionality-in-jamstack/jamstack-authentication-after-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png" data-orig-size="732,383" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAMstack app authentication after login" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1-300x157.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-14744" src="../Images/60b799b6720e27a27332a2383eddad5d.png" alt="JAMstack App Authentication After Login" srcset="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png 732w, https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1-300x157.png 300w" sizes="(max-width: 732px) 100vw, 732px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/02/jamstack-authentication-after-1.png"/></noscript>
<p>这就是全部了！如果你想看完整的演示，请前往<a href="https://codesandbox.io/s/small-pine-qqsxd" target="_blank" rel="noopener noreferrer"> CodeSandbox </a>。</p>
<h2>结论</h2>
<p>跳过服务器并使用JAMstack来构建和交付网站可以节省时间、金钱，并解决DevOps的问题。这些不仅仅是静态网站；有了JAMstack，你的应用程序可以响应用户交互，存储数据，处理用户认证，以及你想要一个现代网站做的任何事情。</p><div class="code-block code-block-2">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket会告诉您应用程序中实际影响用户的最具影响力的bug和UX问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket自动聚合客户端错误、JS异常、前端性能指标和用户交互。然后LogRocket使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试LogRocket】。</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>