<html>
<head>
<title>Search-optimized SPAs with React Helmet - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>搜索优化的温泉与反应头盔日志火箭博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/search-optimized-spas-react-helmet/#0001-01-01">https://blog.logrocket.com/search-optimized-spas-react-helmet/#0001-01-01</a></blockquote><div><article class="article-post">
 <p>每个开发者都希望他们的网站出现在搜索结果页面的顶部。不幸的是，搜索引擎爬虫还没有可靠地理解/呈现JavaScript，这意味着建立在React、Angular等之上的spa。通常不受搜索引擎爬虫的青睐。对于许多开发人员来说，这可能是一个重要的问题。服务器端渲染(SSR)可以解决这个问题，但它也有其局限性。</p>
<p><a href="https://github.com/nfl/react-helmet/"> React头盔</a>是React的文档头管理器。它使得在服务器和客户端上更新元标签变得容易，这意味着这个库是使你的应用程序SEO和社交媒体友好的完美选择。在本文中，我们将看到如何将React头盔添加到您的项目中并使用它。</p>
<h2>设置</h2>
<p>使用create-react-app初始化一个新的React项目，并启动开发服务器。</p>
<pre>npx create-react-app react-helmet-tutorial
cd react-helmet-tutorial
npm start</pre>
<p>除非你系统的端口3000被占用，否则你可以直接去<code><a href="http://localhost:3000" rel="nofollow">http://localhost:3000</a></code>看看你的应用。</p>
<p><img data-attachment-id="25519" data-permalink="https://blog.logrocket.com/search-optimized-spas-react-helmet/new-cra-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png" data-orig-size="730,346" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Newly created React app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app-300x142.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png" decoding="async" class="aligncenter size-full wp-image-25519 jetpack-lazy-image" src="../Images/1746d9fce10ef9252c74d34bbee8c64e.png" alt="Newly Created React App" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app-300x142.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25519" data-permalink="https://blog.logrocket.com/search-optimized-spas-react-helmet/new-cra-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png" data-orig-size="730,346" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Newly created React app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app-300x142.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-25519" src="../Images/1746d9fce10ef9252c74d34bbee8c64e.png" alt="Newly Created React App" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app-300x142.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/new-cra-app.png"/></noscript>
<p>像大多数spa一样，你的应用有一个默认的<code>&lt;head&gt;</code>元素；你可以通过点击Chrome中的<strong> F12 </strong>或Firefox中的<strong> Ctrl+Shift+C </strong>在浏览器中打开检查器来验证这一点。</p>
<p>这是<code>&lt;head&gt;</code>元素的样子:</p>
<pre>&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;link rel="icon" href="/favicon.ico"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
    &lt;meta name="theme-color" content="#000000"&gt;
    &lt;meta name="description" content="Web site created using create-react-app"&gt;
    &lt;link rel="apple-touch-icon" href="/logo192.png"&gt;

    &lt;link rel="manifest" href="/manifest.json"&gt;

    &lt;title&gt;React App&lt;/title&gt;
  &lt;style type="text/css"&gt;
   &lt;!-- CSS --&gt;
  &lt;/style&gt;
&lt;/head&gt;</pre>
<p>管理这个<code>&lt;head&gt;</code>的一种方法是更新<code>public/index.html</code>，但是这并不总是最佳的。</p>
<h2>安装和使用</h2>
<p>您可以使用npm或Yarn将React头盔安装到项目中:</p>
<pre>npm install react-helmet
# OR, using Yarn:
yarn add react-helmet</pre>
<p>要使用React Helmet，首先要导入<code>Helmet</code>组件，然后在文档的<code>&lt;head&gt;</code>中添加想要的元素。</p>
<pre>// src/App.js

import React from "react";
import "./App.css";
import { Helmet } from "react-helmet";

function App() {
  return (
    &lt;div className="App"&gt;

      &lt;Helmet&gt;
        &lt;html lang="en" /&gt;
        &lt;title&gt;React Helmet Tutorial&lt;/title&gt;
        &lt;meta name="description" content="Tutorial for React Helmet" /&gt;
        &lt;meta name="theme-color" content="#E6E6FA" /&gt;
      &lt;/Helmet&gt;

      &lt;header className="App-header"&gt;Title will be React Helmet Tutorial&lt;/header&gt;
    &lt;/div&gt;
  );
}
export default App;</pre>
<p>只要你更新了<code>src/App.js</code>文件，你就会看到React应用的<code>title</code>发生了变化。</p>
<p>在本例中，只使用了<code>description</code>和<code>theme-color</code>的<code>&lt;title&gt;</code>、<code>&lt;html&gt;</code>和<code>&lt;meta&gt;</code>元素，但是您可以使用其他元素，如<code>title</code>、<code>base</code>、<code>meta</code>、<code>link</code>、<code>script</code>、<code>noscript</code>和<code>style</code>作为<code>Helmet</code>的子元素。</p>
<p>您还可以为<code>body</code>和<code>html</code>标签设置属性。例如:</p>
<pre> &lt;Helmet&gt;
        {/* html attributes */}
        &lt;html lang="en" /&gt;

        {/* body attributes */}
        &lt;body className="dark" /&gt;

        {/* title element */}
        &lt;title&gt;React Helmet Tutorial&lt;/title&gt;

        {/* base element */}
        &lt;base target="_blank" href="https://blog.logrocket.com/" /&gt;

        {/* meta elements */}
        &lt;meta name="description" content="Tutorial for React Helmet" /&gt;

        &lt;meta name="theme-color" content="#E6E6FA" /&gt;

        {/* link elements */}
        &lt;link rel="canonical" href="https://blog.logrocket.com/" /&gt;
&lt;/Helmet&gt;</pre>
<h3>谁有优先权:孩子还是父母？</h3>
<p>在父组件和子组件之间，优先选择子组件。例如，如果您有一个子组件，如下所示:</p>
<pre>// src/Child.js

import React from "react";
import { Helmet } from "react-helmet";
function Child() {
  return (
    &lt;div&gt;
      &lt;Helmet&gt;
        &lt;title&gt;Child Component Rocks!&lt;/title&gt;
      &lt;/Helmet&gt;
     {"  "}  This time title will be  Child Component Rocks! 
    &lt;/div&gt;
  );
}
export default Child;</pre>
<p>并且你将这个子组件(即<code>Child.js</code>)导入到父组件(即<code>App.js</code>)中，文档的标题会根据子组件而改变，但是元<code>description</code>和<code>theme-color</code>不会被覆盖。</p>
<pre>// src/App.js

import React from "react";
import "./App.css";
import { Helmet } from "react-helmet";
import Child from "./Child";
function App() {
  return (
    &lt;div className="App"&gt;
      &lt;Helmet&gt;
        &lt;title&gt;React Helmet Tutorial&lt;/title&gt;
        &lt;meta name="description" content="Tutorial for React Helmet" /&gt;
        &lt;meta name="theme-color" content="#E6E6FA" /&gt;
      &lt;/Helmet&gt;

      &lt;header className="App-header"&gt;
        Title will not be React Helmet Tutorial &lt;Child /&gt;
      &lt;/header&gt;
    &lt;/div&gt;
  );
}
export default App;</pre>
<p>在两个子组件之间，稍后使用的那个将被给予优先权。例如，如果有两个子组件，即<code>&lt;Child1 /&gt;</code>和<code>&lt;Child2 /&gt;</code>，那么在<code>App.js</code>文件中稍后使用的组件将被优先考虑。</p>
<pre>// src/App.js
import React from "react";
import "./App.css";
import { Helmet } from "react-helmet";
import Child1 from "./Child1";
import Child2 from "./Child2";
function App() {
  return (
    &lt;div className="App"&gt;
      &lt;Helmet&gt;
        &lt;title&gt;React Helmet Tutorial&lt;/title&gt;
        &lt;meta name="description" content="Tutorial for React Helmet" /&gt;
        &lt;meta name="theme-color" content="#E6E6FA" /&gt;
      &lt;/Helmet&gt;
      &lt;header className="App-header"&gt;
        Title will not be React Helmet Tutorial 

        &lt;Child1 /&gt;
        &lt;Child2 /&gt;
      &lt;/header&gt;
    &lt;/div&gt;
  );
}
export default App;</pre>
<p>在上面的代码中，将根据<code>&lt;Child2 /&gt;</code>组件设置标题。</p>
<p>如果颠倒顺序，将根据<code>&lt;Child1 /&gt;</code>进行设置:</p>
<pre>&lt;header className="App-header"&gt;
        Title will not be React Helmet Tutorial 
        &lt;Child2 /&gt;
        &lt;Child1 /&gt;
&lt;/header&gt;</pre>
<h2>SSR和React头盔</h2>
<p>如上所述，React头盔是服务器端渲染React应用程序的完美合作伙伴。可以参考<a href="https://blog.logrocket.com/why-you-should-render-react-on-the-server-side-a50507163b79/">这里</a>设置一个基本的React SSR app。</p>
<p>在您的服务器端代码中，在您调用ReactDOMServer的<code>renderToString</code>或<code>renderToStaticMarkup</code>之后，您需要使用头盔的<code>renderStatic</code>方法。</p>
<p>下面是一个服务器端渲染的例子:</p>
<pre>// server/index.js
import React from "react";
import { renderToString } from "react-dom/server";
import express from "express";
import App from "./src/App";
import { Helmet } from "react-helmet";
const app = express();  

app.get("/*", (req, res) =&gt; {
  const app = renderToString(&lt;App /&gt;);
  const helmet = Helmet.renderStatic();

  const html = `
  &lt;!DOCTYPE html&gt;
  &lt;html ${helmet.htmlAttributes.toString()}&gt;
    &lt;head&gt;
      ${helmet.title.toString()}
      ${helmet.meta.toString()}
      ${helmet.link.toString()}
    &lt;/head&gt;
    &lt;body ${helmet.bodyAttributes.toString()}&gt;
      &lt;div id="root"&gt;
        ${app}
      &lt;/div&gt;
      &lt;/body&gt;
  &lt;/html&gt;
`;
  res.send(html);
});
app.listen(8000);</pre>
<p>每个<code>helmet</code>属性包含一个<code>toString()</code>方法，该方法在<code>html</code>字符串中使用。头盔的<code>renderStatic</code>返回一个带有所有属性的实例，比如标题、meta、链接、脚本等。，而所有这些属性都有一个<code>toString()</code>方法。</p>
<h2>反应头盔异步</h2>
<p>React头盔可能不总是SSR的最佳选择，因为它是同步工作的。如果您正在进行异步请求，尤其是流式请求，React头盔可能会导致潜在的错误和问题。</p>
<p><a href="https://github.com/staylor/react-helmet-async">react-头盔-异步</a>是React头盔的一个分支，明确解决了这个问题。您可以通过运行以下命令来安装它:</p>
<pre>npm i react-helmet-async</pre>
<p>一切都保持不变，除了在react-helmet-async中，您需要使用<code>HelmetProvider</code>在客户端和服务器端封装react树。</p>
<pre>// src/App.js
import React from "react";
import "./App.css";
import  {Helmet, HelmetProvider } from 'react-helmet-async';
function App() {
  return (
    &lt;HelmetProvider&gt;
    &lt;div className="App"&gt;
      &lt;Helmet&gt;
        &lt;title&gt;React Helmet Tutorial&lt;/title&gt;
        &lt;meta name="description" content="Tutorial for React Helmet" /&gt;
        &lt;meta name="theme-color" content="#E6E6FA" /&gt;
      &lt;/Helmet&gt;
      &lt;header className="App-header"&gt;
        Title will be React Helmet Tutorial 
      &lt;/header&gt;
    &lt;/div&gt;
    &lt;/HelmetProvider&gt;
  );
}
export default App;</pre>
<h2>使用React头盔和React路由器</h2>
<p>当你的应用程序使用类似于<a href="https://reactrouter.com/"> React Router </a>的东西进行路由时，React头盔尤其有益。在这种情况下，您将需要在每条路线上使用React头盔。这里有一个例子来说明:</p>
<pre>// src/App.js
import React from "react";
import { Helmet } from "react-helmet";
import { BrowserRouter, Switch, Route, Link } from "react-router-dom";
import Home from './Home'
import About from './About'
export default function App() {
  return (
    &lt;div&gt;
      &lt;BrowserRouter&gt;
        &lt;Switch&gt;
          &lt;Route exact path="/"&gt;
            &lt;Home /&gt;
          &lt;/Route&gt;
          &lt;Route path="/about"&gt;
            &lt;About /&gt;
          &lt;/Route&gt;
        &lt;/Switch&gt;
      &lt;/BrowserRouter&gt;
    &lt;/div&gt;
  );
}</pre>
<p>其中<code>Home.js</code>是:</p>
<pre>// src/Home.js
import React from "react";
import { Helmet } from "react-helmet";
import {  Link } from "react-router-dom";

const Home = () =&gt; (
  &lt;div&gt;
    &lt;Helmet&gt;
      &lt;title&gt;Home&lt;/title&gt;
    &lt;/Helmet&gt;
    &lt;h2&gt;Home.&lt;/h2&gt;
    &lt;Link to="/about"&gt;About&lt;/Link&gt;
  &lt;/div&gt;
);

export default Home</pre>
<p>而<code>About.js</code>是:</p>
<pre>// src/About.js
import React from "react";
import { Helmet } from "react-helmet";
import {  Link } from "react-router-dom";

const About = () =&gt; (
  &lt;div&gt;
    &lt;Helmet&gt;
      &lt;title&gt;About&lt;/title&gt;
    &lt;/Helmet&gt;
    &lt;h2&gt;About.&lt;/h2&gt;
    &lt;Link to="/"&gt;Home&lt;/Link&gt;
  &lt;/div&gt;
);
export default About</pre>
<p>对于任意数量的路由，可以重复同样的操作。你可以在这里探索这个例子<a href="https://stackblitz.com/edit/react-hqrtsx?file=src/App.js">。</a></p>
<h2>结论</h2>
<p>在本文中，我们看到了如何安装和使用React头盔，一个文件头管理器。它小巧易用，对你的项目很有帮助。</p>
<p>以下是一些您可能会觉得有用的资源:</p>

<p> </p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>