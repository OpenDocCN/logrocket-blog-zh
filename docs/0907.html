<html>
<head>
<title>JSX-driven components with Crank.js - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>JSX驱动的组件与Crank.js - LogRocket博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/jsx-driven-components-crank-js/#0001-01-01">https://blog.logrocket.com/jsx-driven-components-crank-js/#0001-01-01</a></blockquote><div><article class="article-post">
<p>在本教程中，我们将通过理解什么是Crank.js 以及为什么创建它来介绍它。然后，我们将通过构建一个博客应用程序来使用这些知识，该应用程序将使用<a href="https://jsonplaceholder.typicode.com/"> JSONPlaceholder </a> API。</p>
<h2>Crank.js是什么，解决什么问题？</h2>
<p>js是一个新的框架，用于创建具有函数、承诺和生成器的JSX驱动的组件。它的灵感很大程度上来自于<a href="https://reactjs.org/"> React </a>库。</p>
<p>虽然<a href="https://vuejs.org/"> Vue </a>和<a href="https://svelte.dev/"> Svelte </a>为开发者面临的问题提供了解决方案，但他们主要使用HTML模板语言作为使用它们的主要方式。虽然有其他使用JSX的框架(像<a href="https://preactjs.com/"> Preact </a>)，他们也跟随react从“一个视图层”转换成“一个UI运行时”</p>
<p>Crank.js是一个框架，它验证了“基于JSX的组件不仅可以用同步函数编写，还可以用异步函数、同步和异步生成器函数编写”的观点更多关于为什么曲柄被创造的信息可以在这里找到<a href="https://crank.js.org/blog/introducing-crank">。</a></p>
<p>作为本教程一部分构建的应用程序代码可在<a href="https://github.com/ghoshnirmalya/crank.js-tailwind-css"> GitHub </a>上获得，并托管在<a href="https://crank-js-tailwind-css.now.sh/"> Vercel </a>上。</p>
<h2>在我们的应用程序中安装曲柄</h2>
<p>让我们创建应用程序将驻留的目录:</p>
<pre>mkdir introduction-to-crank.js &amp;&amp; cd introduction-to-crank.js</pre>
<p>然后用<a href="https://www.npmjs.com/"> npm </a>初始化我们的应用程序:</p>
<pre>npm init -y</pre>
<p>这将创建一个包含以下内容的<code>package.json</code>文件:</p>
<figure id="attachment_19679" aria-describedby="caption-attachment-19679" class="wp-caption aligncenter"><img data-attachment-id="19679" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/default-package-json-file-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png" data-orig-size="730,405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Default package.json file" data-image-description="" data-image-caption="&lt;p&gt;Our default package.json file.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file-300x166.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png" decoding="async" class="size-full wp-image-19679 jetpack-lazy-image" src="../Images/d0340dffc73e0cb800ac44c4fdaf67a1.png" alt="Our Default package.json File" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file-300x166.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="19679" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/default-package-json-file-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png" data-orig-size="730,405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Default package.json file" data-image-description="" data-image-caption="&lt;p&gt;Our default package.json file.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file-300x166.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png" decoding="async" loading="lazy" class="size-full wp-image-19679" src="../Images/d0340dffc73e0cb800ac44c4fdaf67a1.png" alt="Our Default package.json File" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file-300x166.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/default-package.json-file.png"/></noscript><figcaption id="caption-attachment-19679" class="wp-caption-text">Our default package.json file.</figcaption></figure>
<p>在我们的项目中添加<a href="https://github.com/bikeshaving/crank"> Crank.js </a>作为依赖项:</p>
<pre>yarn add @bikeshaving/crank</pre>
<p>并添加<a href="https://parceljs.org/">包裹</a>作为我们的捆扎机:</p>
<pre>yarn add parcel-bundler --dev</pre>
<p>上述命令将把parcel作为dev依赖项添加。</p>
<p>现在让我们用以下内容创建一个<code>i``ndex.html</code>文件:</p>
<pre>// index.html

&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Introduction to Crank.js&lt;/title&gt;
    &lt;meta charset="UTF-8" /&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;script src="src/index.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
<p>接下来，我们将在一个新的src目录中创建一个<code>index.js</code>文件，内容如下:</p>
<pre>// src/index.js

import { renderer } from "@bikeshaving/crank/dom";

renderer.render(&lt;div id="hello"&gt;Hello world&lt;/div&gt;, document.body);</pre>
<p>并将以下两个脚本添加到我们的<code>package.json</code>文件中:</p>
<pre>// package.json

..
"scripts": {
  "dev": "parcel index.html",
  "build": "parcel build index.html",
  ..
},
..</pre>
<p>现在，如果我们运行<code>yarn dev</code>，我们将得到以下输出:</p>
<figure id="attachment_19681" aria-describedby="caption-attachment-19681" class="wp-caption aligncenter"><img data-attachment-id="19681" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/error-starting-dev-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png" data-orig-size="730,313" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Error starting our dev server" data-image-description="" data-image-caption="&lt;p&gt;We seen an error when starting our dev server.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server-300x129.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png" decoding="async" class="size-full wp-image-19681 jetpack-lazy-image" src="../Images/198a6a1caa56d31158c154e63e2ee210.png" alt="We See An Error When Starting Our Dev Server" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server-300x129.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="19681" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/error-starting-dev-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png" data-orig-size="730,313" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Error starting our dev server" data-image-description="" data-image-caption="&lt;p&gt;We seen an error when starting our dev server.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server-300x129.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png" decoding="async" loading="lazy" class="size-full wp-image-19681" src="../Images/198a6a1caa56d31158c154e63e2ee210.png" alt="We See An Error When Starting Our Dev Server" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server-300x129.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/error-starting-dev-server.png"/></noscript><figcaption id="caption-attachment-19681" class="wp-caption-text">We seen an error when starting our dev server.</figcaption></figure>
<p>让我们在接下来的步骤中解决这个问题。将babel-preset-crank添加到我们的开发依赖列表中:</p>
<pre>yarn add babel-preset-crank --dev</pre>
<p>最后，创建一个包含以下内容的<code>.babelrc</code>文件:</p>
<pre>// .babelrc

{
  "presets": [
    "crank"
  ]
}</pre>
<p>现在，如果我们启动开发服务器，我们将能够在<code><a href="http://localhost:1234/" rel="nofollow">http://localhost:1234/</a></code>上查看我们的应用程序:</p>
<pre>yarn dev</pre>
<figure id="attachment_19684" aria-describedby="caption-attachment-19684" class="wp-caption aligncenter"><img data-attachment-id="19684" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/output-starting-dev-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png" data-orig-size="730,227" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Output from starting our dev server" data-image-description="" data-image-caption="&lt;p&gt;The output from starting our dev server.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server-300x93.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png" decoding="async" class="size-full wp-image-19684 jetpack-lazy-image" src="../Images/3d639430f4e227e41e8ca1373eb03bda.png" alt="The Output From Starting Our Dev Server" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server-300x93.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="19684" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/output-starting-dev-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png" data-orig-size="730,227" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Output from starting our dev server" data-image-description="" data-image-caption="&lt;p&gt;The output from starting our dev server.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server-300x93.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png" decoding="async" loading="lazy" class="size-full wp-image-19684" src="../Images/3d639430f4e227e41e8ca1373eb03bda.png" alt="The Output From Starting Our Dev Server" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server-300x93.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/output-starting-dev-server.png"/></noscript><figcaption id="caption-attachment-19684" class="wp-caption-text">The output from starting our dev server.</figcaption></figure>
<p>我们应该能够看到以下屏幕:</p>
<figure id="attachment_19686" aria-describedby="caption-attachment-19686" class="wp-caption aligncenter"><img data-attachment-id="19686" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/basic-crank-app-setup/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png" data-orig-size="730,235" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Basic Crank.js app setup" data-image-description="" data-image-caption="&lt;p&gt;Our basic Crank.js application setup.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup-300x97.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png" decoding="async" class="size-full wp-image-19686 jetpack-lazy-image" src="../Images/d204d1de0cfa34ab5a873dc0dd79d2d1.png" alt="Our Basic Crank.js Application Setup" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup-300x97.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="19686" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/basic-crank-app-setup/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png" data-orig-size="730,235" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Basic Crank.js app setup" data-image-description="" data-image-caption="&lt;p&gt;Our basic Crank.js application setup.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup-300x97.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png" decoding="async" loading="lazy" class="size-full wp-image-19686" src="../Images/d204d1de0cfa34ab5a873dc0dd79d2d1.png" alt="Our Basic Crank.js Application Setup" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup-300x97.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/basic-crank-app-setup.png"/></noscript><figcaption id="caption-attachment-19686" class="wp-caption-text">Our basic Crank.js application setup.</figcaption></figure>
<h2>向我们的应用程序添加Tailwind CSS</h2>
<p>为了给我们的应用程序添加一些样式，我们将使用<a href="https://tailwindcss.com/"> TailwindCSS </a>。我们可以通过在我们的<code>index.html</code>文件中添加下面一行来将Tailwind CSS添加到我们的应用程序中:</p>
<pre>// index.html

&lt;link href="https://unpkg.com/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="84f0e5ede8f3edeae0e7f7f7c4">[email protected]</a>^1.0/dist/tailwind.min.css" rel="stylesheet"&gt;</pre>
<p>请注意，这不是向项目添加Tailwind CSS的推荐方式。然而，为了使我们的教程简短，我们加入了它的CDN版本。关于如何正确安装Tailwind CSS的更多信息可以在它的<a href="https://tailwindcss.com/docs/installation">文档</a>中找到。</p>
<p>现在我们可以在我们的项目中使用顺风。为了验证这一点，我们可以在<code>src/components/navbar</code>目录中创建一个<code>Navbar</code>组件，它应该包含以下内容:</p>
<pre>// src/components/navbar/index.js

import { createElement } from "@bikeshaving/crank";

const Navbar = () =&gt; {
  return (
    &lt;div className="bg-gray-100"&gt;
      &lt;div className="max-w-2xl mx-auto p-8 flex justify-between"&gt;
        &lt;div&gt;
          &lt;ul class="flex"&gt;
            &lt;li class="mr-6"&gt;
              &lt;a class="text-blue-500 hover:text-blue-800" href="#"&gt;
                Home
              &lt;/a&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;
        &lt;div&gt;
          &lt;ul class="flex"&gt;
            &lt;li class="mr-6"&gt;
              &lt;a class="text-blue-500 hover:text-blue-800" href="#"&gt;
                About
              &lt;/a&gt;
            &lt;/li&gt;
            &lt;li class="mr-6"&gt;
              &lt;a class="text-blue-500 hover:text-blue-800" href="#"&gt;
                Contact
              &lt;/a&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
};

export default Navbar;</pre>
<p>我们现在可以将该组件导入到我们的<code>src/index.js</code>文件中并使用它:</p>
<pre>// src/index.js

import { createElement } from "@bikeshaving/crank";
import { renderer } from "@bikeshaving/crank/dom";
import Navbar from "./components/navbar";

const App = () =&gt; {
  return (
    &lt;div&gt;
      &lt;section&gt;
        &lt;Navbar /&gt;
      &lt;/section&gt;
    &lt;/div&gt;
  );
};

renderer.render(&lt;App /&gt;, document.body);</pre>
<p>现在，如果我们访问<code><a href="http://localhost:1234/" rel="nofollow">http://localhost:1234/</a></code>，我们应该会看到以下屏幕:</p>
<figure id="attachment_19688" aria-describedby="caption-attachment-19688" class="wp-caption aligncenter"><img data-attachment-id="19688" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/navbar-component/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png" data-orig-size="730,356" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Our Navbar component" data-image-description="" data-image-caption="&lt;p&gt;Our page displaying the Navbar component.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component-300x146.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png" decoding="async" class="size-full wp-image-19688 jetpack-lazy-image" src="../Images/f233961be71685ab08216e8c1807f775.png" alt="Our Page Displaying The Navbar Component" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component-300x146.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="19688" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/navbar-component/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png" data-orig-size="730,356" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Our Navbar component" data-image-description="" data-image-caption="&lt;p&gt;Our page displaying the Navbar component.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component-300x146.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png" decoding="async" loading="lazy" class="size-full wp-image-19688" src="../Images/f233961be71685ab08216e8c1807f775.png" alt="Our Page Displaying The Navbar Component" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component-300x146.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/navbar-component.png"/></noscript><figcaption id="caption-attachment-19688" class="wp-caption-text">Our page displaying the Navbar component.</figcaption></figure>
<p>因此，使用Tailwind CSS，我们创建了第一个Crank.js组件。</p>
<h2>从JSONPlaceholder获取数据</h2>
<p>JSONPlaceholder是一个免费服务，它提供了一个用于测试和原型制作的伪在线REST API。使用这个服务，我们将获取一个博客文章列表。</p>
<p>我们将在一个名为<code>Posts</code>的独立组件中显示帖子:</p>
<pre>// src/components/posts/index.js

import { createElement } from "@bikeshaving/crank";

const Posts = async () =&gt; {
  const response = await fetch("https://jsonplaceholder.typicode.com/posts");
  const data = await response.json();

  return (
    &lt;div className="bg-gray-100"&gt;
      &lt;div className="max-w-2xl mx-auto p-8 flex justify-between"&gt;
        &lt;div&gt;
          &lt;ul class="flex"&gt;
            &lt;li class="mr-6"&gt;
              &lt;a class="text-blue-500 hover:text-blue-800" href="#"&gt;
                Home
              &lt;/a&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;
        &lt;div&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
};

export default Posts;</pre>
<p>让我们也将组件导入并添加到我们的<code>src/index.js</code>文件中:</p>
<pre>// src/index.js

const App = () =&gt; {
  return (
    &lt;div&gt;
      ..
      &lt;section&gt;
        &lt;Posts /&gt;
      &lt;/section&gt;
    &lt;/div&gt;
  );
};</pre>
<p>现在，如果我们访问<a href="http://localhost:1234/" rel="nofollow"> http://localhost:1234/ </a>，我们会在浏览器的控制台上看到一个错误:</p>
<pre>index.js:3 Uncaught ReferenceError: regeneratorRuntime is not defined</pre>
<p>关于这个问题的更多信息可以在这个GitHub <a href="https://github.com/bikeshaving/crank/issues/80">问题</a>中找到，但是我们可以通过添加<a href="https://www.npmjs.com/package/regenerator-runtime">再生器-运行时包</a>来解决它:</p>
<pre>yarn add regenerator-runtime</pre>
<p>现在我们需要将这个包导入到我们的<code>src/index.js</code>文件中:</p>
<pre>// src/index.js

import "regenerator-runtime/runtime";
..</pre>
<p>现在，如果我们再次访问<a href="http://localhost:1234/" rel="nofollow"> http://localhost:1234/ </a>，我们将不会再看到该问题。</p>
<p>让我们展示一下<code>Navbar</code>组件下面的所有帖子。为此，我们需要用以下代码更新我们的<code>Posts</code>组件:</p>
<pre>// src/components/posts/index.js

import { createElement } from "@bikeshaving/crank";

const Posts = async () =&gt; {
  const response = await fetch("https://jsonplaceholder.typicode.com/posts");
  const data = await response.json();

  return (
    &lt;div className="bg-gray-100"&gt;
      &lt;div className="max-w-2xl mx-auto p-8"&gt;
        {data.map((post) =&gt; {
          return (
            &lt;div className="mb-16"&gt;
              &lt;h2 className="font-bold text-xl mb-2"&gt;{post.title}&lt;/h2&gt;
              &lt;p className="font-light"&gt;{post.body}&lt;/p&gt;
            &lt;/div&gt;
          );
        })}
      &lt;/div&gt;
    &lt;/div&gt;
  );
};

export default Posts;</pre>
<p>现在，如果我们访问<code><a href="http://localhost:1234/" rel="nofollow">http://localhost:1234/</a></code>，我们应该能够查看所有的帖子。</p>
<figure id="attachment_19691" aria-describedby="caption-attachment-19691" class="wp-caption aligncenter"><img data-attachment-id="19691" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/posts-component/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png" data-orig-size="730,354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Page displaying the Posts component" data-image-description="" data-image-caption="&lt;p&gt;Our page displaying the Posts component.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component-300x145.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png" decoding="async" class="size-full wp-image-19691 jetpack-lazy-image" src="../Images/f9827546284f0ee56a424996594e0678.png" alt="Our Page Displaying The Posts Component" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component-300x145.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="19691" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/posts-component/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png" data-orig-size="730,354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Page displaying the Posts component" data-image-description="" data-image-caption="&lt;p&gt;Our page displaying the Posts component.&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component-300x145.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png" decoding="async" loading="lazy" class="size-full wp-image-19691" src="../Images/f9827546284f0ee56a424996594e0678.png" alt="Our Page Displaying The Posts Component" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component-300x145.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/posts-component.png"/></noscript><figcaption id="caption-attachment-19691" class="wp-caption-text">Our page displaying the Posts component.</figcaption></figure>
<h2>显示获取帖子时的加载程序</h2>
<p>到目前为止，一旦所有的API请求完成，我们就会显示所有的帖子。但是，可能会有一个API请求需要一些时间来完成。因此，当API请求挂起时，我们需要显示一个加载程序。接下来让我们实现它。</p>
<p>为此，我们需要修改我们的<code>src/components/posts/index.js</code>文件:</p>
<pre>// src/components/posts/index.js

import { createElement, Fragment } from "@bikeshaving/crank";
import Spinner from "../spinner";
import Button from "../button";

const BlogPosts = async ({ postCount }) =&gt; {
  const res = await fetch(
    `https://jsonplaceholder.typicode.com/posts/${postCount}`
  );
  const post = await res.json();

  return (
    &lt;Fragment&gt;
      &lt;h2 className="font-bold text-xl mb-2"&gt;{post.title}&lt;/h2&gt;
      &lt;p className="font-light"&gt;{post.body}&lt;/p&gt;
    &lt;/Fragment&gt;
  );
};

async function* PostsLoader({ isLoading, postCount }) {
  for await ({ isLoading, postCount } of this) {
    yield &lt;Spinner /&gt;;
    yield &lt;BlogPosts postCount={postCount} /&gt;;
  }
}

function* Posts() {
  let isLoading = false;
  let postCount = 1;

  this.addEventListener("click", (e) =&gt; {
    if (e.target.tagName === "BUTTON") {
      isLoading = !isLoading;
      postCount++;
      this.refresh();
    }
  });

  while (true) {
    yield (
      &lt;div className="bg-white"&gt;
        &lt;div className="max-w-2xl mx-auto p-8"&gt;
          &lt;div className="mb-8"&gt;
            &lt;PostsLoader isLoading={isLoading} postCount={postCount} /&gt;
          &lt;/div&gt;
          &lt;Fragment&gt;
            &lt;Button text={`Fetch post #${postCount + 1}`} /&gt;
          &lt;/Fragment&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    );
  }
}

export default Posts;</pre>
<p>在上面的代码片段中，我们默认获取第一篇文章，然后将<code>postCount</code>的值加1。我们每点击一次按钮，计数就增加一次。向JSONPlaceholder发出API请求，这取决于<code>postCount</code>变量的值。</p>
<p>js使用生成器组件来获取异步组件。更多相关信息可在其<a href="https://crank.js.org/guides/async-components">文档</a>中找到。</p>
<p>如果我们现在访问<code><a href="http://localhost:1234/" rel="nofollow">http://localhost:1234/</a></code>，我们应该能够看到以下屏幕:</p>
<p><img data-attachment-id="19819" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/loader-new-post/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post.gif" data-orig-size="730,390" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Loader shown on fetch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post-300x160.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post.gif" decoding="async" class="aligncenter size-full wp-image-19819 jetpack-lazy-image" src="../Images/7c61dc6f092a42c3c9115d5eaa5d6d12.png" alt="The Loader Is Shown Each Time We Fetch A New Post" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="19819" data-permalink="https://blog.logrocket.com/jsx-driven-components-crank-js/loader-new-post/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post.gif" data-orig-size="730,390" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Loader shown on fetch" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post-300x160.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-19819" src="../Images/7c61dc6f092a42c3c9115d5eaa5d6d12.png" alt="The Loader Is Shown Each Time We Fetch A New Post" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/loader-new-post.gif"/></noscript>
<p>我们现在可以看到，每次我们获取一个新帖子时，都会显示一个加载器。</p>
<h2>结论</h2>
<p>在本教程中，我们学习了什么是Crank，以及如何使用它来构建应用程序。作为本教程一部分构建的应用程序的源代码可以在<a href="https://github.com/ghoshnirmalya/crank.js-tailwind-css"> Github </a>上获得，并且托管在<a href="https://crank-js-tailwind-css.now.sh/"> Vercel </a>上。</p>
<p>就我个人而言，我觉得虽然它很新，但它有一些强大的功能。像Crank的作者一样，我也更喜欢JSX语法而不是HTML模板。然而，我认为如果在适当的用例中使用，Crank有很大的潜力。</p><div class="code-block code-block-28">
<div class="blog-plug inline-plug js-libraries-plug"><h2>您是否添加了新的JS库来提高性能或构建新特性？如果他们反其道而行之呢？</h2><p>毫无疑问，前端变得越来越复杂。当您向应用程序添加新的JavaScript库和其他依赖项时，您将需要更多的可见性，以确保您的用户不会遇到未知的问题。</p>
<p>LogRocket 是一个前端应用程序监控解决方案，可以让您回放JavaScript错误，就像它们发生在您自己的浏览器中一样，这样您就可以更有效地对错误做出反应。</p><a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/e8a0ab42befa3b3b1ae08c1439527dc6.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/e8a0ab42befa3b3b1ae08c1439527dc6.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/errors-screenshot.png"/></noscript></a>
<a href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p><a href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>可以与任何应用程序完美配合，不管是什么框架，并且有插件可以记录来自Redux、Vuex和@ngrx/store的额外上下文。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。LogRocket还可以监控应用的性能，报告客户端CPU负载、客户端内存使用等指标。</p><p>自信地构建— <a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>