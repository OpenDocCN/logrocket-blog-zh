<html>
<head>
<title>Implementing SSR in Next.js: Dynamic routing and prefetching - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在Next.js中实现SSR:动态路由和预取- LogRocket博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/#0001-01-01">https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/#0001-01-01</a></blockquote><div><article class="article-post">
<p><strong> <em>编者按:</em> </strong> <em>本帖于2022年6月16日更新，以确保所有信息都是最新的，并添加了涵盖<a href="#next-js-dynamic-routing-multiple-segments">多个段</a>和<a href="#imperative-dynamic-routing-next-js">命令式动态路由</a>的章节，并带有Next.js. </em></p>
<p>服务器端渲染(SSR)已经成为一种广泛采用的技术，用于增强web应用程序的性能和SEO。虽然静态站点生成(SSG)被认为更简单、更快，但在某些情况下，服务器端呈现是您唯一的选择。</p>
<p>然而，在特定页面上实现服务器端呈现可能是一项具有挑战性的任务。Next.js试图通过允许您为应用程序的每个页面选择SSG或SSR来解决这个问题。</p>
<p>这篇文章将通过用Agility CMS构建一个博客来探索这些和其他使Next.js成为一个强大的React框架的概念，这是一个为速度而构建的CMS。</p>
<p>这篇文章的目标是确保您理解Next.js提供的两种预加载技术，能够有效地利用Next.js提供的许多内置功能，并且能够创建和设置一个Agility CMS实例。</p>
<p>我们将涵盖的内容:</p>

<h2 id="next-js-react-framework-build-in-ssr">Next.js:内置SSR的React框架</h2>
<p>Next.js是一个React框架，解决了开发人员在构建web应用程序时面临的常见问题。从确保使用webpack这样的捆绑器捆绑并最小化所有代码，到实现代码分割这样的优化以提高页面性能，Next.js拥有您需要的所有工具。</p>
<p>如果你是一个TypeScript用户，你会很高兴听到你所需要做的就是创建一个<code>tsconfig.json</code>文件来开始！</p>
<p>开发体验很棒，因为你可以选择用什么来构建你的应用程序。例如，Next.js允许您使用CSS-in-JS库，但是它也提供了对Sass和CSS模块的支持。</p>
<p>但是让Next.js真正伟大的是它默认预渲染页面的事实。这意味着每个页面将默认使用静态站点生成，这是构成Next.js混合架构的两个呈现选项之一。</p>
<p>然而，SSG并不总是理想的选择，因为标记是在构建时生成的。如果您的页面包含从外部来源获取的内容并经常更改，则这些更改将不会反映在您的页面上，直到您再次构建该页面。这就是SSR的用武之地！</p>
<p>js允许您获取动态内容，然后在每次请求时适当地生成标记。Next.js通过为您提供在页面类型组件中声明两个异步函数之一的选项来做到这一点，这两个异步函数称为<code>getServerSideProps()</code>或<code>getStaticProps()</code>。</p>
<h2 id="setting-up-agility-cms">设置Agility CMS</h2>
<p><a href="https://agilitycms.com/" target="_blank" rel="noreferrer noopener"> Agility CMS </a>是一个内容管理系统，专为提高速度而打造，具有与大多数云架构相同的可扩展性。设置Agility CMS非常容易，因为它们有大多数流行的React框架的起点——包括Next.js。</p>
<p>您的第一步是<a href="https://account.agilitycms.com/sign-up?product=agility-free&amp;source=getstarted" target="_blank" rel="noreferrer noopener">创建一个Agility CMS帐户</a>。完成后，您需要配置一些项目设置。</p>
<p>首先创建一个项目。选择“用Next.js写博客”选项。输入您的项目名称后，您将被带到您的仪表板。</p>
<p>至此，您应该有一个内容准备就绪的CMS。您可以浏览content和pages部分，根据您的喜好编辑内容，但是您真正应该注意的是API键。</p>
<p>要获取API密钥，请单击左侧导航栏中的设置，然后选择API密钥。在下图中，您可以看到该选项以黄色突出显示:</p>
<p><img data-attachment-id="119917" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/how-to-get-your-api-keys-from-settings-on-agility-cms-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530.png" data-orig-size="527,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="How-to-get-your-API-keys-from-settings-on-Agility-CMS-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530-217x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-740x1024.png" decoding="async" class="aligncenter size-full wp-image-119917 jetpack-lazy-image" src="../Images/3dcaf35cc472088207f97ee38aa79d19.png" alt="How To Get Your API Keys From Settings On Agility CMS Dashboard" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530.png 527w, https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530-217x300.png 217w" data-lazy-sizes="(max-width: 527px) 100vw, 527px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="119917" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/how-to-get-your-api-keys-from-settings-on-agility-cms-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530.png" data-orig-size="527,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="How-to-get-your-API-keys-from-settings-on-Agility-CMS-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530-217x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-740x1024.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-119917" src="../Images/3dcaf35cc472088207f97ee38aa79d19.png" alt="How To Get Your API Keys From Settings On Agility CMS Dashboard" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530.png 527w, https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530-217x300.png 217w" sizes="(max-width: 527px) 100vw, 527px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/How-To-Get-Your-API-Keys-From-Settings-On-Agility-CMS-Dashboard-e1655400224530.png"/></noscript>
<p>在这个页面上，您会发现两个重要的值:项目的全局唯一标识符(GUID)和您的<code>defaultlive</code> API密钥。把这些留着以后用——你会需要它们的！</p>
<h2 id="setting-up-development-environment">为Next.js项目设置开发环境</h2>
<p>首先，您需要构建一个Next.js应用程序。如果你曾经创建过React应用程序，那么<a href="https://blog.logrocket.com/next-js-vs-create-react-app/" target="_blank" rel="noreferrer noopener">你一定知道Create React App </a>。Next.js有自己的模拟名为<code>create-next-app</code>。</p>
<p>通过终端运行以下命令:</p>
<pre class="language-bash hljs">npx create-next-app my-blog
</pre>
<p>一旦完成所有依赖项的安装，通过运行<code>cd my-blog</code>进入<code>my-blog</code>目录。</p>
<p>为了让你专注于这篇文章的主题，你将使用一个叫做<a href="https://mui.com/material-ui/getting-started/usage/" target="_blank" rel="noreferrer noopener"> MUI(以前叫做Material-UI) </a>的组件框架。然而，如果你喜欢写自己的风格，记住你可以利用<a href="https://nextjs.org/docs/basic-features/built-in-css-support#adding-component-level-css" target="_blank" rel="noreferrer noopener"> Next的内置CSS模块</a>和<a href="https://nextjs.org/docs/basic-features/built-in-css-support#sass-support"> Sass支持</a>。</p>
<p>此外，您必须安装Agility CMS SDK，以便从其API获取内容。运行以下命令安装SDK和Material-UI:</p>
<pre class="language-bash hljs">npm install @mui/material @emotion/react @emotion/styled @agility/content-fetch
</pre>
<p>完成后，在项目的根目录下创建一个<code>.env.local</code>文件，并添加以下环境变量，这将显示连接到Agility CMS API所需的凭证:</p>
<pre class="language-bash hljs">AGILITY_CMS_GUID=xxx
AGILITY_CMS_API_FETCH_KEY=xxx
</pre>
<p>用之前找到的GUID和<code>defaultlive</code> API键的值替换<code>xxx</code>占位符。请记住，当您单击API Keys按钮时，您应该能够在Getting Started下找到它们。</p>
<p>这样，我们就可以开始写代码了！</p>
<h2 id="creating-next-js-routes">创建您的Next.js路线</h2>
<p>在您尝试创建您的第一个Next.js页面之前，您必须了解Next.js有一个基于文件系统的router，这样，名为<code>pages</code>的目录下的任何文件都将成为您的应用程序的一个路由。</p>
<p>要开始，那么，你应该创建你所有的路线。在<code>pages</code>目录下，你会发现一个<code>index.js</code>文件。该文件将包含将在<code>/</code>提供的页面组件，或者您的应用程序的默认/主路径。</p>
<p>此外，您需要一个路由来为您的所有博客页面提供服务。因此，创建一个名为<code>blog</code>的目录和一个名为<code>[...slug].js</code>的文件。您将在下一个主题中回到这个概念。您的项目结构应该如下所示:</p>
<p><img data-attachment-id="119922" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/next-js-and-agility-cms-project-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png" data-orig-size="376,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Next.js-and-Agility-CMS-project-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure-155x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png" decoding="async" class="aligncenter size-full wp-image-119922 jetpack-lazy-image" src="../Images/7e72451bd457fb1682c54dbeec260366.png" alt="Next.js And Agility CMS Project Structure" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png 376w, https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure-155x300.png 155w" data-lazy-sizes="(max-width: 376px) 100vw, 376px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="119922" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/next-js-and-agility-cms-project-structure/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png" data-orig-size="376,730" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Next.js-and-Agility-CMS-project-structure" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure-155x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-119922" src="../Images/7e72451bd457fb1682c54dbeec260366.png" alt="Next.js And Agility CMS Project Structure" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png 376w, https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure-155x300.png 155w" sizes="(max-width: 376px) 100vw, 376px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Next.js-and-Agility-CMS-project-structure.png"/></noscript>
<p>接下来，您应该初始化Agility CMS客户端。为了鼓励可重用性，您将在名为<code>lib</code>的项目根目录下创建一个名为<code>agility.js</code>的单独文件。</p>
<pre class="language-javascript hljs">// lib/agility.js
import agility from "@agility/content-fetch";

const api = agility.getApi({
  guid: process.env.AGILITY_CMS_GUID,
  apiKey: process.env.AGILITY_CMS_API_FETCH_KEY
});

export default api;
</pre>
<p>确保您已经在<code>.env.local</code>文件中输入了Agility CMS项目的凭证。</p>
<h2 id="creating-next-js-page">创建您的第一个Next.js页面</h2>
<p>现在让我们转到应用程序的<code>home/index</code>页面，使用<code>getServerSideProps()</code>调用Agility CMS API来获取主页内容:</p>
<pre class="language-javascript hljs">// pages/index.js
import api from "../lib/agility";

/* 
* IndexPage content collapsed for readability
*/

export async function getServerSideProps() {
  const page = await api.getPage({
    pageID: 2,
    languageCode: "en-us"
  });

  return {
    props: {
      meta: { title: page.title, desc: page.seo.metaDescription },
      data: page.zones.MainContentZone.reduce((acc, curr) =&gt; {
        acc[curr.module] = curr.item;
        return acc;
      }, {})
    }
  };
}
</pre>
<p><code>getPage()</code>是Agility CMS SDK提供的一种异步方法，只要您提供一个pageID，就可以一次性获取整个页面。如果您的内容在多个地区，那么您还必须传入正确的<code>languageCode</code>。</p>
<p>可以在特定页面的设置下找到<code>pageID</code>属性的值。例如，要找到名为home的页面的<code>pageID</code>,您可以导航到Agility CMS仪表板中的页面，然后选择主页，然后在最右边的面板中单击Properties。</p>
<p><img data-attachment-id="119925" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/how-to-get-your-pageid-from-the-properties-tab/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png" data-orig-size="730,241" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="How-to-get-your-PageID-from-the-properties-tab" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab-300x99.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png" decoding="async" class="aligncenter size-full wp-image-119925 jetpack-lazy-image" src="../Images/83b005a0c31b7ef21ef8c31f6879daa4.png" alt="How To Get Your PageID From The Agility CMS Dashboard's Properties Tab" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab-300x99.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="119925" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/how-to-get-your-pageid-from-the-properties-tab/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png" data-orig-size="730,241" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="How-to-get-your-PageID-from-the-properties-tab" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab-300x99.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-119925" src="../Images/83b005a0c31b7ef21ef8c31f6879daa4.png" alt="How To Get Your PageID From The Agility CMS Dashboard's Properties Tab" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab-300x99.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/How-to-get-your-PageID-from-the-properties-tab.png"/></noscript>
<p>一旦收到来自<code>getPage()</code>的响应，数据就可以以一种您的组件可以方便地使用的方式进行转换。例如，在代码块中，data属性将总是包含来自<code>MainContentZone</code>数组的所有值。</p>
<p><code>MainContentZone</code>是一个名为模块的对象数组，模块有名字。通过这些模块名访问内容比使用它们各自的索引(即数组中的位置)更方便。</p>
<p>有了现在拥有的数据，您可以用适合您的设计的方式构建您的页面，如下所示:</p>
<pre class="language-javascript hljs">import Head from "next/head";
import { useRouter } from "next/router";

import AppBar from '@mui/material/AppBar';
import Button from '@mui/material/Button';
import Container from '@mui/material/Container';
import Grid from '@mui/material/Grid';
import Toolbar from '@mui/material/Toolbar';
import Typography from '@mui/material/Typography';

import api from "../lib/agility";

const HomePage = ({ meta, data }) =&gt; {
  const router = useRouter();
  const pageContent = data?.TextBlockWithImage?.fields;

  return (
    &lt;&gt;
      &lt;Head&gt;
        &lt;title&gt;{meta.title}&lt;/title&gt;
        &lt;meta name="viewport" content="initial-scale=1.0, width=device-width" /&gt;
        &lt;meta name="description" content={meta.desc} /&gt;
      &lt;/Head&gt;
      {
        pageContent &amp;&amp; &lt;Container maxWidth="lg" style={{ marginTop: "30px" }}&gt;
          &lt;Grid container spacing={3} alignItems="center"&gt;
            &lt;Grid item xs={6}&gt;
              &lt;Typography variant="h2"&gt;
                {pageContent.title}
              &lt;/Typography&gt;
              &lt;Typography variant="h3"&gt;
                {pageContent.tagline}
              &lt;/Typography&gt;
              &lt;Typography variant="body1"&gt;{pageContent.content}&lt;/Typography&gt;
              &lt;Button
                variant="contained"
                color="primary"
                onClick={() =&gt; router.push(pageContent.primaryButton.href)}
                role="link"
              &gt;
                {pageContent.primaryButton.text}
              &lt;/Button&gt;
            &lt;/Grid&gt;
            &lt;Grid item xs={6}&gt;
              &lt;img
                src={pageContent.image.url}
                alt={pageContent.image.label}
                height="360px"
                width="100%"
              /&gt;
            &lt;/Grid&gt;
          &lt;/Grid&gt;
        &lt;/Container&gt;
      }
    &lt;/&gt;
  );
};

// getServerSideProps() has been collapsed for readability.
</pre>
<p>在上面的代码中，您将收到的数据分成两个属性:<code>meta</code>和<code>data</code>。<code>meta</code>属性包含页面所有与SEO相关的数据，您可以在Agility CMS的页面SEO类别中设置这些数据。</p>
<p>如果你已经在你的应用中添加了meta标签，那么<a href="https://blog.logrocket.com/search-optimized-spas-react-helmet/" target="_blank" rel="noreferrer noopener">你可能对React头盔</a>比较熟悉。Next.js有自己的库，用于定制<code>&lt;head&gt;</code>标签:<code><a href="https://nextjs.org/docs/api-reference/next/head" target="_blank" rel="noreferrer noopener">next/head</a></code>。页面的所有元标签都可以放在<code>next/head</code>提供的<code>Head</code>组件中。</p>
<h2 id="adding-global-navigation-bar-next-js-app-component">向Next.js <code>App</code>组件添加全局导航栏</h2>
<p>当使用plain React时，您会非常熟悉<code>app.js</code>文件，它充当整个组件层次结构的入口点。Next.js项目也自带这样一个文件:<code>_app.js</code>。这个文件是为您预先生成的。</p>
<p>如果您想将整个应用程序包装在一个组件中，执行一些初始化操作，或者包含一些全局样式，那么<code>_app.js</code>文件就是完成这些工作的地方。这将是应用程序的<a href="https://nextjs.org/docs/advanced-features/custom-app" target="_blank" rel="noreferrer noopener">定制</a> <code><a href="https://nextjs.org/docs/advanced-features/custom-app" target="_blank" rel="noreferrer noopener">App</a></code> <a href="https://nextjs.org/docs/advanced-features/custom-app" target="_blank" rel="noreferrer noopener">组件。</a></p>
<p>让我们在您的<code>App</code>组件中添加一个导航栏:</p>
<pre class="language-javascript hljs">import '../styles/globals.css'

import AppBar from '@mui/material/AppBar';
import Toolbar from '@mui/material/Toolbar';
import Typography from '@mui/material/Typography';

function MyApp({ Component, pageProps }) {
  return (
    &lt;&gt;
      &lt;AppBar
        style={{ marginBottom: "50px" }}
        color="transparent"
        position="static"
      &gt;
        &lt;Toolbar&gt;
          &lt;Typography variant="h6"&gt;NextJS Blog&lt;/Typography&gt;
        &lt;/Toolbar&gt;
      &lt;/AppBar&gt;
      &lt;Component {...pageProps} /&gt;
    &lt;/&gt;
  )
}

export default MyApp
</pre>
<p><code>&lt;Component /&gt;</code>是页面组件，不可避免地会作为子组件加载到<code>App</code>组件中。理想情况下，<code>App</code>组件是您为应用程序添加一个<code>ThemeProvider</code>或一个Redux <code>&lt;Provider&gt;</code>的地方。</p>
<p>页面重新加载后，您应该会看到以下内容:</p>
<p><img data-attachment-id="119928" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/your-next-js-blog-frontend-populated-with-agility-cms-content/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png" data-orig-size="730,384" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Your-Next-js-blog-frontend-populated-with-Agility-CMS-content" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content-300x158.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png" decoding="async" class="aligncenter size-full wp-image-119928 jetpack-lazy-image" src="../Images/f30f67ab83b0aa57c9b00f8843650585.png" alt="Your Next.js Blog Frontend Populated With Agility CMS Content, Including Text And A Button On The Left And An Image On The Right" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content-300x158.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="119928" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/your-next-js-blog-frontend-populated-with-agility-cms-content/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png" data-orig-size="730,384" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Your-Next-js-blog-frontend-populated-with-Agility-CMS-content" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content-300x158.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-119928" src="../Images/f30f67ab83b0aa57c9b00f8843650585.png" alt="Your Next.js Blog Frontend Populated With Agility CMS Content, Including Text And A Button On The Left And An Image On The Right" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content-300x158.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Your-Next-js-blog-frontend-populated-with-Agility-CMS-content.png"/></noscript>
<h2 id="understanding-dynamic-routing-next-js">了解Next.js中的动态路由</h2>
<p>Next.js有一个非常强大的路由器，它是在考虑到各种用例的情况下精心构建的。如果您还记得，您创建了一个名为<code>[...slug].js</code>的文件。该文件利用了Next.js 的<a href="https://nextjs.org/docs/routing/introduction" target="_blank" rel="noreferrer noopener">动态路由特性，解决了多个用例:</a></p>
<pre class="language-javascript hljs">/page/[page-id].js will match with routes like /page/1 or /page/2, but not /page/1/2
/page/[...slug].js will match with routes like /page/1/2, but not /page/
/page/[[...slug]].js will match with routes like /page/1/2and /page/
</pre>
<p>需要记住的是，与特定路由参数同名的查询参数将被路由参数覆盖。例如，如果您有一条路由<code>/page/[id]</code>，那么在<code>/page/123?id=456</code>的情况下，ID将是123，而不是456。</p>
<p>现在您已经了解了Next.js动态路由，让我们来研究一下博客路由:</p>
<pre class="language-javascript hljs">import ErrorPage from "next/error";

import Container from '@mui/material/Container';
import Typography from '@mui/material/Typography';

import api from "../../lib/agility";

const BlogPostPage = ({ page }) =&gt; {

  if (!page) {
    return &lt;ErrorPage statusCode={404} /&gt;;
  }
  return (
    &lt;Container maxWidth="lg"&gt;
      &lt;Typography variant="h2"&gt;{page.fields.title}&lt;/Typography&gt;
      &lt;Typography variant="subtitle1"&gt;
        Written by: {page.fields.authorName} on{" "}
        {new Date(page.fields.date).toUTCString()}
      &lt;/Typography&gt;
      &lt;img
        style={{ maxWidth: "inherit", margin: "20px 0" }}
        src={page.fields.image.url}
        alt={page.fields.image.label}
      /&gt;
      &lt;div dangerouslySetInnerHTML={{ __html: page.fields.content }} /&gt;
    &lt;/Container&gt;
  );
};

export async function getServerSideProps(ctx) {
  const posts = await api.getContentList({
    referenceName: "posts",
    languageCode: "en-us"
  });

  const page = posts.items.find((post) =&gt; {
    return post.fields.slug === ctx.params.slug.join("/");
  });

  return {
    props: {
      page: page || null
    }
  };
}

export default BlogPostPage;
</pre>
<p><code>BlogPostPage</code>遵循与<code>HomePage</code>相同的概念和原则，除了这里使用了上下文对象(缩写为<code>ctx</code>)。</p>
<p><code>ctx</code>包含一些您可以利用的属性，包括<code>params</code>属性。<code>params</code>包含所有的路线参数及其值。</p>
<p>此外，您正在使用Agility CMS SDK中一个名为<code><a href="https://agilitydocs.netlify.app/agility-content-fetch-js-sdk/0.8.2/agilityfetch.client.content#.getContentList" target="_blank" rel="noreferrer noopener">getContentList()</a></code>的新方法。此方法允许您通过引用名称获取数据列表。</p>
<p>如果您导航到Agility CMS仪表板中的内容，然后选择博客文章，您将看到已经创建的文章列表，如下所示:</p>
<p><img data-attachment-id="119931" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/posts-already-created-under-content-tab-in-the-agility-cms-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png" data-orig-size="730,203" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png" decoding="async" class="aligncenter size-full wp-image-119931 jetpack-lazy-image" src="../Images/15860529157ebd89091fd8de9b9cbe3e.png" alt="You Should Be Able To See Posts You Have Already Created Under The Content Tab In The Agility CMS Dashboard" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard-300x83.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="119931" data-permalink="https://blog.logrocket.com/implementing-ssr-next-js-dynamic-routing-prefetching/attachment/posts-already-created-under-content-tab-in-the-agility-cms-dashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png" data-orig-size="730,203" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-119931" src="../Images/15860529157ebd89091fd8de9b9cbe3e.png" alt="You Should Be Able To See Posts You Have Already Created Under The Content Tab In The Agility CMS Dashboard" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard-300x83.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/Posts-already-created-under-Content-tab-in-the-Agility-CMS-dashboard.png"/></noscript>
<p>使用您接收到的数据，您可以使用数组高阶方法来查找一个post，该post具有与您声明为<code>slug</code>的路由器参数相等的slug。如果找到了，页面细节通过；否则，<code>null</code>作为道具传递。</p>
<p>Next.js不允许你把<code>undefined</code>当道具传。如果<code>page</code>道具是falsy，那么<code>BlogPostPage</code>会转而渲染内置的<code>ErrorPage</code>！</p>
<h2 id="common-use-case-dynamic-routing-next-js">处理Next.js中动态路由的常见用例</h2>
<p>很多时候，您希望在根本没有定义route参数的情况下显示一个特色帖子列表或某种内容—例如，<code>/blog/</code>。</p>
<p>您可以使用可选的动态路由的无所不包语法(<code>[[...slug]].js</code>)。但是，您必须检查废料路线参数是否未定义，并有条件地进行渲染。</p>
<p>更好的方法是在该route下声明一个<code>index.js</code>文件，这样当route参数没有定义时，它将指向这个文件。这是因为命名路由(即静态路由)的优先级高于动态路由。</p>
<p>例如，如果您已经声明了一个像<code>/blog/[id].js</code>这样的动态路由，但也声明了一个像<code>/blog/featured</code>这样的静态路由，那么Next.js将优先选择处理静态路由的文件，而不是处理动态路由的文件。</p>
<p>在<code>blog</code>目录下创建一个名为<code>index.js</code>的文件:</p>
<pre class="language-javascript hljs">import Link from "next/link";

import Card from '@mui/material/Card';
import CardActionArea from '@mui/material/CardActionArea';
import CardActions from '@mui/material/CardActions';
import CardContent from '@mui/material/CardContent';
import CardMedia from '@mui/material/CardMedia';

import Container from '@mui/material/Container';
import Typography from '@mui/material/Typography';
import Button from '@mui/material/Button';
import Grid from '@mui/material/Grid';

import api from "../../lib/agility";

const BlogPage = ({ posts }) =&gt; {
  console.log(posts)

  return (
    &lt;Container maxWidth="lg"&gt;
      &lt;Typography variant="h2" gutterBottom&gt;
        Featured Blog Posts
      &lt;/Typography&gt;
      &lt;Grid container spacing={2}&gt;
        {posts &amp;&amp; posts.map((post) =&gt; (
          &lt;Grid item xs={4}key={post.slug}&gt;
            &lt;Card&gt;
              &lt;CardActionArea&gt;
                &lt;CardMedia
                  style={{ height: "240px" }}
                  image={post.image.url}
                  title={post.image.label}
                /&gt;
                &lt;CardContent&gt;
                  &lt;Typography gutterBottom variant="h5" component="h2"&gt;
                    {post.title}
                  &lt;/Typography&gt;
                  &lt;Typography
                    variant="body2"
                    color="textSecondary"
                    component="p"
                  &gt;
                    Written on{" "}
                    {new Date(post.date).toUTCString()}
                  &lt;/Typography&gt;
                &lt;/CardContent&gt;
              &lt;/CardActionArea&gt;
              &lt;CardActions&gt;
                &lt;Link href="/blog/[...slug]" as={`/blog/${post.slug}`} prefetch&gt;
                  &lt;Button role="link" size="small" color="primary"&gt;
                    Read
                  &lt;/Button&gt;
                &lt;/Link&gt;
              &lt;/CardActions&gt;
            &lt;/Card&gt;
          &lt;/Grid&gt;
        ))}
      &lt;/Grid&gt;
    &lt;/Container&gt;
  );
};

export default BlogPage;

export async function getServerSideProps() {
  const posts = await api.getContentList({
    referenceName: "posts",
    languageCode: "en-us",
    take: 3
  });

  return {
    props: {
      posts: posts.items.map((post) =&gt; {
        const { title, slug, image, date } = post.fields;
        return { title, slug, image, date };
      })
    }
  };
}
</pre>
<p>就工作中的概念而言，这个页面或多或少与<code>BlogPostPage</code>相同，但是在这样的设置中，预取页面可能是有益的。如果您知道用户将访问这些页面，那么Next.js允许您提前获取这些页面。</p>
<p>为此，您应该使用通过<code>next/link</code>提供给您的<code>&lt;Link&gt;</code>组件。因为您正在使用动态路由，所以您应该使用包含路由参数值的<code>as</code>属性。</p>
<h2 id="imperative-dynamic-routing-next-js">使用Next.js的强制性动态路由</h2>
<p>对于Next.js路由，<code>&lt;Link/&gt;</code>组件非常方便。然而，需要注意的是Next.js提供了一个<code>useRouter</code>钩子来导航你的应用。除了<code>&lt;Link/&gt;</code>组件，您还可以执行以下操作:</p>
<pre class="language-javascript hljs">import { useRouter } from 'next/router'

const BlogPage = ({ posts }) =&gt; {
  const router = useRouter()

  return (
   {...}
    &lt;Button role="link" size="small" color="primary" onClick={() =&gt; router.push(`/blog/${post.slug}`)}&gt;
                  Read
    &lt;/Button&gt;
  {...}
  )
}
</pre>
<p>您还可以通过<a href="https://nextjs.org/docs/api-reference/next/router" target="_blank" rel="noreferrer noopener">接入Next.js路由器</a>并使用预取方法，以编程方式预取Next.js中的页面:</p>
<pre class="language-javascript hljs">import { useRouter} from "next/router";
import { useEffect } from "react";
// If you want to prefetch the contact page 
// while in the home page, you can do so like this

const HomePage = () =&gt; {
 const router = useRouter();
 useEffect(() =&gt; {
  router.prefetch('/contact');
 }, []);
 // ...
}
</pre>
<h2 id="next-js-dynamic-routing-multiple-segments">Next.js动态路由:多个段</h2>
<p>到目前为止，您已经在Next.js中发现了带有一个像<code>[…slug]</code>这样的段的动态路由。然而，这回避了一个问题:使用Next.js动态路由可以有多个段吗？谢天谢地，答案是肯定的！</p>
<p>您在Agility CMS中的博客文章目前链接到您博客的特定类别。你可以在内容&gt;博客类别中看到这些类别。</p>
<p>假设你想在你的URL中同时包含一个类别和一个slug。使用下面的示例，并遵循以下步骤:</p>
<pre class="language-javascript hljs">blog/travel-guide/virtual-tours-ways-to-travel-from-home</pre>
<p>首先，在你的博客文件夹中，创建一个<code>[category]</code>文件夹。像你的<code>[…slug].js</code>一样，这将允许你为你的所有类别拥有多条路线。</p>
<p>接下来，创建一个<code>[…slug].js</code>文件。在这个文件中，您可以从Next.js <code>ctx</code>对象中获取您的类别和slug参数:</p>
<pre class="language-javascript hljs">export async function getServerSideProps(ctx) {
  const { params } = ctx
  const { slug, category } = params

  //Grab your page

  return {
    props: {
      page: page || null
    }
  };
}
</pre>
<p>对于URL <code>/blog/travel-guide/virtual-tours-ways-to-travel-from-home</code>，您的参数应该是:</p>
<pre class="language-javascript hljs">params: {
  category: 'travel-guide',
  slug: [ 'virtual-tours-ways-to-travel-from-home' ]
}
</pre>
<h2 id="ssr-vs-ssg-next-js-making-best-choice">SSR vs. SSG在Next.js:做出最好的选择</h2>
<p>虽然当页面内容频繁变化时，Next.js中的SSR是最佳选择，但如果内容是静态的，Next.js中的SSG将是更好的选择。</p>
<p>也就是说，如果页面的大部分内容是静态的，您不必一下子就跳到服务器端呈现。更好的方法是通过使用Next.js为数据获取定制的钩子，像 <code><a href="https://blog.logrocket.com/caching-clash-useswr-vs-react-query/" target="_blank" rel="noreferrer noopener">useSWR</a></code> <a href="https://blog.logrocket.com/caching-clash-useswr-vs-react-query/">这样的</a><a href="https://blog.logrocket.com/caching-clash-useswr-vs-react-query/" target="_blank" rel="noreferrer noopener">，或者像React Query </a>这样的库，来使用客户端数据获取。</p>
<h2 id="conclusion">结论</h2>
<p>虽然您构建的应用程序还远未准备好投入生产，但您现在应该对Next.js的工作方式以及Agility CMS如何帮助您满足内容管理需求有了相当深入的了解。</p>
<p>如果你想更深入地研究Next.js，一定要查看Next.js 的<a href="https://nextjs.org/learn/basics/create-nextjs-app" target="_blank" rel="noreferrer noopener">分步教程。如果你想看看一个更适合生产的敏捷CMS和Next.js组合会是什么样子，看看这个</a><a href="https://github.com/vercel/next.js/tree/canary/examples/cms-agilitycms" target="_blank" rel="noreferrer noopener">范例库</a>。</p><div class="code-block code-block-30">
<div class="blog-plug inline-plug next-plug"><h2><a href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank"> LogRocket </a>:全面了解生产Next.js应用</h2><p>调试下一个应用程序可能会很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪状态、自动显示JavaScript错误、跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" data-lazy-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/></noscript></a><a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a><p>LogRocket 就像是网络和移动应用的DVR，记录下你的Next.js应用上发生的一切。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。LogRocket还可以监控应用程序的性能，报告客户端CPU负载、客户端内存使用等指标。</p><p>LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p><p>让您调试Next.js应用的方式现代化— <a class="signup" href="https://lp.logrocket.com/blg/nextjs-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div></div>

<p class="clearfix"/>
 <p class="clearfix"/>
</article>

</div>    
</body>
</html>