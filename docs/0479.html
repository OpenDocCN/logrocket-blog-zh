<html>
<head>
<title>4 alternatives to Moment.js for internationalizing dates - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>约会国际化的4种Moment.js替代方案</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/4-alternatives-to-moment-js-for-internationalizing-dates/#0001-01-01">https://blog.logrocket.com/4-alternatives-to-moment-js-for-internationalizing-dates/#0001-01-01</a></blockquote><div><article class="article-post">
<p>当准备在不同语言中使用的应用程序时，日期格式是最重要的方面之一。</p>
<p>Moment.js 是最常用的JavaScript库之一，用于格式化和操作我们可以用于此目的的日期。然而，在某些情况下，关于这个库的一些事情<a href="https://inventi.studio/en/blog/why-you-shouldnt-use-moment-js" target="_blank" rel="noopener noreferrer">(比如它的大小或者它的构造方式)可能会让你想知道是否有其他的选择。</a></p>
<p>在本文中，我将回顾关于日期国际化的Moment.js的四种替代方案:</p>

<p>我将着重于将日期转换为不同地区的不同格式的字符串，包括相对时间。</p>
<p>让我们从JavaScript国际化API开始。</p>
<h2>JavaScript国际化API</h2>
<p><code>Intl</code>是一个全局对象，充当ECMAScript国际化API的名称空间。关于日期，该对象提供了以下构造函数:</p>
<ul>
<li><code>Intl.DateTimeFormat</code>，提供日期和时间格式</li>
<li><code>Intl.RelativeTimeFormat</code>，它为日期和时间戳提供了语言敏感的易读短语</li>
</ul>
<p>这些构造函数有两个可选参数，一个是locale，另一个是带有自定义输出选项的对象。例如:</p>
<pre>let rtf = new Intl.RelativeTimeFormat('en-GB', { style: 'long' });
let dtf = new Intl.DateTimeFormat('de');</pre>
<p>区域设置参数是一个表示<a href="https://github.com/libyal/libfwnt/wiki/Language-Code-identifiers" target="_blank" rel="noopener noreferrer"> BCP 47语言标签</a>的字符串，由以下部分组成:</p>
<ul>
<li>语言代码(<a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank" rel="noopener noreferrer">T2/639-2【ISO 639-1】)。例如，<code>el</code>(现代希腊语)</a></li>
<li>脚本代码(<a href="https://unicode.org/iso15924/iso15924-codes.html" target="_blank" rel="noopener noreferrer">T2【ISO 15924】)。例如，<code>Grek</code>(希腊语)</a></li>
<li>国家代码(<a href="https://en.wikipedia.org/wiki/List_of_ISO_3166_country_codes" target="_blank" rel="noopener noreferrer">T2【ISO 3166】)。例如，<code>GR</code>(希腊)</a></li>
<li>变体(来自<a href="https://www.iana.org/assignments/language-subtag-registry/language-subtag-registry" target="_blank" rel="noopener noreferrer">iana.org</a>，搜索“类型:变体”)。例如，<code>polyton</code>(多音希腊文)</li>
<li>扩展(来自Unicode，更多信息<a href="https://www.w3.org/International/multilingualweb/dublin/slides/23b-davis.pdf" target="_blank" rel="noopener noreferrer">此处</a>)。例如，<code>u-nu-native</code>(原生数字)</li>
</ul>
<p>以下是一个包含所有部件的示例:</p>
<pre>let rtf = new Intl.RelativeTimeFormat('el-Grek-GR-polyton-u-nu-native');</pre>
<p>只有第一部分(语言代码)是必需的，您可以传递一个字符串数组来定义后备语言:</p>
<pre>// Requests Dutch as the primary language and if it is not available, it requests french
let dtf = new Intl.DateTimeFormat(['nl', 'fr'])</pre>
<p>如果没有提供区域设置，则使用运行时环境的区域设置。</p>
<p>关于第二个参数，options对象，它因构造函数而异。</p>
<p><code>Intl.DateTimeFormat</code>接受诸如日期样式(<code>full</code>、<code>long</code>、<code>medium</code>和<code>short</code>)的选项，是使用12小时制还是24小时制，或者格式化一天中各部分的表示，如年、月、工作日等。</p>
<p>在Intl的<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat#Syntax" target="_blank" rel="noopener noreferrer">文档页面中。DateTimeFormat </a>，您可以了解更多关于您可以用来定制该对象的所有选项。</p>
<p>关于<code>Intl.RelativeTimeFormat</code>，选项对象只有以下属性:</p>
<ul>
<li><code>localeMatcher</code>，要使用的区域设置匹配算法。可能的值是<code>lookup</code>(从更具体到不太具体，如果<code>en-us</code>不可用，则选择<code>en</code>)和<code>best fit</code>(默认值，如果<code>en-us</code>不可用，则可以选择类似于<code>en-uk</code>的值)</li>
<li><code>numeric</code>，对输出信息进行格式化。可能的值是<code>always</code>(例如，<code>2 hours ago</code>)或<code>auto</code>，这并不总是允许输出中有数值(例如，<code>yesterday</code>)</li>
<li><code>style</code>，对输出报文的长度进行格式化。可能的值有<code>long</code>、<code>short</code>和<code>narrow</code></li>
</ul>
<p>一旦有了类型为<code>Intl.DateTimeFormat</code>或<code>Intl.RelativeTimeFormat</code>的对象，就可以使用方法<code>format()</code>或<code>formatToParts()</code>(返回包含输出部分的数组)来格式化日期。</p>
<p>在<code>Intl.DateTimeFormat</code>的情况下，这些方法接受<code>Date</code>对象进行格式化:</p>
<pre>const date = new Date(Date.UTC(2014, 8, 19, 14, 5, 0));
const options = {
   dateStyle: 'short',
   timeStyle: 'full',
   hour12: true,
   day: 'numeric',
   month: 'long',
   year: '2-digit',
   minute: '2-digit',
   second: '2-digit',
};
// Sample output: 19 septembre 14 à 05:00
console.log(new Intl.DateTimeFormat("fr", options).format(date));
// Sample output: 19. September 14, 05:00
console.log(new Intl.DateTimeFormat("de-AT", options).format(date));
/* Sample output: [{"type":"day","value":"19"},{"type":"literal","value":" "},{"type":"month","value":"settembre"},{"type":"literal","value":" "},{"type":"year","value":"14"},{"type":"literal","value":", "},{"type":"minute","value":"05"},{"type":"literal","value":":"},{"type":"second","value":"00"}] */
console.log(new Intl.DateTimeFormat("it", options).formatToParts(date));</pre>
<p>请注意，如果您仅在options对象中指定了几个日期时间组件，这些组件将出现在输出中:</p>
<pre>const date = new Date(Date.UTC(2014, 08, 19, 14, 5, 0));
const options = {
   year: '2-digit',
};
// Output: 14
console.log(new Intl.DateTimeFormat("en", options).format(date));</pre>
<p>在使用<code>Intl.RelativeTimeFormat</code>的情况下，<code>format()</code>使用消息中使用的数值和第二个参数来表示该值的单位(如<code>year</code>或<code>second</code>，可以是单数或复数形式):</p>
<pre>const options = {
   localeMatcher: 'best fit',
   numeric: 'auto',
   style: 'short',
};
// Output: last mo.
console.log(new Intl.RelativeTimeFormat("en-CA", options).format(-1, 'month'));
// Output: la semana pasada
console.log(new Intl.RelativeTimeFormat("es-ES", options).format(-1, 'week'));
/* Output: [{"type":"integer","value":"60","unit":"minute"},{"type":"literal","value":" 分鐘前"}] */
console.log(new Intl.RelativeTimeFormat("zh-TW", options).formatToParts(-60, 'minutes'));</pre>
<p>另外，请注意对<code>numeric</code>属性使用<code>always</code>和<code>auto</code>值的区别:</p>
<pre>// Output: in 0 days
console.log(new Intl.RelativeTimeFormat("en", {numeric: 'always'}).format(0, 'day'));
// Output: today
console.log(new Intl.RelativeTimeFormat("en", {numeric: 'auto'}).format(0, 'day'));</pre>
<p>你可以尝试修改上面所有的例子<a href="https://codesandbox.io/s/intl-datetimeformat-example-e32u4" target="_blank" rel="noopener noreferrer">这里</a>和<a href="https://codesandbox.io/s/intl-relativetimeformat-example-5xy7l" target="_blank" rel="noopener noreferrer">这里</a>，但是根据你使用的浏览器，你可能会得到一些错误。</p>
<p><code>Intl.DateTimeFormat</code>的大部分功能在现代浏览器中都得到了很好的支持(更多信息<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat#Browser_compatibility" target="_blank" rel="noopener noreferrer">在这里</a>)，然而，<code>Intl.RelativeTimeFormat</code>只有Chrome 71和Firefox 70才完全支持(在撰写本文时Safari或Edge还不支持)。</p>
<p>你可以使用<a href="https://github.com/catamphetamine/relative-time-format" target="_blank" rel="noopener noreferrer">多边形填充</a>，但是你必须以不同的方式创建对象:</p>
<pre>const myLocale = /* Import JSON file for the choosen locale */;
const localeTag = /* Tag for the above locale */;
const options = { /* Options object */ };
RelativeTimeFormat.addLocale(myLocale);
new RelativeTimeFormat(localeTag, options).format(3, 'day');</pre>
<p>你可以试试这个例子<a href="https://codesandbox.io/s/intl-relativetimeformat-polyfill-example-eq2y9" target="_blank" rel="noopener noreferrer">这里</a>。</p>
<p>所以你可以看到，<code>Intl.RelativeTimeFormat</code>类似于<code>moment.duration().humanize()</code>:</p>
<pre>moment.duration(-1, 'weeks').humanize(true); // a week ago</pre>
<p>如果您习惯于像Moment.js那样计算从现在开始的相对时间或相对于给定参考时间的日历时间:</p>
<pre>moment('20140919', 'YYYYMMDD').fromNow(); // 5 years ago
moment().add(5, 'days').calendar(); // Tuesday at 1:15 PM</pre>
<p>您需要手动计算两个日期之间的<a href="https://stackoverflow.com/questions/3224834/get-difference-between-2-dates-in-javascript" target="_blank" rel="noopener noreferrer">差。</a></p>
<p>没有什么比使用原生特性更好的了，但是如果这成为一个问题，还有其他的选择。</p>
<h2>勒克斯</h2>
<p>Luxon是由Moment的一个维护者创建的一个库<a href="https://github.com/moment/luxon/blob/master/docs/why.md" target="_blank" rel="noopener noreferrer">，所以它借鉴了它的许多想法，同时在某些方面提供了改进。</a></p>
<p>出于国际化的目的，您可以将Luxon视为<code>Intl.DateTimeFormat</code>和<code>Intl.RelativeTimeFormat</code>的包装器。</p>
<p>例如，根据地区设置日期格式的一种方法是首先设置地区，然后使用方法<code>toFormat(fmt:string, opts: Object)</code>和来自<a href="https://moment.github.io/luxon/docs/manual/formatting.html#table-of-tokens" target="_blank" rel="noopener noreferrer">这个表</a>的日期时间标记:</p>
<pre>// Sample output: 2019 сентябрь
console.log(DateTime.local().setLocale('ru').toFormat('yyyy MMMM'));</pre>
<p>您还可以在options对象中传递该方法可以作为参数的区域设置:</p>
<pre>// Output: 2019 сентябрь
console.log(DateTime.local(2018, 9, 1).toFormat('yyyy MMMM', { locale: "ru" }));</pre>
<p>或者，如果您使用的方法是来自Object 的<a href="https://moment.github.io/luxon/docs/class/src/datetime.js~DateTime.html#static-method-fromObject" target="_blank" rel="noopener noreferrer">、来自ISO </a>的<a href="https://moment.github.io/luxon/docs/class/src/datetime.js~DateTime.html#static-method-fromISO" target="_blank" rel="noopener noreferrer">、来自HTTP </a>的<a href="https://moment.github.io/luxon/docs/class/src/datetime.js~DateTime.html#static-method-fromHTTP" target="_blank" rel="noopener noreferrer">、来自Format </a>的<a href="https://moment.github.io/luxon/docs/class/src/datetime.js~DateTime.html#static-method-fromFormat" target="_blank" rel="noopener noreferrer">或来自RFC2822 </a>的<a href="https://moment.github.io/luxon/docs/class/src/datetime.js~DateTime.html#static-method-fromRFC2822" target="_blank" rel="noopener noreferrer">，您可以在创建时设置区域设置:</a></p>
<pre>const italianDate = DateTime.fromISO("2014-09-19", { locale: "it" });
// Output: 2014 settembre 19
console.log(italianDate.toFormat("yyyy MMMM dd"));</pre>
<p>然而，推荐的方法是使用方法<code>toLocaleString()</code>和<code>toLocaleParts()</code>，它们分别返回表示日期的本地化字符串和包含字符串各个部分的数组。</p>
<p>这些方法相当于<code>Intl.DateTimeFormat</code>的<code>format()</code>和<code>formatToParts()</code>方法，实际上它们采用相同的options对象(以及一些预置，如<code>DateTime.DATE_SHORT</code>、<a href="https://moment.github.io/luxon/docs/manual/formatting.html#presets" target="_blank" rel="noopener noreferrer">等等</a>):</p>
<pre>const date = DateTime.utc(2014, 9, 1, 14, 5, 0);
const options = {
  dateStyle: "short",
  timeStyle: "full",
  hour12: true,
  day: "numeric",
  month: "long",
  year: "2-digit",
  minute: "2-digit",
  second: "2-digit"
};
// Output: 1 septembre 14 à 05:00 
console.log(date.setLocale("fr").toLocaleString(options));
// Output: 1. September 14, 05:00 
console.log(date.setLocale("de-AT").toLocaleString(options));
/* Output: [{"type":"day","value":"1"},{"type":"literal","value":" "},{"type":"month","value":"settembre"},{"type":"literal","value":" "},{"type":"year","value":"14"},{"type":"literal","value":", "},{"type":"minute","value":"05"},{"type":"literal","value":":"},{"type":"second","value":"00"}] */
console.log(
  JSON.stringify(date.setLocale("it").toLocaleParts(options), null, 3)
);
// Output: 2:05 PM
console.log(date.toLocaleString(DateTime.TIME_SIMPLE));
// Output: 01/09/2014 
console.log(date.toLocaleString({ locale: 'pt' }));</pre>
<p>这意味着:</p>
<ul>
<li>Luxon可以使用与<code>Intl</code>对象相同的<a href="https://tools.ietf.org/html/rfc5646" target="_blank" rel="noopener noreferrer"> BCP 47 </a>区域设置字符串进行配置</li>
<li>如果<code>Intl</code>对象在目标浏览器中不可用，这部分库将无法正常工作(对于Node.js应用程序，您可能需要采取<a href="https://moment.github.io/luxon/docs/manual/install.html#node" target="_blank" rel="noopener noreferrer">一些额外的步骤来设置库</a></li>
<li>关于国际化，Luxon充当JavaScript国际化API的包装器，但是它在<code>DateTime</code> Luxon对象的级别上设置语言环境(更多信息<a href="https://moment.github.io/luxon/docs/manual/intl.html" target="_blank" rel="noopener noreferrer">在这里</a></li>
</ul>
<p>另一方面，方法<a href="https://moment.github.io/luxon/docs/class/src/datetime.js~DateTime.html#instance-method-toRelative" target="_blank" rel="noopener noreferrer"> toRelative </a>(默认情况下，返回相对于现在的给定时间的字符串表示)和<a href="https://moment.github.io/luxon/docs/class/src/datetime.js~DateTime.html#instance-method-toRelativeCalendar" target="_blank" rel="noopener noreferrer"> toRelativeCalendar </a>(默认情况下，返回相对于今天的给定日期的字符串表示)提供了类似于<code>Intl.RelativeTimeFormat</code>的功能:</p>
<pre>// Sample output: in 23 hours 
console.log(DateTime.local().plus({ days: 1 }).toRelative());
// Sample output: tomorrow
console.log(DateTime.local().plus({ days: 1 }).toRelativeCalendar());
// Sample output: in 1 Tag 
console.log(DateTime.local().plus({ days: 1 }).toRelative({ locale: "de" }));
// Sample output: morgen 
console.log(DateTime.local().plus({ days: 1 }).toRelativeCalendar({ locale: "de" }));
// Sample output: il y a 1 semaine 
console.log(DateTime.local().setLocale("fr").minus({ days: 9 }).toRelative({ unit: "weeks" }));
// Sample output: la semaine dernière 
console.log(DateTime.local().setLocale("fr").minus({ days: 9 }).toRelativeCalendar({ unit: "weeks" }));</pre>
<p>与<code>Intl.RelativeTimeFormat</code>不同，如果你的浏览器不支持这个API，上述方法不会抛出错误，唯一的问题是它们不会被翻译成合适的语言。</p>
<p>你可以试试上面所有的例子<a href="https://codesandbox.io/s/luxon-example-gmi98" target="_blank" rel="noopener noreferrer">这里</a>。</p>
<h2>Date-fns</h2>
<p><a href="https://date-fns.org" target="_blank" rel="noopener noreferrer"> Date-fns </a>是另一个流行的用于日期处理和格式化的JavaScript库。在撰写本文时最新的版本2仅以<a href="https://date-fns.org/v2.2.1/docs/Getting-Started#installation" target="_blank" rel="noopener noreferrer"> NPM包</a>的形式出现，所以如果你想在浏览器中直接使用它，你必须使用像<a href="http://browserify.org" target="_blank" rel="noopener noreferrer"> Browserify </a>这样的捆绑器。</p>
<p>这个库包含大约60个不同的区域(这里<a href="https://github.com/date-fns/date-fns/tree/master/src/locale" target="_blank" rel="noopener noreferrer">你可以看到所有的区域)。要使用一个或多个语言环境，您需要像这样导入它们:</a></p>
<pre>import { es, enCA, it, ptBR } from 'date-fns/locale'</pre>
<p>接受区域设置作为参数的函数如下:</p>
<ul>
<li><a href="https://date-fns.org/v2.2.1/docs/format" target="_blank" rel="noopener noreferrer"> format </a>，它返回格式化的日期，将日期、表示格式化日期的模式的字符串(基于<a href="https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table" target="_blank" rel="noopener noreferrer"> Unicode技术标准#35 </a>的日期字段符号)以及带有区域设置和一周第一天的索引等选项的对象作为参数</li>
<li><a href="https://date-fns.org/v2.2.1/docs/formatDistance" target="_blank" rel="noopener noreferrer"> formatDistance </a>，它返回给定日期之间的距离(以文字表示)，将要比较的日期和一个带有区域设置或是否包含秒等选项的对象作为参数</li>
<li><a href="https://date-fns.org/v2.2.1/docs/formatDistanceToNow" target="_blank" rel="noopener noreferrer"> formatDistanceToNow </a>与<code>formatDistance</code>相同，但只取一个日期(将与现在进行比较)</li>
<li><a href="https://date-fns.org/v2.2.1/docs/formatDistanceStrict" target="_blank" rel="noopener noreferrer">格式距离限制</a>与<code>formatDistance</code>相同，但是没有使用<code>almost</code>、<code>over</code>或<code>less than</code>这样的助手。options对象具有强制时间单位和指定部分单位舍入方式的属性</li>
<li><a href="https://date-fns.org/v2.2.1/docs/formatRelative" target="_blank" rel="noopener noreferrer"> formatRelative </a>，用文字表示相对于给定基准日期的日期。它还可以接受一个options对象作为参数，来设置一周第一天的区域设置和索引</li>
</ul>
<p>以下是一些例子:</p>
<pre>import {
   format,
   formatDistance,
   formatDistanceToNow,
   formatDistanceStrict,
   formatRelative,
   addDays
 } from "date-fns";
 import { es, enCA, ro, it, ptBR } from "date-fns/locale";

 // Output: septiembre / 19
 console.log(format(new Date(), "MMMM '/' yy", { locale: es }));
 // Output: in less than 10 seconds
 console.log(
   formatDistance(
     new Date(2019, 8, 1, 0, 0, 15),
     new Date(2019, 8, 1, 0, 0, 10),
     { locale: enCA, includeSeconds: true, addSuffix: true }
   )
 );
 // Output: less than 10 seconds ago
 console.log(
   formatDistance(
     new Date(2019, 8, 1, 0, 0, 10),
     new Date(2019, 8, 1, 0, 0, 15),
     { locale: enCA, includeSeconds: true, addSuffix: true }
   )
 );
 // Output: circa 15 ore (assuming now is 9/20/2019 15:00)
 console.log(formatDistanceToNow(new Date(2019, 8, 20), { locale: ro }));
 // Output: 0 minuti
 console.log(
   formatDistanceStrict(
     new Date(2019, 8, 1, 0, 0, 15),
     new Date(2019, 8, 1, 0, 0, 10),
     { locale: it, unit: "minute" }
   )
 );
 // Output: un minuto
 console.log(
   formatDistanceStrict(
     new Date(2019, 8, 1, 0, 0, 10),
     new Date(2019, 8, 1, 0, 0, 15),
     { locale: it, unit: "minute", roundingMethod: "ceil" }
   )
 );
 // Output: amanhã às 14:48
 console.log(formatRelative(addDays(new Date(), 1), new Date(), { locale: ptBR }));</pre>
<p><code>formatRelative</code>通常与助手一起使用，以增加或减少不同的时间单位，如<a href="https://date-fns.org/v2.2.1/docs/addWeeks" target="_blank" rel="noopener noreferrer">增加周数</a>、<a href="https://date-fns.org/v2.2.1/docs/subMonths" target="_blank" rel="noopener noreferrer">子月数</a>、<a href="https://date-fns.org/v2.2.1/docs/addQuarters" target="_blank" rel="noopener noreferrer">增加季度数</a>等等。</p>
<p>另外，如果日期之间的距离超过六天，<code>formatRelative</code>将返回作为第一个参数给出的日期:</p>
<pre>// If today is September 20, 2019 the output will be 27/09/2019
console.log(formatRelative(addDays(new Date(), 7), new Date(), { locale: ptBR }));</pre>
<p>你可以试试上面所有的例子<a href="https://codesandbox.io/s/date-fns-example-pvkpn" target="_blank" rel="noopener noreferrer">这里</a>。</p>
<h2>天天网</h2>
<p>Day.js是Moment.js 的一个轻量级库<a href="https://garbagevalue.com/blog/dayjs-the-best-lightweight-alternative-to-momentjs" target="_blank" rel="noopener noreferrer">。</a></p>
<p>默认情况下，Day.js附带美国英语区域设置。要使用其他语言环境，您需要像这样导入它们:</p>
<pre>import 'dayjs/locale/pt';
import localeDe from 'dayjs/locale/de'; // With a custom alias for the locale object

dayjs.locale('pt') // use Portuguese locale globally
// To use the locale just in certain places
console.log(
  dayjs()
    .locale(localeDe)
    .format()
);
console.log( dayjs('2018-4-28', { locale: 'pt' }) );</pre>
<p>在这里你可以找到所有支持的语言环境列表。</p>
<p>在上面的例子中，<a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/API-reference.md#format-formatstringwithtokens-string"> format() </a>方法返回一个带有格式化日期的字符串。它可以接受一个带有标记的字符串，以特定的方式格式化日期:</p>
<pre>// Sample output: September 2019, Samstag
console.log(
  dayjs()
    .locale(localeDe)
    .format('MMMM YYYY, dddd')
);</pre>
<p><a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/API-reference.md#list-of-all-available-formats" target="_blank" rel="noopener noreferrer">这里的</a>是所有可用格式的列表。</p>
<p>然而，Day.js的许多高级功能来自于<a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/Plugin.md" target="_blank" rel="noopener noreferrer">插件</a>，你可以根据自己的需要加载这些插件。例如，<a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/Plugin.md#utc" target="_blank" rel="noopener noreferrer"> UTC </a>插件添加了获取UTC和当地时间日期的方法:</p>
<pre>import dayjs from "dayjs";
import utc from "dayjs/plugin/utc";

dayjs.extend(utc);

console.log(dayjs.utc().format()); // Sample output: 2019-09-21T11:31:55Z</pre>
<p>关于国际化，我们可以使用<a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/Plugin.md#advancedformat" target="_blank" rel="noopener noreferrer">高级格式</a>、<a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/Plugin.md#localizedformat" target="_blank" rel="noopener noreferrer">本地化格式</a>、<a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/Plugin.md#relativetime" target="_blank" rel="noopener noreferrer">相对时间</a>和<a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/Plugin.md#calendar" target="_blank" rel="noopener noreferrer">日历</a>插件。</p>
<p>AdvancedFormat和LocalizedFormat插件为<code>format()</code>方法增加了更多的格式选项(你可以在<a href="https://github.com/iamkun/dayjs/blob/dev/docs/en/Plugin.md#advancedformat" target="_blank" rel="noopener noreferrer">插件文档页面</a>中看到所有选项):</p>
<pre>// ...

// Plugins
import advancedFormat from "dayjs/plugin/advancedFormat";
import localizedFormat from "dayjs/plugin/localizedFormat";

// Load plugins
dayjs.extend(advancedFormat);
dayjs.extend(localizedFormat);

// Advanced format options
// If today is 2019/09/21 at 12:00 PM, the output will be 3 21º 12 12 1569087454 1569087454869
console.log(
  dayjs()
    .locale("pt")
    .format("Q Do k kk X x")
);
// Localized format options
// If today is 2019/09/21 at 12:00 PM, the output will be Sábado, 21 de Setembro de 2019 às 12:00 
console.log(
  dayjs()
    .locale("pt")
    .format("LLLL")
);</pre>
<p><code>RelativeTime</code>插件增加了将日期格式化为相对时间字符串的方法:</p>
<ul>
<li><code>.fromNow(withoutSuffix?: boolean)</code>返回一个表示从现在开始的相对时间的字符串</li>
<li><code>.from(compared: Dayjs, withoutSuffix?: boolean)</code>返回一个表示从X开始的相对时间的字符串</li>
<li><code>.toNow(withoutSuffix?: boolean)</code>返回一个表示到现在的相对时间的字符串</li>
<li><code>.to(compared: Dayjs, withoutSuffix?: boolean)</code>返回表示相对于X的时间的字符串</li>
</ul>
<p>以下是一些例子:</p>
<pre>// ...
import relativeTime from "dayjs/plugin/relativeTime";

// Load plugin
dayjs.extend(relativeTime);

// Assuming now is 2019-09-21 at 12:00 PM
// Output: in einem Jahr 
console.log(
  dayjs()
    .locale(localeDe)
    .from(dayjs("2018-09-21"))
);
// Output: einem Jahr 
console.log(
  dayjs()
    .locale(localeDe)
    .from(dayjs("2018-09-21"), true)
);
// Output: vor einem Jahr 
console.log(
  dayjs("2018-09-21")
    .locale(localeDe)
    .fromNow()
);
// Output: vor 2 Jahren 
console.log(
  dayjs("2018-09-21")
    .locale(localeDe)
    .to(dayjs("2016-09-21"))
);
// Output: vor 11 Jahren 
console.log(
  dayjs("2030-09-21")
    .locale(localeDe)
    .toNow()
);</pre>
<p>日历插件添加了<code>.calendar</code>方法来显示日历时间(七天内)。它似乎没有本地化输出:</p>
<pre>// ...
import calendar from "dayjs/plugin/calendar";

// Load plugin
dayjs.extend(calendar);

// Assuming now is 2019-09-21 at 12:00 PM
// Output: Yesterday at 12:00 PM
console.log(
  dayjs()
    .locale('pt')
    .calendar(dayjs("2019-09-22"))
);</pre>
<p>但是，它允许您使用字符串文字(用方括号括起来)和日期时间格式标记来手动定制同一天、第二天、上周末和下周的输出标签，以及其他任何内容:</p>
<pre>// Assuming now is 2019-09-21 at 12:00 PM
// The output is Hoje às 12:00
console.log(
  dayjs().calendar(dayjs("2019-09-21"), {
    sameDay: "[Hoje às] h:m",
    nextDay: "[Amanhã]",
    nextWeek: "dddd",
    lastDay: "[Ontem]",
    lastWeek: "[Último] dddd",
    sameElse: "DD/MM/YYYY"
  })
);</pre>
<p>你可以试试上面所有的例子<a href="https://codesandbox.io/s/dayjs-example-cgg4f" target="_blank" rel="noopener noreferrer">这里</a>。</p>
<h2>结论</h2>
<p>对于数据处理来说，Moment.js是一个健壮而成熟的库，但是，对于某些项目来说，它可能有些矫枉过正。在本文中，我比较了四个流行的库在国际化环境中处理日期格式的方式。</p>
<p>JavaScript国际化API提供的特性对于简单的用例来说可能已经足够了，但是如果您需要一个更高级别的API(例如，相对时间)和其他特性，比如时区或用于增加或减少时间单位的辅助方法，您可能需要考虑本文中讨论的其他库。</p>
<p>最后，这里有一些您可能会觉得有用的链接:</p>

<p>编码快乐！</p><div class="code-block code-block-27">
<div class="blog-plug inline-plug vanilla-javascript-cta"><h2>通过理解上下文，更容易地调试JavaScript错误</h2>
<p>调试代码总是一项单调乏味的任务。但是你越了解自己的错误，就越容易改正。</p>
<p>LogRocket 让你以新的独特的方式理解这些错误。我们的前端监控解决方案跟踪用户与您的JavaScript前端的互动，让您能够准确找出导致错误的用户行为。</p>
<a href="https://lp.logrocket.com/blg/javascript-signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/cbfed9be3defcb505e662574769a7636.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/cbfed9be3defcb505e662574769a7636.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif"/></noscript></a>
<p>LogRocket记录控制台日志、页面加载时间、堆栈跟踪、慢速网络请求/响应(带有标题+正文)、浏览器元数据和自定义日志。理解您的JavaScript代码的影响从来没有这么简单过！</p>
<a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">Try it for free</a><p>.</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>