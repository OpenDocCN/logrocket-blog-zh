<html>
<head>
<title>Make React Fast Again [Part 1]: Performance Timeline - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>再次快速反应[第1部分]:性能时间表</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/make-react-fast-again-part-1-performance-timeline-f7f39f676f58/#0001-01-01">https://blog.logrocket.com/make-react-fast-again-part-1-performance-timeline-f7f39f676f58/#0001-01-01</a></blockquote><div><div class="section-content">
<div class="section-inner sectionLayout--insetColumn">
<h3 class="graf graf--h3">绩效时间表</h3>
<p class="graf graf--p">React 15.4.0引入了一个新的性能时间线特性，可以让您准确地看到组件何时被挂载、更新和卸载。它还允许您可视化组件生命周期之间的相互关系。</p>
<p class="graf graf--p"><strong class="markup--strong markup--p-strong">注意:</strong>目前，该功能仅在Chrome、Edge和IE中有效，因为它利用了尚未在所有浏览器中实现的用户定时API。</p>
<h4 class="graf graf--h4">它是如何工作的</h4>
<ol class="postList">
<li class="graf graf--li">打开您的应用程序并追加查询参数:<code>react_perf</code>。例如，<code><a class="markup--anchor markup--li-anchor" href="http://localhost:3000?react_perf" target="_blank" rel="noopener noreferrer" data-href="http://localhost:3000?react_perf">http://localhost:3000?react_perf</a></code></li>
<li class="graf graf--li">打开Chrome DevTools<strong class="markup--strong markup--li-strong">Performance</strong>选项卡，按下<strong class="markup--strong markup--li-strong"> Record </strong>。</li>
<li class="graf graf--li">执行您想要分析的操作。</li>
<li class="graf graf--li">停止记录。</li>
<li class="graf graf--li">在<strong class="markup--strong markup--li-strong">用户计时下检查可视化。</strong></li>
</ol>
</div>
<div class="section-inner sectionLayout--outsetColumn">
<figure class="graf graf--figure graf--layoutOutsetCenter"><img decoding="async" class="graf-image jetpack-lazy-image" src="../Images/b1d97577f57de1a0ef654ee2ab33c739.png" data-image-id="1*cOO5vUnbkdDUcqMW8ebJqA.png" data-width="1910" data-height="946" data-is-featured="true" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*cOO5vUnbkdDUcqMW8ebJqA.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://storage.googleapis.com/blog-images-backup/1*cOO5vUnbkdDUcqMW8ebJqA.png"/><noscript><img data-lazy-fallback="1" decoding="async" class="graf-image" src="../Images/b1d97577f57de1a0ef654ee2ab33c739.png" data-image-id="1*cOO5vUnbkdDUcqMW8ebJqA.png" data-width="1910" data-height="946" data-is-featured="true" data-original-src="https://storage.googleapis.com/blog-images-backup/1*cOO5vUnbkdDUcqMW8ebJqA.png"/></noscript></figure>
</div>
<div class="section-inner sectionLayout--insetColumn">
<h4 class="graf graf--h4">了解输出</h4>
<p class="graf graf--p">每个彩色条显示组件正在“工作”的时间。由于JavaScript是单线程的，每当组件被装载或渲染时，它就会霸占主线程并阻止其他代码运行。</p>
<p class="graf graf--p">括号中的文本描述了组件生命周期的哪一部分正在发生。时间线分解了每一步，所以你可以看到像<code>[componentDidMount]</code> <code>[componentWillReceiveProps]</code> <code>[ctor]</code>(构造函数)和<code>[render].</code>这样的方法的细粒度计时</p>
<p class="graf graf--p">堆叠的条形表示组件树。虽然React中通常有相当深的组件树，但如果您正在优化一个频繁挂载的组件，这有助于减少包装器组件的数量，因为每个组件都会增加少量的性能和内存损失。</p>
<p class="graf graf--p">这里需要注意的一点是，时间线中的计时数字是针对React的开发构建的，它比prod慢得多。事实上，性能时间线本身甚至会降低应用程序的速度。虽然这些数字不应该被认为是真实世界性能的代表，但不同组件之间的<em class="markup--em markup--p-em">相对</em>计时是准确的。此外，组件是否更新根本不取决于产品版本。</p>
<h3 class="graf graf--h3">演示！</h3>
<p class="graf graf--p">为了好玩，我修改了TodoMVC应用程序，使其存在一些严重的性能问题。您可以在这里尝试一下:</p>

<p class="graf graf--p">要查看时间线，请打开Chrome dev工具，转到“性能”选项卡，然后单击录制。然后在应用程序中添加一些TODOs，停止录制，检查时间轴。看看您是否能发现哪些组件导致了性能问题🙂</p>
<h3 class="graf graf--h3">调试生产中的性能问题</h3>
<p class="graf graf--p">React中的性能时间线特性只在本地开发中起作用，因为它是在React的生产版本之外编译的。如果您有兴趣了解生产应用程序中的性能问题，请尝试使用<a class="markup--anchor markup--p-anchor" href="https://logrocket.com/for/react-performance-monitoring/" target="_blank" rel="noopener noreferrer" data-href="https://logrocket.com/signup/"> LogRocket </a>。</p>
</div>

<div class="section-inner sectionLayout--insetColumn">
<p class="graf graf--p">LogRocket 就像是网络应用的DVR，记录下<em class="markup--em markup--p-em">字面上的</em> <em class="markup--em markup--p-em">发生在你网站上的一切</em>。您可以重放有错误或性能问题的会话，以快速了解根本原因，而不是猜测问题发生的原因。</p>
<p class="graf graf--p">LogRocket让你的应用程序记录性能计时、Redux动作/状态、日志、错误、带有头+主体的网络请求/响应以及浏览器元数据。它还记录页面上的HTML和CSS，甚至可以重建最复杂的单页面应用程序的像素级完美视频。</p>

<h3 class="graf graf--h3">结论</h3>
<p class="graf graf--p"><code>react_perf</code>是可视化React组件生命周期的极好工具。它可以让你快速看到哪些组件正在更新，哪些可能会降低你的应用程序的速度。</p>
<p class="graf graf--p">因为<code>react_perf</code>只在开发中工作，所以请查看<a class="markup--anchor markup--p-anchor" href="https://logrocket.com" target="_blank" rel="noopener noreferrer" data-href="https://logrocket.com">日志火箭</a>，以诊断生产中的错误和性能问题。</p>
<p class="graf graf--p">有关React性能的更多技巧，请参阅本系列的第2部分:</p>

</div>
</div>
</div>    
</body>
</html>