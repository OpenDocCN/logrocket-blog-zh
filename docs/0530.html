<html>
<head>
<title>Getting started with progressive web applications through Workbox and service workers - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>通过Workbox和服务工作者开始使用渐进式web应用程序</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/getting-started-with-progressive-web-applications-through-workbox-and-service-workers/#0001-01-01">https://blog.logrocket.com/getting-started-with-progressive-web-applications-through-workbox-and-service-workers/#0001-01-01</a></blockquote><div><article class="article-post">
 <p>渐进式web应用程序由许多因素组成，无论是具有移动友好的用户体验(UX)，具有本机桌面和移动API集成，还是能够在没有互联网连接的情况下使用应用程序。</p>
<p>在本教程中，我们将探索如何通过使用从<a href="https://developers.google.com/web/tools/workbox" target="_blank" rel="noopener noreferrer"> Workbox </a>生成的服务工人来使web应用程序离线工作，该工具旨在使缓存变得非常容易。</p>
<p>如果你以前从未接触过服务人员，它是浏览器在后台运行的脚本，可以实现不需要网页或任何用户交互的功能。问题是服务工作者可能很难设计，即使他们的API并不难使用。这是因为您必须考虑许多场景，例如缓存过期、更新等等。这就是为什么像<a href="https://developers.google.com/web/tools/workbox" target="_blank" rel="noopener noreferrer"> Workbox </a>这样的框架对开发有如此大的好处。</p>
<p>如果你是一个Hugo开发者，像我一样，你可能记得我写了一篇教程，演示了如何让一个静态生成的网站PWA友好。这很好，但是这一次我们想让这个过程更通用一些，这样它就可以在Hugo场景之外使用。</p>
<p class="cro31"><span class="embed-youtube"> <iframe loading="lazy" class="youtube-player" src="https://www.youtube.com/embed/dGWoffJcFhg?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation">视频</iframe> </span></p>
<p> </p>
<h2>用HTML、CSS和JavaScript构建网站</h2>
<p>让我们创建一个简单的网站，了解正在发生的事情以及为什么服务人员帮助我们，而不仅仅是为了能够将我们的应用程序称为PWA。</p>
<p>几乎每个网站都会有HTML、CSS和JavaScript文件，所以让我们从这些开始着手吧。在你电脑的某个地方，用index.html文件、styles.css文件和scripts.js文件创建一个新文件夹。</p>
<p>在scripts.js文件中，添加以下代码:</p>
<pre>console.log("HELLO WORLD!");</pre>
<p>这肯定不是你见过的最复杂的脚本，但是到时候它会证明我们的观点。我们只想说我们的应用程序中有一个单独的JavaScript文件。同样，将以下内容添加到项目的styles.css文件中:</p>
<pre>body { margin: 0; }
h1 { margin: 0; }</pre>
<p>同样，复杂性不是本教程的目标。目标是展示服务人员如何为我们的项目增加价值，以及您应该如何让他们参与进来。让我们通过创建一个包含脚本和样式的HTML文件来完成这个非常基础的项目。打开项目的index.html文件，包括以下内容:</p>
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link rel="stylesheet" href="styles.css" /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;
            &lt;h1&gt;Hello World!&lt;/h1&gt;
        &lt;/div&gt;
        &lt;script src="scripts.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
<p>如果我们愿意，我们可以打开我们的HTML文件，看到一个完全可以接受的网站。为了尽早设置好，我们不能仅仅从文件系统中打开我们的文件来查看运行中的东西。我们将需要为我们的项目提供服务，要么使用Python或Caddy之类的工具，要么将我们的应用程序发布到托管提供商。</p>
<p>如果您使用的是macOS或Linux，或者在Windows电脑上安装了Python，您可以执行以下操作:</p>
<pre>python -m SimpleHTTPServer</pre>
<p>上面的命令将在<a href="http://localhost:8000/index.html" rel="nofollow">http://localhost:8000/index . html</a>为我们的应用程序提供服务，这对于本例来说是完美的。</p>
<p>现在我们有了一个简单的web应用程序，让我们打开Chrome Inspector，假设您使用的是Google Chrome。如果您浏览到“网络”选项卡，您会看到类似下图的内容:</p>
<figure id="attachment_9731" aria-describedby="caption-attachment-9731" class="wp-caption aligncenter"><img data-attachment-id="9731" data-permalink="https://blog.logrocket.com/getting-started-with-progressive-web-applications-through-workbox-and-service-workers/chrome-inspector-without-sw/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png" data-orig-size="938,444" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="chrome-inspector-without-sw" data-image-description="" data-image-caption="&lt;p&gt;Chrome Inspector Network Info&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw-300x142.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png" decoding="async" class="wp-image-9731 size-full jetpack-lazy-image" src="../Images/fff547e7553e3feccf7aeec72c7446b3.png" alt="Chrome Inspector Network Info" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png 938w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw-300x142.png 300w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw-768x364.png 768w" data-lazy-sizes="(max-width: 938px) 100vw, 938px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="9731" data-permalink="https://blog.logrocket.com/getting-started-with-progressive-web-applications-through-workbox-and-service-workers/chrome-inspector-without-sw/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png" data-orig-size="938,444" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="chrome-inspector-without-sw" data-image-description="" data-image-caption="&lt;p&gt;Chrome Inspector Network Info&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw-300x142.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png" decoding="async" loading="lazy" class="wp-image-9731 size-full" src="../Images/fff547e7553e3feccf7aeec72c7446b3.png" alt="Chrome Inspector Network Info" srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png 938w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw-300x142.png 300w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw-768x364.png 768w" sizes="(max-width: 938px) 100vw, 938px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-without-sw.png"/></noscript><figcaption id="caption-attachment-9731" class="wp-caption-text">Chrome Inspector network info</figcaption></figure>
<p>虽然不是特别大，也不是特别慢，但是必须获取HTML、CSS和JavaScript资源。每个用户的每个请求都会获取这些资源。如果你在看一个真实的生产web应用程序，这可能会增加高达MB的下载量和几秒钟的时间，这在web世界中是不好的，尤其是在通过蜂窝信号的移动设备上。</p>
<p>你可以通过进入Chrome浏览器的“审计”标签来进一步评估。</p>
<figure id="attachment_9733" aria-describedby="caption-attachment-9733" class="wp-caption aligncenter"><img data-attachment-id="9733" data-permalink="https://blog.logrocket.com/getting-started-with-progressive-web-applications-through-workbox-and-service-workers/chrome-audit-without-sw/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png" data-orig-size="936,377" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="chrome-audit-without-sw" data-image-description="" data-image-caption="&lt;p&gt;Chrome Inspector Audit Info&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw-300x121.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png" decoding="async" class="wp-image-9733 size-full jetpack-lazy-image" src="../Images/6c9afeeabbe66bc50f24e1ce692b8d80.png" alt="Chrome Inspector Audit Info" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png 936w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw-300x121.png 300w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw-768x309.png 768w" data-lazy-sizes="(max-width: 936px) 100vw, 936px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="9733" data-permalink="https://blog.logrocket.com/getting-started-with-progressive-web-applications-through-workbox-and-service-workers/chrome-audit-without-sw/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png" data-orig-size="936,377" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="chrome-audit-without-sw" data-image-description="" data-image-caption="&lt;p&gt;Chrome Inspector Audit Info&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw-300x121.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png" decoding="async" loading="lazy" class="wp-image-9733 size-full" src="../Images/6c9afeeabbe66bc50f24e1ce692b8d80.png" alt="Chrome Inspector Audit Info" srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png 936w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw-300x121.png 300w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw-768x309.png 768w" sizes="(max-width: 936px) 100vw, 936px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-audit-without-sw.png"/></noscript><figcaption id="caption-attachment-9733" class="wp-caption-text">Chrome Inspector audit info</figcaption></figure>
<p>你会发现这个应用程序没有被评为一个进步的网络应用程序，当你检查原因时，它缺少了一些东西，离线功能就是其中之一。虽然我们对构建100% PWA等级的应用程序不太感兴趣，但我们确实关心服务人员和离线方面。这比告诉人们我们的网站是PWA更有帮助。</p>
<p>因此，让我们从使用Workbox格式的服务工作者添加缓存策略开始。</p>
<h2>使用Workbox定义缓存策略</h2>
<p>Workbox可以有多种用途，但首先是作为服务人员的运行时替代品。为了了解它是如何工作的，让我们创建一个sw.js文件来表示我们的服务人员。</p>
<pre>importScripts("https://storage.googleapis.com/workbox-cdn/releases/4.3.1/workbox-sw.js");

workbox.routing.registerRoute(
    /\.(?:css|js)$/,
    new workbox.strategies.StaleWhileRevalidate({
        "cacheName": "assets",
        plugins: [
            new workbox.expiration.Plugin({
                maxEntries: 1000,
                maxAgeSeconds: 31536000
            })
        ]
    })
);

workbox.routing.registerRoute(
    /\.(?:png|jpg|jpeg|gif|bmp|webp|svg|ico)$/,
    new workbox.strategies.CacheFirst({
        "cacheName": "images",
        plugins: [
            new workbox.expiration.Plugin({
                maxEntries: 1000,
                maxAgeSeconds: 31536000
            })
        ]
    })
);</pre>
<p>上面的JavaScript代表了一个用Workbox创建的服务工作者。上面的代码中主要发生了两件事，它可能会根据您的业务需求而改变。发生的两件事是取决于文件的两种不同的缓存策略。</p>
<p>对于JavaScript和CSS文件，使用<code>StaleWhileRevalidate</code>策略。这意味着资产将总是被获取，然后被缓存，除非互联网不可用，此时使用缓存的版本。对于映像正在使用的<code>CacheFirst</code>策略，将一直使用缓存版本，直到该缓存版本过期或被手动从缓存中清除。</p>
<p>同样，你需要为你的业务需求选择策略。不止存在<code>StaleWhileRevalidate</code>和<code>CacheFirst</code>策略。</p>
<p>要激活这个服务人员，我们可以编辑我们的<strong>index.html</strong>文件，如下所示:</p>
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link rel="stylesheet" href="styles.css" /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;
            &lt;h1&gt;Hello World!&lt;/h1&gt;
        &lt;/div&gt;
        &lt;script src="scripts.js"&gt;&lt;/script&gt;
        &lt;script&gt;
            if ("serviceWorker" in navigator) {
                window.addEventListener("load", () =&gt; {
                    navigator.serviceWorker.register("sw.js").then(swReg =&gt; { }).catch(err =&gt; {
                        console.error('Service Worker Error', err);
                    });
                });
            }
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
<p>请注意，sw.js文件现在正由web应用程序注册。如果我们重新加载浏览器，并进入Chrome浏览器的网络选项卡，情况应该会略有不同。</p>
<figure id="attachment_9742" aria-describedby="caption-attachment-9742" class="wp-caption aligncenter"><img data-attachment-id="9742" data-permalink="https://blog.logrocket.com/getting-started-with-progressive-web-applications-through-workbox-and-service-workers/chrome-inspector-with-sw/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png" data-orig-size="937,429" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="chrome-inspector-with-sw" data-image-description="" data-image-caption="&lt;p&gt;Chrome Inspector Service Worker&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw-300x137.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png" decoding="async" class="wp-image-9742 size-full jetpack-lazy-image" src="../Images/504de1ac151ae5d28d6be6c6c8987776.png" alt="Chrome Inspector Service Worker" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png 937w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw-300x137.png 300w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw-768x352.png 768w" data-lazy-sizes="(max-width: 937px) 100vw, 937px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="9742" data-permalink="https://blog.logrocket.com/getting-started-with-progressive-web-applications-through-workbox-and-service-workers/chrome-inspector-with-sw/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png" data-orig-size="937,429" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="chrome-inspector-with-sw" data-image-description="" data-image-caption="&lt;p&gt;Chrome Inspector Service Worker&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw-300x137.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png" decoding="async" loading="lazy" class="wp-image-9742 size-full" src="../Images/504de1ac151ae5d28d6be6c6c8987776.png" alt="Chrome Inspector Service Worker" srcset="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png 937w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw-300x137.png 300w, https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw-768x352.png 768w" sizes="(max-width: 937px) 100vw, 937px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/11/chrome-inspector-with-sw.png"/></noscript><figcaption id="caption-attachment-9742" class="wp-caption-text">Chrome Inspector service worker</figcaption></figure>
<p>这一次，JavaScript和CSS文件通过服务工作器从缓存中加载。对于这个例子，请求时间的节省可能并不明显，但是对于大小接近MB的文件，从缓存中加载除了使应用程序脱机兼容之外，还会显著提高应用程序的速度。</p>
<p>那么我们如何改进这个过程呢？</p>
<h2>使用工具箱构建策略预先缓存资产</h2>
<p>使用Workbox并不是特别困难，但是我们可以做一些改变，不仅改进流程，还改进功能。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>假设我们想在网站首次加载时缓存我们的资源，而不是按需缓存。我们需要想出一个预缓存策略。最好的方法是通过Workbox构建配置，可以用Node.js来执行，或者在Hugo 的<a href="https://www.thepolyglotdeveloper.com/2019/03/service-workers-workbox-hugo-static-generated-site/" target="_blank" rel="noopener noreferrer">示例中，通过Gulp来执行。</a></p>
<p>继续在您的项目中创建一个新的generator.js文件。在我们打开它之前，我们需要配置我们的项目来使用Node.js，这意味着获取我们的依赖项。假设您安装了Node.js，执行以下命令:</p>
<pre>npm init -y
npm install workbox-build --save-dev</pre>
<p>要明确的是，这些都是开发依赖。您的web应用程序不需要使用Node.js</p>
<p>依赖项就绪后，打开项目的generator.js文件，并包含以下内容:</p>
<pre>const workbox = require("workbox-build");

workbox.generateSW({
    cacheId: "example",
    globDirectory: "./",
    globPatterns: [
        "**/*.{css,js}"
    ],
    globIgnores: [
        "node_modules/**/*",
        "**/gulpfile.js",
        "**/sw.js"
    ],
    swDest: "./sw.js",
    runtimeCaching: [
        {
            urlPattern: /\.(?:html|htm|xml)$/,
            handler: "staleWhileRevalidate",
            options: {
                cacheName: "markup",
                expiration: {
                    maxAgeSeconds: 60 * 60 * 24 * 7,
                },
            },
        }
    ],
});</pre>
<p>所以让我们看看这个生成器脚本中发生了什么，从看起来最熟悉的部分<code>runtimeCaching</code>开始。</p>
<p>在<code>runtimeCaching</code>中，我们为任何给定的文件类型定义策略。在这种情况下，我们为HTML或XML文件定义了一个策略，但是我们可以很容易地包含更多。我们没有在运行时缓存JavaScript和CSS等资产，而是选择预缓存这些资产。要预缓存资源，应该将其添加到<code>globPatterns</code>数组中。为了消除缓存开发依赖项的风险，我们可以向<code>globIgnores</code>数组添加资源。</p>
<p>应该谨慎使用预缓存，因为它会在应用程序加载后立即发生。如果你试图预先缓存太多或者非常大的文件，用户体验会很糟糕。相反，只预先缓存那些能给用户带来最佳体验的资源。</p>
<p>如果您执行<code>node generator.js</code>,它应该会向您的项目添加一个sw.js文件。这个文件看起来类似于手动创建的服务工作器，只是现在它定义了预缓存。</p>
<h2>结论</h2>
<p>我们刚刚看了如何缓存web应用程序资源，不仅提高web应用程序的性能，而且使它可以脱机使用。服务人员是开发完全兼容的渐进式web应用程序(PWA)的第一步，而像Workbox这样的框架使开发变得非常容易。</p>
<p>虽然我们没有使用像推送通知这样的本地API来创建PWA，但我们仍然致力于构建一个像Google Chrome这样的浏览器能够识别的PWA。</p><div class="code-block code-block-2">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket会告诉您应用程序中实际影响用户的最具影响力的bug和UX问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket自动聚合客户端错误、JS异常、前端性能指标和用户交互。然后LogRocket使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试LogRocket】。</a></p></div></div>
<h2/>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>