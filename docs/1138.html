<html>
<head>
<title>Build a file compression application in Node.js and Vue.js - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在Node.js和Vue.js - LogRocket Blog中构建一个文件压缩应用程序</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/#0001-01-01">https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/#0001-01-01</a></blockquote><div><article class="article-post">
<p>Node.js为我们提供了一个帮助文件压缩的模块。在本文中，我们将构建一个应用程序，用户可以上传他们想要压缩的文件，然后使用Node.js Zlib模块下载文件的压缩版本。</p>
<h3>先决条件</h3>
<p>要跟随本教程，您需要以下内容:</p>
<ul>
<li>熟悉HTML、CSS和Javascript (ES6+)</li>
<li>VS代码或安装在开发机器上的任何代码编辑器</li>
<li>安装在您的开发机器上的POSTMAN</li>
<li>Vue和Node.js的基础知识</li>
</ul>
<h2>设置项目</h2>
<p>我们将从构建后端开始，这是我们应用程序的主干。在桌面上，为应用程序创建一个文件夹，并通过运行<code>npm init -y</code>建立一个新的Node.js项目。</p>
<pre>cd desktop &amp;amp;&amp;amp; mkdir compressor &amp;amp;&amp;amp; cd compressor
mkdir server &amp;amp;&amp;amp; cd server
npm init -y</pre>
<p>我们现在需要为我们的应用程序安装必要的包:</p>
<ul>
<li>这将有助于设置我们的服务器和压缩路径</li>
<li>每当我们对应用程序进行修改时，Nodemon将重启我们的服务器</li>
<li><code>multer</code>:用于上传文件的中间件</li>
<li><code>cors</code>:帮助向代理请求添加报头</li>
</ul>
<p>要安装所有这些，在我们创建的<code>server</code>目录中运行这个命令:</p>
<pre>npm i --save express nodemon multer cors</pre>
<p>安装完成后，在服务器目录下创建一个<code>index.js</code>文件。这是我们写后端代码的地方。</p>
<p>使用VS代码打开文件夹。在我们开始之前，让我们创建一个<code>.gitignore</code>文件并将<code>node_modules</code>添加到其中。这将阻止<code>node_modules</code>文件夹被添加到git。</p>
<p>让我们继续创建一个简单的Express.js服务器，然后配置我们的包:</p>
<pre>var express = require('express');
var multer = require('multer');
var zlib = require('zlib');
var cors = require('cors');
let fs = require('fs');
let path = require('path');
var app = express();
app.use(cors());

//multer
var storage = multer.memoryStorage();
var upload = multer({
  storage: storage,
});

app.listen(3000, () =&amp;gt; {
  console.log('App is runnuing on port 3000');
});</pre>
<p>我们首先需要我们已安装的软件包，如Express、Multer和Cors。然后，我们创建Express的一个实例，并将其存储在一个变量中。我们使用Express实例将我们的<code>cors</code>配置为中间件。</p>
<p>我们还需要一些Node.js核心模块，如<code>zlib</code>，我们将使用它们进行实际的压缩。然后，我们使用Express的实例来创建一个将监听端口<code>3000</code>的服务器。</p>
<p>Multer使我们能够通过使用Multer <code>memoryStorage()</code>方法获得实际的文件缓冲区。这将返回文件缓冲区，我们将使用它，因为我们的<code>zlib</code>模块只接受字符串或缓冲区。</p>
<p>接下来，我们将创建一个路由，它接收一个文件，然后返回压缩文件。</p>
<p>Zlib有很多压缩方法，但是对于本文，我们将使用<code>gzip</code>方法。</p>
<pre>app.post("/compress", upload.single("file"), async (req, res) =&gt; {
  try {
    const destination = `compressed/${req.file.originalname}.gz`;
    let fileBuffer = req.file.buffer;
    await zlib.gzip(fileBuffer, (err, response) =&gt; {
      if (err) {
        console.log(err);
      }
      fs.writeFile(path.join(__dirname, destination), response, (err, data) =&gt; {
        if (err) {
          console.log(err);
        }
        res.download(path.join(__dirname, destination));
      });
    });
  } catch (err) {
    console.log(err);
    res.json(err);
  }
});</pre>
<p>我们定义了<code>/compress</code>路由，这是一个<code>POST</code>请求，然后在路由中传递Multer中间件。我们的Multer中间件将返回文件缓冲区，我们将它存储在<code>fileBuffer</code>变量中。</p>
<p>出于测试目的，让我们创建一个<code>compressed</code>目录来存储我们的压缩文件。</p>
<p>我们将使用Multer中间件来获取我们想要压缩的文件的名称，这样我们就可以将它保存在我们的<code>compressed</code>目录中。</p>
<pre>const destination = `compressed/${req.file.originalname}.gz`;</pre>
<p>我们使用Zlib方法<code>gzip</code>来压缩我们的文件，它将<code>fileBuffer</code>作为第一个参数，然后将一个回调函数作为第二个参数。回调函数由任何可能的错误和压缩响应组成。</p>
<p>在获得Zlib响应后，我们创建一个文件并将响应存储在<code>compressed</code>目录中。这个文件将有一个<code>.gz</code>文件扩展名，因为这是用来识别Zlib压缩的。</p>
<p>我们现在可以在开始前端之前在POSTMAN上测试我们的应用程序。我将压缩一个<code>package.lock.json</code>文件。其大小为488kb。</p>
<p><img data-attachment-id="24885" data-permalink="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/launchpad-local-host/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png" data-orig-size="730,540" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="launchpad-local-host" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host-300x222.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png" decoding="async" class="aligncenter wp-image-24885 size-full jetpack-lazy-image" src="../Images/aa4e195d0e91a15de7c03f63ab4ff4b0.png" alt="The full-sized package.json file we want to compress." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host-300x222.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24885" data-permalink="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/launchpad-local-host/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png" data-orig-size="730,540" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="launchpad-local-host" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host-300x222.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png" decoding="async" loading="lazy" class="aligncenter wp-image-24885 size-full" src="../Images/aa4e195d0e91a15de7c03f63ab4ff4b0.png" alt="The full-sized package.json file we want to compress." srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host-300x222.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/launchpad-local-host.png"/></noscript>
<p>压缩文件得到127kb。</p>
<p><img data-attachment-id="24886" data-permalink="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/package-lock-json/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png" data-orig-size="730,481" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="package-lock-json" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json-300x198.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png" decoding="async" class="aligncenter wp-image-24886 size-full jetpack-lazy-image" src="../Images/b2b08d9f4ece95d0db401f0fe6ee95b3.png" alt="Our newly compressed package.json file." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json-300x198.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24886" data-permalink="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/package-lock-json/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png" data-orig-size="730,481" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="package-lock-json" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json-300x198.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png" decoding="async" loading="lazy" class="aligncenter wp-image-24886 size-full" src="../Images/b2b08d9f4ece95d0db401f0fe6ee95b3.png" alt="Our newly compressed package.json file." srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json-300x198.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/package-lock-json.png"/></noscript>
<p>现在我们的后端已经准备好了，我们可以为应用程序设置用户界面了。</p>
<p>让我们在<code>compressor</code>根目录下创建一个<code>client</code>目录。在<code>client</code>目录下，创建两个文件:<code>index.html</code>和<code>main.js</code>。</p>
<p>我们将从定义应用程序的用户界面开始。</p>
<p>我们将搭建一个HTML 5样板文件，然后在模板头中添加Vue.js脚本、引导CSS CDN和Axios脚本。然后，我们将在body标签的末尾添加我们的<code>main.js</code>文件。</p>
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Vue Compressor&lt;/title&gt;
    &lt;link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous"&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/vue"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="app"&gt;
    &lt;h1&gt;Compressor&lt;/h1&gt;
&lt;/div&gt;
    &lt;script src=" main.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p>对于这个应用程序，用户将通过拖放来添加他们的文件。让我们为我们的应用程序定义一个简单的用户界面。</p>
<p>将您的模板修改为:</p>
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Vue Compressor&lt;/title&gt;
    &lt;link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous"&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/vue"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"&gt;&lt;/script&gt;
    &lt;style&gt;
        body {
            background: darkgrey !important;
        }
        .wrapper {
            width: 350px;
            height: 350px;
            border: 2px dotted gray
        }
        .wrapper h4 {
            text-align: center;
            font-family: sans-serif;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="app"&gt;
    &lt;div class="container"&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-12"&gt;
                &lt;div class="wrapper mt-5 p-3"&gt;
                    &lt;h4&gt;Drag and Drop here&lt;/h4&gt;
                    &lt;ul class="list-group mt-5"&gt;
                        &lt;li class="list-group-item"&gt;FileName -&gt; File Size &lt;button
                                class="btn btn-sm btn-danger"&gt;X&lt;/button&gt;&lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/div&gt;
                &lt;button class="btn btn-primary my-4"&gt;  &lt;span class="spinner-border spinner-border-sm" role="status" v-if="loading" aria-hidden="true"&gt;&lt;/span&gt;

Compress&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
    &lt;script src=" main.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p>您可以使用您选择的任何实时服务器来运行您的应用程序，以预览您的应用程序:</p>
<p><img data-attachment-id="24887" data-permalink="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/drag-and-drop/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png" data-orig-size="730,406" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="drag-and-drop" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop-300x167.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png" decoding="async" class="aligncenter wp-image-24887 size-full jetpack-lazy-image" src="../Images/9c52eba6a052314bfffb80705827c72c.png" alt="Our drag and drop functionality for user files." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop-300x167.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24887" data-permalink="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/drag-and-drop/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png" data-orig-size="730,406" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="drag-and-drop" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop-300x167.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png" decoding="async" loading="lazy" class="aligncenter wp-image-24887 size-full" src="../Images/9c52eba6a052314bfffb80705827c72c.png" alt="Our drag and drop functionality for user files." srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop-300x167.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/drag-and-drop.png"/></noscript>
<h2>实现拖放</h2>
<p>我们将从在<code>main.js</code>文件中定义Vue.js实例开始。然后，我们将创建一个保存文件的状态:</p>
<pre>​​var app = new Vue({
​​  el: '#app',
​​  data: {
​​    files: [],
​​    loading:false
​​  },
​​  methods: {
​​    addFile(e) {
​​    },
​​    removeFile(file) {
​​    },
​​    compressFile() {
​​    }
​​  }
​​})</pre>
<p>为了在Vue.js中实现拖放，我们需要添加一个选择文件的<code>@drop</code>事件和一个用于在应用程序加载前隐藏<code>{{tags}}</code>的<code>v-cloak</code>属性。</p>
<pre>&lt;div class="wrapper mt-5 p-3" v-cloak @drop.prevent="addFile" @dragover.prevent&gt;
            &lt;h4&gt;Drag and Drop here&lt;/h4&gt;
        &lt;/div&gt;</pre>
<p><code>@drop</code>事件监听<code>addFile</code>方法，我们必须定义:</p>
<pre>addFile(e) {
      let files = e.dataTransfer.files;
      [...files].forEach(file =&gt; {
        this.files.push(file);
        console.log(this.files)
      });
    }</pre>
<p>通过这种方法，任何放入盒子中的文件都会记录在我们的控制台上。然而，我们希望在我们的盒子中显示文件，所以要这样做，我们必须将<code>&lt;li&gt;</code>元素修改为:</p>
<pre>&lt;li v-for="(file,id) in files" :key="id" class="list-group-item"&gt;
                                {{ file.name }}-{{ file.size }} kb&lt;button class="btn btn-sm btn-danger"&gt;X&lt;/button&gt;
                            &lt;/li&gt;</pre>
<p>有了这个，任何时候我们把一个文件放到盒子里，文件名和大小都会显示出来。</p>
<p>我们可以添加一个额外的特性，通过向<code>X</code>按钮添加一个点击事件来从盒子中移除文件。</p>
<p>然后我们定义<code>removeFile</code>方法:</p>
<pre>removeFile(file) {
      this.files = this.files.filter(f =&gt; {
        return f != file;
      });
    },</pre>
<p>让我们定义我们的压缩函数，它将压缩我们选择的文件。这就是Axios的用武之地。我们将向我们在后端定义的<code>/compress</code>路线发出请求:</p>
<pre>compressFile() {
      this.loading = true;
      let formdata = new FormData();
      formdata.append('file', this.files[0])
      axios.post('http://localhost:3000/compress', formdata, {
        responseType: 'blob'
      }).then(response =&gt; {
        let fileURL = window.URL.createObjectURL(new Blob([(response.data)]))
        let fileLink = document.createElement('a');
        fileLink.href = fileURL;
        fileLink.setAttribute('download', `${this.files[0].name}.gz`);
        document.body.appendChild(fileLink);
        fileLink.click();
        this.loading = false;
      }).catch(err =&gt; {
        this.loading = false;
        console.log(err)
      })
    }</pre>
<p>我们使用<code>FormData</code>上传文件。上传文件后，我们的后端压缩文件，并将压缩文件返回给我们。</p>
<p>我们使用<code>URL.createObjectURL</code>创建一个<code>DOMstring</code>,其中包含一个代表给定对象的URL。然后，我们下载从后端接收到的给定数据。</p>
<p>我们现在需要向压缩按钮添加一个click事件来监听我们创建的方法:</p>
<pre>&lt;button class="btn btn-primary my-4" @click="compressFile"&gt; &lt;span
                            class="spinner-border spinner-border-sm" role="status" v-if="loading"
                            aria-hidden="true"&gt;&lt;/span&gt;
                        Compress &lt;/button&gt;</pre>
<p>点击我们的压缩按钮将触发文件下载:</p>
<p><img data-attachment-id="24888" data-permalink="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/screenshot-2020/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png" data-orig-size="730,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot-2020" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020-300x210.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png" decoding="async" class="aligncenter wp-image-24888 size-full jetpack-lazy-image" src="../Images/8843fa58e29afa9e3dd7145741260527.png" alt="Our user saving a screenshot of our file." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020-300x210.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="24888" data-permalink="https://blog.logrocket.com/build-a-file-compression-application-in-node-js-and-vue-js/screenshot-2020/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png" data-orig-size="730,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot-2020" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020-300x210.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png" decoding="async" loading="lazy" class="aligncenter wp-image-24888 size-full" src="../Images/8843fa58e29afa9e3dd7145741260527.png" alt="Our user saving a screenshot of our file." srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020-300x210.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/screenshot-2020.png"/></noscript>
<p>就是这样！</p>
<p>我们刚刚构建了一个简单的压缩应用程序。我们想添加的最后一件事是一个简单的方法，通过创建一个Vue.js过滤器来格式化我们的文件大小(以千字节为单位):</p>
<pre>filters: {
    kb(val) {
      return Math.floor(val / 1024);
    }
  },</pre>
<p>然后，我们将像这样传递一个管道到文件的大小:</p>
<pre>{{ file.size | kb }} kb</pre>
<p>这将把我们文件的大小格式化成更具可读性的格式。</p>
<h2>结论</h2>
<p>Node.js简化了文件压缩。它还可以用于压缩HTTP请求和响应，以提高应用程序的性能。要获得更多Zlib特性，可以查看Zlib上的Node.js文档。</p>
<p>要获取源代码，请点击这里的。</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>