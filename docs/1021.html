<html>
<head>
<title>JavaScript and Vue animations - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>JavaScript和Vue动画- LogRocket博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/javascript-and-vue-animations/#0001-01-01">https://blog.logrocket.com/javascript-and-vue-animations/#0001-01-01</a></blockquote><div><div class="mainheading">


<h1 class="posttitle">JavaScript和Vue动画</h1>
<h2 class="post-subtitle"><span class="post-date"><time class="post-date">2020年7月27日</time> </span> <span class="dot"/> <span class="readingtime"> 3 min读</span> <span class="wordcount"> 981 </span> <span class="logrocket_editor"/></h2>
<p>在<a href="https://blog.logrocket.com/understanding-transitions-and-animations-in-vue/" target="_blank" rel="noopener noreferrer">之前的一篇文章</a>中，我们介绍了Vue的过渡和动画，以及如何使用只带有CSS和<code>transition</code>标签的过渡类来创建效果。有趣的是，通过单独使用JavaScript或将其与CSS结合使用，您可以做更多的事情。</p>
</div>
<article class="article-post">
<p>标签附带了一个叫做事件挂钩的东西，它允许JavaScript影响转换。事件挂钩影响元素，就像CSS中的转换类一样。这样，在动画或过渡发生的每个阶段，您都可以在DOM中添加或删除HTML元素时运行JavaScript代码。</p>
<p>这些钩子使您能够在动画开始之前、动画进行过程中以及动画完成之后立即运行JS代码。这个额外的功能可以让您对UI有更多的控制和灵活性，促进交互，并改善用户体验。</p>
<p><code>transition</code>标签为JavaScript提供了默认的事件钩子，这些钩子将它们自己附加到方法上，这些方法有实际的代码。</p>
<p><code>@before-enter</code>允许JavaScript代码在附加到DOM之前运行一帧</p>
<pre>&lt;transition
  @before-enter="beforeEnter"
  @enter="enter"
  @after-enter="afterEnter"
  @enter-cancelled="enterCancelled"

  @before-leave="beforeLeave"
  @leave="leave"
  @after-leave="afterLeave"
  @leave-cancelled="leaveCancelled"
&gt; 
  [...]
&lt;/transition&gt;
</pre>
<ul>
<li>发出附加到DOM时运行的代码</li>
<li>发出附加到DOM后运行的代码</li>
<li>发出清除动画并中止播放的代码(你也可以有其他类型的代码)</li>
<li>允许JavaScript代码在从DOM中移除之前运行一帧</li>
<li>发出从DOM中删除时运行的代码</li>
<li><code>@after-leave</code>发出从DOM中删除后运行的代码</li>
<li><code>@leave-cancelled</code>发出动画被取消时运行的代码</li>
<li>让我们看一个例子。</li>
</ul>
<p>上面的例子提供了一个如何结合JavaScript和CSS中的事件挂钩来创建动画的用例。在这种情况下，我们在CSS中使用<code>@keyframes</code>来创建从DOM中附加和移除的样式。然后，我们为事件挂钩创建了方法，在每个用JavaScript附加/移除的阶段，我们向控制台添加了注释，向元素添加了样式。</p>
<pre>&lt;template&gt;
  &lt;div&gt;
    &lt;div class="container"&gt;
    &lt;button @click="display = !display"&gt;Switch&lt;/button&gt;
    &lt;transition
      @before-enter="beforeEnter"
      @enter="enter"
      @after-enter="afterEnter"
      @enter-cancelled="enterCancelled"

      @before-leave="beforeLeave"
      @leave="leave"
      @after-leave="afterLeave"
      @leave-cancelled="leaveCancelled"&gt;
    &lt;div class="item" v-if="display"&gt;1&lt;/div&gt;
    &lt;/transition&gt;
  &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;style scoped&gt;
  body {
    align-content: center;
  }
    .container {
        display: grid;
        grid-gap: 20px;
        width: 500px;
        margin: 0 auto;
      }
    .item {
      background-color: blue;
      height: 100px;
    }
    .fadeInClass {
      animation : fadeIn 1s;  
    }
    .fadeOutClass {
      animation : fadeOut 1s;  
    }
    @keyframes fadeIn {
      0% {
        opacity : 0
      }
      100% {
        opacity : 1;
      }
    }

    @keyframes fadeOut {
      0% {
        opacity : 1;
      }
      100% {
        opacity : 0;
      }
    }

&lt;/style&gt;


&lt;script&gt;
export default {
  data () {
    return {
      display : false
    }
  },
  methods : {
    beforeEnter () {
      console.log("about to")
    },
    enter (el, done) {
       el.classList.add('fadeInClass');
      console.log("enter")
       done();
    },
    afterEnter (el) {
      el.addEventListener('animationend', () =&gt;{el.classList.remove('fadeInClass'); } )
      console.log("after enter")
    },
    enterCancelled ()  {
     console.log("enter cancelled")
    },
    beforeLeave () {
      console.log("beforeLeave")
    },
    leave (el, done) {
      el.classList.add('fadeOutClass')
      console.log("leave")
       done();
    },
    afterLeave () {
      console.log("after-leave");
    },
     leaveCancelled ()  {
     console.log("leave cancelled")
    }
  }
}
&lt;/script&gt;
</pre>
<p>注意:我们只在<code>enter</code>和<code>leave</code>中添加了<code>done()</code>，因为它有助于Vue中的元素知道JavaScript何时完成过渡/动画，因为它不像CSS那样定时。</p>
<p>有趣的是，您也可以单独使用任何事件挂钩来运行JavaScript代码，因此您不需要将所有挂钩都附加到转换标签上就可以工作。你只能用你需要的东西。</p>
<p>例如，您可以简单地将<code>@after-leave</code>添加到已经使用CSS和transition类的transition标签中，在动画从DOM中移除后，它将运行您想要的任何代码。</p>
<p>这里有一个例子:</p>
<p><code>@after-leave</code>被附加到transition标签上，该标签已经在使用transition类进行操作。<code>@after-leave</code>钩子在元素从DOM中移除后生效。然后它运行<code>afterLeave()</code>函数并显示关于随机数的声明。这可以用我们之前讨论过的所有其他事件挂钩来重现。</p>
<pre>&lt;template&gt;
  &lt;div&gt;
    &lt;div class="container"&gt;
    &lt;button @click="display = !display"&gt;Switch&lt;/button&gt;
    &lt;transition  @after-leave="afterLeave" name="block"&gt;
    &lt;div class="item" v-if="display" &gt;1&lt;/div&gt;
    &lt;/transition&gt;
    &lt;div id="comment"&gt;&lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;style scoped&gt;
  body {
    align-content: center;
  }
    .container {
        display: grid;
        grid-gap: 20px;
        width: 500px;
        margin: 0 auto;
      }
    .item {
      background-color: blue;
      height: 100px;
    }
    .block-enter {
    }
    .block-enter-active {
      animation : fadeIn 1s;
    }
    .block-leave {
    }
    .block-leave-active {
       animation : fadeOut 1s 
    }
      @keyframes fadeIn {
      0% {
        opacity : 0
      }
      100% {
        opacity : 1;
      }
    }

    @keyframes fadeOut {
      0% {
        opacity : 1;
      }
      100% {
        opacity : 0;
      }
    }
&lt;/style&gt;


&lt;script&gt;
export default {
  data () {
    return {
      display : false
    }
  },
  methods : {

    afterLeave () {
      document.getElementById('comment').innerHTML = `The random number is ${(Math.random())}`
    }
  }
}
&lt;/script&gt;
</pre>
<p>如果你使用的JavaScript钩子没有任何CSS，你可以添加<code>:css="false"</code>到你的转换标签中。这告诉转换标签不要监听任何CSS，因为默认情况下它通常会监听。</p>
<p>结论</p>
<pre>&lt;transition
      @before-enter="beforeEnter"
      @enter="enter"
      @after-enter="afterEnter"
      @enter-cancelled="enterCancelled"

      @before-leave="beforeLeave"
      @leave="leave"
      @after-leave="afterLeave"
      @leave-cancelled="leaveCancelled" 
      :css="false"&gt;
    &lt;div class="item" v-if="display"&gt;1&lt;/div&gt;
    &lt;/transition&gt;
</pre>
<h2 id="conclusion">使用JavaScript，您可以完全通过DOM控制元素，这取决于您希望在项目中实现什么。您可以随时在动画的任何地方使用转换挂钩来安装JavaScript，这为您提供了精确操作元素的灵活性，并为您的用户创建更好、更具伸缩性的应用程序。</h2>
<p>要了解更多，请查看这个<a href="https://www.youtube.com/watch?v=r1zF9aXQdLU&amp;feature=youtu.be" target="_blank" rel="noopener noreferrer">速成班</a>。</p>
<p>像用户一样体验您的Vue应用</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</h2><p>. </p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p>
<p>Modernize how you debug your Vue apps - <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a>.</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>