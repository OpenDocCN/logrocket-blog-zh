<html>
<head>
<title>localStorage in JavaScript: A complete guide - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>JavaScript中的本地存储:一个完整的指南</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/localstorage-javascript-complete-guide/#0001-01-01">https://blog.logrocket.com/localstorage-javascript-complete-guide/#0001-01-01</a></blockquote><div><article class="article-post">
<p><em> <strong>编者按:</strong>本帖更新于2020年12月29日。</em></p>
<p>在本教程中，我们将向您展示如何使用<code>localStorage</code>机制和<code>Window.localStorage</code>属性，并回顾JavaScript中web存储的基础知识。</p>
<p>我们将详细介绍以下内容:</p>

<h2 id="webstorageapi">什么是Web存储API？</h2>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API" target="_blank" rel="noopener"> Web存储API </a>是一组使浏览器能够存储键值对的机制。它被设计得比使用cookies更直观。</p>
<p>键-值对表示存储对象，它类似于对象，只是在页面加载期间保持不变，并且始终是字符串。您可以像访问一个对象一样访问这些值，或者使用<code>getItem()</code>方法(稍后会详细介绍)。</p>
<h3 id="sessionstoragevslocalstorage"><code>sessionStorage</code>和<code>localStorage</code>有什么区别？</h3>
<p>Web存储API由两种机制组成:<code>sessionStorage</code>和<code>localStorage</code>。在页面会话期间，<code>sessionStorage</code>和<code>localStorage</code>都为每个可用的原点维护一个单独的存储区域。</p>
<p><code>sessionStorage</code>和<code>localStorage</code>的主要区别在于<code>sessionStorage</code>只在浏览器打开时(包括页面重新加载或恢复时)维护一个存储区，而<code>localStorage</code>在浏览器关闭后继续存储数据。换句话说，当页面关闭时，存储在<code>sessionStorage</code>中的数据被清除，而存储在<code>localStorage</code>中的数据不会过期。</p>
<p>在本教程中，我们将关注如何在JavaScript中使用<code>localStorage</code>。</p>
<h2 id="whatislocalstorage">JavaScript中的<code>localStorage</code>是什么？</h2>
<p><code>localStorage</code>是一个属性，允许JavaScript站点和应用程序在web浏览器中保存键值对，并且没有截止日期。这意味着存储在浏览器中的数据即使在浏览器窗口关闭后仍将存在。</p>
<p>关于如何在JavaScript中使用<code>localStorage</code>的视觉复习，请看下面的视频教程:</p>
<p><iframe loading="lazy" title="YouTube video player" src="https://www.youtube.com/embed/LfeOLVGHiXI" frameborder="0" allowfullscreen="allowfullscreen">视频</iframe></p>
<h3 id="whereislocalstoragestored"><code>localStorage</code>存放在哪里？</h3>
<p>在谷歌浏览器中，<a href="https://en.wikipedia.org/wiki/Web_storage" target="_blank" rel="noopener">网络存储</a>数据保存在用户档案子文件夹中的SQLite文件中。该子文件夹在Windows机器上位于<code>\AppData\Local\Google\Chrome\User Data\Default\Local Storage</code>，在macOS上位于<code>~/Library/Application Support/Google/Chrome/Default/Local Storage</code></p>
<p>Firefox将存储对象保存在名为<code>webappsstore.sqlite</code>的SQLite文件中，该文件也位于用户的profile文件夹中。</p>
<h2 id="windowlocalstorage">什么是<code>Window.localStorage</code>？</h2>
<p>通过<code><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" target="_blank" rel="noopener">Window.localStorage</a></code>属性可以使用<code>localStorage</code>机制。<code>Window.localStorage</code>是JavaScript中<code><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window" target="_blank" rel="noopener">Window</a></code>接口的一部分，它代表一个包含DOM文档的窗口。</p>
<p><code>Window</code>接口具有广泛的函数、构造函数、对象和名称空间。<code>Window.localStorage</code>是一个只读属性，返回对本地存储对象的引用，该对象用于存储只有创建它的源才能访问的数据。</p>
<h2 id="howdoeslocalstoragework"><code>localStorage</code>是如何工作的？</h2>
<p>要在您的web应用程序中使用<code>localStorage</code>,有五种方法可供选择:</p>
<ol>
<li><code>setItem()</code>:给<code>localStorage</code>添加键值</li>
<li><code>getItem()</code>:这是你从<code>localStorage</code>得到物品的方法</li>
<li><code>removeItem()</code>:从<code>localStorage</code>中按键删除一个项目</li>
<li><code>clear()</code>:全部清除<code>localStorage</code></li>
<li><code>key()</code>:传递一个数字来检索一个<code>localStorage</code>的密钥</li>
</ol>
<h3 id="setitem"><code>setItem()</code>:如何在<code>localStorage</code>中存储数值</h3>
<p>顾名思义，这个方法允许你在<code>localStorage</code>对象中<a href="https://blog.logrocket.com/storing-retrieving-javascript-objects-localstorage/" target="_blank" rel="noopener">存储值。</a></p>
<p>它有两个参数:一个键和一个值。稍后可以引用该键来获取附加到它的值。</p>
<pre>window.localStorage.setItem('name', 'Obaseki Nosa');</pre>
<p>其中<code>name</code>是键，<code>Obaseki Nosa</code>是值。还要注意，<code>localStorage</code>只能存储字符串。</p>
<p>要存储数组或对象，您必须将它们转换为字符串。</p>
<p>为此，我们在传递给<code>setItem()</code>之前使用<code>JSON.stringify()</code>方法。</p>
<pre>const person = {
    name: "Obaseki Nosa",
    location: "Lagos",
}

window.localStorage.setItem('user', JSON.stringify(person));</pre>
<h3 id="getitem"><code>getItem()</code>:如何从<code>localStorage</code>获取物品</h3>
<p>要从localStorage获取项目，请使用<code>getItem()</code>方法。<code>getItem()</code>允许您访问存储在浏览器的<code>localStorage</code>对象中的数据。</p>
<p><code>getItem()</code>只接受一个参数，即<code>key</code>，并以字符串形式返回<code>value</code>。</p>
<p>要检索用户密钥:</p>
<pre>window.localStorage.getItem('user');</pre>
<p>这将返回一个字符串，其值为:</p>
<pre>“{“name”:”Obaseki Nosa”,”location”:”Lagos”}”</pre>
<p>要使用该值，您必须将其转换回对象。</p>
<p>为此，我们使用了<code>JSON.parse()</code>方法，该方法将JSON字符串转换成JavaScript对象。</p>
<pre>JSON.parse(window.localStorage.getItem('user'));</pre>
<h3 id="removeitem"><code>removeItem()</code>:如何删除<code>localStorage</code>个会话</h3>
<p>要删除本地存储会话，请使用<code>removeItem()</code>方法。</p>
<p>当传递一个键名时，<code>removeItem()</code>方法从存储中删除这个键(如果它存在的话)。如果没有与给定键相关联的项，此方法将不执行任何操作。</p>
<pre>window.localStorage.removeItem('name');</pre>
<h3 id="clear"><code>clear()</code>:如何删除<code>localStorage</code>中的所有项目</h3>
<p>使用<code>clear()</code>方法删除<code>localStorage</code>中的所有项目。</p>
<p>调用此方法时，会清除该域的所有记录的整个存储。它不接收任何参数。</p>
<pre>window.localStorage.clear();</pre>
<h3 id="key"><code>key()</code>:如何获取<code>localStorage</code>中某个按键的名称</h3>
<p>在需要循环遍历键的情况下，<code>key()</code>方法非常方便，它允许您向<code>localStorage</code>传递一个数字或索引来检索键的名称。</p>
<pre>var KeyName = window.localStorage.key(index);</pre>
<h2 id="browsersupport"><code>localStorage</code>浏览器支持</h2>
<p><code>localStorage</code>作为一种网络存储是HTML5规范。包括IE8在内的主流浏览器都支持。为了确保浏览器支持<code>localStorage</code>，您可以使用下面的代码片段进行检查:</p>
<pre>if (typeof(Storage) !== "undefined") {
    // Code for localStorage
    } else {
    // No web storage Support.
}</pre>
<h2 id="limitations"><code>localStorage</code>限制</h2>
<p>使用<code>localStorage</code>很容易，但也很容易被误用。以下是限制，以及不使用<code>localStorage</code>的方法:</p>
<ul>
<li>不要在<code>localStorage</code>中存储敏感的用户信息</li>
<li>它不能替代基于服务器的数据库，因为信息只存储在浏览器中</li>
<li><code>localStorage</code>在所有主流浏览器中限制为5MB</li>
<li>非常不安全，因为它没有任何形式的数据保护，可以被你网页上的任何代码访问</li>
<li><code>localStorage</code>是同步的，意味着每个被调用的操作只会一个接一个地执行</li>
</ul>
<p>有了这些，我们在web应用程序中就拥有了<code><a href="https://blog.logrocket.com/web-storage-made-simple-use-local-storage-state/" target="_blank" rel="noopener">localStorage</a></code>的力量。</p><div class="code-block code-block-27">
<div class="blog-plug inline-plug vanilla-javascript-cta"><h2>通过理解上下文，更容易地调试JavaScript错误</h2>
<p>调试代码总是一项单调乏味的任务。但是你越了解自己的错误，就越容易改正。</p>
<p>LogRocket 让你以新的独特的方式理解这些错误。我们的前端监控解决方案跟踪用户与您的JavaScript前端的互动，让您能够准确找出导致错误的用户行为。</p>
<a href="https://lp.logrocket.com/blg/javascript-signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/cbfed9be3defcb505e662574769a7636.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/cbfed9be3defcb505e662574769a7636.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif"/></noscript></a>
<p>LogRocket记录控制台日志、页面加载时间、堆栈跟踪、慢速网络请求/响应(带有标题+正文)、浏览器元数据和自定义日志。理解您的JavaScript代码的影响从来没有这么简单过！</p>
<a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">Try it for free</a><p>.</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>