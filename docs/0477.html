<html>
<head>
<title>Authentication with Vue 3 and Firebase - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用Vue 3和Firebase - LogRocket博客进行认证</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/authentication-vue-3-firebase/#0001-01-01">https://blog.logrocket.com/authentication-vue-3-firebase/#0001-01-01</a></blockquote><div><article class="article-post">
<p><strong> <em>编者按:</em> </strong> <em>本文最后一次更新于2022年8月18日，以反映Firebase v9和Vue v3中所做的更改。</em></p>
<p>在构建任何类型的应用程序时，隐私和安全是需要牢记的两个重要因素。随着网络犯罪变得越来越先进，身份认证是阻止黑客攻击和保护用户最有价值信息的重要一步。</p>
<p><a href="https://firebase.google.com/docs/auth"> Firebase Authentication </a>提供后端服务来帮助验证应用程序中的用户，支持不同的身份验证方法，如密码和电话号码，并支持包括谷歌、推特和脸书在内的身份提供商。</p>
<p>要将Firebase身份验证集成到您的应用程序中，您可以使用<a href="https://firebase.google.com/docs/auth/android/firebaseui"> Firebase UI，</a>来处理用户登录不同提供商的UI流，或者您可以在您的项目中手动设置Firebase SDK，并配置对您想要使用的任何提供商的支持。</p>
<p>在本教程中，我们将手动设置Firebase。我们将创建用户注册和登录所需的不同视图，最后提供对电子邮件和密码认证的支持。</p>
<p>为了跟随本文，您可以<a href="https://github.com/Abiola-Farounbi/VUE-authentication">访问完整的代码库</a>。我们开始吧！</p>

<h2 id="setting-up-vue">设置Vue</h2>
<p>首先，我们将使用<a href="https://github.com/vuejs/vue-cli"> Vue CLI </a> v3.0快速搭建一个新的Vue项目。如果您已经安装了较旧版本的CLI，可以通过运行以下命令卸载它:</p>
<pre class="language-bash hljs">npm uninstall -g vue/cli
</pre>
<p>然后，通过运行以下命令全局安装新的CLI:</p>
<pre class="language-bash hljs">npm install -g @vue/cli
</pre>
<p>接下来，通过运行下面的命令创建一个新的Vue项目:</p>
<pre class="language-bash hljs">vue create firebase-auth
</pre>
<p>系统会提示您选择一个预设。选择<strong> Default ([Vue 3] babel，eslint) </strong>，这将在指定位置搭建一个新的Vue应用程序。</p>
<h2 id="setting-up-firebase-project">设置Firebase项目</h2>
<p>要开始使用Firebase，你需要一个Gmail帐户。前往<a href="https://console.firebase.google.com/u/0/">https://console.firebase.google.com/u/0/</a>创建一个新项目:</p>
<p><img data-attachment-id="127978" data-permalink="https://blog.logrocket.com/create-new-firebase-project-ui/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png" data-orig-size="730,354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="create-new-firebase-project-ui" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui-300x145.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png" decoding="async" class="aligncenter wp-image-127978 size-full jetpack-lazy-image" src="../Images/fb3a8f196fcbeb7a7fa02271071cd087.png" alt="Create New Firebase Project UI" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui-300x145.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127978" data-permalink="https://blog.logrocket.com/create-new-firebase-project-ui/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png" data-orig-size="730,354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="create-new-firebase-project-ui" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui-300x145.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png" decoding="async" loading="lazy" class="aligncenter wp-image-127978 size-full" src="../Images/fb3a8f196fcbeb7a7fa02271071cd087.png" alt="Create New Firebase Project UI" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui-300x145.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/create-new-firebase-project-ui.png"/></noscript>
<p>Firebase支持使用不同的方法进行身份验证，比如社交身份验证、电话号码以及标准的电子邮件和密码。</p>
<p>在本教程中，我们将使用电子邮件和密码认证方法。我们需要为我们刚刚在Firebase中创建的项目启用它，因为默认情况下它是禁用的。</p>
<p>在项目的<strong>认证部分</strong>下，点击<strong>登录方法</strong>，您应该会看到Firebase当前支持的提供商列表:</p>
<p><img data-attachment-id="127980" data-permalink="https://blog.logrocket.com/authentication-section-sign-in-method/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png" data-orig-size="730,407" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="authentication-section-sign-in-method" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method-300x167.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png" decoding="async" class="aligncenter wp-image-127980 size-full jetpack-lazy-image" src="../Images/418540c9db31da8c10e7f7deddb6cb7c.png" alt="Authentication Section Sign In Method" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method-300x167.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127980" data-permalink="https://blog.logrocket.com/authentication-section-sign-in-method/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png" data-orig-size="730,407" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="authentication-section-sign-in-method" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method-300x167.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png" decoding="async" loading="lazy" class="aligncenter wp-image-127980 size-full" src="../Images/418540c9db31da8c10e7f7deddb6cb7c.png" alt="Authentication Section Sign In Method" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method-300x167.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/authentication-section-sign-in-method.png"/></noscript>
<p>接下来，单击电子邮件/密码提供程序上的<strong>编辑</strong>图标，并打开<strong>启用</strong>开关:</p>
<p><img data-attachment-id="127984" data-permalink="https://blog.logrocket.com/edit-email-password-icon/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png" data-orig-size="730,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-email-password-icon" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon-300x180.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png" decoding="async" class="aligncenter wp-image-127984 size-full jetpack-lazy-image" src="../Images/5de2d1dc5a114042158d127af6e386a5.png" alt="Edit Email Password Icon" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon-300x180.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127984" data-permalink="https://blog.logrocket.com/edit-email-password-icon/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png" data-orig-size="730,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-email-password-icon" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon-300x180.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png" decoding="async" loading="lazy" class="aligncenter wp-image-127984 size-full" src="../Images/5de2d1dc5a114042158d127af6e386a5.png" alt="Edit Email Password Icon" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon-300x180.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/edit-email-password-icon.png"/></noscript>
<p>接下来，您需要在Firebase项目下注册您的应用程序。在项目的概述页面上，在<strong>通过将Firebase添加到您的应用</strong>开始下，选择<strong> web </strong> <strong>图标</strong>:</p>
<p><img data-attachment-id="127990" data-permalink="https://blog.logrocket.com/register-application-firebase-project/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png" data-orig-size="730,216" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="register-application-firebase-project" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project-300x89.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png" decoding="async" class="aligncenter wp-image-127990 size-full jetpack-lazy-image" src="../Images/85228da0445503e8135938832e5507e1.png" alt="Register Application Firebase Project" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project-300x89.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="127990" data-permalink="https://blog.logrocket.com/register-application-firebase-project/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png" data-orig-size="730,216" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="register-application-firebase-project" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project-300x89.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png" decoding="async" loading="lazy" class="aligncenter wp-image-127990 size-full" src="../Images/85228da0445503e8135938832e5507e1.png" alt="Register Application Firebase Project" srcset="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png 730w, https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project-300x89.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/08/register-application-firebase-project.png"/></noscript>
<p>一旦你完成了应用程序的注册，你会看到一个包含你的应用程序凭证的<strong> Add Firebase SDK </strong>部分。注意<code>firebaseConfig</code>对象，我们将在我们的Vue应用程序中使用它。</p>
<h2 id="installing-dependencies">安装依赖项</h2>
<p>接下来，<code>cd</code>进入您的项目目录，并运行以下命令来安装所有需要的依赖项:</p>
<pre class="language-bash hljs">npm i firebase <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fd8b8898d08f928889988fbdc9">[email protected]</a> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="631516061b230d061b17">[email protected]</a> 
</pre>
<ul>
<li>Firebase是我们将用来与Firebase交互的npm包</li>
<li><a href="https://router.vuejs.org/"> Vue路由器</a>是Vue的官方路由器</li>
<li>Vuex是Vue的一个状态管理库</li>
</ul>
<h2 id="integrating-firebase-vue">如何集成Firebase和Vue</h2>
<p>现在，我们可以用我们的Vue项目设置Firebase。在<code>main.js</code>文件中，我们将导入Firebase包，并将其配置为使用我们之前从Firebase控制台记录的应用程序凭证。在<code>src</code>文件夹中，创建一个名为<code>firebaseConfig.js</code>的文件，然后添加应用程序凭证，它应该类似于下面的代码:</p>
<pre class="language-javascript hljs">// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAuth } from 'firebase/auth'



const firebaseConfig = {
  apiKey: process.env.VUE_APP_FIREBASE_API_KEY,
  authDomain: process.env.VUE_APP_FIREBASE_AUTH_DOMAIN,
  databaseURL: process.env.VUE_APP_FIREBASE_DATABASE_URL,
  projectId: process.env.VUE_APP_FIREBASE_PROJECT_ID,
  storageBucket: process.env.VUE_APP_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: process.env.VUE_APP_FIREBASE_MESSAGING_SENDER_ID,
  appId: process.env.VUE_APP_FIREBASE_APP_ID,
  measurementId: process.env.VUE_APP_FIREBASE_MEASUREMENT_ID
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);

//initialize firebase auth
const auth = getAuth()


export { app, auth }
</pre>
<p>不要忘记用我们之前提到的Firebase凭证替换<code>firebaseConfig</code> vales。</p>
<h2 id="creating-components">创建组件</h2>
<p>现在，我们可以继续为我们的项目创建所需的组件。</p>
<ul>
<li><code>Register.vue</code>:处理允许用户注册的逻辑，以及显示注册视图</li>
<li><code>Login.vue</code>:允许用户登录并显示登录视图的句柄</li>
<li><code>Dashboard.vue</code>:用户成功注册或认证后显示</li>
<li><code>Navbar.vue</code>:将在所有其他组件之间共享的导航栏组件</li>
</ul>
<p>转到<code>src/components</code>目录，运行下面的命令来创建上面列出的组件:</p>
<pre class="language-javascript hljs">touch Register.vue Login.vue Dashboard.vue Navbar.vue
</pre>
<h2 id="adding-routing-project">将路由添加到项目中</h2>
<p>在我们开始处理组件之前，让我们添加应用程序将拥有的路线。在<code>src</code>目录下创建一个<code>routes</code>文件夹。在该文件夹中，添加一个<code>index.js</code>文件，并用以下代码编辑该文件:</p>
<pre class="language-javascript hljs">import { createRouter, createWebHistory } from 'vue-router'
import Login from '../views/Login.vue';
import Register from '../views/Register.vue';
import Dashboard from '../views/Dashboard.vue';


const routes = [
        {
        path: '/login',
        name: 'login',
        component: Login
    },
    {
        path: '/register',
        name: 'Register',
        component: Register
    },
    {
        path: '/',
        name: 'Dashboard',
        component: Dashboard
    }
]


const router = createRouter({
    history: createWebHistory(),
    routes
  })

  export default router      
</pre>
<p>接下来，用<code>&lt;router-view/&gt;</code>标签替换<code>App.vue</code>文件的内容:</p>
<pre class="language-bash hljs">&lt;template&gt;
  &lt;div&gt;
    &lt;main class="py-4"&gt;
      &lt;router-view&gt;&lt;/router-view&gt;
    &lt;/main&amp;gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
};
&lt;/script&gt;
</pre>
<h2 id="managing-state-vuex">使用Vuex管理状态</h2>
<p>Vuex是一个<a href="https://blog.logrocket.com/managing-multiple-store-modules-vuex/">状态管理库，它提供了一个集中的存储库</a>来帮助管理你的Vue应用中的组件。在<code>src</code>目录中创建一个<code>store.js</code>文件，并将以下代码添加到该文件中:</p>
<pre class="language-javascript hljs">import { createStore } from 'vuex'

const store = createStore({
})

// export the store
export default store
</pre>
<p>首先，我们定义包含一个<code>user</code>对象的状态，该对象包含关于登录用户的信息:</p>
<pre>state: {
  user: {
    loggedIn: false,
    data: null
  }
},
</pre>
<p>属性<code>loggedIn</code>的默认值为<code>false</code>，它是一个布尔值，告诉我们用户是否已经过身份验证。<code>data</code>属性保存登录用户的信息:</p>
<pre>getters: {
    user(state){
      return state.user
    }
  },
</pre>
<p>在<a href="https://blog.logrocket.com/unit-testing-vuex-modules-jest/#testing-getters"> Vuex中，getters通常提供一种访问存储在状态中的数据</a>的方法。我们定义了一个名为<code>user</code>的简单getter，它从状态中返回<code>user</code>对象:</p>
<pre>mutations: {
  SET_LOGGED_IN(state, value) {
    state.user.loggedIn = value;
  },
  SET_USER(state, data) {
    state.user.data = data;
  }
}
</pre>
<p>突变允许我们改变我们的状态；这里，我们定义了两种突变。第一个是<code>SET_LOGGED_IN</code>，它将<code>state.user</code>上的<code>loggedIn</code>属性设置为传递给它的<code>value</code>。<code>SET_USER</code>在<code>state.user</code>对<code>data</code>属性进行修改:</p>
<pre>  actions: {
      async register(context, { email, password, name}){
          const response = await createUserWithEmailAndPassword(auth, email, password)
          if (response) {
              context.commit('SET_USER', response.user)
              response.user.updateProfile({displayName: name})
          } else {
              throw new Error('Unable to register user')
          }
      },

      async logIn(context, { email, password }){
        const response = await signInWithEmailAndPassword(auth, email, password)
        if (response) {
            context.commit('SET_USER', response.user)
        } else {
            throw new Error('login failed')
        }
    },

    async logOut(context){
        await signOut(auth)
        context.commit('SET_USER', null)
    },

    async fetchUser(context ,user) {
      context.commit("SET_LOGGED_IN", user !== null);
      if (user) {
        context.commit("SET_USER", {
          displayName: user.displayName,
          email: user.email
        });
      } else {
        context.commit("SET_USER", null);
      }
  }
  }
</pre>
<p>动作类似于突变，但是<a href="https://blog.logrocket.com/unit-testing-vuex-modules-jest/#testing-actions">不是突变状态，而是提交突变</a>。<br/>为了简化流程，我们将在动作中定义认证的所有动作，然后在方法中分派它们。</p>
<p><code>register</code> action使用来自<code>firebase.auth()</code>的<code>createUserWithEmailAndPassword()</code>方法，传递我们想要在Firebase上注册的用户的电子邮件和密码。</p>
<p>我们不需要散列密码，因为Firebase会自动处理。如果注册成功，我们调用返回的<code>user</code>对象上的<code>updateProfile()</code>方法，将名称字段与<code>user</code>关联起来。否则，我们抛出一个错误异常，然后显示给用户。</p>
<p><code>logIn</code>动作使用与寄存器动作<code>()</code>相同的逻辑，但使用不同的<code>signInWithEmailAndPassword()</code>方法。</p>
<p><code>logout()</code>动作使用<code>signOut()</code>方法，然后将用户状态更新为<code>null</code>。<code>fetchUser</code>动作接受用户作为参数，根据其当前值更新状态。</p>
<h2 id="registering-users-firebase">在Firebase中注册用户</h2>
<p>让我们看看如何在Firebase上注册用户并存储他们的详细信息。用以下代码编辑<code>src/components/Register.vue</code>:</p>
<pre>&lt;template&gt;
  &lt;div class="container"&gt;
    &lt;div class="row justify-content-center"&gt;
      &lt;div class="col-md-8"&gt;
        &lt;div class="card"&gt;
          &lt;div class="card-header"&gt;Register&lt;/div&gt;
          &lt;div class="card-body"&gt;
            &lt;div v-if="error" class="alert alert-danger"&gt;{{error}}&lt;/div&gt;
            &lt;form action="#" @submit.prevent="Register"&gt;
              &lt;div class="form-group row"&gt;
                &lt;label for="name" class="col-md-4 col-form-label text-md-right"&gt;Name&lt;/label&gt;

                &lt;div class="col-md-6"&gt;
                  &lt;input
                    id="name"
                    type="name"
                    class="form-control"
                    name="name"
                    value
                    required
                    autofocus
                    v-model="name"
                  /&gt;
                &lt;/div&gt;
              &lt;/div&gt;

              &lt;div class="form-group row"&gt;
                &lt;label for="email" class="col-md-4 col-form-label text-md-right"&gt;Email&lt;/label&gt;

                &lt;div class="col-md-6"&gt;
                  &lt;input
                    id="email"
                    type="email"
                    class="form-control"
                    name="email"
                    value
                    required
                    autofocus
                    v-model="email"
                  /&gt;
                &lt;/div&gt;
              &lt;/div&gt;

              &lt;div class="form-group row"&gt;
                &lt;label for="password" class="col-md-4 col-form-label text-md-right"&gt;Password&lt;/label&gt;

                &lt;div class="col-md-6"&gt;
                  &lt;input
                    id="password"
                    type="password"
                    class="form-control"
                    name="password"
                    required
                    v-model="password"
                  /&gt;
                &lt;/div&gt;
              &lt;/div&gt;

              &lt;div class="form-group row mb-0"&gt;
                &lt;div class="col-md-8 offset-md-4"&gt;
                  &lt;button type="submit" class="btn btn-primary"&gt;Register&lt;/button&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/form&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;


&lt;script&gt;
import { ref } from 'vue'
import { useStore } from 'vuex'
import { useRouter } from 'vue-router'

export default {
  name: "RegisterComponent",
 setup() {
    const name = ref('')
    const email = ref('')
    const password = ref('')
    const error = ref(null)

    const store = useStore()
    const router = useRouter()

    const Register = async () =&gt; {
      try {
        await store.dispatch('register', {
          email: email.value,
          password: password.value,
          name: name.value
        })
        router.push('/')
      }
      catch (err) {
        error.value = err.message
            }
    }

    return { Register, name,email, password, error }
  }
};
&lt;/script&gt;
</pre>
<p>在<code>&lt;template&gt;&lt;/template&gt;</code>标签中，我们为注册用户创建了一个简单的引导表单。表单中的每个输入字段都在来自组合API 的<a href="https://blog.logrocket.com/vue-composition-api-vs-react-hooks/"> <code>setup()</code>钩子中定义。当提交表单时，调用<code>Register</code>函数，该函数处理用户在Firebase上的实际注册。</a></p>
<p>为了进一步理解发生了什么，让我们来详细看看<code>Register</code>函数:</p>
<pre>const Register = async () =&gt; {
      try {
        await store.dispatch('register', {
          email: email.value,
          password: password.value,
          name: name.value
        })
        router.push('/')
      }
      catch (err) {
        error.value = err.message
            }
    }
</pre>
<p>在<code>submit()</code>方法中，<code>firebase.auth()</code>让我们可以访问默认应用的认证服务。</p>
<p>接下来，我们调用<code>createUserWithEmailAndPassword()</code>，传递我们想要在Firebase上注册的用户的电子邮件和密码。我们不需要散列密码，因为Firebase会自动完成这项工作。</p>
<p>由此，我们定义了一个异步函数<code>Register</code>，它从商店和电子邮件中调度<code>Register</code>动作，然后传递密码和名称作为有效负载。如果成功，用户将被重定向到仪表板页面。否则，错误会显示在页面中。</p>
<h2 id="logging-users">登录用户</h2>
<p>接下来，让我们学习如何允许用户登录。继续用下面的代码编辑我们之前创建的<code>Login.vue</code>组件:</p>
<pre>&lt;template&gt;
  &lt;div class="container"&gt;
    &lt;div class="row justify-content-center"&gt;
      &lt;div class="col-md-8"&gt;
        &lt;div class="card"&gt;
          &lt;div class="card-header"&gt;Login&lt;/div&gt;
          &lt;div class="card-body"&gt;
            &lt;div v-if="error" class="alert alert-danger"&gt;{{error}}&lt;/div&gt;
            &lt;form action="#"  @submit.prevent="Login"&gt;
              &lt;div class="form-group row"&gt;
                &lt;label for="email" class="col-md-4 col-form-label text-md-right"&gt;Email&lt;/label&gt;

                &lt;div class="col-md-6"&gt;
                  &lt;input
                    id="email"
                    type="email"
                    class="form-control"
                    name="email"
                    value
                    required
                    autofocus
                    v-model="email"
                  /&gt;
                &lt;/div&gt;
              &lt;/div&gt;

              &lt;div class="form-group row"&gt;
                &lt;label for="password" class="col-md-4 col-form-label text-md-right"&gt;Password&lt;/label&gt;

                &lt;div class="col-md-6"&gt;
                  &lt;input
                    id="password"
                    type="password"
                    class="form-control"
                    name="password"
                    required
                    v-model="password"
                  /&gt;
                &lt;/div&gt;
              &lt;/div&gt;

              &lt;div class="form-group row mb-0"&gt;
                &lt;div class="col-md-8 offset-md-4"&gt;
                  &lt;button type="submit" class="btn btn-primary"&gt;Login&lt;/button&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/form&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import { ref } from 'vue'
import { useStore } from 'vuex'
import { useRouter } from 'vue-router'

export default {
  name: "LoginComponent",
    setup() {
    const email = ref('')
    const password = ref('')
    const error = ref(null)

    const store = useStore()
    const router = useRouter()

    const Login = async () =&gt; {
      try {
        await store.dispatch('logIn', {
          email: email.value,
          password: password.value
        })
        router.push('/')
      }
      catch (err) {
        error.value = err.message
      }
    }
    return { Login, email, password, error }
  }
};
&lt;/script&gt;
</pre>
<p><code>Login.vue</code>组件类似于<code>Register.vue</code>组件。表单中的每个输入字段都在组合API的<code>setup()</code>钩子中定义。当用户提交表单时，调用<code>Login</code>函数，处理用户在Firebase上的实际注册:</p>
<pre>    const Login = async () =&gt; {
      try {
        await store.dispatch('logIn', {
          email: email.value,
          password: password.value
        })
        router.push('/')
      }
      catch (err) {
        error.value = err.message
      }
    }
</pre>
<h2 id="creating-dashboard-component">创建<code>Dashboard</code>组件</h2>
<p>接下来，我们将定义一个简单的仪表板视图，其中包含一个引导警报，通知用户他们已经成功登录，显示用户配置文件，并显示注销按钮。将以下代码添加到<code>src/components/Dashboard.vue</code>文件中:</p>
<pre>&lt;template&gt;
  &lt;div class="container"&gt;
    &lt;div class="row justify-content-center"&gt;
      &lt;div class="col-md-8"&gt;
        &lt;div class="card"&gt;
          &lt;div v-if="user.loggedIn"&gt;

          &lt;div class="card-header"&gt;Welcome, {{user.data.displayName}}&lt;/div&gt;
          &lt;div class="card-body"&gt;
            &lt;div class="alert alert-success" role="alert"&gt;
            You are logged in!
            &lt;div class="my-4"&gt;
                  &lt;button  @click.prevent="signOut" class="btn btn-primary"&gt;Log Out&lt;/button&gt;
            &lt;/div&gt;
             &lt;/div&gt;
          &lt;/div&gt;

          &lt;/div&gt;
            &lt;div v-else class="alert alert-danger" role="alert"&gt;
              You are not logged in! 
            &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import { useStore} from "vuex";
import { useRouter } from "vue-router";
import {computed} from "vue";
import { auth } from '../firebaseConfig'


export default {
  name: "DashboardComponent",

  setup() {

  const store = useStore()
  const router = useRouter()

  auth.onAuthStateChanged(user =&gt; {
    store.dispatch("fetchUser", user);
  });

  const user = computed(() =&gt; {
    return store.getters.user;
  });

  const signOut = async () =&gt; {
        await store.dispatch('logOut')
        router.push('/')
  }

    return {user,signOut}
 }



};
&lt;/script&gt;
</pre>
<p>使用<code>onAuthStateChanged()</code>观察器，我们可以在用户成功通过身份验证时分派<code>fetchUser()</code>动作:</p>
<pre>  auth.onAuthStateChanged(user =&gt; {
    store.dispatch("fetchUser", user);
  });
</pre>
<p>使用计算出的属性，我们可以很容易地从存储getters中更新用户对象:</p>
<pre>  const user = computed(() =&gt; {
    return store.getters.user;
  });
</pre>
<p>然后，用户的配置文件信息会显示在仪表板页面上。</p>
<h2 id="logging-out-users">注销用户</h2>
<p>在<code>Dashboard.vue</code>组件中，我们定义了一个<code>signOut()</code>函数。该函数从商店调度<code>logout</code>动作，然后它被重定向回登录页面:</p>
<pre>const signOut = async () =&gt; {
        await store.dispatch('logOut')
        router.push('/login')
  }
</pre>
<h2 id="conclusion">结论</h2>
<p>在本教程中，我们学习了如何使用Firebase支持的电子邮件和密码提供者来建立一个简单的认证系统。Firebase是提高应用程序安全性的一个很好的工具，正如您所看到的，Firebase身份验证使用起来相当简单。</p>
<p>为了构建这个项目，您可以向某些路由添加中间件，并且只允许经过身份验证的用户访问这些路由。我希望你喜欢这个教程，如果你有任何问题，一定要留下评论。编码快乐！</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>