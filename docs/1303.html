<html>
<head>
<title>Build rich text editors in React using Draft.js and react-draft-wysiwyg - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用Draft.js和react-draft-wysiwyg - LogRocket博客在React中构建富文本编辑器</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/#0001-01-01">https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/#0001-01-01</a></blockquote><div><article class="article-post">
<p><em> <strong>编者按:</strong>这份在React中构建富文本编辑器的指南是由<a href="https://blog.logrocket.com/author/shalithasuranga/"> Shalitha Suranga </a>于2022年12月1日最后一次更新的，以反映React的更新。这次更新增加了关于react-draft-wysiwyg的好处的部分，关于Draft.js和react-draft-wysiwyg的更多信息，以及关于使用<code>UseEffect</code>钩子的部分。要了解更多关于React挂钩的信息，请查看我们的<a href="https://blog.logrocket.com/react-reference-guide-hooks-api/"> React挂钩参考指南</a>和<a href="https://blog.logrocket.com/react-hooks-cheat-sheet-unlock-solutions-to-common-problems-af4caf699e70/">备忘单</a>。</em></p>
<p>前端开发人员通常使用明文输入或<code>textarea</code>元素来捕获小尺寸的文本段，例如用户名、地址或城市。在某些情况下，他们需要让用户在web应用程序中输入带有多媒体项目的格式化文本。然而，明文输入不能满足这些需求，所以开发人员倾向于使用富文本编辑器的概念。</p>
<p>富文本编辑器已经成为我们与web应用程序交互方式中不可或缺的一部分，尤其是在内容生成方面。基于Web的富文本编辑器通常是<a href="https://blog.logrocket.com/build-a-wysiwyg-text-editor-using-quill/"> WYSIWYG HTML </a>编辑器，提供样式化和格式化的文本片段的实时预览。富文本编辑器使您能够控制文本的外观，并为内容创建者提供了一种在任何地方创建和发布HTML的强大方法。</p>
<p>在本文中，我们将使用<a href="https://draftjs.org/"> Draft.js </a>和<a href="https://www.npmjs.com/package/react-draft-wysiwyg"> react-draft-wysiwyg </a>来构建一个富文本编辑器，并显示我们使用该编辑器创建的文本。</p>
<p><em>向前跳转:</em></p>

<h2 id="draft-js">什么是Draft.js？</h2>
<p><a href="https://draftjs.org/"> Draft.js </a>是React的一个富文本编辑器框架，为开发者提供API来构建自己的富文本编辑器实现。它提供了一个预先开发的React组件，用于生成和呈现富文本。Draft.js通过提供一个声明性API，支持从简单的文本格式到嵌入媒体项(如超链接、图像、提及等)的各种功能，让开发人员能够为各种用例构建富文本编辑器。</p>
<p>Draft.js不提供预建的工具栏元素。它提供了原子富文本编辑器构建块作为框架，所以如果我们需要创建一个带工具栏的富文本编辑器，我们必须使用基于Draft.js的包装器库或者从头构建一个。</p>
<h2 id="react-draft-wysiwyg">什么是反应-草稿-所见即所得？</h2>
<p><a href="https://www.npmjs.com/package/react-draft-wysiwyg"> react-draft-wysiwyg </a>库是一个使用react和Draft.js库构建的wysiwyg(所见即所得)编辑器。它带有许多可定制的内置功能，这些功能是现代HTML编辑器组件所期望的，例如文本样式按钮、键盘快捷键支持、嵌入媒体项目、表情符号支持等等。</p>
<h2 id="benefits-react-draft-wysiwyg">反应-草稿-所见即所得的好处</h2>
<h3 id="fully-featured-package">功能齐全的套装</h3>
<p><a href="https://www.npmjs.com/package/react-draft-wysiwyg"> react-draft-wysiwyg </a>库提供了一个丰富的文本编辑器组件，它具有所有通用的wysiwyg特性和一些高级特性，包括提及和标签支持。您可以将预构建的编辑器安装到您的应用程序中，并拥有您需要的所有功能！</p>
<h3 id="customizability-flexibility">可定制性和灵活性</h3>
<p>这个库没有通过提供一个严格的特性集来限制开发者的特性范围。它允许开发者通过各种组件道具定制工具栏和特性。您甚至可以轻松添加自定义工具栏项目！</p>
<h3 id="quick-setup-available-integrations">快速设置和可用集成</h3>
<p>react-draft-wysiwyg库还附带了一个简单的API、自解释的组件道具和编写良好的文档。这允许您在创纪录的时间内为React应用程序设置一个富文本编辑器。此外，您可以在富文本编辑器组件中使用Draft.js核心API和一些流行的Draft.js社区库。</p>
<h2 id="draft.js-react-draft-wysiwyg">Draft.js和react-draft-wysiwyg入门</h2>
<p>本教程假设您已经掌握了<a href="https://reactjs.org/"> React </a>的工作知识。此外，确保您的机器上安装了<a href="https://nodejs.org/en/"> Node.js </a>、<a href="https://yarnpkg.com/"> Yarn </a>或<a href="https://npmjs.com/"> npm </a>。我们将使用<a href="https://github.com/facebook/create-react-app"> Create React App </a>来引导我们的项目。</p>
<p>让我们在您选择的目录中创建我们的项目。可以在命令行中键入下面突出显示的任何命令来完成您的项目。</p>
<p>npx: <code>npx create-react-app draft-js-example</code></p>
<p>npm ( <code>npm init &lt;initializer&gt;</code>在npm v6+中可用):<code>npm init react-app draft-js-example</code></p>
<p>纱线(<code><a href="https://yarnpkg.com/lang/en/docs/cli/create/">yarn create</a></code>在v0.25+中可用):<code>yarn create react-app draft-js-example</code></p>
<p>这将生成一个新的React项目，其目录结构如下:</p>
<pre class="language-plaintext hljs">draft-js-example-|
      |__node_mudles/
      |__public/
      |__src/
      |__.gitignore
      |__pacakge.json
      |__README.md
      |__yarn.lock
</pre>
<p>导航到项目文件夹的根目录并运行它:</p>
<pre class="language-bash hljs">cd draft-js-example

npm start
# --- or ---
yarn start
</pre>
<p>这将在开发模式下运行应用程序，您可以使用<a href="http://localhost:3000/"> <code>http://localhost:3000/</code> </a>在浏览器中查看它:</p>
<p><img data-attachment-id="150691" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/react-app-js-browser/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png" data-orig-size="730,418" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React app.js in a browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser-300x172.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png" decoding="async" class="aligncenter size-full wp-image-150691 jetpack-lazy-image" src="../Images/efc5db018a7a284fadcf45d67ff6ccaf.png" alt="React App.js in a Browser" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser-300x172.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150691" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/react-app-js-browser/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png" data-orig-size="730,418" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="React app.js in a browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser-300x172.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150691" src="../Images/efc5db018a7a284fadcf45d67ff6ccaf.png" alt="React App.js in a Browser" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser-300x172.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/react-app-js-browser.png"/></noscript>
<h3 id="install-required-dependencies">安装所需的依赖项</h3>
<p>以下命令将Draft.js和react-draft-wysiwyg包安装到react项目中:</p>
<pre class="language-bash hljs">npm install install draft-js react-draft-wysiwyg
# --- or ---
yarn add draft-js react-draft-wysiwyg
</pre>
<h2 id="setup-editor">设置编辑器</h2>
<p>开始之前，我们需要对<code>src/App.js</code>文件进行一些编辑。我们将从<code>react-draft-wysiwyg</code>引进<code>editor</code>组件和样式，从<code>draft-js</code>引进<code>EditorState</code>。</p>
<p><code>editor</code>使用默认的Draft.js编辑器，没有任何样式。Draft.js编辑器是作为基于React的受控输入API的受控<code>ContentEditable</code>组件构建的。<code>EditorState</code>提供了<code>EditorState</code>的快照。这包括撤消/重做历史、内容和光标。</p>
<p>让我们添加一些代码来显示一个富文本编辑器。将以下代码添加到您的<code>App.js</code>文件中:</p>
<pre class="language-javascript hljs">import React, { useState } from 'react';
import { EditorState } from 'draft-js';
import { Editor } from 'react-draft-wysiwyg';

import 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';
import './App.css';

function App() {
  const [editorState, setEditorState] = useState(
    () =&gt; EditorState.createEmpty(),
  );

  return (
    &lt;div className="App"&gt;
      &lt;header className="App-header"&gt;
        Rich Text Editor Example
      &lt;/header&gt;

      &lt;Editor
        editorState={editorState}
        onEditorStateChange={setEditorState}
      /&gt;
    &lt;/div&gt;
  )
}

export default App;
</pre>
<p>我们将从使用<code>EditorState</code>的<code>createEmpty</code>方法创建的空状态开始。<code>editor</code>以<code>EditorState</code>为道具。您会注意到在保存更改和显示更新后，视图看起来不太好:</p>
<p><img data-attachment-id="150693" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-web-browser/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser.gif" data-orig-size="730,406" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Rich text editor example on the web browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser-300x167.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser.gif" decoding="async" class="aligncenter size-full wp-image-150693 jetpack-lazy-image" src="../Images/5b508aff7a177f0bc268f437599b2060.png" alt="Rich Text Editor Example on the Web Browser " data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150693" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-web-browser/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser.gif" data-orig-size="730,406" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Rich text editor example on the web browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser-300x167.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150693" src="../Images/5b508aff7a177f0bc268f437599b2060.png" alt="Rich Text Editor Example on the Web Browser " data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-web-browser.gif"/></noscript>
<p>需要对<code>App.css</code>文件进行一些修改。将其内容替换为以下内容:</p>
<pre class="language-css hljs">.App-header {
  background-color: #282c34;
  min-height: 5vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: calc(10px + 2vmin);
  color: white;
  margin-bottom: 5vh;
  text-align: center;
  padding: 12px;
 }
</pre>
<p>现在，<code>editor</code>已经在浏览器视图中定位好了。通过点击<strong>工具栏图标</strong>或按键盘快捷键如<strong> <code>Control + B</code> </strong>来输入一些文本并改变样式以显示粗体文本:</p>
<p><img data-attachment-id="150695" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-improved/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved.gif" data-orig-size="730,475" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="The rich text editor with better positioning" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved-300x195.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved.gif" decoding="async" class="aligncenter size-full wp-image-150695 jetpack-lazy-image" src="../Images/6ec7322d29462b105f3dc9160e3938be.png" alt="The Rich Text Editor with Better Positioning" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150695" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-improved/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved.gif" data-orig-size="730,475" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="The rich text editor with better positioning" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved-300x195.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150695" src="../Images/6ec7322d29462b105f3dc9160e3938be.png" alt="The Rich Text Editor with Better Positioning" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-improved.gif"/></noscript>
<h2 id="styling-editor">样式编辑器</h2>
<p>如果你看我们上面渲染的编辑器，很难判断应该在哪里输入文本。使用样式道具可以使编辑器的不同部分更加明显。道具可以是应用于特定部分的类，也可以是包含样式的对象:</p>
<ul>
<li><code>wrapperClassName</code> = <code>"wrapper-class"</code></li>
<li><code>editorClassName</code> = <code>"editor-class"</code></li>
<li><code>toolbarClassName</code> = <code>"toolbar-class"</code></li>
<li><code>wrapperStyle</code> = <code>{&lt;wrapperStyleObject&gt;}</code></li>
<li><code>editorStyle</code> = <code>{&lt;editorStyleObject&gt;}</code></li>
<li><code>toolbarStyle</code> = <code>{&lt;toolbarStyleObject&gt;}</code></li>
</ul>
<p>向<code>Editor</code>组件添加<code>className</code>道具，向<code>App.css</code>添加相关样式，如下所示，为编辑器设置样式:</p>
<h3 id="app-js"><code>App.js</code>:</h3>
<pre class="language-javascript hljs">&lt;Editor
  editorState={editorState}
  onEditorStateChange={setEditorState}
  wrapperClassName="wrapper-class"
  editorClassName="editor-class"
  toolbarClassName="toolbar-class"
/&gt;
</pre>
<h3 id="app-css"><code>App.css</code>:</h3>
<pre class="language-css hljs">.wrapper-class {
  padding: 1rem;
  border: 1px solid #ccc;
}
.editor-class {
  background-color:lightgray;
  padding: 1rem;
  border: 1px solid #ccc;
}
.toolbar-class {
  border: 1px solid #ccc;
}
</pre>
<p>现在，富文本编辑器应该是这样的:</p>
<p><img data-attachment-id="150698" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-customized/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized.gif" data-orig-size="730,475" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="A rich text editor with custom styling in containers" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized-300x195.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized.gif" decoding="async" class="aligncenter size-full wp-image-150698 jetpack-lazy-image" src="../Images/306062321a4c4ff33a6195647e48d63a.png" alt="A Rich Text Editor With Custom Styling in Containers" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150698" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-customized/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized.gif" data-orig-size="730,475" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="A rich text editor with custom styling in containers" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized-300x195.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150698" src="../Images/306062321a4c4ff33a6195647e48d63a.png" alt="A Rich Text Editor With Custom Styling in Containers" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customized.gif"/></noscript>
<blockquote><p>注意:在开发模式下，您可能会注意到一个警告，上面写着“<code>Can’t call setState on a component</code>”。React显示此警告消息是因为react-draft-wysiwyg中存在问题。希望库的维护者能尽快发布这个问题的修复程序。现在，您可以禁用本教程的<a href="https://reactjs.org/docs/strict-mode.html">反应严格模式</a>，如下所示:</p></blockquote>
<pre class="language-javascript hljs">import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;App /&gt;);
</pre>
<p>在GitHub 上看到关于这个问题<a href="https://github.com/jpuri/react-draft-wysiwyg/issues?q=Can%27t+call+setState">的更多细节。</a></p>
<h2 id="working-editor-state">与<code>EditorState</code>一起工作</h2>
<p>编辑器可以是受控制的组件<a href="https://blog.logrocket.com/controlled-vs-uncontrolled-components-in-react/">或不受控制的组件</a>。使用编辑器的顶层状态对象<code>EditorState</code>实现受控编辑器。</p>
<p>而不受控制的编辑器可以使用<a href="https://draftjs.org/docs/api-reference-editor-state"> <code>EditorState</code> </a>或<a href="https://github.com/facebook/draft-js/blob/main/src/model/encoding/RawDraftContentState.js"> <code>RawDraftContentState</code> </a>创建，这是表示内容的原始格式的预期结构的流程类型。如果我们想创建一个受控编辑器，我们将向它传递以下道具:</p>
<ul>
<li><code>editorState</code>:支持以受控方式更新编辑器状态</li>
<li><code>onEditorStateChange</code>:当编辑器状态发生变化时调用的函数，该函数采用<code>EditorState</code>类型的对象参数</li>
</ul>
<p>在将这些添加到我们的<code>editor</code>组件中之后，它将看起来像这样:</p>
<pre class="language-javascript hljs">function App() {
  const [editorState, setEditorState] = useState(
    () =&gt; EditorState.createEmpty(),
  );

  return (
    &lt;div className="App"&gt;
      &lt;header className="App-header"&gt;
        Rich Text Editor Example
      &lt;/header&gt;
      &lt;Editor
        editorState={editorState}
        onEditorStateChange={setEditorState}
        wrapperClassName="wrapper-class"
        editorClassName="editor-class"
        toolbarClassName="toolbar-class"
      /&gt;
    &lt;/div&gt;
  )
}
</pre>
<p><code>EditorState</code>也可以通过传递<code>defaultEditorState</code>来创建一个不受控制的编辑器。这是一个类型为<code>EditorState</code>的对象，一旦它被创建，就用它来初始化编辑器状态:</p>
<pre class="language-javascript hljs">function App() {
  const [editorState, setEditorState] = useState(
    () =&gt; EditorState.createEmpty(),
  );


  return (
    &lt;div className="App"&gt;
      &lt;header className="App-header"&gt;
        Rich Text Editor Example
      &lt;/header&gt;
      &lt;Editor
        defaultEditorState={editorState}
        onEditorStateChange={setEditorState}
        wrapperClassName="wrapper-class"
        editorClassName="editor-class"
        toolbarClassName="toolbar-class"
      /&gt;
    &lt;/div&gt;
  )
}
</pre>
<p>另一种实现不受控制的编辑器的方法是使用<code>RawDraftContentState</code>。不受控制的编辑器采用以下道具:</p>
<ul>
<li><code>defaultContentState</code>:类型为<code>RawDraftContentState</code>的对象，用于在创建编辑器后初始化编辑器状态</li>
<li><code>onContentStateChange</code>:当编辑器状态发生变化时调用的函数，该函数采用<code>RawDraftContentState</code>类型的对象参数</li>
</ul>
<p>使用<code>RawDraftContentState</code>实现的不受控制的编辑器如下所示:</p>
<pre class="language-javascript hljs">import React, { useState } from 'react';
import { ContentState, convertToRaw } from 'draft-js';
import { Editor } from 'react-draft-wysiwyg';
import 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';
import './App.css';

function App() {
  const _contentState = ContentState.createFromText('Sample content state');
  const raw = convertToRaw(_contentState);  // RawDraftContentState JSON
  const [contentState, setContentState] = useState(raw); // ContentState JSON


  return (
    &lt;div className="App"&gt;
      &lt;header className="App-header"&gt;
        Rich Text Editor Example
      &lt;/header&gt;
      &lt;Editor
        defaultContentState={contentState}
        onContentStateChange={setContentState}
        wrapperClassName="wrapper-class"
        editorClassName="editor-class"
        toolbarClassName="toolbar-class"
      /&gt;
    &lt;/div&gt;
  )
}

export default App;
</pre>
<p>呈现后，将会显示这样的富文本编辑器，其中包含预加载的文本:</p>
<p><img data-attachment-id="150700" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-uncontrolled-editor/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png" data-orig-size="730,475" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Uncontrolled rich text editor using RawDraftContentState" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor-300x195.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png" decoding="async" class="aligncenter size-full wp-image-150700 jetpack-lazy-image" src="../Images/256c49b25308d61c8b9a66d305a78dde.png" alt="Uncontrolled Rich Text Editor Using RawDraftContentState" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor-300x195.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150700" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-uncontrolled-editor/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png" data-orig-size="730,475" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Uncontrolled rich text editor using RawDraftContentState" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor-300x195.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150700" src="../Images/256c49b25308d61c8b9a66d305a78dde.png" alt="Uncontrolled Rich Text Editor Using RawDraftContentState" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor-300x195.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-uncontrolled-editor.png"/></noscript>
<h2 id="using-data-conversion-functions">使用数据转换功能</h2>
<p>作为与富文本编辑器交互的用户，您无疑需要保存文本或编辑保存的文本。这意味着您应该能够将<code>ContentState</code>转换为原始JavaScript，反之亦然——或者将<code>ContentState</code>转换为HTML，反之亦然。Draft.js提供了三个函数来实现这一点:</p>
<ul>
<li><code><a href="https://draftjs.org/docs/api-reference-data-conversion#convertfromraw">ContentFromRaw</a></code>:将原始状态(<code>RawDraftContentState</code>)转换为<code>ContentState</code>。您可以使用这个函数将保存在数据库中原始JSON结构加载到富文本编辑器实例中</li>
<li><code><a href="https://draftjs.org/docs/api-reference-data-conversion#converttoraw">ContentToRaw</a></code>:将<code>ContentState</code>转换为原始状态。您可以使用这个函数将当前的富文本编辑器状态转换为原始的JSON结构，以便存储在数据库中</li>
<li><code><a href="https://draftjs.org/docs/api-reference-data-conversion#convertfromhtml">ContentFromHTML</a></code>:将一个HTML片段转换成一个带有两个键的对象，其中一个键保存一个<a href="https://draftjs.org/docs/api-reference-content-block/"> <code>ContentBlock</code> </a>对象的数组，另一个键保存一个对<code>entityMap</code>的引用。然后，该对象可用于从HTML文档构造内容状态</li>
</ul>
<p>对于我们的特定用例，我们希望将编辑器状态转换为HTML以便存储和显示。我们可以使用像<a href="https://www.npmjs.com/package/draftjs-to-html"> draftjs-to-html </a>或者<a href="https://www.npmjs.com/package/draft-convert"> draft-convert </a>这样的库来实现。我们将使用draft-convert，因为它比draftjs-to-html拥有更多的功能。</p>
<p>在您的终端中运行以下命令进行安装:</p>
<pre class="language-bash hljs">npm install draft-convert
# --- or ---
yarn add draft-convert
</pre>
<p>让我们使用draft-convert包从编辑器状态生成HTML！</p>
<h2 id="create-preview-converted-editor-state">为转换后的<code>EditorState</code>创建预览</h2>
<p>我们的富文本编辑器已经准备好创建一些富文本，但是还不能保存或预览我们输入的内容。您可以使用编辑器和不同的工具栏选项，看看如何创建富文本。以下是我在这个阶段能够用编辑器做的不同事情的例子:</p>
<p><img data-attachment-id="150702" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/text-editor-toolbar-controls/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png" data-orig-size="730,346" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sample formatted text with the editor toolbar controls" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls-300x142.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png" decoding="async" class="aligncenter size-full wp-image-150702 jetpack-lazy-image" src="../Images/b91da31ad13f5896b9de507e8c9102f9.png" alt="Sample Formatted Text With the Editor Toolbar Controls" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls-300x142.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150702" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/text-editor-toolbar-controls/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png" data-orig-size="730,346" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sample formatted text with the editor toolbar controls" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls-300x142.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150702" src="../Images/b91da31ad13f5896b9de507e8c9102f9.png" alt="Sample Formatted Text With the Editor Toolbar Controls" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls-300x142.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/text-editor-toolbar-controls.png"/></noscript>
<p>下一步是将这个富文本转换成HTML。我们将使用draft-convert中的<code>convertToHTML</code>函数来转换它，但是首先，我们需要获取编辑器中输入的当前内容。</p>
<p><code>EditorState</code>提供了一个方法<code>getCurrentContent</code>，它返回编辑器的当前<code>ContentState</code>，然后我们可以将它转换成HTML。</p>
<p>我们处理<code>EditorState</code>变化的方式将不得不有所改变。将调用一个处理程序来更新<code>EditorState</code>，组件将转换后的<code>HTML</code>存储在一个JavaScript变量中。</p>
<h3 id="using-use-effect-hook">使用<code>useEffect</code>挂钩</h3>
<p>让我们添加一个组件，它将获取<code>editor</code>内容，将其转换为HTML，并在浏览器控制台上打印原始的<code>HTML</code>字符串:</p>
<pre class="language-javascript hljs">import React, { useState, useEffect } from 'react';
import { EditorState } from 'draft-js';
import { Editor } from 'react-draft-wysiwyg';
import { convertToHTML } from 'draft-convert';

import 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';
import './App.css';

function App() {
  const [editorState, setEditorState] = useState(
    () =&gt; EditorState.createEmpty(),
  );
  const [convertedContent, setConvertedContent] = useState(null);

  useEffect(() =&gt; {
    let html = convertToHTML(editorState.getCurrentContent());
    setConvertedContent(html);
  }, [editorState]);

  console.log(convertedContent);

  return (
    &lt;div className="App"&gt;
      &lt;header className="App-header"&gt;
        Rich Text Editor Example
      &lt;/header&gt;
      &lt;Editor
        editorState={editorState}
        onEditorStateChange={setEditorState}
        wrapperClassName="wrapper-class"
        editorClassName="editor-class"
        toolbarClassName="toolbar-class"
      /&gt;
    &lt;/div&gt;
  )
}

export default App;
</pre>
<blockquote><p>请注意，<code>draft-convert</code>可能不支持某些编辑器格式，这可能会导致错误。</p></blockquote>
<p>上面的代码使用<a href="https://blog.logrocket.com/guide-to-react-useeffect-hook/"> <code>useEffect</code>钩子</a>和<code>[editorState]</code>依赖数组来更新<code>convertedContent</code>状态值。运行上述代码并输入一些带有样式的文本后，您可以在浏览器控制台上看到当前编辑器状态的原始HTML内容，如下所示:</p>
<p><img data-attachment-id="150704" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/editor-state-raw-html-react-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app.gif" data-orig-size="730,397" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Printing raw HTML of the editor state on the browser console" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app-300x163.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app.gif" decoding="async" class="aligncenter size-full wp-image-150704 jetpack-lazy-image" src="../Images/a3c1fbbbfa1db16515053bbe90a4bbe5.png" alt="Printing Raw HTML of the Editor State on the Browser Console" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150704" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/editor-state-raw-html-react-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app.gif" data-orig-size="730,397" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Printing raw HTML of the editor state on the browser console" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app-300x163.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150704" src="../Images/a3c1fbbbfa1db16515053bbe90a4bbe5.png" alt="Printing Raw HTML of the Editor State on the Browser Console" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/editor-state-raw-html-react-app.gif"/></noscript>
<p>既然编辑器中输入的文本在呈现<a href="https://blog.logrocket.com/million-js-build-apps-jsx-faster-react-preact/"> JSX </a>结构之前已经被转换，我们就可以显示它了。我们将创建一个<code>div</code>来显示输入的文本。</p>
<p>所以，为了显示文本，我们将使用<a href="https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml"> <code>dangerouslySetInnerHTML</code> </a>。你可能会问自己，为什么是<code>dangerously</code>？通过从代码中设置HTML，您将自己暴露在<a href="https://en.wikipedia.org/wiki/Cross-site_scripting">跨站脚本(XSS) </a>攻击之下。这个名字微妙地提醒了我们这样做的危险性。</p>
<h3 id="sanitizing-html">净化你的HTML</h3>
<p>你必须确保你的<a href="https://blog.logrocket.com/what-you-need-know-inbuilt-browser-html-sanitization/"> HTML在被添加到你的页面之前已经被适当地组织和净化了。一个简单的方法是使用</a><a href="https://www.npmjs.com/package/dompurify"> dompurify </a>库。</p>
<p>使用以下命令安装此软件包:</p>
<pre class="language-bash hljs">npm install dompurify
# --- or ---
yarn add dompurify
</pre>
<p><code>dangerouslySetInnerHTML</code>接收一个带有<code>__html</code>键(两个下划线)的对象。这把钥匙将保存消毒过的<code>HTML</code>。我们现在可以添加方法来净化<code>HTML</code>和元素来保存它。添加<code>import DOMPurify from 'dompurify';</code>。</p>
<p>接下来，使用以下函数实现代替现有的<code>console.log</code>语句:</p>
<pre class="language-javascript hljs">function createMarkup(html) {
  return {
    __html: DOMPurify.sanitize(html)
  }
}
</pre>
<p>现在，在一个<code>div</code>中渲染净化后的<code>HTML</code>，如下所示:</p>
<pre class="language-javascript hljs">&lt;div className="App"&gt;
  &lt;header className="App-header"&gt;
    Rich Text Editor Example
  &lt;/header&gt;
  &lt;Editor
    editorState={editorState}
    onEditorStateChange={setEditorState}
    wrapperClassName="wrapper-class"
    editorClassName="editor-class"
    toolbarClassName="toolbar-class"
  /&gt;
  &lt;div
    className="preview"
    dangerouslySetInnerHTML={createMarkup(convertedContent)}&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>
<p><code>createMarkup</code>函数接收一个<code>HTML</code>字符串作为参数，并返回一个带有净化过的<code>HTML</code>的对象。这个方法由<code>dangerouslySetInnerHTML</code>调用，内容被转换为<code>HTML</code>。</p>
<h3 id="adding-styles-html-container">向<code>HTML</code>容器添加样式</h3>
<p>最后，为<code>HTML</code>容器添加一些样式:</p>
<pre class="language-css hljs">.preview {
  padding: 1rem;
  margin-top: 1rem;
}
</pre>
<p>现在，我们可以在编辑器中输入文本，并在富文本编辑器下方看到它的显示，就像我们格式化它一样:</p>
<p><img data-attachment-id="150707" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-formatted-text/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text.gif" data-orig-size="730,406" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Displaying formatted text in a separate div element" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text-300x167.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text.gif" decoding="async" class="aligncenter size-full wp-image-150707 jetpack-lazy-image" src="../Images/066aea3c7953a4a4461859df03b69a90.png" alt="Displaying Formatted Text in a Separate Div Element" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150707" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-formatted-text/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text.gif" data-orig-size="730,406" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Displaying formatted text in a separate div element" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text-300x167.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150707" src="../Images/066aea3c7953a4a4461859df03b69a90.png" alt="Displaying Formatted Text in a Separate Div Element" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-formatted-text.gif"/></noscript>
<p>就是这样！我们完了。我们构建了一个富文本编辑器，使我们能够以各种方式格式化文本。<code>App.js</code>文件的最终代码应该是:</p>
<pre class="language-javascript hljs">import React, { useState, useEffect } from 'react';
import { EditorState } from 'draft-js';
import { Editor } from 'react-draft-wysiwyg';
import { convertToHTML } from 'draft-convert';
import DOMPurify from 'dompurify';

import 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';
import './App.css';

function App() {
  const [editorState, setEditorState] = useState(
    () =&gt; EditorState.createEmpty(),
  );
  const [convertedContent, setConvertedContent] = useState(null);

  useEffect(() =&gt; {
    let html = convertToHTML(editorState.getCurrentContent());
    setConvertedContent(html);
  }, [editorState]);

  function createMarkup(html) {
    return {
      __html: DOMPurify.sanitize(html)
    }
  }

  return (
    &lt;div className="App"&gt;
      &lt;header className="App-header"&gt;
        Rich Text Editor Example
      &lt;/header&gt;
      &lt;Editor
        editorState={editorState}
        onEditorStateChange={setEditorState}
        wrapperClassName="wrapper-class"
        editorClassName="editor-class"
        toolbarClassName="toolbar-class"
      /&gt;
      &lt;div
        className="preview"
        dangerouslySetInnerHTML={createMarkup(convertedContent)}&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  )
}

export default App;
</pre>
<h2 id="customizing-rich-text-editor-component">自定义富文本编辑器组件</h2>
<p>当您使用没有定制的<code>Editor</code>组件时，该库默认呈现一般的WYSIWYG特征。例如，默认情况下，您会得到一个工具栏，它具有您在富文本编辑器中期望的特性，比如文本样式和添加嵌入项。react-draft-wysiwyg库非常灵活且功能全面，它提供了自定义工具栏、行为和启用附加功能的道具。</p>
<p>例如，您可以使用<code>toolbar</code>属性创建一个最小工具栏，如下所示:</p>
<pre class="language-javascript hljs">&lt;Editor
  editorState={editorState}
  onEditorStateChange={setEditorState}
  wrapperClassName="wrapper-class"
  editorClassName="editor-class"
  toolbarClassName="toolbar-class"
  toolbar={{
    options: ['inline', 'blockType']
  }}
/&gt;
</pre>
<p>看下面的预告:</p>
<p><img data-attachment-id="150709" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-customization-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png" data-orig-size="730,329" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Customizing toolbar options in the rich text editor" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example-300x135.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png" decoding="async" class="aligncenter size-full wp-image-150709 jetpack-lazy-image" src="../Images/1508384b114f60668ace54473a2ec98b.png" alt="Customizing Toolbar Options in the Rich Text Editor" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example-300x135.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150709" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-customization-example/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png" data-orig-size="730,329" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Customizing toolbar options in the rich text editor" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example-300x135.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150709" src="../Images/1508384b114f60668ace54473a2ec98b.png" alt="Customizing Toolbar Options in the Rich Text Editor" srcset="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example-300x135.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-customization-example.png"/></noscript>
<p>此外，您可以使用以下道具启用<code>hashtags</code>和<code>mentions</code>支持:</p>
<pre class="language-javascript hljs">hashtag={{
  separator: ' ',
  trigger: '#',
}}
mention={{
  separator: ' ',
  trigger: '@',
  suggestions: [
    { text: 'JavaScript', value: 'javascript', url: 'js' },
    { text: 'Golang', value: 'golang', url: 'go' },
  ],
}}
</pre>
<p>上述道具支持以下功能:</p>
<p><img data-attachment-id="150711" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-hashtags-props/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props.gif" data-orig-size="730,323" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Enabling hashtags and mentions feature via props" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props-300x133.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props.gif" decoding="async" class="aligncenter size-full wp-image-150711 jetpack-lazy-image" src="../Images/d98d910cea7c06098be3724c8cc25ed2.png" alt="Enabling Hashtags and Mentions Feature Via Props" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="150711" data-permalink="https://blog.logrocket.com/build-rich-text-editors-react-draft-js-react-draft-wysiwyg/attachment/rich-text-editor-hashtags-props/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props.gif" data-orig-size="730,323" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Enabling hashtags and mentions feature via props" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props-300x133.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-150711" src="../Images/d98d910cea7c06098be3724c8cc25ed2.png" alt="Enabling Hashtags and Mentions Feature Via Props" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/rich-text-editor-hashtags-props.gif"/></noscript>
<p>你可以在<a href="https://jpuri.github.io/react-draft-wysiwyg/#/docs">官方库文档</a>中看到所有支持的特性。</p>
<h2>结论</h2>
<p>在本文中，我们研究了如何创建一个富文本编辑器，它已经有了一个工具栏，工具栏上有几个用于输入和显示文本的选项。我们仅仅触及了使用“反应-草稿-所见即所得”创建的体验的表面。</p>
<p>您可以在<a href="https://jpuri.github.io/react-draft-wysiwyg/#/docs?_k=jjqinp"> react-draft-wysiwyg文档</a>中找到其他选项和功能，并探索如何构建功能更加丰富的编辑器。如果您希望更有挑战性，您可以添加将文本保存到数据库、检索文本和更新文本的功能。这篇文章的代码可以在<a href="https://github.com/codezri/react-draft-wysiwyg-demo"> GitHub </a>上找到。我迫不及待地想看看你做了什么。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产React应用</h2><p>调试React应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪Redux状态、自动显示JavaScript错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的web和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试React应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>