<html>
<head>
<title>Why you should be using useWorker - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>为什么你应该使用useWorker - LogRocket博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/why-you-should-be-using-useworker/#0001-01-01">https://blog.logrocket.com/why-you-should-be-using-useworker/#0001-01-01</a></blockquote><div><article class="article-post">
<p>Web workers是在后台运行任务和其他功能的工作线程。</p>
<p>在本指南中，我们将探索使用web workers的基础知识，完成<code>useWorker</code>实现，并构建一个演示应用程序，这样您就可以看到运行中的库。我们还将回顾一些真实世界的用例以及关于web工作者的有趣事实。</p>
<h2>为什么要使用web workers？</h2>
<p id="whatarewebworkers">您可能会想，“为什么我需要在后台运行任何东西？”看看下面的演示。</p>
<p><img data-attachment-id="21314" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/useworker-demo-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app.gif" data-orig-size="720,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="useWorker demo app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-300x188.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app.gif" decoding="async" class="aligncenter size-full wp-image-21314 jetpack-lazy-image" src="../Images/1dfbf7288cd310f04f9af70735c8763a.png" alt="useWorker Demo App" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="21314" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/useworker-demo-app/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app.gif" data-orig-size="720,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="useWorker demo app" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-300x188.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-21314" src="../Images/1dfbf7288cd310f04f9af70735c8763a.png" alt="useWorker Demo App" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app.gif"/></noscript>
<p>正如你所看到的，当你点击按钮时，应用程序的用户界面冻结了几秒钟。停顿后，举杯表示动作完成。</p>
<p>这里我们有两个组件:一个用于渲染动画，另一个用于处理数千条记录的繁重计算。只要你点击按钮，它就开始计算，这导致用户界面冻结。</p>
<p>显然，这导致了低劣的用户体验。用户不应该等待一个特定的动作完成。Web workers解决了这个问题，它允许您在后台运行大量计算任务，而不会影响UI线程。</p>
<h2 id="howwebworkerswork">网络工作者如何工作</h2>
<p><img data-attachment-id="21315" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/web-worker-diagram/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png" data-orig-size="720,328" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="web worker diagram" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram-300x137.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png" decoding="async" class="aligncenter size-full wp-image-21315 jetpack-lazy-image" src="../Images/0b0fe79f738763de86fdda1e86299b4e.png" alt="Web Worker Diagram" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram-300x137.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="21315" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/web-worker-diagram/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png" data-orig-size="720,328" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="web worker diagram" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram-300x137.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-21315" src="../Images/0b0fe79f738763de86fdda1e86299b4e.png" alt="Web Worker Diagram" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram-300x137.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/web-worker-diagram.png"/></noscript>
<p>当您的应用程序需要运行繁重的计算任务时，工作线程将在独立于主UI线程的线程中处理计算。您可以将数据从主线程传递给工作线程。</p>
<p>一旦工作线程完成一个任务，它将向主线程发送一条消息。然后，您可以基于该消息更新您的主UI线程。</p>
<h2 id="webworkerimplementation">履行</h2>
<p>为了描绘一幅基本的画面并展示web worker的易用性，让我们从实现一个不使用<code>useWorker</code>钩子的web worker开始。</p>
<h3 id="webworkerapi">Web worker API</h3>
<p>创建一个react组件，并添加以下代码。</p>
<pre>import React, { useEffect, useState } from "react";
import { fetchUsers } from "../../utils/sortData";
import { useToasts } from "react-toast-notifications";
import "./index.css";
import webworker from "../../utils/app.worker";
import WorkerClass from "./Worker";
const WebWorker = () =&gt; {
  const [workerState, setWorkerState] = useState("DESC");
  const { addToast } = useToasts();

  const sortWorkerData = async () =&gt; {};

  return (
    &lt;div className="user-div"&gt;
      &lt;button
        className="sort-button"
        onClick={sortWorkerData}
      &gt;
        {" "}
        Worker Sort
      &lt;/button&gt;
    &lt;/div&gt;
  );
};
export default WebWorker;
</pre>
<p>在这里，我们有一个按钮，当点击时，执行一个繁重的计算任务。让我们把这个功能带给我们的网络工作者。</p>
<p>首先，在JavaScript的<code>Worker</code>类周围创建一个包装类，<code>Worker.js</code>。</p>
<pre>export default class WebWorker {
  constructor(worker) {
    const code = worker.toString();
    const blob = new Blob(["(" + code + ")()"]);
    return new Worker(URL.createObjectURL(blob));
  }
}
</pre>
<p>这将使用工作线程函数返回一个新的<code>Worker</code>对象。</p>
<p>接下来，在组件中导入<code>Worker</code>类包装器。</p>
<pre>import WorkerClass from "./Worker";
</pre>
<p>下一步是创建工作线程来处理计算任务。</p>
<pre>export default () =&gt; {
  self.addEventListener("message", (e) =&gt; {// eslint-disable-line no-restricted-globals
    if (!e) return;
    let users = e.data;
    const copy = [...users];
    for (var i = 0; i &lt; copy.length - 1; i++) {
      for (var j = i + 1; j &lt; copy.length; j++) {
        if (copy[i].commentCount &lt; copy[j].commentCount) {
          var t = copy[i];
          copy[i] = copy[j];
          copy[j] = t;
        }
      }
    }
    postMessage(copy);
  });
};
</pre>
<p>上面的代码添加了一个事件监听器，其中线程执行一个计算任务，并在完成后执行<code>postMessage</code>。</p>
<p>让我们在组件中导入它。</p>
<pre>import webworker from "../../utils/app.worker";
</pre>
<p>现在该包装组件了。添加功能。</p>
<pre>const sortWorkerData = async () =&gt; {
    try {
      const users = await fetchUsers();
      let worker = new WorkerClass(webworker);
      worker.postMessage(users);
      worker.addEventListener("message", function (event) {
        setWorkerState("ASC");
        // setUsers(sortedData)
        addToast("Finished: Sort using useWorker.", { appearance: "success" });
      });
    } catch (e) {
      console.log(e);
      addToast("Some Error Occurred", { appearance: "error" });
    }
  };
</pre>
<p>首先，获取所有用户数据，并在实例化<code>WorkerClass</code>之前创建一个worker对象，它是<code>Worker</code>的包装器。</p>
<p>接下来，<code>postMessage</code>将用户的数据传给工作线程。一旦计算任务完成，它就触发带有结果的监听事件。</p>
<p><img data-attachment-id="21316" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/webworker-api-demo/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo.gif" data-orig-size="720,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="webWorker API demo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo-300x188.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo.gif" decoding="async" class="aligncenter size-full wp-image-21316 jetpack-lazy-image" src="../Images/3af3a4bb1538c8862e47ca6c687a90df.png" alt="webWorker API Demo" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="21316" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/webworker-api-demo/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo.gif" data-orig-size="720,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="webWorker API demo" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo-300x188.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-21316" src="../Images/3af3a4bb1538c8862e47ca6c687a90df.png" alt="webWorker API Demo" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-api-demo.gif"/></noscript>
<h2 id="useworker"><code>useWorker</code></h2>
<p>到目前为止，我们已经讨论了如何在React应用程序中实现web worker API。web worker API的一个问题是很难跟踪工作者的状态。</p>
<p>正如你在演示中看到的，很难判断一个工作线程是否正在运行，除非它已经完成。随着应用程序中线程数量的增加，这将变得越来越困难。</p>
<p><code>useWorker</code>为盘子增加了四个主要特征:</p>
<ol>
<li>跟踪工作线程状态</li>
<li>终止线程的选项</li>
<li>可维护性</li>
<li>可读性</li>
</ol>
<p>要在您的应用程序中安装<code>useWorker</code>:</p>
<pre>npm i @koale/useworker
</pre>
<p>让我们实现<code>useWorker</code>来看看它是如何工作的。</p>
<pre>import React, { useEffect, useState } from "react";
import {
  fetchUsers,
  sortListDescending,
  sortListAscending,
} from "../../utils/sortData";
import { useWorker, WORKER_STATUS } from "@koale/useworker";
import { useToasts } from "react-toast-notifications";
import "./index.css";
const UserList = () =&gt; {
  const [users, setUsers] = useState([]);
  const { addToast } = useToasts();
  const [
    sortListDescWorker,
    { status: DescWorkerStatus, kill: DescWorkerKill },
  ] = useWorker(sortListDescending);
  useEffect(() =&gt; {
    async function fetchData() {
      const user = await fetchUsers();
      setUsers(user);
    }
    fetchData();
  }, []);
  const sortWorkerData = async () =&gt; {
    try {
      const users = await fetchUsers();
      await sortListDescWorker(users);
      addToast("Finished: Sort using useWorker.", { appearance: "success" });
    } catch (e) {
      console.log(e);
      addToast("Some Error Occurred", { appearance: "error" });
    }
  };
  return (
    &lt;div className="user-div"&gt;
      &lt;button
        className="sort-button"
        disabled={DescWorkerStatus === WORKER_STATUS.RUNNING}
        onClick={sortWorkerData}
      &gt;
        {DescWorkerStatus === WORKER_STATUS.RUNNING
          ? `Loading`
          : "useWorker Sort"}
      &lt;/button&gt;
      {DescWorkerStatus === WORKER_STATUS.RUNNING ? (
        &lt;button className="sort-button" onClick={DescWorkerKill}&gt;
          Kill Worker
        &lt;/button&gt;
      ) : null}
    &lt;/div&gt;
  );
};
export default UserList;
</pre>
<p>首先，用一个计算任务繁重的函数实现<code>useWorker</code>。</p>
<pre> const [
    sortListDescWorker,
    { status: DescWorkerStatus, kill: DescWorkerKill },
  ] = useWorker(sortListDescending);
</pre>
<p><code>useWorker</code>导出三个参数:</p>
<ol>
<li>工作线程调用函数</li>
<li>工作线程的状态</li>
<li>函数来终止线程</li>
</ol>
<p>调用工作线程函数以及要传递的数据。</p>
<pre>  const sortWorkerData = async () =&gt; {
    try {
      const users = await fetchUsers();
      await sortListDescWorker(users);
      addToast("Finished: Sort using useWorker.", { appearance: "success" });
    } catch (e) {
      console.log(e);
      addToast("Some Error Occurred", { appearance: "error" });
    }
  };
</pre>
<p>就这么简单！<code>useWorker</code>将web worker的状态更新到组件。您可以使用它来根据状态更新UI。</p>
<p><img data-attachment-id="21317" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/webworker-ui-status/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png" data-orig-size="720,345" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="webWorker UI status" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status-300x144.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png" decoding="async" class="aligncenter size-full wp-image-21317 jetpack-lazy-image" src="../Images/d54f1b69ce8591cdd896348d57e17ece.png" alt="webWorker UI Status" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status-300x144.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="21317" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/webworker-ui-status/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png" data-orig-size="720,345" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="webWorker UI status" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status-300x144.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-21317" src="../Images/d54f1b69ce8591cdd896348d57e17ece.png" alt="webWorker UI Status" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status-300x144.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/webWorker-ui-status.png"/></noscript>
<h2 id="useworkerdemo"><code>useWorker</code>最终演示</h2>
<p><img data-attachment-id="21313" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/useworker-demo-app-complete/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete.gif" data-orig-size="720,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="useWorker demo app complete" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete-300x188.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete.gif" decoding="async" class="aligncenter size-full wp-image-21313 jetpack-lazy-image" src="../Images/540bba37dc885e3c7e64c1cf17134b00.png" alt="useWorker Demo App Complete" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="21313" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/useworker-demo-app-complete/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete.gif" data-orig-size="720,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="useWorker demo app complete" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete-300x188.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-21313" src="../Images/540bba37dc885e3c7e64c1cf17134b00.png" alt="useWorker Demo App Complete" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/useWorker-demo-app-complete.gif"/></noscript>
<h2 id="mainfeaturesofuseworker"><code>useWorker</code>的主要特点</h2>
<p>让我们退一步，回顾一下使用<code>useWorker</code>的主要优势。</p>
<p>如前所述，<code>useWorker</code>为我们提供了一个很好的包装函数，可以根据工作线程的状态来更新UI。它还提供了一个包装函数来终止线程。</p>
<p>钩子使你能够使用web worker API编写可读和可维护的代码。</p>
<p>让我们看看有和没有<code>useWorker</code>的代码是什么样子。</p>
<h3>不带<code>useWorker</code></h3>
<p><img data-attachment-id="21318" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/without-useworker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png" data-orig-size="720,418" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Without useWorker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker-300x174.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png" decoding="async" class="aligncenter size-full wp-image-21318 jetpack-lazy-image" src="../Images/97cafdf8debb83c28757e300f6c2ab23.png" alt="Without useWorker" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker-300x174.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="21318" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/without-useworker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png" data-orig-size="720,418" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Without useWorker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker-300x174.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-21318" src="../Images/97cafdf8debb83c28757e300f6c2ab23.png" alt="Without useWorker" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker-300x174.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/without-useWorker.png"/></noscript>
<h3>用<code>useWorker</code></h3>
<p><img data-attachment-id="21319" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/with-useworker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png" data-orig-size="720,378" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="With useWorker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker-300x158.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png" decoding="async" class="aligncenter size-full wp-image-21319 jetpack-lazy-image" src="../Images/c223c57bb59d28ba3a1e3d4cab687dd8.png" alt="With useWorker" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker-300x158.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="21319" data-permalink="https://blog.logrocket.com/why-you-should-be-using-useworker/with-useworker/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png" data-orig-size="720,378" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="With useWorker" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker-300x158.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-21319" src="../Images/c223c57bb59d28ba3a1e3d4cab687dd8.png" alt="With useWorker" srcset="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker-300x158.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/with-useWorker.png"/></noscript>
<h2 id="conclusion">结论</h2>
<p>我们都知道钩子是React生态系统中编写组件的首选方式。将是在应用程序中使用web workers的最优雅的方式，主要是由于可读性和可维护性的好处。</p>
<p>自己试试吧，在评论里告诉我们效果如何。编码快乐！</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>