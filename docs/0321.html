<html>
<head>
<title>Introduction to Vue lifecycle hooks - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Vue生命周期钩子介绍- LogRocket博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/introduction-to-vue-lifecycle-hooks/#0001-01-01">https://blog.logrocket.com/introduction-to-vue-lifecycle-hooks/#0001-01-01</a></blockquote><div><article class="article-post">
<p>在本帖中，我们将了解所有可用于Vue JS工作流的<a href="https://vuejs.org/v2/guide/instance.html">钩子</a>。</p>
<h2>某视频剪辑软件</h2>
<p>Vue JS是一个非常进步的JavaScript框架，由和Vue核心团队以及230多名开源社区爱好者共同创建。超过87万人使用Vue，并且<a href="https://github.com/vuejs/vue" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">在GitHub </a>上被加星14万次。它由一个只关注视图层的可接近的核心库和一个支持库的生态系统组成，支持库可以帮助您处理大型单页面应用程序中的复杂性。在本帖中，你将了解到Vue实例从创建到销毁的整个生命周期。</p>
<h2>开始之前</h2>
<p>这篇文章适合使用Vue JS的所有阶段的开发者，包括初学者。在阅读本文之前，您应该已经具备了一些先决条件。你将需要以下物品:</p>
<ul>
<li><a href="https://nodejs.org/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)"> Node.js版本10.x </a>及以上安装。您可以通过在终端/命令提示符下运行以下命令来验证您是否知道:</li>
</ul>
<pre class="wp-block-preformatted">node -v</pre>

<pre class="wp-block-preformatted">npm uninstall -g vue-cli</pre>
<p>然后安装新的:</p>
<pre class="wp-block-preformatted">npm install -g @vue/cli</pre>
<ul>
<li>在这里下载一个Vue Mixins starter项目<a href="https://github.com/viclotana/Mixins_starter" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)"/></li>
<li>解压缩下载的项目</li>
<li>导航到解压缩后的文件，并运行命令以保持所有依赖项最新:</li>
</ul>
<pre class="wp-block-preformatted">npm install</pre>
<h2>实例视图</h2>
<p>Vue应用程序由一个用<code>new Vue</code>创建的根Vue实例组成，可选地组织成一个嵌套的、可重用的组件树。每当您创建一个新的Vue项目时，默认情况下，在main.js文件中，Vue实例由以下代码激活:</p>
<pre class="wp-block-preformatted">new Vue({&#13;
 render: h =&gt; h(App),&#13;
 }).$mount(‘#app’)</pre>
<p>表示包含app组件的Vue实例，该语法与单文件应用程序等变体稍有不同。</p>
<h2>生命周期挂钩</h2>
<p>每个Vue实例都要经历一系列初始化步骤。从设置数据观察到编译模板，到将实例挂载到DOM，最后到在数据更改期间更新DOM。这个过程被称为Vue实例的生命周期，默认情况下，在创建和更新DOM的过程中，它们内部会运行一些函数。正是在它们内部，Vue组件被创建和存在，这些功能被称为生命周期挂钩。</p>
<figure class="wp-block-image"><img decoding="async" src="../Images/bb5b95574be6831d330ab2052036376d.png" alt="Lifecycle illustration from Vue docs" data-lazy-src="https://cdn-images-1.medium.com/max/1600/1*byyX8EW6mIhRsCBWwByNYg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://cdn-images-1.medium.com/max/1600/1*byyX8EW6mIhRsCBWwByNYg.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/bb5b95574be6831d330ab2052036376d.png" alt="Lifecycle illustration from Vue docs" data-original-src="https://cdn-images-1.medium.com/max/1600/1*byyX8EW6mIhRsCBWwByNYg.png"/></noscript></figure>
<p>有八种生命周期方法:</p>
<ol>
<li>创建前</li>
<li>创造</li>
<li>安装前</li>
<li>安装好的</li>
<li>更新前</li>
<li>更新</li>
<li>销毁前</li>
<li>破坏</li>
</ol>
<p>在这篇文章中，你将会被介绍到这些钩子中的每一个，以及在每一个阶段允许什么样的行为。如果您从一开始就阅读了本文，那么您应该已经有了一个Vue starter应用程序并正在运行。</p>
<p>对于这篇文章，我们将使用测试组件，它位于src文件夹内的components文件夹中。它应该是这样的:</p>
<pre>// src/components/Test.vue&#13;
&lt;template&gt;&#13;
 &lt;div&gt;&#13;
 &lt;/div&gt;&#13;
&lt;/template&gt;&#13;
&lt;script&gt;&#13;
export default {&#13;
 name: ‘Test’,&#13;
 props: {&#13;
  msg: String&#13;
 }&#13;
}&#13;
&lt;/script&gt;&#13;
&lt;! — Add “scoped” attribute to limit CSS to this component only →&#13;
&lt;style scoped&gt;&#13;
&#13;
h3 {&#13;
 margin: 40px 0 0;&#13;
}&#13;
ul {&#13;
 list-style-type: none;&#13;
 padding: 0;&#13;
}&#13;
li {&#13;
 display: inline-block;&#13;
 margin: 0 10px;&#13;
}&#13;
a {&#13;
 color: #42b983;&#13;
}&#13;
&lt;/style&gt;&#13;
 &#13;
</pre>
<p>在本教程的整个过程中，脚本部分将单独用于各种钩子的说明。</p>
<h2>创建之前()</h2>
<p>这是Vue JS中调用的第一个生命周期钩子，它在Vue实例初始化后立即被调用。</p>
<pre>&lt;script&gt;&#13;
export default {&#13;
name: 'Test',&#13;
beforeCreate() {&#13;
 alert('beforCreate hook has been called');&#13;
 console.log('beforCreate hook has been called');&#13;
 }&#13;
}&#13;
&lt;/script&gt;</pre>
<p>您可以通过在开发环境中运行您的应用程序来检查该接口。</p>
<pre>npm run serve</pre>
<p>这将输出如下界面:</p>
<p/>
<p/>
<figure class="wp-block-image"><img decoding="async" src="../Images/db2903fb74ef650700c71c768674fbba.png" alt="" data-lazy-src="https://cdn-images-1.medium.com/max/1600/1*NzJVcSFCOVcMqoQJETEAOQ.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://cdn-images-1.medium.com/max/1600/1*NzJVcSFCOVcMqoQJETEAOQ.gif"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/db2903fb74ef650700c71c768674fbba.png" alt="" data-original-src="https://cdn-images-1.medium.com/max/1600/1*NzJVcSFCOVcMqoQJETEAOQ.gif"/></noscript></figure>
<p>请注意，编写在生命周期挂钩中的alert语句在组件加载之前首先执行。这正是函数:在Vue引擎创建app组件之前被调用。这样，在beforeCreate阶段，诸如计算属性、观察器、事件、数据属性和操作之类的东西还没有设置。</p>
<h2>已创建()</h2>
<p>正如您已经猜到的，这是紧接在beforeCreated钩子之后调用的第二个生命周期钩子。在这个阶段，Vue实例已经被初始化，并且已经激活了诸如计算属性、观察器、事件、数据属性和随之而来的操作之类的东西。</p>
<p/>
<pre>&lt;script&gt;&#13;
export default {&#13;
name: 'Test',&#13;
data() {&#13;
return {&#13;
books: 0&#13;
}&#13;
},&#13;
created() {&#13;
 alert('Created hook has been called');&#13;
 console.log(`books is of type ${typeof this.books}`);&#13;
 }&#13;
}&#13;
&lt;/script&gt;</pre>
<p>如果您运行该应用程序，您会很快注意到现在可以显示的数据类型。这在beforeCreated阶段是不可能的，因为这里发生的激活当时还没有发生。但是，Vue实例在这个阶段还没有挂载，所以您不能在这里操作DOM，element属性还不可用。</p>
<h2>安装前()</h2>
<p>这是在调用创建的挂钩之后调用的下一个生命周期挂钩。这是将实例装载到DOM之前的时刻，模板和作用域样式都在这里编译，但是您仍然不能操作DOM，元素属性仍然不可用。下面是您不希望放在组件中的初始化应该进入的地方:</p>
<pre>&lt;script&gt;&#13;
export default {&#13;
  beforeMount() {&#13;
    alert('beforeMount is called')&#13;
  }&#13;
}&#13;
&lt;/script&gt;</pre>
<h2>已安装()</h2>
<p>这是调用beforeMounted后要调用的下一个生命周期挂钩。在装载实例后立即调用它。在这里，app组件或项目中的任何其他组件都可以使用了。数据被放入模板中，DOM元素被替换为填充了数据的元素，现在可以在这里操作了，元素属性现在可以使用了。</p>
<pre>&lt;script&gt;&#13;
export default {&#13;
  mounted() {&#13;
    alert('mounted has been called'); &#13;
   }&#13;
}&#13;
&lt;/script&gt;</pre>
<p>这是用Vue CLI创建的任何项目的默认位置，因为正如我们在开始时看到的，已经在main.js文件中完成了挂载。这就是为什么您可能无法使用其他钩子，因为默认情况下已经为您挂载了实例。</p>
<h2>更新前()</h2>
<p>这是在挂载钩子之后调用的生命周期钩子，每当对需要更新DOM的数据进行更改时。这个阶段对于数据更改前的任何逻辑都很有用，比如删除事件侦听器。</p>
<pre>&lt;template&gt;<br/> &lt;div&gt; {{hello}}<br/> &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/> export default {<br/>  name: 'Test',<br/>  data() {<br/>   return {<br/>    books: 0,<br/>    hello: 'welcome to Vue JS'<br/>   }<br/> },<br/>beforeUpdate(){<br/> alert('beforeUpdate hook has been called');<br/>},<br/>mounted(){<br/> this.$data.hello= 'lalalalallalalalalaalal';<br/> }<br/>}<br/>&lt;/script&gt;</pre>
<p>这最初在DOM上有一个欢迎说明，但是在挂载阶段(可以操作DOM的地方)，数据发生了变化，因此beforeUpdate的警告就在它发生变化之前出现。</p>
<h2>已更新()</h2>
<p>这个生命周期钩子在DOM更新发生之后被调用，所以这意味着在beforeUpdate钩子被调用之后。DOM相关的操作可以在这里执行，尽管不建议在这个钩子内部改变状态，因为Vue已经专门为此提供了平台。</p>
<pre>&lt;template&gt;<br/> &lt;div&gt; {{hello}}<br/> &lt;/div&gt;<br/>&lt;/template&gt;&#13;
&lt;script&gt;<br/> export default {<br/>  name: 'Test',<br/>  data() {<br/>   return {<br/>    books: 0,<br/>    hello: 'welcome to Vue JS'<br/>   }<br/>  },<br/>beforeUpdate(){<br/> alert('beforeUpdate hook has been called');<br/>},<br/>updated(){<br/> alert('Updated hook has been called');<br/>},<br/>mounted(){<br/> this.$data.hello= 'lalalalallalalalalaalal';<br/> }<br/>}<br/>&lt;/script&gt;</pre>
<h2>销毁前()</h2>
<p>这个Vue生命周期钩子在Vue实例被销毁之前被调用，实例和所有功能仍然完好无损，并且在这里工作。这是您可以进行资源管理、删除变量和清理组件的阶段。</p>
<pre>&lt;script&gt;&#13;
export default {&#13;
name: 'Test',&#13;
 data() {&#13;
    return {&#13;
      books: 0&#13;
    }&#13;
  },&#13;
  beforeDestroy() {&#13;
    this.books = null&#13;
    delete this.books&#13;
  }&#13;
}&#13;
&lt;/script&gt;</pre>
<h2>已销毁()</h2>
<p>这是Vue生命周期的最后一个阶段，所有的子Vue实例都被销毁，像事件监听器和所有指令都在这个阶段被解除绑定。在对象上运行destroy后调用它。</p>
<pre>&lt;script&gt;&#13;
export default {&#13;
  destroyed() {&#13;
    this.$destroy() &#13;
    console.log(this)&#13;
  }&#13;
}&#13;
&lt;/script&gt;</pre>
<p>当您运行应用程序并查看控制台时，您将什么也看不到。</p>
<h2>结论</h2>
<p>已经向您介绍了Vue JS中的八个生命周期挂钩，以及它们的用途和使用时间。现在，您可以使用生命周期挂钩在Vue实例生命周期的不同阶段添加我们的定制逻辑，控制从创建到销毁的流程。这将加深你对你在Vue JS中使用的日常功能背后的推理的理解。黑客快乐！</p>
<p> </p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>