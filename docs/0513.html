<html>
<head>
<title>How to improve social engagement with the Web Share API - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何通过网络共享API提高社交参与度</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/#0001-01-01">https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/#0001-01-01</a></blockquote><div><article class="article-post">
<p>在本教程中，我们将讨论:</p>
<ul>
<li>为什么社交媒体按钮会损害你的网站</li>
<li>替代社交媒体参与选项，以及</li>
<li>如何使用Web Share API与设备上的社交媒体和/或其他应用程序共享数据</li>
</ul>
<h2>社交媒体按钮</h2>
<p>大多数流行的社交媒体平台都提供简单的按钮，你可以把它们添加到任何网页上。</p>
<p><img data-attachment-id="8918" data-permalink="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/facebook-share/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png" data-orig-size="127,20" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="facebook-share" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png" decoding="async" class="aligncenter wp-image-8918 size-full jetpack-lazy-image" src="../Images/a096f9a89325c301983a3327fea427e0.png" alt="facebook share button" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8918" data-permalink="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/facebook-share/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png" data-orig-size="127,20" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="facebook-share" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png" decoding="async" loading="lazy" class="aligncenter wp-image-8918 size-full" src="../Images/a096f9a89325c301983a3327fea427e0.png" alt="facebook share button" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/facebook-share.png"/></noscript>
<p>脸书“赞”，推特推文/转发/赞，LinkedIn分享，等等。理论上，这些按钮允许用户分享和讨论你的内容。</p>
<p>现实情况有些不太有利。</p>
<h2>共享按钮参与度低</h2>
<p>很少使用社交分享按钮。这取决于你的网站，但大多数网站能达到1%的点击率就很幸运了。GOV.UK网站<a href="https://insidegovuk.blog.gov.uk/2014/02/20/gov-uk-social-sharing-buttons-the-first-10-weeks/">在网站上线后不久发布了他们自2014年</a>以来的分享统计数据:</p>
<ul>
<li>总的来说，只有0.21%，即476名用户中有1人点击了分享按钮</li>
<li>移动用户使用分享按钮的可能性是桌面用户的两倍</li>
</ul>
<p><a href="https://www.moovweb.com/anyone-use-social-sharing-buttons-mobile/" target="_blank" rel="noopener noreferrer"> Moovweb报道</a>类似的点击率为0.2%。访问者点击广告的可能性增加了12倍！</p>
<h2>共享系统提供了糟糕且不一致的用户界面</h2>
<p>每个社交媒体网站都有一个不同的按钮，必须添加到您网站的页面上。</p>
<p>提交过程也可能让用户感到困惑。表单不一致，术语可能不同，用户界面可能很笨拙——尤其是在移动设备上。</p>
<h2>支持每个社交媒体系统是不可能的</h2>
<p>对于想在Pinterest上分享的人来说，你的脸书、Twitter和LinkedIn按钮毫无用处！增加每一个社交媒体选项是不切实际的，甚至像<a href="https://www.addthis.com/" target="_blank" rel="noopener noreferrer"> AddThis </a>这样的第三方服务也可能无法迎合国际受众的流行系统。有些服务，如Instagram，不提供共享设施。</p>
<h2>分享按钮影响网站性能</h2>
<p>大多数共享按钮都可以通过几行代码添加到您的站点中。不幸的是，看起来无害的HTML有一个隐藏的成本。仅脸书的分享按钮就下载了786Kb的代码(216Kb gzipped)。Twitter增加了151Kb (52Kb)，LinkedIn增加了182Kb (55Kb)。</p>
<p>您可以通过打开浏览器DevTools中的网络选项卡来评估您站点上共享按钮的总大小。选中禁用缓存，在过滤器中输入特定的域，如“facebook ”,然后刷新页面:</p>
<p><img data-attachment-id="8924" data-permalink="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/networkdevtools/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png" data-orig-size="512,280" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="networkdevtools" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png" decoding="async" class="aligncenter wp-image-8924 size-full jetpack-lazy-image" src="../Images/58cd5a110cd5f12f5e3d140453ae3533.png" alt="devtools network calls" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png 512w, https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools-300x164.png 300w" data-lazy-sizes="(max-width: 512px) 100vw, 512px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8924" data-permalink="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/networkdevtools/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png" data-orig-size="512,280" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="networkdevtools" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png" decoding="async" loading="lazy" class="aligncenter wp-image-8924 size-full" src="../Images/58cd5a110cd5f12f5e3d140453ae3533.png" alt="devtools network calls" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png 512w, https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools-300x164.png 300w" sizes="(max-width: 512px) 100vw, 512px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/networkdevtools.png"/></noscript><br/>
The status bar at the bottom shows the number of requests, the total (compressed) data downloaded, the uncompressed file sizes, and load timings. The total of all third-party requests can be examined by entering “-domain:*.yourdomain.com” in the filter box.
<p>添加一些社交媒体按钮会大大增加页面的重量。处理一两兆字节的JavaScript也会对性能产生不利影响，尤其是在移动设备上。</p>
<h2>社交分享引发隐私担忧</h2>
<p>脸书的JavaScript代码没有闲着。不管他们是否点击按钮，你的所有访问者都在你的网站和其他网站上被监控，所以他们的活动可以被货币化。虽然这可能与您无关，但社交媒体网站收集用户数据是为了他们的利益，而不是您的利益。</p>
<h2>您可能在数据使用方面合法合规</h2>
<p>添加“喜欢”按钮会让你对社交网络使用或滥用个人数据负责吗？</p>
<p>欧洲法院最近裁定，<a href="https://curia.europa.eu/jcms/upload/docs/application/pdf/2019-07/cp190099en.pdf" target="_blank" rel="noopener noreferrer">网站所有者在使用分享按钮时可能需要对数据收集负责。一个网站自愿与一个社交网络共享访问者信息，所以它被认为是一个联合数据控制者。</a></p>
<p>你能确定这些共享按钮在你经营的每个地区都是合法的吗？你确定社交媒体平台的行为是负责任的吗？</p>
<h2>第三方JavaScript存在安全风险</h2>
<p>添加第三方<code>&lt;script&gt;</code>标签运行JavaScript，其权限与您自己的代码相同。该脚本可以做任何事情-您的安全性取决于最弱的提供商。</p>
<p><a href="https://www.bbc.com/news/business-48905907" target="_blank" rel="noopener noreferrer">英国航空公司</a>在2018年被罚款2.32亿美元，当时50万名客户的姓名、电子邮件地址和完整的信用卡信息在网站交易中被盗。攻击很可能源自第三方脚本，该脚本可能在其供应商不知情或未经其许可的情况下被修改。</p>
<p>社交媒体公司将努力防止问题，但没有人能幸免于安全问题。</p>
<h2>可以减少现场参与</h2>
<p>社交媒体平台只有被利用才能生存。点击“分享”按钮会把你的访问者带到那个系统，在那里他们会被鼓励留下来，不再与你的品牌或服务互动。</p>
<h2>基于URL的社交共享API</h2>
<p>尽管有风险和低使用率，分享按钮可以增加曝光率，并提供一些搜索引擎优化的好处。你的下一个客户可能会从脸书、推特、LinkedIn等网站上的对话中了解你的服务。</p>
<p>通过使用基于URL的共享API，可以显著减少页面权重、性能、隐私和安全性方面的问题。这些不需要第三方JavaScript，也不会跟踪用户，除非他们选择使用按钮。</p>
<p>加载网址即可将任何网页分享给脸书:<br/><a href="https://www.facebook.com/sharer/sharer.php?u=%24%7Burl%7D" target="_blank" rel="noopener noreferrer">https://www.facebook.com/sharer/sharer.php?u=${url}</a></p>
<p>或者推特:<br/><a href="https://twitter.com/intent/tweet?url=%24%7Burl%7D&amp;text=%24%7Btitle%7D" target="_blank" rel="noopener noreferrer">https://twitter.com/intent/tweet?url=${url}&amp;text = $ { title }</a></p>
<p>或者LinkedIn:<br/><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%24%7Burl%7D&amp;title=%24%7Btitle%7D" target="_blank" rel="noopener noreferrer">https://www.linkedin.com/shareArticle?mini=true&amp;URL = $ { URL }&amp;title = $ { title }</a></p>
<p>其中${url}是页面url，${title}是标题(通常是HTML <code>&lt;title&gt;</code>标记的内容)。</p>
<p>在可能的情况下，访问者还可以使用浏览器的共享功能将URL发布到其他应用程序，如电子邮件、消息、Pocket、WhatsApp等。然而，该选项对用户来说很少是显而易见的——直到现在…</p>
<h2>Web共享API</h2>
<p>在几次<a href="https://en.wikipedia.org/wiki/Web_Intents" target="_blank" rel="noopener noreferrer">失败</a>之后，<a href="https://w3c.github.io/web-share/" target="_blank" rel="noopener noreferrer">的网络共享API </a>终于<a href="https://caniuse.com/#feat=web-share" target="_blank" rel="noopener noreferrer">登陆安卓系统的Chrome 76</a>、iOS系统的Safari 12.3和Mac OS系统的Safari 12.1。使用时，浏览器将信息传递给主机操作系统上的共享工具。操作系统知道哪些应用程序支持共享，并相应地传递数据。</p>
<p>优点:</p>
<ul>
<li>分享可以通过页面按钮而不是不太明显的浏览器菜单来触发</li>
<li>全屏渐进式网络应用隐藏了浏览器界面，共享成为可能</li>
<li>提供一致的用户界面和体验。比如Android用户会看到一个类似这样的分享面板:</li>
</ul>
<p><img data-attachment-id="8934" data-permalink="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/androidview/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png" data-orig-size="288,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="androidview" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview-169x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png" decoding="async" class="aligncenter wp-image-8934 size-full jetpack-lazy-image" src="../Images/2f0ce3d0750989441e2d068dbf1abfa7.png" alt="ui for android users" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png 288w, https://blog.logrocket.com/wp-content/uploads/2019/10/androidview-169x300.png 169w" data-lazy-sizes="(max-width: 288px) 100vw, 288px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8934" data-permalink="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/androidview/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png" data-orig-size="288,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="androidview" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview-169x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png" decoding="async" loading="lazy" class="aligncenter wp-image-8934 size-full" src="../Images/2f0ce3d0750989441e2d068dbf1abfa7.png" alt="ui for android users" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png 288w, https://blog.logrocket.com/wp-content/uploads/2019/10/androidview-169x300.png 169w" sizes="(max-width: 288px) 100vw, 288px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/androidview.png"/></noscript><br/>
The sharing UI can be launched in reaction to a user click. The following JavaScript checks whether the Web Share API is supported then adds a button click handler which passes a ShareData object to <code>navigator.share</code>:
<pre>// is Web Share API supported?
if ( navigator.share ) {

  // share button click handler
  document.getElementById('share').addEventListener('click', () =&gt; {

    // share page information
    navigator.share({
      url: 'https://example.com/',
      title: 'My example page',
      text: 'An example page implementing the Web Share API.'
    });

  });

}</pre>
<p>ShareData对象包含:</p>
<ul>
<li><span>url</span><span>–正在共享的URL(空字符串表示当前页面)</span></li>
<li><span>标题</span>——文档标题(可能是页面HTML <code>&lt;title&gt;</code>字符串)</li>
<li><span>正文</span><span>–任意正文(也许是页面</span> <span>描述</span> <span> meta标签)</span></li>
</ul>
<p><code>navigator.share</code> <span>返回一个承诺，因此如果需要执行其他动作或对失败做出反应，可以使用<code>.then()</code> </span> <span>和<code>.catch()</code> </span> <span>块。</span></p>
<h2>改善社交分享</h2>
<p>网络共享API的支持<a href="https://caniuse.com/#feat=web-share" target="_blank" rel="noopener noreferrer">相当有限</a>，尤其是在桌面浏览器上。出于这个原因，下面的代码提供了一个逐步增强的解决方案，它实现了一个共享按钮，还使用轻量级和安全的基于URL的API定义了Twitter、脸书、LinkedIn和电子邮件选项。</p>
<p>完整演示可在<a href="https://codepen.io/craigbuckler/full/oNNjKbX" target="_blank" rel="noopener noreferrer"> Codepen.io </a>上查看:</p>
<p class="codepen" data-height="459" data-theme-id="0" data-default-tab="html,result" data-user="craigbuckler" data-slug-hash="oNNjKbX" data-pen-title="Simpler Sharing">参见<a href="https://codepen.io"> CodePen </a>上Craig Buckler(<a href="https://codepen.io/craigbuckler">@ Craig Buckler</a>)<br/>的笔<a href="https://codepen.io/craigbuckler/pen/oNNjKbX"> <br/>更简单的分享</a>。</p>
<p>没有跨桌面或移动平台的标准共享图标，但三节点图形是可识别的，文本标签应使其明显。当点击时，它显示标准的操作系统共享用户界面，如上面显示的Android示例。</p>
<p><span>Twitter、脸书和LinkedIn按钮在一个小弹出窗口或移动设备上的另一个标签中打开分享网址:</span></p>
<p><img data-attachment-id="8941" data-permalink="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/share-demo-popup/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png" data-orig-size="581,221" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="share-demo-popup" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup-300x114.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png" decoding="async" class="aligncenter wp-image-8941 size-full jetpack-lazy-image" src="../Images/9386d09b15c2e9b67bd74097eff2c427.png" alt="social share demo popup" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png 581w, https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup-300x114.png 300w" data-lazy-sizes="(max-width: 581px) 100vw, 581px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8941" data-permalink="https://blog.logrocket.com/how-to-improve-social-engagement-with-the-web-share-api/share-demo-popup/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png" data-orig-size="581,221" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="share-demo-popup" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup-300x114.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png" decoding="async" loading="lazy" class="aligncenter wp-image-8941 size-full" src="../Images/9386d09b15c2e9b67bd74097eff2c427.png" alt="social share demo popup" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png 581w, https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup-300x114.png 300w" sizes="(max-width: 581px) 100vw, 581px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/share-demo-popup.png"/></noscript>
<p>弹出窗口对用户体验来说很糟糕，但这是社交按钮通常的操作方式，它允许用户返回原始页面。</p>
<p>最后，email按钮是一个mailto:链接，它启动默认的邮件应用程序。</p>
<h2>HTML代码</h2>
<p>带有“share”类的任意数量的无序列表可以添加到HTML中的任意位置。</p>
<p>下面显示的第一个项目是共享图标。这被分配了一个类“webshare ”,并且链接href目标是“#webshare ”,因此它可以被识别。</p>
<p>所有其他列表项使用${url}、${title}和${text}占位符定义共享url，因此相同的代码可以在任何页面上使用。</p>
<pre>&lt;ul class="share"&gt;
 
  &lt;li class="webshare"&gt;
    &lt;a href="#webshare"&gt;share&lt;/a&gt;
  &lt;/li&gt;
    
  &lt;li&gt;
    &lt;a href="https://twitter.com/intent/tweet?url=${url}&amp;amp;text=${title}"&gt;Twitter&lt;/a&gt;
  &lt;/li&gt;
 
  &lt;li&gt;
    &lt;a href="https://www.facebook.com/sharer/sharer.php?u=${url}"&gt;Facebook&lt;/a&gt;
  &lt;/li&gt;
 
  &lt;li&gt;
    &lt;a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=${url}&amp;amp;title=${title}"&gt;LinkedIn&lt;/a&gt;
  &lt;/li&gt;
 
  &lt;li&gt;
    &lt;a href="mailto:?subject=${title}&amp;amp;body=${url}"&gt;email&lt;/a&gt;
  &lt;/li&gt;

&lt;/ul&gt;
</pre>
<p><i>(未显示SVG图标代码以帮助阅读。)</i></p>
<h2>CSS代码</h2>
<p>默认情况下，共享图标是隐藏的:</p>
<pre>.share, .webshare {
  display: none;
}</pre>
<p>JavaScript(见下文)在运行时会将一个. social类附加到HTML头中。额外的。当Web共享api可用时，将添加webshareapi类。因此，只有在支持列表和共享按钮时，CSS才会显示它们:</p>
<pre>/* URL sharing is enabled */
.social .share {
  display: flex;
  flex-wrap: wrap;
}

/* Web Share API is supported */
.webshareapi .webshare {
  display: block;
}</pre>
<p>其他属性定义颜色、样式、悬停效果等。</p>
<pre>/* basic share styling */
.share, .share li {
  list-style-type: none;
  padding: 0;
  margin: 0;
}

.share a {
  display: block;
  text-decoration: none;
  color: #fff;
  background-color: #557;
  border-radius: 1.5em;
}

.share a:hover, .share a:focus {
  background-color: #779;
}</pre>
<h2>JavaScript代码</h2>
<p>当DOM准备就绪时，一旦DOMContentLoaded事件触发，JavaScript功能就会启动。该函数从页面中提取以下信息来创建pageInfo对象:</p>
<ul>
<li>url——从规范的URL(T2)中提取，在HTML(T0)或页面URL中定义</li>
<li>标题–HTML<code>&lt;head&gt;</code>中定义的文档<code>&lt;title&gt;</code> <span/></li>
<li>文本–描述元标记(如果有)</li>
</ul>
<p>当navigator.share可用时,<code>&lt;html&gt;</code>元素应用了一个. webshareapi类。用于指示脚本正在运行的社交类。这将触发CSS显示链接:</p>
<pre>// web sharing detection
document.addEventListener('DOMContentLoaded', () =&gt; {
 
  'use strict';
 
  // get page information
  const
    html = document.documentElement,
    canonical = document.querySelector('link[rel=canonical]'),
    desc = document.getElementsByName('description'),
    pageInfo = {
      url: canonical ? canonical.href : location.href,
      title: document.title || '',
      text: desc.length ? desc[0].content : ''
    };
 
   // Web Share API support?
  if (navigator.share) html.classList.add('webshareapi');
 
  // social sharing enabled
  html.classList.add('social');

  //...
 
});</pre>
<p>定义了一个处理程序事件，它监听整个文档上的点击事件。当被触发时，它会检查是否在. share列表中单击了共享按钮，并取消默认操作:</p>
<pre>// click event
  document.body.addEventListener('click', (e) =&gt; {
    
    // on share button?
    let t = e.target.closest('A');
    if (!t || !t.closest('.share')) return;
    
    // cancel link
    e.preventDefault();

    // ...

  });
</pre>
<p>然后，该代码检查共享链接是否已被单击，并将pageInfo对象传递给Web共享API，然后返回:</p>
<pre> // Web Share API
    if (t.hash === '#webshare') {
 
      navigator.share(pageInfo);
      return;
 
    }</pre>
<p>如果使用了任何其他链接，则提取其href地址，并使用<code>urlParse()</code>函数将占位符替换为pageInfo信息:</p>
<pre>// social media link
    let popup, newUrl = urlParse(t.href, pageInfo);</pre>
<p>urlParse()函数(在代码的末尾)使用正则表达式来替换和编码字符串:</p>
<pre>// URL template parser
  function urlParse(str, token) {
    
    for (let t in token) {
      str = str.replace(
        new RegExp('\\$\\{' + t + '\\}', 'g'), 
        encodeURIComponent(token[t])
      );
    }
    return str;
    
  }
</pre>
<p><span>最后，任何http链接处理程序都在一个居中的弹出窗口中打开，该窗口大小为600x600px，或者适合较小屏幕上的可用空间:</span></p>
<pre>// open popup
    if (t.protocol.startsWith('http')) {
     
      let
        sw = screen.availWidth || 1024,
        sh = screen.availHeight || 700,
        pw = Math.min(600, (sw - 40)),
        ph = Math.min(600, (sh - 40)),
        px = Math.floor((sw - pw) / 2),
        py = Math.floor((sh - ph) / 2);

      popup = window.open(
        newUrl,
        'social',
        `width=${pw},height=${ph},left=${px},top=${py},\
        location=0,menubar=0,toolbar=0,personalbar=0,\
        status=0,scrollbars=1,resizable=1`
    );
    }
</pre>
<p>焦点被设置为弹出窗口，但是，如果弹出窗口无法打开或者需要非HTTP处理程序(例如mailto: links)，则窗口位置被设置为URL:</p>
<pre>if (popup) popup.focus();
else location.href = newUrl;
</pre>
<h2>结论</h2>
<p>完整演示可在<a href="https://codepen.io/craigbuckler/full/oNNjKbX" target="_blank" rel="noopener noreferrer"> Codepen.io </a>查看。</p>
<p>上面的JavaScript代码少于1Kb，并且不需要框架(它应该与任何兼容)。它允许将共享按钮添加到您的网站，而没有社交媒体公司提供的性能、隐私或安全问题。</p>
<p> </p>
<p> </p><div class="code-block code-block-2">
<div class="blog-plug base-cta"><h2>使用<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>消除传统错误报告的干扰</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一个数字体验分析解决方案，它可以保护您免受数百个假阳性错误警报的影响，只针对几个真正重要的项目。LogRocket会告诉您应用程序中实际影响用户的最具影响力的bug和UX问题。</p>
<p>然后，使用具有深层技术遥测的会话重放来确切地查看用户看到了什么以及是什么导致了问题，就像你在他们身后看一样。</p>
<p>LogRocket自动聚合客户端错误、JS异常、前端性能指标和用户交互。然后LogRocket使用机器学习来告诉你哪些问题正在影响大多数用户，并提供你需要修复它的上下文。</p>
<p>关注重要的bug—<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">今天就试试LogRocket】。</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>