<html>
<head>
<title>Troubleshooting common React Native bugs - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>常见React原生错误故障排除</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/troubleshooting-common-react-native-bugs/#0001-01-01">https://blog.logrocket.com/troubleshooting-common-react-native-bugs/#0001-01-01</a></blockquote><div><article class="article-post">
<p><em> <strong>编者按:</strong>本帖于2022年3月7日更新，以反映React原生v0.67 </em>的相关信息</p>
<p>React Native是一个很好的框架，可以在Android和iOS平台上实现你的应用。但是尽管它得到了React社区和脸书的广泛支持，它离1.0版本还很远。</p>
<p>您可能会遇到的一些错误可能会产生误导，或者很难发现。最近，React Native团队要求开发人员帮助他们确定这些恼人的错误中哪一个导致了最大的挫败感。虽然他们确实解决了一些最严重的错误，但仍有少数错误可能会被忽略。</p>
<p>让我们来看看以下问题，并讨论在您开发下一个React本机应用程序时，如果这些问题突然出现，该如何解决:</p>

<h2 id="import-error">导入错误</h2>
<blockquote><p>固定冲突:元素类型无效:应为字符串(对于内置组件)或类/函数(对于复合组件)，但得到的是:未定义。您可能忘记了从定义组件的文件中导出组件，或者您可能混淆了默认导入和命名导入。</p>
<p>请检查“App”的呈现方法。</p>
<p>此错误位于:</p>
<p>在RCTScrollContentView(at ScrollView . js:1038)中<br/>在RCTScrollView(at ScrollView . js:1178)中<br/>在ScrollView (at App.js:25)中<br/>在rctsafeareview(at safea review . js:55)中<br/>在safea review(at App . js:24)中<br/>在App (at renderApplication.js:40)中<br/>在RCTView(at App container . js:js</p></blockquote>
<p>自上一版本以来，React原生团队已对此错误进行了更详细的描述。通常，混淆的默认和命名导入是罪魁祸首。</p>
<p>这仍然很棘手，因为正如你所见，错误是由导入到应用程序中的一个组件引起的，但我们无法判断哪个组件导入不正确。该提示不识别出现错误的组件，甚至不识别出现错误的行。</p>
<p>为了避免在创建和导出组件时出现这种错误，请记住不要混合默认导入和命名导入。有什么区别？</p>
<p>假设您的组件具有以下内容:</p>
<pre class="language-javascript hljs">export const componentName
</pre>
<p>您必须像这样导入它:</p>
<pre class="language-javascript hljs">import { componentName } from './file'
</pre>
<p>但是如果使用默认导出会怎么样呢？</p>
<pre class="language-javascript hljs">export default componentName
</pre>
<p>在这种情况下，您必须不带花括号地导入它，但是命名并不重要。你可以这样做:</p>
<pre class="language-javascript hljs">import componentName from './file' //ok
import someOtherName from './file' //ok
import { componentName } from './file' //wrong!
</pre>
<h2 id="animatedview-error"><code>Animated.View</code> <strong>错误</strong></h2>
<blockquote><p>不变违例:[453，" RCTView "，1，<br/> {"width":250，" height":50，" backgroundColor":4289781990，" opacity":1}]不能用作本机方法参数</p>
<p>此错误位于:</p>
<p>在RCTView (at file.js:27) <br/>在FadeInView (at file.js:42) <br/>在RCTView (at file.js:41) <br/>在_default (at App.js:29) <br/>在RCTScrollContentView(at scroll view . js:1038)<br/>在RCTScrollView(at scroll view . js:1178)<br/>在SafeAreaView (at App.js:24) 【T6</p></blockquote>
<p>开发者在使用React Native 中的<a href="https://blog.logrocket.com/how-to-make-tinder-like-card-animations-with-react-native/" target="_blank" rel="noopener">动画元素时经常会遇到这个错误。这是您会遇到的最棘手的错误之一，根据不同的用例，提示可能看起来略有不同。</a></p>
<p>尽管消息令人困惑，但错误是由一个简单的错误引起的:当创建动画组件时，您必须创建一个元素(例如，视图)，如下所示:</p>
<pre class="language-javascript hljs">&lt;Animated.View&gt;
</pre>
<p>如果使用普通视图，会弹出上面的错误。</p>
<p>识别这个错误可能很困难，理解它可以为您节省大量时间。React Native repository中列出了一个需要修复的<a href="https://github.com/facebook/react-native/issues/24626" target="_blank" rel="noopener">问题</a>,以及其他令人讨厌的错误，该团队预计将在即将发布的版本中对其进行改进。</p>
<h2 id="autolinking-error">自动链接错误</h2>
<blockquote><p>error React Native CLI对本机依赖项使用自动链接，但以下模块是手动链接的:</p>
<p>…</p>
<p>升级到React Native v0.60或更高版本时经常会遇到此错误。接下来，您可以通过<code>react-native unlink &lt;dependency&gt;</code>取消此依赖关系的链接，它将自动包含在您的应用程序中。如果库与自动链接不兼容，忽略此消息并通知库维护人员。</p></blockquote>
<p>有了React Native v0.60+，设置app就容易多了，因为我们不再需要使用<code>react-native link</code>命令。但是，这可能会触发新的错误，尤其是如果您使用的是不支持自动链接功能的旧库。</p>
<p>如果您在React Native v0.60+项目中使用了<code>react-native link</code>，请运行<code>react-native unlink</code>，然后尝试运行您的应用程序。如果你没有使用<code>react-native link</code>命令，但仍然收到错误，很可能你的一个依赖项不适合自动链接。如果是这种情况，可以尝试使用<code>[patch-package](<a href="https://www.npmjs.com/package/patch-package" rel="nofollow">https://www.npmjs.com/package/patch-package</a>)</code>自行修复。</p>
<p>请确保使用您的解决方案创建对库存储库的拉请求；您可能会帮助其他开发人员节省大量时间。</p>
<h2 id="unrecognized-font-family-error">无法识别的字体系列错误</h2>
<blockquote><p>无法识别字体系列' Lato-Regular '</p>
<p>[rctfnt update font:with family:size:weight:style:variant:scale multiplier:]<br/>rctfnt . mm:347<br/>rcttxtattributes effective font][rcttxtattributes effective text attributes][rctbsetextshadow view attributedtxtwithbasetext attributes:][rcttxtshadow view attribute dtxtwithmeasured size:]</p></blockquote>
<p>当我们试图在React本地项目中添加自定义字体时，会出现此错误。</p>
<p>为了避免这个错误，在项目文件夹的根级别创建一个<code>react-native.co``n``fig</code>文件，并添加下面的代码片段:</p>
<pre class="language-javascript hljs">module.exports = {
  project: {
    ios: {},
    android: {},
  },
  assets: ['./assets/fonts/'],
};
</pre>
<p>要将字体链接到iOS和Android，运行以下命令之一:<br/> <code>npx react-native link</code>或<code>yarn react-native link</code></p>
<p>现在，我们可以在React本地样式中使用自定义字体。</p>
<p>这里有一个例子:<code>fontFamily: 'custom-font'</code></p>
<h2 id="command-phasescriptexecution-failed">命令<code>PhaseScriptExecution</code>失败</h2>
<blockquote><p>命令PhaseScriptExecution失败，返回非零退出代码<br/>phasescript execution[CP-User]\ Generate \ Specs/Users/BM/Library/Developer/Xcode/derived data/RNLocalAuthentication-bhitgdgehuvfyyewuiqxedwixzjg/Build/intermediates . no index/Pods . Build/Debug-iphone simulator/FBReactNativeSpec . Build/Script-5f4c 70 ef 7d 90 a5 5 bdaeb 4279 f 232 a . sh(在项目的目标“FBReactNativeSpec”中</p>
<p>CD/Users/BM/Documents/Projects/RNLocalAuthentication/IOs/Pods<br/>export ACTION \ = build<br/>export AD<em>HOC</em>CODE<em>SIGNING</em>ALLOWED \ = YES<br/>export ALLOW<em>TARGET</em>PLATFORM<em>specification \ = NO<br/>export ALTERNATE</em>GROUP \ = staff<br/>export ALTERNATE<em>MODE \ = u+w，go-w，a+rX<br/>export ALTERNATE</em>OWNER \ = BM</p></blockquote>
<p>npm软件包出现了此错误，这些软件包在M1本地MAC上不受支持。为了在M1 MAC上工作，我们将它添加到podfile中，以便运行并编译到x86模式。</p>
<pre class="language-javascript hljs"> post_install do |installer|
    react_native_post_install(installer)
    __apply_Xcode_12_5_M1_post_install_workaround(installer)
    installer.pods_project.targets.each do |target|
        target.build_configurations.each do |config|
            # Needed for building for simulator on M1 Macs
            config.build_settings['ONLY_ACTIVE_ARCH'] = 'NO'
        end
    end
  end
</pre>
<p>上述代码将其从活动拱门中排除。接下来，按照“Android和iOS的其他故障诊断”一节中列出的其他必要步骤进行操作。</p>
<h2 id="string-outside-text-error">文本外字符串错误</h2>
<blockquote><p>不变冲突:文本字符串必须在组件中呈现。</p>
<p>此错误位于:</p>
<p>在一个(at App.js:29) <br/>在RCTScrollContentView(at scroll view . js:1038)<br/>在RCTScrollView(at scroll view . js:1178)<br/>在ScrollView (at App.js:25) <br/>在rctsafearaveview(at safearaveview . js:55)<br/>在safearaveview(at App . js:24)<br/>在App (at renderApplication.js:40</p></blockquote>
<p>这个错误消息相当简单，您可以看到它位于第29行的<code>app.js</code>文件中，但是仍然值得一提可能的原因。</p>
<p>如果您遇到这个错误，您可能忘记了用一个<code>Text</code>组件来包装您的字符串，或者您可能输入了一个错别字，导致您的组件无法识别。后者是最常见的原因——这里多了一个括号，那里多了一个逗号。即使我们知道去哪里找，这些错别字也很难被发现。</p>
<p>如果在未来的版本中，错误消息能够包含更多有用的信息，比如导致问题的特定字符串，那就太好了。</p>
<h2 id="dependencies-error">依赖性错误</h2>
<blockquote><p>错误:undefined无法从<code>App.js</code>解析模块<code>@babel/runtime/helpers/interopRequireDefault</code>:在项目中找不到@ babel/runtime/helpers/interopRequireDefault。</p>
<p>如果您确定该模块存在，请尝试以下步骤:</p>
<ol>
<li>清除守望者监视:守望者监视-全部</li>
<li>删除节点<em>模块:rm -rf节点</em>模块并运行纱线安装</li>
<li>重置Metro的缓存:纱线开始––重置缓存</li>
<li>移除缓存:rm -rf /tmp/metro-*</li>
</ol>
</blockquote>
<p>如果像这样的错误似乎是凭空出现的，首先应该怀疑是npm或Yarn以及<code>node_modules</code>文件夹中的依赖项。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>首先，您可以尝试重新安装整个依赖项目录。如果您的存储库中的一个主要依赖项发生了某种程度的变化，这可能会导致问题。在主项目目录中运行命令，在那里可以看到<code>node_modules</code>文件夹，删除并重新安装它们。</p>
<pre class="language-javascript hljs">rm -rf node_modules &amp;&amp; yarn
</pre>
<p>如果这不起作用，您可以尝试按照错误消息中概述的步骤操作。下面是一个稍加修改的命令，可以复制到您的终端上:</p>
<pre class="language-javascript hljs">watchman watch-del-all &amp;&amp; rm -rf /tmp/haste-map-react-native-packager-* &amp;&amp; rm -rf /tmp/metro-bundler-cache-* &amp;&amp; rm -rf node_modules/ &amp;&amp; yarn cache clean &amp;&amp; yarn
</pre>
<p>这将清除看守者监视，重置metro bundler缓存，移除haste缓存，重新安装整个<code>node_modules</code>目录，并清除纱线缓存。</p>
<h2 id="additional-troubleshooting-for-android-and-ios">Android和iOS的其他故障排除</h2>
<p>如果仍然有错误，您可以尝试清理您的项目。这些步骤会因您的开发平台而异。</p>
<p>Android  <br/>尝试从主项目目录中键入以下命令来清除Gradle缓存:</p>
<pre class="language-javascript hljs">cd android &amp;&amp; ./gradlew clean
</pre>
<p>如果你正从Xcode打开你的项目，尝试清理它。点击上层菜单栏中的<strong>产品</strong>和<strong>清洗</strong>。</p>
<p>您可能还想尝试运行<code>ios</code>目录中的<code>pod deintegrate</code>来完全删除pod，然后再次运行<code>pod install</code>。</p>
<p>最后，删除派生数据非常有用:</p>
<pre class="language-javascript hljs">rm -rf ~/Library/Developer/Xcode/DerivedData/*
</pre>
<h2 id="conclusion"><strong>结论</strong></h2>
<p>现在，您应该能够解决在开发React本机应用程序时可能遇到的七个最常见的错误。当您阅读本文时，其中一些错误正在被修复，随着新版本的发布，错误消息将变得更具描述性和信息性。但现在，我们需要利用现有资源。了解这些错误背后的上下文可以为您节省大量调试时间。毕竟，虽然这些错误中的大多数很难发现，但是如果您知道自己在寻找什么，它们通常很容易修复。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产React应用</h2><p>调试React应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪Redux状态、自动显示JavaScript错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的web和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试React应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现React原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款React原生监控解决方案，可帮助您即时重现问题、确定bug的优先级并了解React原生应用的性能。</p><p>LogRocket还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的React原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用LogRocket】。</a></p></div>
</div>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>