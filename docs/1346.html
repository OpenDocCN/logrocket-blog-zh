<html>
<head>
<title>What’s new in create-react-app 4.0.0 - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>create-react-app 4 . 0 . 0-log rocket博客的新特性</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/whats-new-in-create-react-app-4-0-0/#0001-01-01">https://blog.logrocket.com/whats-new-in-create-react-app-4-0-0/#0001-01-01</a></blockquote><div><article class="article-post">
<p>创建React应用程序是创建单页React应用程序(spa)的推荐方法。它得到了React的官方支持，提供了一个无需配置的现代构建设置。</p>
<p>有了它，你可以用一个简单的命令启动一个现代的React应用。因为Create React App同时支持<code>npm</code>和<code>yarn</code>，所以这个命令会根据您想要使用的包管理器而略有不同。</p>
<p>要创建新的React应用程序，您可以运行以下任一命令:</p>
<pre>npx create-react-app my-app</pre>
<p>或者</p>
<pre>npm init react-app my-app</pre>
<p>或者</p>
<pre>yarn create react-app my-app</pre>
<p>此外，Create React App消除了安装和配置预先配置和隐藏的Webpack和Babel等繁重任务，因此您可以专注于编码。这意味着需要学习的东西更少，开始创建React应用程序所需要做的就是运行上面的任何命令。</p>
<p>尽管Create React App附带了针对Webpack和Babel的预配置，但它并不强迫您使用它自己的配置。您可以<code>eject</code>从Create React App中，根据您的喜好添加您的自定义配置。</p>
<p>版本4.0是一个主要的发行版，附带了几个有趣的特性。</p>
<p>如果您已经全局安装了<code>create-react-app</code>，您应该运行:</p>
<pre>npm uninstall -g create-react-app</pre>
<p>或者</p>
<pre>yarn global remove create-react-app</pre>
<p>卸载它。然后运行:</p>
<pre>npx create-react-app my-app</pre>
<p>今后，请确保<code>npx</code>始终使用最新版本。你可以在这里获得更多关于这个<a href="https://create-react-app.dev/docs/getting-started#quick-start" target="_blank" rel="noopener noreferrer">的信息。如果您有一个使用旧版本的项目，您可以在下一节中看到关于迁移的说明。</a></p>
<h2>移民</h2>
<p>从版本3.4.x迁移到版本4.0.0时，从尚未退出的项目内部运行以下命令:</p>
<pre>npm install --save --save-exact <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bac8dfdbd9ce97c9d9c8d3cacec9fa8e948a948a">[email protected]</a></pre>
<p>或者</p>
<pre>yarn add --exact <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4b392e2a283f66382839223b3f380b7f657b657b">[email protected]</a></pre>
<p>这应该可以无缝地更新react脚本。如果您遇到任何错误，建议您删除您的<code>node_modules</code>文件夹，并通过运行以下命令重新安装您的依赖项:</p>
<pre>npm install or yarn install</pre>
<p>这将完成迁移，不会出现任何错误。我们将在下一节继续讨论新特性。</p>
<h2>新功能</h2>
<h3>快速刷新</h3>
<p>快速刷新是旧功能热重装的官方React实现。它类似于热重装，但更可靠。</p>
<p>快速刷新使您能够在运行的应用程序中编辑React组件，而不会丢失它们的状态，如下图所示:</p>
<p><img data-attachment-id="29492" data-permalink="https://blog.logrocket.com/whats-new-in-create-react-app-4-0-0/attachment/imagebyadamcharron/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron.gif" data-orig-size="640,371" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="imagebyadamcharron" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron-300x174.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron.gif" decoding="async" class="aligncenter size-full wp-image-29492 jetpack-lazy-image" src="../Images/4feb5217b7ca02b84897b9638c40c64b.png" alt="editing component without losing state" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="29492" data-permalink="https://blog.logrocket.com/whats-new-in-create-react-app-4-0-0/attachment/imagebyadamcharron/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron.gif" data-orig-size="640,371" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="imagebyadamcharron" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron-300x174.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-29492" src="../Images/4feb5217b7ca02b84897b9638c40c64b.png" alt="editing component without losing state" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/11/imagebyadamcharron.gif"/></noscript>
<p>简而言之，它使您能够实时调整React组件。这类似于<code>react-hot-loader</code>。</p>
<p>但是fash refresh相对于其前身的一个主要优势是它支持热重载挂钩和状态保存。</p>
<p>Create React App 4.0.0使用<a href="https://www.npmjs.com/package/react-refresh" target="_blank" rel="noopener noreferrer"> react-refresh </a>包和<a href="https://github.com/pmmmwh/react-refresh-webpack-plugin" target="_blank" rel="noopener noreferrer"> react refresh webpack插件</a>实现了这一点。</p>
<h3>React 17(新JSX变换)和类型脚本支持</h3>
<p>Create React App 4.0.0提供了对新的<a href="https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html" target="_blank" rel="noopener noreferrer"> JSX变换</a>和React 17的支持。新的JSX变换没有改变JSX语法，但是，它带来了显着的改进反应。</p>
<p>由于浏览器不理解开箱即用的JSX，React开发人员依赖编译器将他们的JSX转换成浏览器可以理解的React函数调用。Babel和TypeScript等编译器大多用于此目的。</p>
<p>此外，Create React App等工具包也附带了JSX变换，4.0.0通过TypeScript 4.1.0提供了对新的JSX变换的支持。</p>
<p>虽然升级到新JSX变换是可选的，但它确实带来了一些有趣的好处，例如:</p>
<ul>
<li>新的JSX变换允许你使用JSX而不用导入React</li>
</ul>
<p>如上所述，浏览器不理解JSX，所以它必须被编译成JavaScript函数。如果您有这样的React代码:</p>
<pre>import React from 'react';

function App() {
  return &lt;p&gt;Hi I am Lawrence Eagles&lt;/p&gt;;
}</pre>
<p>旧的<code>JSX</code>转换会将其转换为:</p>
<pre>import React from 'react';

function App() {
  return `('p', null, 'Hi I am Lawrence Eagles');
}</pre>
<p>这样做的问题是它调用了<code>React.createElement</code>函数，因此，必须导入React。</p>
<p>另外，<code>React.createElement</code>不支持一些性能优化技术。因此，在<code>JSX</code>变换的实现中还有改进的空间。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>使用新的<code>JSX</code>转换，如果我们有以下代码:</p>
<pre>function App() {
  return &lt;p&gt;Hi I am Lawrence Eagles&lt;/p&gt;;
}</pre>
<p>它会把它变成这样:</p>
<pre>// Inserted by a compiler (don't import it yourself!)
import {jsx as _jsx} from 'react/jsx-runtime';

function App() {
  return _jsx('p', { children: 'Hi I am Lawrence Eagles });
}</pre>
<blockquote><p>上面的代码示例来自于<a href="https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html#whats-different-in-the-new-transform" target="_blank" rel="noopener noreferrer">文档</a>。</p></blockquote>
<p>注意，我们的原始代码不需要导入React，它仍然工作得很好。</p>
<p>此外，根据您的配置，新的<code>JSX</code>转换可以减少您的应用包大小。</p>
<h3>ESLint 7支持</h3>
<p>React使用<a href="https://www.npmjs.com/package/eslint" target="_blank" rel="noopener noreferrer"> ESLint </a>隐藏我们的代码。这很重要，因为React是一个JavaScript库，而JavaScript是松散类型的。这意味着错误不是在开发期间或在<code>compile time</code>被捕获，而是在<code>runtime</code>被捕获。</p>
<p>诸如ESLint之类的Linters为您提供了一种在开发过程中过滤代码和捕捉错误的机制。这可能是救命稻草。此外，使用linters，您可以编写自定义规则来加强您的编码风格。如果你想加强编码风格，建议你使用<a href="https://github.com/prettier/prettier" target="_blank" rel="noopener noreferrer">更漂亮的</a>。</p>
<p>Create React App 4.0.0自带更新的<code>eslint-config-react-app</code>来支持新发布的<a href="https://eslint.org/blog/2020/05/eslint-v7.0.0-released" target="_blank" rel="noopener noreferrer"> ESLint 7 </a>。它还为<code>import/no-anonymous-default-export</code>、<code>Jest</code>和<code>React testing library</code>增加了新的规则。</p>
<p>创建React应用程序，允许您扩展默认的ESLint规则，甚至替换它。但是替换它是不明智的，因为这是令人讨厌的错误的已知原因。</p>
<p>在扩展基本ESLint规则之前，需要注意一些问题，它们是:</p>
<ul>
<li>任何设置为<code>error</code>的规则都会破坏应用程序构建过程</li>
<li>使用TypeScript时，您需要提供一个仅针对TypeScript文件的<code>override</code>对象</li>
<li>如前所述，扩展而不是取代ESLint规则</li>
</ul>
<p>以下是扩展的ESLint规则的示例:</p>
<pre>{
  "eslintConfig": {
    "extends": ["react-app", "shared-config"],
    "rules": {
      "additional-rule": "warn",
      "indent": ["error", 4]
    },
    "overrides": [
      {
        "files": ["**/*.ts?(x)"],
        "rules": {
          "additional-typescript-only-rule": "warn",
          "indent": ["error", "tab"]
        }
      }
    ]
  }
}</pre>
<p>上述规则简单地执行以下操作:</p>
<ul>
<li>首先延长<code>react-app</code>:<ul>
<li><code>"extends": ["react-app", "shared-config"]</code></li>
</ul>
</li>
<li>将任何附加规则设置为<code>“warn”</code>以避免停止构建过程:<ul>
<li><code>"additional-rule": "warn"</code></li>
</ul>
</li>
<li>将一致的缩进样式设置为<code>4 spaces</code>:</li>
<li>如果正在使用TypeScript，请将TypeScript特定配置放在<code>override</code>部分:<ul>
<li><pre>"overrides": [           {             "files": ["**/*.ts?(x)"],             "rules": {               "additional-typescript-only-rule": "warn",               "indent": ["error", "tab"] // enforce tab indentation.             }           }         ]</pre></li>
</ul>
</li>
</ul>
<p>你也可以在这里了解更多关于这个<a href="https://create-react-app.dev/docs/setting-up-your-editor/#extending-or-replacing-the-default-eslint-config" target="_blank" rel="noopener noreferrer">的信息。</a></p>
<h2>其他显著变化</h2>
<ul>
<li>不再支持<code>typescript flag</code>和<code>NODE_PATH</code></li>
</ul>
<p>要添加TypeScript以创建React App 4.0.0，请执行以下操作:</p>
<pre>npx create-react-app my-app --template typescript</pre>
<p>而不是这个:</p>
<pre>npx create-react-app hello-tsx --typescript</pre>
<p>此外，对<code>NODE_PATH</code>的支持已经被删除，因为它被在<code>jsconfig.json</code>中设置基本路径所取代。</p>
<ul>
<li>笑话升级到26</li>
<li>停止对节点8的支持，该节点已于2019年底停产，不再受支持</li>
<li>切换到<a href="https://developers.google.com/web/tools/workbox/reference-docs/latest/module-workbox-webpack-plugin.InjectManifest" target="_blank" rel="noopener noreferrer"> Workbox injectManifest插件</a>，并使<code>PWA</code>模板独立于它们自己的仓库</li>
</ul>
<h2>结论</h2>
<p>Create React App 4.0.0是一个主要版本，它提供了一些非常棒的功能。最让我兴奋的是<code>fast refresh</code>。有这个真的很好，不需要额外的包装。</p>
<p>新的<code>JSX transform</code>也是一个很好的补充，但这并没有增强开发者的体验，因为语法保持不变。</p>
<p>其他更新也很酷，迁移过程是无缝的，这是一件好事。我们可以通过运行一个命令来获得所有这些更新。</p>
<p>最后，如果你需要这个版本的更多细节，你可以在这里找到。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产React应用</h2><p>调试React应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪Redux状态、自动显示JavaScript错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的web和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试React应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>