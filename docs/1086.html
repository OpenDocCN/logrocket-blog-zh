<html>
<head>
<title>Data visualization with Vue.js and D3 - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>用Vue.js和D3实现数据可视化</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/data-visualization-vue-js-d3/#0001-01-01">https://blog.logrocket.com/data-visualization-vue-js-d3/#0001-01-01</a></blockquote><div><article class="article-post">
<p><em> <strong>编者按:</strong>这篇文章最后一次更新是在2022年7月6日，包含了关于Vue和D3最新版本的信息。</em></p>
<p>在过去的两年里，我们已经看到了很多数据可视化回答了关于新冠肺炎的问题。这些可视化通过给我们提供关于特定位置的病例数的重要信息，帮助我们所有人变得更安全。</p>
<p>数据可视化帮助我们更好地理解数字。视觉帮助人类大脑更快地感知信息，而不是进行复杂的计算。另外，它们看起来和玩起来比一个充满数字的电子表格有趣得多。</p>
<p>为了演示，在本文中我们将使用<a href="https://d3js.org/" target="_blank" rel="noopener"> D3.js </a>和Vue.js来创建一个折线图，这样您就可以看到D3和Vue在构建数据可视化时是多么有用。</p>
<h3>内容</h3>

<h2 id="what-is-d3-js">D3.js是什么？</h2>
<p>D3是一个开源的JavaScript库，用于在web浏览器中创建交互式数据可视化。D3可以用来操作DOM对象和HTML、SVG或Canvas元素来可视化数据。D3.js可以控制数据的显示方式，并让我们增加交互性。</p>
<h2 id="why-use-d3-js">为什么要用D3.js？</h2>
<p>目前有许多JS库用于数据可视化。一些库用于创建3D视觉效果，如<a href="https://blog.logrocket.com/creating-game-three-js/" target="_blank" rel="noopener"> three.js </a>和Babylon.js，还有一些是多用途的，如<a href="https://www.highcharts.com/" target="_blank" rel="noopener"> HighCharts </a>和<a href="https://recharts.org/en-US/" target="_blank" rel="noopener"> Recharts </a>。</p>
<p>然而，D3是可用的最健壮和最广泛的JavaScript数据可视化库之一。在GitHub 上有超过102k的星星，D3是领先的数据可视化JavaScript库。</p>
<p>根据<a href="https://d3js.org/" target="_blank" rel="noopener">官方文件</a>:</p>
<blockquote><p>D3帮助您使用HTML、SVG和CSS将数据变得生动。D3对web标准的重视使您可以获得现代浏览器的全部功能，而无需将自己束缚于专有框架，将强大的可视化组件和数据驱动的DOM操作方法结合起来。</p></blockquote>
<p>有数百个例子可供参考和学习。从简单的<a href="https://bl.ocks.org/d3noob/8952219" target="_blank" rel="noopener">条形图</a>到更复杂的<a href="https://observablehq.com/@d3/directed-chord-diagram" target="_blank" rel="noopener">弦图</a>可视化国家之间的债务，你可以用D3让任何事情变得生动起来。</p>
<p>除了是创建视觉效果的强大工具，D3还有一个巨大的开源社区。如果你有一个图形的想法，有可能某个地方的某个人已经创造了类似的东西，并且写了关于它的文章。或者，如果你在创建工具提示或动画方面停滞不前，那么很有可能StackOverflow会给你一个答案。底线是你永远不会孤单。</p>
<h2 id="getting-started">入门指南</h2>
<p>我们首先在终端中运行以下命令来创建一个新的Vue应用程序:</p>
<pre class="language-shell hljs">npm init <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6513100025090411001611">[email protected]</a>
</pre>
<p>接下来，导航到项目目录并安装必要的依赖项:</p>
<pre class="language-shell hljs">cd vue-project
npm install
</pre>
<p>我们将使用D3，所以我们可以这样安装它:</p>
<pre class="language-shell hljs">npm i d3
</pre>
<h2 id="building-line-chart-d3-js">用D3.js构建折线图</h2>
<p>现在我们了解了D3是什么，让我们通过创建折线图来学习如何使用它。</p>
<p>首先要做的是定义我们将在其中呈现图表的HTML模板。对于本文，我们将使用一个SVG:</p>
<pre class="language-html hljs">&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;Vue.js and D3 Line Chart&lt;/h2&gt;
    &lt;svg&gt;&lt;/svg&gt;
  &lt;/div&gt;
&lt;/template&gt;
</pre>
<p>接下来，我们定义要在图表上显示的数据。我们将在本演示中使用虚拟数据，但在实际应用中，我们最有可能使用实时数据，例如注册应用的用户数量、一个月的降雨量或企业的季度利润:</p>
<pre class="language-html hljs">&lt;script&gt;
  const data = [
    { date: "24-Apr-07", amount: 93.24 },
    { date: "25-Apr-07", amount: 95.35 },
    { date: "26-Apr-07", amount: 98.84 },
    { date: "27-Apr-07", amount: 99.92 },
    { date: "30-Apr-07", amount: 99.8 },
    { date: "1-May-07", amount: 99.47 },
    { date: "2-May-07", amount: 100.39 },
    { date: "3-May-07", amount: 100.4 },
    { date: "4-May-07", amount: 100.81 },
    { date: "7-May-07", amount: 103.92 },
    { date: "8-May-07", amount: 105.06 },
    { date: "9-May-07", amount: 106.88 },
    { date: "10-May-07", amount: 107.34 },
  ];
&lt;script/&gt;
</pre>
<p>这里的数据是一个对象数组，每个对象都有<code>date</code>和<code>key</code>。</p>
<h3>创建图表</h3>
<p>让我们从示例图表开始</p>
<p>首先，选择我们将安装图表的元素:</p>
<pre class="language-js hljs">&lt;script&gt;
  import * as d3 from 'd3'

  data = [//the chart data we defined earlier]

  mounted(){
    const width = 800;
    const height = 500;
    const svg = d3.select("svg").attr("width", width).attr("height", height);
    const g = svg.append("g");
  }
&lt;script/&gt;
</pre>
<p>在上面的代码中，我们从D3库中导入了<code>d3</code>,并定义了图表的宽度和高度。然后，我们使用<code>d3.select()</code>方法选择我们之前定义的SVG元素，并将其存储为一个名为<code>svg</code>的常量。这个<em> <em/> </em>方法将选择DOM中第一个匹配的元素(从上到下)。</p>
<p>接下来，我们使用D3的<code>attr()</code>方法将<code>width</code>和<code>height</code>属性添加到<code>svg</code>，然后将SVG组元素<code>g</code>添加到<code>svg</code>。SVG <code>&lt;g&gt;</code>元素是一个用于对其他SVG元素进行分组的容器。</p>
<p>我们的下一步是将日期从字符串数据解析为JavaScript日期对象。</p>
<p>目前，我们的<code>data</code>数组中的日期是字符串格式的。我们需要将它们转换成表示单个时间点的JavaScript date对象。D3有一个<a href="https://github.com/d3/d3-time-format"> d3-time-format </a>模块，包含几个解析和格式化日期的方法:</p>
<pre class="language-shell hljs">const parseTime = d3.timeParse("%d-%b-%y");
</pre>
<h3>创建图表轴</h3>
<p>我们希望在x轴上绘制日期，在y轴上绘制金额。</p>
<p>D3有一个<a href="https://github.com/d3/d3-scale" target="_blank" rel="noopener"> d3-scale </a>模块，我们将使用它将数据值转换成像素。标度是在两个域之间转换值的函数。D3标度用于将数据值转换成可视变量。</p>
<p>D3秤需要两条信息:域和范围。简单来说，域就是我们给的输入，范围就是我们想要的输出:</p>
<pre class="language-js hljs">const x = d3
      .scaleTime()
      .domain(
        d3.extent(data, function (d) {
          return parseTime(d.date);
        })
      )
      .rangeRound([0, width]);

const y = d3
      .scaleLinear()
      .domain(
        d3.extent(data, function (d) {
          return d.amount;
        })
      )
      .rangeRound([height, 0]);
</pre>
<p>在这里，我们执行以下操作:</p>
<p>我们在x轴上使用了<code>d3.scaleTime()</code>刻度，因为我们正在处理日期对象，这是知道如何处理日期对象的刻度。然后，我们在y轴上使用了<code>d3.scaleLinear()</code>刻度，因为y轴上的值是线性增加的数字。</p>
<h3>创建线</h3>
<p>D3提供了一个<a href="https://github.com/d3/d3-shape" target="_blank" rel="noopener"> d3-shape </a>模块，我们可以用它来创建复杂的形状，比如符号、线条和弧线。我们正在创建一个折线图，所以我们将使用<code>d3.line()</code>方法。</p>
<p><code>d3.line()</code>方法创建一个遵循一系列点的形状:</p>
<pre class="language-js hljs">const line = d3.line()
  .x(function (d) {
    return x(parseTime(d.date));
  })
  .y(function (d) {
    return y(d.amount);
  });
</pre>
<p>这里，我们通过传入匿名函数并返回date对象和对应于每个日期的金额来定义该行的x轴和y轴属性。</p>
<h3>将轴追加到图表</h3>
<p>现在，我们需要将x轴和y轴连接到图表，如下所示:</p>
<pre class="language-js hljs"> g.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

    g.append("g")
      .call(d3.axisLeft(y))
      .append("text")
      .attr("fill", "#000")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", "0.71em")
      .attr("text-anchor", "end")
      .text("Price ($)");
</pre>
<p>对于x轴，我们调用<code>d3.axisBottom()</code>，因为我们需要在画布的底部对齐它。对于y轴，我们调用<code>d3.axisLeft()</code>,因为我们想让它在画布的左边对齐。</p>
<h3>向图表追加路径</h3>
<p>最后，我们向图表添加一个路径。这个路径实际上会根据数据的值绘制折线图:</p>
<pre class="language-js hljs">g.append("path")
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", "steelblue")
      .attr("stroke-width", 1.5)
      .attr("d", line);
</pre>
<p>在这里，我们执行以下操作:</p>
<ul>
<li>使用<code>datum</code>方法传递<code>data</code>数组</li>
<li>设置填充颜色、线条颜色和线条宽度的属性</li>
<li>设置<code>d</code>的属性，该属性为SVG路径提供关于在何处连接路径点的指令</li>
</ul>
<p>这样，我们看到浏览器中出现了折线图。</p>
<p><img data-attachment-id="125073" data-permalink="https://blog.logrocket.com/data-visualization-vue-js-d3/attachment/d3-and-vue-line-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png" data-orig-size="969,600" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="D3 and Vue line chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart-300x186.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png" decoding="async" class="size-full wp-image-125073 aligncenter jetpack-lazy-image" src="../Images/4ada99f908fb74364b2bee3cb9e2c5f3.png" alt="D3 and Vue line chart" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png 969w, https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart-300x186.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart-768x476.png 768w, https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart-825x510.png?crop=1 825w" data-lazy-sizes="(max-width: 969px) 100vw, 969px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="125073" data-permalink="https://blog.logrocket.com/data-visualization-vue-js-d3/attachment/d3-and-vue-line-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png" data-orig-size="969,600" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="D3 and Vue line chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart-300x186.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png" decoding="async" loading="lazy" class="size-full wp-image-125073 aligncenter" src="../Images/4ada99f908fb74364b2bee3cb9e2c5f3.png" alt="D3 and Vue line chart" srcset="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png 969w, https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart-300x186.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart-768x476.png 768w, https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart-825x510.png?crop=1 825w" sizes="(max-width: 969px) 100vw, 969px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/08/D3-and-Vue-line-chart.png"/></noscript>
<p>下面是折线图的最终代码:</p>
<pre class="language-js hljs">&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;Vue.js and D3 Line Chart&lt;/h2&gt;
    &lt;svg&gt;&lt;/svg&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import * as d3 from "d3";
export default {
  data() {
    return {};
  },
  mounted() {
    const width = 800;
    const height = 500;
    const data = [];

    const svg = d3.select("svg").attr("width", width).attr("height", height);
    const g = svg.append("g");

    //2. Parse the dates
    const parseTime = d3.timeParse("%d-%b-%y");

    //3. Creating the Chart Axes
    const x = d3
      .scaleTime()
      .domain(
        d3.extent(data, function (d) {
          return parseTime(d.date);
        })
      )
      .rangeRound([0, width]);

    const y = d3
      .scaleLinear()
      .domain(
        d3.extent(data, function (d) {
          return d.amount;
        })
      )
      .rangeRound([height, 0]);

    //4. Creating a Line
    const line = d3
      .line()
      .x(function (d) {
        return x(parseTime(d.date));
      })
      .y(function (d) {
        return y(d.amount);
      });

    //5. Appending the Axes to the Chart
    g.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

    g.append("g")
      .call(d3.axisLeft(y))
      .append("text")
      .attr("fill", "#000")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", "0.71em")
      .attr("text-anchor", "end")
      .text("Price ($)");    

    //6. Appending a path to the Chart
    g.append("path")
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", "steelblue")
      .attr("stroke-width", 1.5)
      .attr("d", line);
  },
};
&lt;/script&gt;
</pre>
<h2>结论</h2>
<p>D3是一个庞大的库，尽管我们涵盖了很多，但这只是基础。我们可以使用D3创建不同种类的图表。通过<a href="https://observablehq.com/@d3" target="_blank" rel="noopener"> Observable </a>这样的平台去看一些例子，获得灵感。</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>