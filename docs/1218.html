<html>
<head>
<title>A complete guide to permissions in a GraphQL API - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>GraphQL API - LogRocket博客中的权限完整指南</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/#0001-01-01">https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/#0001-01-01</a></blockquote><div><article class="article-post">
<h2>介绍</h2>
<p>GraphQL已经成为开发API的新常态。它有自己的优势和灵活性。其中一个优点是，它允许您在API中实现权限和粒度访问控制。</p>
<p>在大型REST APIs中，获得粒度访问控制是一大难题。在GraphQL中，您可以非常容易地实现粒度。</p>
<p>在本文中，我们将看到在GraphQL API中实现权限的不同模式。</p>
<h3>访问控制和权限的基础知识</h3>
<p><strong>访问控制</strong>–检查用户是否被授权访问API。</p>
<p>通常，如果一个用户没有登录，但是API端点需要一个登录的用户，API会抛出一个身份验证错误。</p>
<p>如果用户已经登录，但是没有足够的权限来执行操作，API将抛出一个禁止的错误或一个未授权的错误。</p>
<p><strong>Permissions</strong>–Permissions是一组规则，有助于决定用户是否可以访问特定的API。</p>
<p>让我们检查一些权限的示例用例。</p>
<p>想想Twitter应用程序:</p>
<ul>
<li>用户可以写一条推文</li>
<li>写推文的作者可以删除</li>
<li>其他用户可以喜欢、转发或分享这条推文</li>
<li>其他用户可以报告推文</li>
<li>推文的作者和其他用户都可以参与推文上的评论线程</li>
</ul>
<p>如您所见，作者和其他用户拥有不同级别的权限，尽管授权级别是相同的。他们都被授权为用户，但根据活动，他们有不同的访问权限。</p>
<h2>GraphQL中的权限</h2>
<p>您可以在GraphQL API中以不同的方式实现权限。例如，您可以通过模式中的GraphQL指令或者通过检查GraphQL中间件(如解析器)中的权限来实现权限。</p>
<p><strong>权限深度</strong></p>
<p>在GraphQL中，可以深入到任何深度来实现权限。</p>
<p>您可以拥有查询级权限、对象级权限和字段级权限。</p>
<p><strong>在GraphQL中实现权限的不同方式</strong></p>
<p>实现这些权限有不同的技术:指令、中间件解析器和GraphQL shield库。</p>
<p>我们将在示例中看到所有这些技术。现在，让我们构建一个简单的GraphQL服务器示例。</p>
<h2>构建简单的GraphQL API</h2>
<p>首先，创建一个新的npm项目:</p>
<pre>npm init</pre>
<p>添加您的<code>express</code>、<code>apollo-server-express</code>和<code>graphql</code>套餐。</p>
<pre>npm i express apollo-server-express</pre>
<p>接下来，使用示例GraphQL服务器创建一个<code>index.js</code>文件:</p>
<pre>const express = require('express');
const { ApolloServer, gql } = require('apollo-server-express');

// Construct a schema, using GraphQL schema language
const typeDefs = gql`
  type Query {
    hello: String
  }
`;

// Provide resolver functions for your schema fields
const resolvers = {
  Query: {
    hello: () =&gt; 'Hello world!',
  },
};

const server = new ApolloServer({ typeDefs, resolvers });
const app = express();
server.applyMiddleware({ app });

app.listen({ port: 4000 }, () =&gt;
  console.log(`🚀 Server ready at http://localhost:4000${server.graphqlPath}`)
);</pre>
<p>让我们添加nodemon来本地运行服务器。Nodemon通过在开发过程中观察文件的变化来帮助重新加载服务器:</p>
<pre>npm i -D nodemon</pre>
<p>在<code>package.json</code>文件中添加运行服务器的脚本:</p>
<pre>"scripts": {
    "start": "node index.js",
    "dev": "nodemon index.js"
},</pre>
<p>让我们在终端中启动服务器:</p>
<pre>npm run dev</pre>
<p>服务器将在端口<code>4000</code>打开。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>让我们再创建几个文件并拆分代码。我们将使用一个<code>schema.js</code>文件来定义GraphQL类型:</p>
<pre>// schema.js

const { gql } = require("apollo-server-express");
// Construct a schema, using GraphQL schema language
module.exports = gql`
  type Query {
    hello: String
  }
`;</pre>
<p>和<code>resolver.js</code>文件用于解析器:</p>
<pre>// schema.js

const { gql } = require("apollo-server-express");
// Construct a schema, using GraphQL schema language
module.exports = gql`
  type Query {
    hello: String
  }
`;</pre>
<p>让我们为一个简单的Tweet应用程序创建一些数据和相应的查询和解析器。</p>
<p><code>data.js</code>文件将是:</p>
<pre>// data.js

module.exports = [
  {
    id: 0,
    content: "HTML is a programming language",
    author: "Param",
  },
  {
    id: 1,
    content: "JavaScript programmers are beginners",
    author: "Param",
  },
  {
    id: 2,
    content: "HTML and CSS pages are enough to build a bank project",
    author: "Joshua",
  },
  {
    id: 3,
    content: "React Js can prove earth as flat in 2025",
    author: "Joshua",
  },
];</pre>
<p>现在，我们将创建查询和解析器来显示这条Tweet数据:</p>
<pre>// schema.js

const { gql } = require("apollo-server-express");
// Construct a schema, using GraphQL schema language
module.exports = gql`
  type Query {
    hello: String
    tweets: [Tweet]!
    tweet(id: Int!): Tweet!
  }

  type Tweet {
    id: Int!
    content: String!
    author: String!
  }
`;</pre>
<p><code>tweets</code>和<code>tweet</code>查询的解析器:</p>
<pre>// resolvers.js

const { ApolloError } = require("apollo-server-express");
const tweets = require("./data");

// Provide resolver functions for your schema fields
module.exports = {
  Query: {
    hello: () =&gt; "Hello world!",
    tweets: () =&gt; {
      return tweets;
    },
    tweet: (_, { id }) =&gt; {
      const tweetId = tweets.findIndex((tweet) =&gt; tweet.id === id);
      if (tweetId === -1) return new ApolloError("Tweet not found");
      return tweets[tweetId];
    },
  },
};</pre>
<p>我们现在已经准备好了基本的GraphQL服务器。让我们通过例子进入graphQL权限。</p>
<h3>查询级别权限:只有登录的用户才能访问tweet</h3>
<blockquote><p>这些例子是假设的，仅供学习之用。在真实的应用程序中，这些场景中的大多数都没有意义。</p></blockquote>
<p>对于这个例子，首先我们需要从HTTP请求中获取登录用户的详细信息。</p>
<p>这种许可可以用不同的方式实现。</p>
<p><strong>解析器内部的简单解决方案</strong></p>
<p>首先，我们将用户添加到请求上下文中。为了简单起见，我们只将头用户传递给请求。</p>
<pre>// index.js
...
const server = new ApolloServer({
  typeDefs,
  resolvers,
  context: ({ req }) =&gt; {
    return {
      user: req.headers.user || "",
    };
  },
});
...</pre>
<p>然后，添加逻辑以确保只有登录的用户才能看到Tweet查询:</p>
<pre>// resolvers.js
const { ApolloError, ForbiddenError } = require("apollo-server-express");

...
tweet: (_, { id }, { user }) =&gt; {
      // Check whether user is logged-in
      if (!user) return new ForbiddenError("Not Authorized");
      
      const tweetId = tweets.findIndex((tweet) =&gt; tweet.id === id);
      if (tweetId === -1) return new ApolloError("Tweet not found");
      return tweets[tweetId];
}
...</pre>
<p>如果你在操场上经过用户，它会显示推文:</p>
<p><img data-attachment-id="26669" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/localhost/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="localhost" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png" decoding="async" class="aligncenter wp-image-26669 size-full jetpack-lazy-image" src="../Images/e46e961ad7f1ff097e06ca2673ab642f.png" alt="Our Tweet in a local GraphQL server." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/localhost-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="26669" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/localhost/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="localhost" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png" decoding="async" loading="lazy" class="aligncenter wp-image-26669 size-full" src="../Images/e46e961ad7f1ff097e06ca2673ab642f.png" alt="Our Tweet in a local GraphQL server." srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/localhost-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/localhost.png"/></noscript>
<p>如果头中没有传入用户，就会抛出一个<code>ForbiddenError</code>:</p>
<p><img data-attachment-id="26670" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/tweet-errors/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="tweet-errors" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png" decoding="async" class="aligncenter wp-image-26670 size-full jetpack-lazy-image" src="../Images/2aed1098a2ada0bec1015fd8484f2126.png" alt="A forbidden error in the GraphQL server." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors-300x154.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="26670" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/tweet-errors/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="tweet-errors" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png" decoding="async" loading="lazy" class="aligncenter wp-image-26670 size-full" src="../Images/2aed1098a2ada0bec1015fd8484f2126.png" alt="A forbidden error in the GraphQL server." srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors-300x154.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/tweet-errors.png"/></noscript>
<p>这种保护方式不具有可扩展性和可重用性。但是它仍然适用于这个用例。</p>
<h3>使用GraphQL指令</h3>
<p>让我们创建一个GraphQL指令<code>isLoggedin</code>并将其应用于<code>tweet</code>查询:</p>
<pre>// schema.js

const { gql } = require("apollo-server-express");

// Construct a schema, using GraphQL schema language
module.exports = gql`
  directive @isLoggedin on FIELD_DEFINITION
  type Query {
    hello: String
    tweets: [Tweet]!
    tweet(id: Int!): Tweet! @isLoggedin
  }
  ...
`;</pre>
<p>然后，在GraphQL服务器上添加该指令的逻辑。创建一个<code>directives.js</code>文件:</p>
<pre>// directives.js

const {
  ForbiddenError,
  SchemaDirectiveVisitor,
} = require("apollo-server-express");
const { defaultFieldResolver } = require("graphql");

class isLoggedinDirective extends SchemaDirectiveVisitor {
  visitFieldDefinition(field) {
    const originalResolve = field.resolve || defaultFieldResolver;
    field.resolve = async function (...args) {
      const context = args[2];
      const user = context.user || "";
      if (!user) {
        throw new ForbiddenError("Not Authorized");
      }
      const data = await originalResolve.apply(this, args);
      return data;
    };
  }
}

module.exports = { isLoggedinDirective };</pre>
<p>创建指令的语法有点荒谬。你可以在阿波罗<a href="https://www.apollographql.com/docs/apollo-server/schema/creating-directives/" target="_blank" rel="noopener noreferrer">文档</a>中探索更多。我们需要链接服务器上的指令:</p>
<pre>// index.js

const { isLoggedinDirective } = require("./directives");

...
const server = new ApolloServer({
  typeDefs,
  resolvers,
  schemaDirectives: {
    isLoggedin: isLoggedinDirective,
  },
  context: ({ req }) =&gt; {
    return {
      user: req.headers.user || "",
    };
  },
});
...</pre>
<p>运行服务器并检查GraphQL playground中的<code>with</code>和<code>without user</code>头。该指令的工作方式与我们简单的解决方案完全一样，但是由于逻辑是解耦的，所以很容易在多个地方重用。</p>
<h3>使用GraphQL中间件</h3>
<p>中间件也是一个解析器。不是直接解析查询，而是首先在中间件解析器中进行检查，然后传递给下一个解析器。您可以使用这种技术组合多个解析器。</p>
<p>为此，我们将使用名为<code>graphql-resolvers</code>的包。</p>
<pre>npm i graphql-resolvers</pre>
<p>让我们在<code>middlewares.js</code>文件中创建我们的<code>isLoggedin</code>中间件解析器:</p>
<pre>// middlewares.js

const { ForbiddenError } = require("apollo-server-express");

// Middleware resolver
const isLoggedin = (parent, args, { user }, info) =&gt; {
  if (!user) throw new ForbiddenError("Not Authorized");
};

module.exports = { isLoggedin };</pre>
<p>现在，我们可以将这个中间件添加到<code>tweet</code>解析器中:</p>
<pre>// resolvers.js
...
const { combineResolvers } = require("graphql-resolvers");
const { isLoggedin } = require("./middlewares");

...
tweet: combineResolvers(isLoggedin, (_, { id }) =&gt; {
      const tweetId = tweets.findIndex((tweet) =&gt; tweet.id === id);
      if (tweetId === -1) return new ApolloError("Tweet not found");
      return tweets[tweetId];
})
...</pre>
<p>使用<code>combineResolvers</code>，我们能够在解析实际查询之前组合多个中间件解析器。</p>
<p>这个方法也是可重用的，因为我们从真正的解析器中提取逻辑。</p>
<h2>对象级权限</h2>
<p>对于同一个示例，我们将该指令应用于整个Tweet类型。然后，我们将启用对象级权限。我们可以跨所有查询保护整个对象，而不是只保护查询。</p>
<p>让我们把它看作一个例子。该示例类似于我们的模式指令示例:</p>
<pre>// schema.js

const { gql } = require("apollo-server-express");

// Construct a schema, using GraphQL schema language
module.exports = gql`
  directive @isLoggedin on OBJECT
  
  type Query {
    hello: String
    tweets: [Tweet]!
    tweet(id: Int!): Tweet!
  }
  
  type Tweet @isLoggedin {
    id: Int!
    content: String!
    author: String!
  }
`;</pre>
<p>指令附加在类型<code>Tweet</code>上。如果你注意到了，我们改变了<code>OBJECT</code>上的指令声明。这需要对<code>directives.js</code>进行一些修改:</p>
<pre>// directives.js

const {
  ForbiddenError,
  SchemaDirectiveVisitor,
} = require("apollo-server-express");
const { defaultFieldResolver } = require("graphql");

class isLoggedinDirective extends SchemaDirectiveVisitor {
  visitObject(obj) {
    const fields = obj.getFields();
    Object.keys(fields).forEach((fieldName) =&gt; {
      const field = fields[fieldName];
      const originalResolve = field.resolve || defaultFieldResolver;
      field.resolve = async function (...args) {
        const context = args[2];
        const user = context.user || "";
        if (!user) {
          throw new ForbiddenError("Not Authorized");
        }
        const data = await originalResolve.apply(this, args);
        return data;
      };
    });
  }
}

module.exports = { isLoggedinDirective };</pre>
<p>如果您在没有登录的情况下检查<code>tweets</code>查询，那么它将抛出一个错误，因为<code>tweets</code>查询返回一个Tweets数组。</p>
<p>标题中没有用户:</p>
<p><img data-attachment-id="26671" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/error-messages/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="error-messages" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png" decoding="async" class="aligncenter wp-image-26671 size-full jetpack-lazy-image" src="../Images/a677dc19c1b786736ca121d0d9a555d6.png" alt="An error message shown because there is no user in the header." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="26671" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/error-messages/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="error-messages" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png" decoding="async" loading="lazy" class="aligncenter wp-image-26671 size-full" src="../Images/a677dc19c1b786736ca121d0d9a555d6.png" alt="An error message shown because there is no user in the header." srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/error-messages.png"/></noscript>
<p>标题中包含用户:</p>
<p><img data-attachment-id="26672" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/data/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="data" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png" decoding="async" class="aligncenter wp-image-26672 size-full jetpack-lazy-image" src="../Images/7c501ef49181e6811a2ee2ae64259348.png" alt="A successful tweet with a user in the header." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/data-300x154.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="26672" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/data/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="data" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png" decoding="async" loading="lazy" class="aligncenter wp-image-26672 size-full" src="../Images/7c501ef49181e6811a2ee2ae64259348.png" alt="A successful tweet with a user in the header." srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/data-300x154.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/data.png"/></noscript>
<h2>字段级权限</h2>
<p>我们还可以实现字段级的粒度权限。例如，具有管理员角色的用户可以查看某些字段。同时，具有普通访问权限的用户不会看到这样的字段。</p>
<p>这种情况的典型例子是计费和订阅信息。只有管理员可以看到这些信息，其他用户看不到。您可以在GraphQL API上以这样的粒度授予权限。</p>
<p>对于上一个例子，我们使用了指令。我们将使用一种新技术来实现我们的字段级权限。正如我之前提到的，您可以用许多不同的方式实现权限。由你选择一个，这取决于项目。</p>
<h3>使用GraphQL屏蔽库</h3>
<p>GraphQL shield可用于在GraphQL API中进行非常广泛或详尽的权限设置。我们将看到如何使用<code>graphql-shield</code>来实现粒度权限。</p>
<p>让我们安装它:</p>
<pre>npm i graphql-shield graphql-middleware @graphql-tools/schema</pre>
<p>接下来，创建一个<code>permissions.js</code>文件。让我们拒绝所有请求，只允许一个<code>hello</code>查询:</p>
<pre>// permissions.js

const { allow, deny, shield } = require("graphql-shield");

const permissions = shield({
  Query: {
    "*": deny,
    hello: allow,
  },
});

module.exports = permissions;</pre>
<p>通配符将拒绝每个请求，然后精确地允许<code>hello</code>查询。现在，在服务器中应用权限:</p>
<pre>// index.js

const express = require("express");
const { ApolloServer } = require("apollo-server-express");
const { applyMiddleware } = require("graphql-middleware");
const { makeExecutableSchema } = require("@graphql-tools/schema");

const typeDefs = require("./schema");
const resolvers = require("./resolvers");
const permissions = require("./permissions");

const schema = makeExecutableSchema({
  typeDefs,
  resolvers,
});

const server = new ApolloServer({
  schema: applyMiddleware(schema, permissions),
  resolvers,
  context: ({ req }) =&gt; {
    return {
      user: req.headers.user || "",
    };
  },
});

const app = express();
server.applyMiddleware({ app });

app.listen({ port: 4000 }, () =&gt;
  console.log(`🚀 Server ready at http://localhost:4000${server.graphqlPath}`)
);</pre>
<p>去检查<code>tweets</code>或<code>tweet</code>查询。它会抛出一个<code>Not Authorized!</code>错误。只有一个<code>hello</code>查询可以工作。</p>
<p>现在让我们允许每个查询，并且只拒绝<code>Tweet</code>类型中的字段<code>author</code>:</p>
<pre>// permissions.js

const { allow, shield, deny } = require("graphql-shield");

const permissions = shield({
  Query: {
    "*": allow,
  },
  Tweet: {
    author: deny,
  },
});

module.exports = permissions;</pre>
<p>如果您发送一个带有<code>author</code>字段的查询，它将显示如下错误:</p>
<p><img data-attachment-id="26675" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/not-authorized/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="not-authorized" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png" decoding="async" class="aligncenter wp-image-26675 size-full jetpack-lazy-image" src="../Images/d186be573cfc928dc3ec71f7ad044d03.png" alt="A failed query shown because the author field is shown." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="26675" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/not-authorized/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="not-authorized" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png" decoding="async" loading="lazy" class="aligncenter wp-image-26675 size-full" src="../Images/d186be573cfc928dc3ec71f7ad044d03.png" alt="A failed query shown because the author field is shown." srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/not-authorized.png"/></noscript>
<p>如果您发送没有作者的请求，那么它将显示<code>tweets</code>数据:</p>
<p><img data-attachment-id="26673" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/data-tweets/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="data-tweets" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png" decoding="async" class="aligncenter wp-image-26673 size-full jetpack-lazy-image" src="../Images/77ed895eede923e263d14cf9830022ec.png" alt="A successful tweet because there is no author listed." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets-300x154.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="26673" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/data-tweets/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="data-tweets" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png" decoding="async" loading="lazy" class="aligncenter wp-image-26673 size-full" src="../Images/77ed895eede923e263d14cf9830022ec.png" alt="A successful tweet because there is no author listed." srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets-300x154.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/data-tweets.png"/></noscript>
<p>现在，我们将添加一条规则，仅在用户登录时显示作者，而不是完全拒绝。否则，我们将拒绝那些查询字段<code>author</code>的请求。</p>
<p>GraphQL shield库有大量方法来创建规则。wW可以创建我们的<code>isLoggedin</code>规则:</p>
<pre>// permissions.js

const { ForbiddenError } = require("apollo-server-express");
const { allow, shield, rule } = require("graphql-shield");

// Rule for shield
const isLoggedin = rule({ cache: "contextual" })(
  async (parent, args, { user }, info) =&gt; {
    if (user) return true;
    return new ForbiddenError("Not Authorized");
  }
);

const permissions = shield({
  Query: {
    "*": allow,
  },
  Tweet: {
    author: isLoggedin,
  },
});

module.exports = permissions;</pre>
<p>如果字段被请求，那么GraphQL shield将为用户检查。如果用户出现在标题中，那么它允许<code>tweet</code>结果。否则，它会拒绝请求。</p>
<p>标题中没有用户:</p>
<p><img data-attachment-id="26676" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/without-user/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Without user" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png" decoding="async" class="aligncenter wp-image-26676 size-full jetpack-lazy-image" src="../Images/2d912b9ac61560061fb70d71b8527a96.png" alt="A denied request because there is no user in the header." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user-300x154.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="26676" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/without-user/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png" data-orig-size="730,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Without user" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user-300x154.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png" decoding="async" loading="lazy" class="aligncenter wp-image-26676 size-full" src="../Images/2d912b9ac61560061fb70d71b8527a96.png" alt="A denied request because there is no user in the header." srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user-300x154.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/Without-user.png"/></noscript>
<p>标题中有用户:</p>
<p><img data-attachment-id="26677" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/authorized-tweets/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="authorized tweets." data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets.-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png" decoding="async" class="aligncenter wp-image-26677 size-full jetpack-lazy-image" src="../Images/76dec2821fc2af4f6eb81c522fd97728.png" alt="An authorized tweet because the author is included." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets.-300x164.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="26677" data-permalink="https://blog.logrocket.com/a-complete-guide-to-permissions-in-a-graphql-api/authorized-tweets/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png" data-orig-size="730,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="authorized tweets." data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets.-300x164.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png" decoding="async" loading="lazy" class="aligncenter wp-image-26677 size-full" src="../Images/76dec2821fc2af4f6eb81c522fd97728.png" alt="An authorized tweet because the author is included." srcset="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png 730w, https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets.-300x164.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/10/authorized-tweets..png"/></noscript>
<h2>结论</h2>
<p>我们讨论了在GraphQL API中实现权限。如果您觉得这篇文章对在GraphQL API中实现权限有用，请在评论中告诉我。</p>
<p>你可以在这里找到源代码<a href="https://github.com/learnwithparam/logrocket-grpahql-permissions" target="_blank" rel="noopener noreferrer">。您需要寻找不同的分支来查看每个示例。所有的都有一个数字前缀，以便于导航。</a></p><div class="code-block code-block-24">
<div class="blog-plug inline-plug graphql-plug"><h2>监控生产中失败和缓慢的GraphQL请求</h2><p>虽然GraphQL有一些调试请求和响应的特性，但确保GraphQL可靠地为您的生产应用程序提供资源是一件比较困难的事情。如果您对确保对后端或第三方服务的网络请求成功感兴趣，</p><a href="https://lp.logrocket.com/blg/graphql-signup" target="_blank">try LogRocket</a><p>.</p><a class="signup" href="https://lp.logrocket.com/blg/graphql-signup" target="_blank" rel="noopener noreferrer"><img src="../Images/432a3823c85b3fb72a206e6236a29f48.png" data-lazy-src="https://files.readme.io/69aa835-Image_2019-11-09_at_1.28.05_PM.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://files.readme.io/69aa835-Image_2019-11-09_at_1.28.05_PM.png"/><noscript><img data-lazy-fallback="1" src="../Images/432a3823c85b3fb72a206e6236a29f48.png" data-original-src="https://files.readme.io/69aa835-Image_2019-11-09_at_1.28.05_PM.png"/></noscript><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a><a href="https://lp.logrocket.com/blg/graphql-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用的DVR，记录下你网站上发生的每一件事。您可以汇总并报告有问题的GraphQL请求，以快速了解根本原因，而不是猜测问题发生的原因。此外，您可以跟踪Apollo客户机状态并检查GraphQL查询的键值对。</p><p>LogRocket检测您的应用程序以记录基线性能计时，如页面加载时间、到达第一个字节的时间、慢速网络请求，还记录Redux、NgRx和Vuex操作/状态。</p><a class="signup" href="https://lp.logrocket.com/blg/graphql-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a><p>.</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>