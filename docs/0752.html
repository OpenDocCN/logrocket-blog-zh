<html>
<head>
<title>Quickly build schema-based forms in React with uniforms - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在React with uniforms - LogRocket博客中快速构建基于模式的表单</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/quickly-build-schema-based-forms-in-react-with-uniforms/#0001-01-01">https://blog.logrocket.com/quickly-build-schema-based-forms-in-react-with-uniforms/#0001-01-01</a></blockquote><div><article class="article-post">
<p>制服是React库，用于从每个模式构建基于表单的web UIs。模式是数据、数据类型、允许值、默认值、必需值等的正式表示。这些web用户界面是为接受、修改和呈现数据而设计的，通常嵌入在应用程序中。</p>
<p>在本教程中，我们将演示如何使用统一标准在React中高效地构建基于模式的表单。</p>
<h2 id="whydoyouneeduniforms">你为什么需要制服？</h2>
<p>手动编写HTML模板和数据绑定逻辑非常困难，尤其是在相对较大的应用程序中。表单甚至更棘手，因为它们通常涉及比数据绑定更高级的功能，比如验证和提交。</p>
<p>统一消除了编写模板和数据绑定的JavaScript逻辑的压力。它们有助于表单呈现，并负责状态管理、验证和提交。</p>
<p>以下是制服的核心特征，根据<a href="https://uniforms.tools/docs/what-are-uniforms/" target="_blank" rel="noopener noreferrer">官方文件</a>。</p>
<ul>
<li>自动表格生成</li>
<li>能够呈现每个模式的字段</li>
<li>用一行创建自定义字段的助手</li>
<li>内嵌和异步表单验证</li>
<li>各种模式集成</li>
<li>广泛的主题支持</li>
</ul>
<h2 id="howdouniformsitwork">制服是怎么工作的？</h2>
<p>制服的定义如下。</p>
<ol>
<li><strong>模式</strong> <strong> — </strong>兼容模式包括<a href="https://graphql.org/learn/schema/" target="_blank" rel="noopener noreferrer"> GraphQL模式</a>、<a href="https://json-schema.org/" target="_blank" rel="noopener noreferrer"> JSON模式</a>、<a href="https://www.npmjs.com/package/uniforms-bridge-simple-schema" target="_blank" rel="noopener noreferrer"> <code>uniforms-bridge-simple-schema</code> </a>和<code><a href="https://www.npmjs.com/package/uniforms-bridge-simple-schema-2" target="_blank" rel="noopener noreferrer">uniforms-bridge-simple-schema-2</a></code></li>
<li><strong>Theme</strong>—Theme是一个包，其中包含来自当今任何<a href="https://blog.logrocket.com/top-10-react-component-libraries-for-2020/" target="_blank" rel="noopener noreferrer">流行风格librar</a><a href="https://blog.logrocket.com/top-10-react-component-libraries-for-2020/">ie</a>的预样式表单组件，如AntDesign、Bootstrap 3、Bootstrap 4、Material Design、Semantic、unstyled HTML等。</li>
<li><strong>模式桥</strong> —桥是一个统一的模式映射器，uniforms的内部人员使用它来操作模式数据，验证表单，并从错误中生成。uniforms有一个预定义的模式到桥的映射器<code><a href="https://www.npmjs.com/package/uniforms-bridge-json-schema" target="_blank" rel="noopener noreferrer">uniforms-bridge-json-schema</a></code>，它可以用来<a href="https://uniforms.tools/docs/uth-bridge-concept/" target="_blank" rel="noopener noreferrer">创建一个模式桥</a></li>
</ol>
<h2 id="usinguniforms">使用制服</h2>
<p>假设您公司的营销团队想要收集销售线索信息，您同意提供帮助。您的任务是使用制服创建一个表单，供用户联系营销团队。</p>
<h3>装置</h3>
<p>要使用制服，您必须首先安装依赖包。我们将使用JSON Schema指定数据格式，Bootstrap 4作为我们的UI主题，使用<a href="https://github.com/epoberezkin/ajv" target="_blank" rel="noopener noreferrer"> Ajv </a>进行模式验证。</p>
<p>要安装所需的软件包，请运行以下命令。</p>
<pre>npm install uniforms uniforms-bridge-json-schema uniforms-bootstrap4 <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0a6865657e797e786b7a4a3e243e243b">[email protected]</a> ajv
</pre>
<h3>创建模式</h3>
<p>通过定义普通JSON来定义表单的形状，普通JSON是JSON模式的有效部分。</p>
<pre>// schema.js

const schema = {
  title: 'Lead Form',
  type: 'object',
  properties: {
    name: { type: 'string' },
    email: { type: 'string' },
    phone: {
      type: 'integer',
      minimum: 0,
      maximum: 100
    },
    reason: {
      type: 'string',
      options: [
        {
          label: 'Product Questions',
          value: 'product-questions'
        },
        {
          label: 'Online Order Support',
          value: 'online-order-support'
        },
        {
          label: 'Sales-support',
          value: 'sales-support'
        },
        {
          label: 'Events',
          value: 'events'
        }
      ]
    },
    message: {
      type: 'string',
      uniforms: {
        component: LongTextField
      }
    }
  },
  required: ['firstName', 'email', 'message']
};
</pre>
<h3>创建一座桥梁</h3>
<p>要让统一使用任何模式，您必须创建模式的桥梁。</p>
<p>以下模式与<code>uniforms</code>兼容。</p>
<ul>
<li><code>uniforms-bridge-graphql</code>中的<code>GraphQLBridge</code></li>
<li><code>uniforms-bridge-json-schema</code>中的<code>JSONSchemaBridge</code></li>
<li><code>uniforms-bridge-simple-schema-2</code>中的<code>SimpleSchema2Bridge</code></li>
<li><code>uniforms-bridge-simple-schema</code>中的<code>SimpleSchemaBridge</code></li>
</ul>
<pre>import { JSONSchemaBridge } from 'uniforms-bridge-json-schema';

const bridge = new JSONSchemaBridge(schema);
</pre>
<p>尽管JSON Schema很容易与uniforms一起使用，但它没有开箱即用的验证。您必须手动定义要在联系人表单上使用的验证程序。</p>
<p>让我们使用Ajv进行验证:</p>
<pre>import Ajv from 'ajv';

const ajv = new Ajv({ allErrors: true, useDefaults: true });

function createValidator(schema) {
  const validator = ajv.compile(schema);

  return model =&gt; {
    validator(model);

    if (validator.errors &amp;&amp; validator.errors.length) {
      throw { details: validator.errors };
    }
  };
}

const schemaValidator = createValidator(schema);
</pre>
<p>现在您已经有了一个验证器，您可以将它作为桥的一部分。</p>
<pre>const bridge = new JSONSchemaBridge(schema, schemaValidator);
</pre>
<p>此时，<code>schema.js</code>文件应该是这样的:</p>
<pre>import Ajv from 'ajv';
import { JSONSchemaBridge } from 'uniforms-bridge-json-schema';
const ajv = new Ajv({ allErrors: true, useDefaults: true });
const schema = {
  title: 'Lead Form',
  type: 'object',
  properties: {
    name: { type: 'string' },
    email: { type: 'string' },
    phone: {
      type: 'integer',
      minimum: 0,
      maximum: 100
    },
    reason: {
      type: 'string',
      options: [
        {
          label: 'Product Questions',
          value: 'product-questions'
        },
        {
          label: 'Online Order Support',
          value: 'online-order-support'
        },
        {
          label: 'Sales-support',
          value: 'sales-support'
        },
        {
          label: 'Events',
          value: 'events'
        }
      ]
    },
    message: {
      type: 'string',
      uniforms: {
        component: LongTextField
      }
    }
  },
  required: ['firstName', 'email', 'message']
};

function createValidator(schema) {
  const validator = ajv.compile(schema);
  return model =&gt; {
    validator(model);
    if (validator.errors &amp;&amp; validator.errors.length) {
      throw { details: validator.errors };
    }
  };
}
const schemaValidator = createValidator(schema);
const bridge = new JSONSchemaBridge(schema, schemaValidator);
export default bridge;
</pre>
<h3>将架构添加到表单中</h3>
<p>Uniforms的主题包包括一个名为<code>AutoForm</code>的组件，它从模式中生成一个表单。</p>
<p>将模式传递给<code>AutoForm</code>以生成表单。</p>
<pre>import React from "react";
import "./styles.css";
import { AutoForm, AutoFields, ErrorsField, SubmitField } from 'uniforms-bootstrap4';

import LeadSchema from './schema';
export default function App() {
  return (
    &lt;div className="App"&gt;
      &lt;div className="uniforms"&gt;
        &lt;AutoForm schema={LeadSchema} onSubmit={(e) =&gt; {console.log(e)}}&gt;
          &lt;h4&gt;Have a question? Contact Sales&lt;/h4&gt;
          &lt;AutoFields /&gt;
          &lt;ErrorsField /&gt;
          &lt;SubmitField /&gt;
        &lt;/AutoForm&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</pre>
<p><img data-attachment-id="15875" data-permalink="https://blog.logrocket.com/quickly-build-schema-based-forms-in-react-with-uniforms/schema-based-react-form-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png" data-orig-size="720,285" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schema-based React form built with uniforms" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1-300x119.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png" decoding="async" class="aligncenter size-full wp-image-15875 jetpack-lazy-image" src="../Images/41b3952350bdbbe087faa5c8453fa497.png" alt="Schema-Based React Form Built With uniforms" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1-300x119.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="15875" data-permalink="https://blog.logrocket.com/quickly-build-schema-based-forms-in-react-with-uniforms/schema-based-react-form-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png" data-orig-size="720,285" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schema-based React form built with uniforms" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1-300x119.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-15875" src="../Images/41b3952350bdbbe087faa5c8453fa497.png" alt="Schema-Based React Form Built With uniforms" srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1-300x119.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-1.png"/></noscript>
<p><img data-attachment-id="15867" data-permalink="https://blog.logrocket.com/quickly-build-schema-based-forms-in-react-with-uniforms/schema-based-react-form-error-prompts/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png" data-orig-size="720,402" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schema-based React form with error prompts" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png" decoding="async" class="aligncenter size-full wp-image-15867 jetpack-lazy-image" src="../Images/3dd54bede0531bfb25d46c8ffb2ae705.png" alt="Schema-Based React Form With Error Prompts" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts-300x168.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="15867" data-permalink="https://blog.logrocket.com/quickly-build-schema-based-forms-in-react-with-uniforms/schema-based-react-form-error-prompts/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png" data-orig-size="720,402" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Schema-based React form with error prompts" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts-300x168.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-15867" src="../Images/3dd54bede0531bfb25d46c8ffb2ae705.png" alt="Schema-Based React Form With Error Prompts" srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png 720w, https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts-300x168.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/schema-based-react-form-error-prompts.png"/></noscript>
<h2 id="conclusion">结论</h2>
<p>现在，您已经掌握了在React中使用制服创建基于模式的表单所需的基本知识。该库附带了无数其他预构建的表单元素，您可以在<a href="https://uniforms.tools/docs/api-fields/" target="_blank" rel="noopener noreferrer">制服文档</a>中探索。</p>
<p>本教程中使用的片段来自一个<a href="https://codesandbox.io/s/agitated-feynman-itwiy?from-embed" target="_blank" rel="noopener noreferrer">示例应用</a>。欢迎你克隆出来自己玩。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720"><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener"> LogRocket </a>:全面了解您的生产React应用</h2><p>调试React应用程序可能很困难，尤其是当用户遇到难以重现的问题时。如果您对监视和跟踪Redux状态、自动显示JavaScript错误以及跟踪缓慢的网络请求和组件加载时间感兴趣，</p><a href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" vwo-el-id="19356441070">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<p vwo-el-id="28675660440" class="">LogRocket 结合了会话回放、产品分析和错误跟踪，使软件团队能够创建理想的web和移动产品体验。这对你来说意味着什么？</p>
<p>LogRocket不是猜测错误发生的原因，也不是要求用户提供截图和日志转储，而是让您回放问题，就像它们发生在您自己的浏览器中一样，以快速了解哪里出错了。</p>
<p>不再有嘈杂的警报。智能错误跟踪允许您对问题进行分类，然后从中学习。获得有影响的用户问题的通知，而不是误报。警报越少，有用的信号越多。</p>
<p vwo-el-id="28675660750">LogRocket Redux中间件包为您的用户会话增加了一层额外的可见性。LogRocket记录Redux存储中的所有操作和状态。</p>
<p vwo-el-id="28675661060">现代化您调试React应用的方式— <a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">开始免费监控</a>。</p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>