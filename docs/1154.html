<html>
<head>
<title>React Native form validations with Formik and Yup - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用Formik和Yup - LogRocket Blog进行原生表单验证</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/#0001-01-01">https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/#0001-01-01</a></blockquote><div><article class="article-post">
<p>表单输入是用户输入和与应用程序交互的关键组件，包括注册、登录、内容创建、评论等。这些是任何应用程序的关键部分，确保用户在表单上的体验是无缝的，可以大大提高应用程序的可用性。</p>
<p>在这篇文章中，我们将使用<a href="https://formik.org/" target="_blank" rel="noopener noreferrer"> Formik </a>创建一些表单。Formik是一个简单的React/React本地表单库，帮助处理表单状态、输入验证、格式化、错误处理、表单提交等。Formik使用react state和pros使一切变得简单，便于理解、集成、调试和测试您的表单。</p>
<p>我们还将在混合中加入一些<a href="https://github.com/jquense/yup" target="_blank" rel="noopener noreferrer">是的</a>来帮助构建验证和解析表单输入的模式。</p>
<h2>先决条件</h2>
<p>要阅读本文，您需要:</p>
<ul>
<li>对React Native的基本了解</li>
<li>在你的机器上设置</li>
</ul>
<figure id="attachment_25261" aria-describedby="caption-attachment-25261" class="wp-caption aligncenter"><img data-attachment-id="25261" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/reactnativewelcomescreen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen.png" data-orig-size="624,1338" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="reactnativewelcomescreen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-140x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-478x1024.png" decoding="async" class="wp-image-25261 size-large jetpack-lazy-image" src="../Images/dcb42f79d3cb3d9b66f612a7a4a3ef4d.png" alt="React Native welcome screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-478x1024.png 478w, https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-140x300.png 140w, https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen.png 624w" data-lazy-sizes="(max-width: 478px) 100vw, 478px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-478x1024.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-478x1024.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="25261" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/reactnativewelcomescreen/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen.png" data-orig-size="624,1338" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="reactnativewelcomescreen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-140x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-478x1024.png" decoding="async" loading="lazy" class="wp-image-25261 size-large" src="../Images/dcb42f79d3cb3d9b66f612a7a4a3ef4d.png" alt="React Native welcome screen" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-478x1024.png 478w, https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-140x300.png 140w, https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen.png 624w" sizes="(max-width: 478px) 100vw, 478px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/reactnativewelcomescreen-478x1024.png"/></noscript><figcaption id="caption-attachment-25261" class="wp-caption-text">React Native welcome screen</figcaption></figure>
<h2>入门指南</h2>
<p>如果您没有React本机设置，请参考<a href="https://reactnative.dev/docs/getting-started" target="_blank" rel="noopener noreferrer">文档以开始使用</a>，然后从那里开始。</p>
<p>我们将使用以下工具设置我们的新应用:</p>
<pre>npx react-native init formikExample</pre>
<p>这将创建一个包含React本地项目的文件夹<code>formikExample</code>。在您的模拟器或设备上运行项目，并确保它显示React Native <a href="https://reactnative.dev/docs/0.61/getting-started" target="_blank" rel="noopener noreferrer">欢迎屏幕</a>。</p>
<p>设置好React本地项目后，现在让我们开始创建一些表单。在这个博客中，我们将创建三种形式:</p>
<ul>
<li>登录表单</li>
<li>注册表单</li>
<li>发布博客表单</li>
</ul>
<p>这三个表单应该有助于我们了解使用Formik和Yup创建表单的一些核心特性。</p>
<p>最后，让我们添加我们将使用的两个库:</p>
<pre>yarn add formik yup</pre>
<h2>登录表单</h2>
<p>从最简单的形式开始。这应该有两个电子邮件和密码输入和一个登录按钮。</p>
<p>在开始添加文本输入之前，让我们先做一些清理工作。更新<code>App.js</code>如下图所示:</p>
<pre>// App.js
import React from 'react'
import {
  SafeAreaView,
  StyleSheet,
  ScrollView,
  View,
  Text,
  StatusBar,
  TextInput,
} from 'react-native'

const App = () =&gt; {
  return (
    &lt;&gt;
      &lt;StatusBar barStyle="dark-content" /&gt;
      &lt;SafeAreaView style={styles.container}&gt;
        &lt;View style={styles.loginContainer}&gt;
          &lt;Text&gt;Login Screen&lt;/Text&gt;
        &lt;/View&gt;
      &lt;/SafeAreaView&gt;
    &lt;/&gt;
  )
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
  loginContainer: {
    width: '80%',
    alignItems: 'center',
  }
})

export default App</pre>
<p><img data-attachment-id="25265" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/loginscreen-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen.png" data-orig-size="624,1338" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="loginscreen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen-140x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen-478x1024.png" decoding="async" class="aligncenter size-full wp-image-25265 jetpack-lazy-image" src="../Images/9639609d8a3a1741981ce12b5716d478.png" alt="login screen" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen.png 624w, https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen-140x300.png 140w, https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen-478x1024.png 478w" data-lazy-sizes="(max-width: 624px) 100vw, 624px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25265" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/loginscreen-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen.png" data-orig-size="624,1338" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="loginscreen" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen-140x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen-478x1024.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-25265" src="../Images/9639609d8a3a1741981ce12b5716d478.png" alt="login screen" srcset="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen.png 624w, https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen-140x300.png 140w, https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen-478x1024.png 478w" sizes="(max-width: 624px) 100vw, 624px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/loginscreen.png"/></noscript>
<p>这应该会将<code>defaultWelcome</code>屏幕更改为屏幕中央的“登录屏幕”文本。</p>
<p>现在让我们开始添加一些输入。</p>
<p>当为比如说电子邮件地址添加<code>TextInputs</code>时，它要求我们设置状态来存储电子邮件值，并设置一个<code>handleEmailChange</code>函数来处理文本更改和更新电子邮件状态。</p>
<p>这可能会变得太多，尤其是当您处理大量输入时。</p>
<p>这就是Formik帮助处理所有这些重复性工作的地方。所以让我们看看如何用Formik来做，让我们用Formik来添加电子邮件输入表单。</p>
<p>我们将从导入Formik库开始，然后设置输入:</p>
<pre>// App.js

import { Formik } from 'formik'

...
        &lt;View style={styles.loginContainer}&gt;
          &lt;Text&gt;Login Screen&lt;/Text&gt;
          &lt;Formik
            initialValues={{ email: '', password: '' }}
            onSubmit={values =&gt; console.log(values)}
          &gt;
            {({ handleChange, handleBlur, handleSubmit, values }) =&gt; (
              &lt;&gt;
                &lt;TextInput
                  name="email"
                  placeholder="Email Address"
                  style={styles.textInput}
                  onChangeText={handleChange('email')}
                  onBlur={handleBlur('email')}
                  value={values.email}
                  keyboardType="email-address"
                /&gt;
                &lt;TextInput
                  name="password"
                  placeholder="Password"
                  style={styles.textInput}
                  onChangeText={handleChange('password')}
                  onBlur={handleBlur('password')}
                  value={values.password}
                  secureTextEntry
                /&gt;
                &lt;Button onPress={handleSubmit} title="Submit" /&gt;
              &lt;/&gt;
            )}
          &lt;/Formik&gt;
        &lt;/View&gt;</pre>
<p>一个好的用户界面有助于改善用户体验，所以让我们添加一些样式来帮助我们的输入看起来更好。</p>
<p>让我们添加下面的样式来改进用户界面，如下所示:</p>
<pre>const styles = StyleSheet.create({

  loginContainer: {
    width: '80%',
    alignItems: 'center',
    backgroundColor: 'white',
    padding: 10,
    elevation: 10,
    backgroundColor: '#e6e6e6'
  },
  textInput: {
    height: 40,
    width: '100%',
    margin: 10,
    backgroundColor: 'white',
    borderColor: 'gray',
    borderWidth: StyleSheet.hairlineWidth,
    borderRadius: 10,
  },
})</pre>
<p>目前，我们的<code>onSubmit</code>函数是传递值的<code>console.log</code>语句。这就是我们的登录函数进入并获取这些值进行处理的地方。</p>
<p>让我们在<a href="https://reactnative.dev/docs/debugging" target="_blank" rel="noopener noreferrer">调试模式</a>下测试一下我们的<code>handleSubmit</code>，在文本输入中输入一些内容，看看这些值是否被记录在调试器中。</p>
<p><img data-attachment-id="25270" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/logginginputvalues/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues.gif" data-orig-size="600,541" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Logginginputvalues" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues-300x271.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues.gif" decoding="async" class="aligncenter size-full wp-image-25270 jetpack-lazy-image" src="../Images/728481566ef3025847d700b36ca3f4aa.png" alt="Logging input values in react native simulator" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25270" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/logginginputvalues/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues.gif" data-orig-size="600,541" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Logginginputvalues" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues-300x271.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-25270" src="../Images/728481566ef3025847d700b36ca3f4aa.png" alt="Logging input values in react native simulator" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Logginginputvalues.gif"/></noscript>
<p>你可能已经注意到了，但是，我们可以提交没有价值，格式错误的电子邮件地址和其他缺陷。我们不希望出现这种情况，我们希望用户只有在输入正确格式的电子邮件和密码后才能登录。在那之前，我们希望登录按钮被禁用。</p>
<p>这就是输入验证的用武之地，我们想要创建一个验证模式来检查输入的格式是否符合预期。如前所述，我们将使用<a href="https://github.com/jquense/yup" target="_blank" rel="noopener noreferrer"> Yup </a>来创建验证模式，并为每次检查提供定制的错误消息。</p>
<p>让我们创建登录验证模式，如下所示:</p>
<pre>// App.js
import * as yup from 'yup'

const loginValidationSchema = yup.object().shape({
  email: yup
    .string()
    .email("Please enter valid email")
    .required('Email Address is Required'),
  password: yup
    .string()
    .min(8, ({ min }) =&gt; `Password must be at least ${min} characters`)
    .required('Password is required'),
})</pre>
<p>正如在模式中看到的，电子邮件应该是格式化的<code>email</code>的<code>string()</code>，以检查它是否是正确的电子邮件格式，如果检查失败，我们也将返回相应的错误消息，我们稍后将显示这一点。</p>
<p>对于密码字段，它也是一个必需的字符串，我们还添加了另一个对最小字符数的检查，<code>min(8)</code>以确保密码至少有8个字符。</p>
<p>你可以对你的输入进行更多的检查，查看<a href="https://github.com/jquense/yup" target="_blank" rel="noopener noreferrer">是文档</a>了解更多。</p>
<p>现在让我们将这个模式添加到Formik表单中，这样我们就可以用它来验证我们的输入。我们将更新我们的表单，如下所示:</p>
<pre>// App.js

&lt;Formik
   validationSchema={loginValidationSchema}
   initialValues={{ email: '', password: '' }}
   onSubmit={values =&gt; console.log(values)}
 &gt;
   {({
     handleChange,
     handleBlur,
     handleSubmit,
     values,
     errors,
     isValid,
   }) =&gt; (
     &lt;&gt;
       &lt;TextInput
         name="email"
         placeholder="Email Address"
         style={styles.textInput}
         onChangeText={handleChange('email')}
         onBlur={handleBlur('email')}
         value={values.email}
         keyboardType="email-address"
       /&gt;
       {errors.email &amp;&amp;
         &lt;Text style={{ fontSize: 10, color: 'red' }}&gt;{errors.email}&lt;/Text&gt;
       }
       &lt;TextInput
         name="password"
         placeholder="Password"
         style={styles.textInput}
         onChangeText={handleChange('password')}
         onBlur={handleBlur('password')}
         value={values.password}
         secureTextEntry
       /&gt;
       {errors.password &amp;&amp;
         &lt;Text style={{ fontSize: 10, color: 'red' }}&gt;{errors.password}&lt;/Text&gt;
       }
       &lt;Button
         onPress={handleSubmit}
         title="LOGIN"
         disabled={!isValid}
       /&gt;
     &lt;/&gt;
   )}
 &lt;/Formik&gt;</pre>
<p><img data-attachment-id="25274" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/withouttouchedcheck/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck.gif" data-orig-size="600,1290" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Withouttouchedcheck" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck-140x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck-476x1024.gif" decoding="async" class="aligncenter wp-image-25274 size-full jetpack-lazy-image" src="../Images/065c24fb12325b480b7efdc66b6c43ea.png" alt="Without touched check" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25274" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/withouttouchedcheck/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck.gif" data-orig-size="600,1290" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Withouttouchedcheck" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck-140x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck-476x1024.gif" decoding="async" loading="lazy" class="aligncenter wp-image-25274 size-full" src="../Images/065c24fb12325b480b7efdc66b6c43ea.png" alt="Without touched check" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Withouttouchedcheck.gif"/></noscript><br/>
We added our <code>validationSchema</code> as seen above, all our inputs are validated against the schema after every change to ensure they match the expected format.
<p>如果没有，则根据当前输入为每个输入生成<code>errors</code>。</p>
<p>为了显示<code>errors</code>,我们从Formik props中析构它们，如上所示，并将它们显示在相应的文本输入下方。</p>
<p>我们还访问了<code>isValid</code>状态，这是一个用于检查输入是否有效的布尔值，我们将用它来设置登录按钮的<code>disabled</code>状态。</p>
<p>由于每次更改后都会检查所有输入，所以即使用户还没有开始与输入交互，我们也会显示错误。</p>
<p>我们不希望出现这种情况，所以我们将添加一个检查，以确保只有在用户触摸输入后才会显示错误。</p>
<pre>            {({
              handleChange,
              handleBlur,
              handleSubmit,
              values,
              errors,
              touched,
              isValid,
            }) =&gt; (
...
                {(errors.email &amp;&amp; touched.email) &amp;&amp;
                  &lt;Text style={styles.errorText}&gt;{errors.email}&lt;/Text&gt;
                }

                {(errors.password &amp;&amp; touched.password) &amp;&amp;
                  &lt;Text style={styles.errorText}&gt;{errors.password}&lt;/Text&gt;
                }

...
// in stylesheet
  errorText: {
    fontSize: 10,
    color: 'red',
  },</pre>
<p><img data-attachment-id="25278" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/withtouchcheck/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck.gif" data-orig-size="600,1290" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="withtouchcheck" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck-140x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck-476x1024.gif" decoding="async" class="aligncenter size-full wp-image-25278 jetpack-lazy-image" src="../Images/2ac9c7a98b25ea3052da0ff006ab12cf.png" alt="Without touched check" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25278" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/withtouchcheck/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck.gif" data-orig-size="600,1290" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="withtouchcheck" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck-140x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck-476x1024.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-25278" src="../Images/2ac9c7a98b25ea3052da0ff006ab12cf.png" alt="Without touched check" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/withtouchcheck.gif"/></noscript>
<p>请注意，在第二张图中，错误仅在有问题的输入被触摸后出现，而在第一张图中，错误出现在所有输入上，即使只触摸了一个输入。</p>
<p>至此，我们已经完成了我们的登录表单。</p>
<p>让我们继续注册表格。</p>
<h2>注册表单</h2>
<p>在上一节登录表单中，我们使用Formik来处理表单，但是仍然需要传递不同的函数(比如<code>handleChange</code>、<code>handleBlur value</code>等)。)对每个<code>TextInput</code>来说，随着投入的增加，这可能会变成大量的工作。</p>
<p>Formik提供了一个组件<code>Field</code>,可以自动为我们将输入连接到Formik。在本节中，我们将探讨这一点。</p>
<p>让我们从创建一个将被传递到<code>Field</code>组件的<code>CustomInput</code>组件开始，获取Formik道具，并为我们处理输入。</p>
<p>我们将创建一个名为<code>CustomInput.js</code>的文件，并向其中添加以下代码:</p>
<pre>// CustomInput.js
import React from 'react'
import { Text, TextInput, StyleSheet } from 'react-native'

const CustomInput = (props) =&gt; {
  const {
    field: { name, onBlur, onChange, value },
    form: { errors, touched, setFieldTouched },
    ...inputProps
  } = props

  const hasError = errors[name] &amp;&amp; touched[name]

  return (
    &lt;&gt;
      &lt;TextInput
        style={[
          styles.textInput,
          hasError &amp;&amp; styles.errorInput
        ]}
        value={value}
        onChangeText={(text) =&gt; onChange(name)(text)}
        onBlur={() =&gt; {
          setFieldTouched(name)
          onBlur(name)
        }}
        {...inputProps}
      /&gt;
      {hasError &amp;&amp; &lt;Text style={styles.errorText}&gt;{errors[name]}&lt;/Text&gt;}
    &lt;/&gt;
  )
}

const styles = StyleSheet.create({
  textInput: {
    height: 40,
    width: '100%',
    margin: 10,
    backgroundColor: 'white',
    borderColor: 'gray',
    borderWidth: StyleSheet.hairlineWidth,
    borderRadius: 10,
  },
  errorText: {
    fontSize: 10,
    color: 'red',
  },
  errorInput: {
    borderColor: 'red',
  }
})

export default CustomInput
</pre>
<p>如你所见，这个<code>CustomInput</code>处理了我们在登录表单<code>TextInputs</code>中做的许多事情，从处理输入、样式、检查和呈现错误等等。</p>
<p>现在让我们创建一个新文件<code>SignUp.js</code>来存放我们的注册表单。要查看内容，让我们将<code>index.js</code>指向注册屏幕。</p>
<p>在<code>index.js</code>将应用程序导入更新到<code>import App from './SignUp'</code>。</p>
<p>现在在<code>SignUp.js</code>上，让我们从下面的代码开始:</p>
<pre>// SignUp.js
import React from 'react'
import {
  SafeAreaView,
  StyleSheet,
  View,
  Text,
  StatusBar,
  TextInput,
  Button,
} from 'react-native'
import { Formik, Field } from 'formik'
import * as yup from 'yup'

const SignUp = () =&gt; {
  return (
    &lt;&gt;
      &lt;StatusBar barStyle="dark-content" /&gt;
      &lt;SafeAreaView style={styles.container}&gt;
        &lt;View style={styles.signupContainer}&gt;
          &lt;Text&gt;Sign Up Screen&lt;/Text&gt;

        &lt;/View&gt;
      &lt;/SafeAreaView&gt;
    &lt;/&gt;
  )
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
  signupContainer: {
    width: '80%',
    alignItems: 'center',
    backgroundColor: 'white',
    padding: 10,
    elevation: 10,
    backgroundColor: '#e6e6e6'
  },
})
export default SignUp</pre>
<p>这应该显示我们的初始注册屏幕，只有文本。</p>
<p>现在让我们导入我们创建的<code>CustomInput</code>,并开始使用讨论过的<code>Field</code>组件创建我们的<code>SignUp</code>表单:</p>
<pre>// SignUp.js

import CustomInput from './CustomInput'

...
          &lt;Text&gt;Sign Up Screen&lt;/Text&gt;

          &lt;Formik
            initialValues={{
              fullName: '',
              email: '',
              phoneNumber: '',
              password: '',
              confirmPassword: '',
            }}
            onSubmit={values =&gt; console.log(values)}
          &gt;
            {({ handleSubmit, isValid }) =&gt; (
              &lt;&gt;
                &lt;Field
                  component={CustomInput}
                  name="fullName"
                  placeholder="Full Name"
                /&gt;
                &lt;Field
                  component={CustomInput}
                  name="email"
                  placeholder="Email Address"
                  keyboardType="email-address"
                /&gt;
                &lt;Field
                  component={CustomInput}
                  name="phoneNumber"
                  placeholder="Phone Number"
                  keyboardType="numeric"
                /&gt;
                &lt;Field
                  component={CustomInput}
                  name="password"
                  placeholder="Password"
                  secureTextEntry
                /&gt;
                &lt;Field
                  component={CustomInput}
                  name="confirmPassword"
                  placeholder="Confirm Password"
                  secureTextEntry
                /&gt;

                &lt;Button
                  onPress={handleSubmit}
                  title="SIGN UP"
                  disabled={!isValid}
                /&gt;
              &lt;/&gt;
            )}
          &lt;/Formik&gt;</pre>
<p><img data-attachment-id="25286" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/withoutvalidation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation.gif" data-orig-size="600,1294" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Withoutvalidation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation-139x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation-475x1024.gif" decoding="async" class="aligncenter size-full wp-image-25286 jetpack-lazy-image" src="../Images/4453263b8c9720fd06f86bf43c1dcc26.png" alt="Without validation" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25286" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/withoutvalidation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation.gif" data-orig-size="600,1294" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Withoutvalidation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation-139x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation-475x1024.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-25286" src="../Images/4453263b8c9720fd06f86bf43c1dcc26.png" alt="Without validation" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Withoutvalidation.gif"/></noscript>
<p>正如你可能注意到的，由于<code>Field</code>自动将输入连接到Formik，我们从<code>Formik</code>析构的道具更少，因为它们被直接传递给<code>CustomInput</code>。这使得代码更加清晰易读。</p>
<p>我们还添加了一些输入，全名、电话号码、密码和确认密码。</p>
<p>最后，对于我们的注册表单，让我们添加<code>validationSchema</code>。我们还将借此机会展示一些验证肌肉。yup的一个主要好处是，我们可以使用其庞大的可扩展API来验证不同的输入格式。</p>
<p>我们将使用验证模式来:</p>
<ul>
<li>检查所需的值是否存在</li>
<li>使用regex检查全名和电话的格式是否符合预期</li>
<li>使用正则表达式来确保我们用户的密码强度</li>
<li>检查我们的密码和确认密码是否匹配</li>
</ul>
<p>好了，让我们添加验证模式:</p>
<pre>// SignUp.js
const signUpValidationSchema = yup.object().shape({
  fullName: yup
    .string()
    .matches(/(\w.+\s).+/, 'Enter at least 2 names')
    .required('Full name is required'),
  phoneNumber: yup
    .string()
    .matches(/(01)(\d){8}\b/, 'Enter a valid phone number')
    .required('Phone number is required'),
  email: yup
    .string()
    .email("Please enter valid email")
    .required('Email is required'),
  password: yup
    .string()
    .matches(/\w*[a-z]\w*/,  "Password must have a small letter")
    .matches(/\w*[A-Z]\w*/,  "Password must have a capital letter")
    .matches(/\d/, "Password must have a number")
    .matches(/[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="edccad">[email protected]</a>#$%^&amp;*()\-_"=+{}; :,&lt;.&gt;]/, "Password must have a special character")
    .min(8, ({ min }) =&gt; `Password must be at least ${min} characters`)
    .required('Password is required'),
  confirmPassword: yup
    .string()
    .oneOf([yup.ref('password')], 'Passwords do not match')
    .required('Confirm password is required'),
})</pre>
<p><img data-attachment-id="25289" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/fullsignupform/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform.gif" data-orig-size="600,1294" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fullsignupform" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform-139x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform-475x1024.gif" decoding="async" class="aligncenter size-full wp-image-25289 jetpack-lazy-image" src="../Images/7135a496214ea071a38b0f37c36dad0a.png" alt="sign up form with input fields for full name, email address, phone number, password, confirm password" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25289" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/fullsignupform/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform.gif" data-orig-size="600,1294" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fullsignupform" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform-139x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform-475x1024.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-25289" src="../Images/7135a496214ea071a38b0f37c36dad0a.png" alt="sign up form with input fields for full name, email address, phone number, password, confirm password" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/fullsignupform.gif"/></noscript>
<p>然后把它传给我们的Formik表单<code>validationSchema={signUpValidationSchema}</code>。</p>
<p>对于上面的全名，我们使用regex来确保用户至少输入两个名字。我们还使用regex来检查电话号码的格式，在本例中检查号码是否符合格式<code>01xxxxxxxx</code>。</p>
<p>最后，对于密码，我们使用regex来确保用户创建的密码至少包含一个小写字母、一个大写字母、一个数字、一个特殊字符和至少8个字符。</p>
<p>我们还使用Yup来确保确认密码与密码匹配。</p>
<p>注册表单到此结束。</p>
<h2>发布博客表单</h2>
<p>最后，让我们跳到最后一个表单。内容创建表单，在这个表单中，我们将有三个字段，标题，内容和照片。</p>
<p>正如我们之前所做的，让我们为表单创建一个新文件<code>BlogForm.js</code>，并更新<code>index.js</code>中的ppp以指向它<code>import App from './BlogForm'</code>。</p>
<p>现在让我们跳到我们的<code>BlogForm</code>上，添加下面的代码开始吧:</p>
<pre>// BlogForm.js
import React from 'react'
import {
  SafeAreaView,
  StyleSheet,
  View,
  Text,
  StatusBar,
  Button,
} from 'react-native'
import { Formik, Field } from 'formik'
import * as yup from 'yup'
import CustomInput from './CustomInput'

const App = () =&gt; {
  return (
    &lt;&gt;
      &lt;StatusBar barStyle="dark-content" /&gt;
      &lt;SafeAreaView style={styles.container}&gt;
        &lt;View style={styles.signupContainer}&gt;
          &lt;Text&gt;Blog Screen&lt;/Text&gt;
          &lt;Formik
            initialValues={{
              title: '',
              post: '',
            }}
            onSubmit={values =&gt; console.log(values)}
          &gt;
            {({ handleSubmit, isValid, values }) =&gt; (
              &lt;&gt;
                &lt;Field
                  component={CustomInput}
                  name="title"
                  placeholder="Title"
                /&gt;
                &lt;Field
                  component={CustomInput}
                  name="post"
                  placeholder="Write post..."
                  multiline
                  numberOfLines={3}
                /&gt;
                &lt;Button
                  onPress={handleSubmit}
                  title="POST"
                  disabled={!isValid}
                /&gt;
              &lt;/&gt;
            )}
          &lt;/Formik&gt;
        &lt;/View&gt;
      &lt;/SafeAreaView&gt;
    &lt;/&gt;
  )
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
  signupContainer: {
    width: '80%',
    alignItems: 'center',
    backgroundColor: 'white',
    padding: 10,
    elevation: 10,
    backgroundColor: '#e6e6e6'
  },
})
export default App</pre>
<p>注意，我们向post输入添加了一些属性，使其成为<code>multiline</code>并将<code>numberOfLines</code>增加到三个。</p>
<p>这是为了让我们的输入更大，所以让我们对<code>CustomInput</code>做一些调整，以确保更新良好:</p>
<pre>// CustomInput.js
    &lt;TextInput
      style={[
        styles.textInput,
        props.multiline &amp;&amp; { height: props.numberOfLines * 40 },
        hasError &amp;&amp; styles.errorInput
      ]}</pre>
<p><img data-attachment-id="25293" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/blogpostform/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform.gif" data-orig-size="600,1294" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="blogpostform" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform-139x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform-475x1024.gif" decoding="async" class="aligncenter size-full wp-image-25293 jetpack-lazy-image" src="../Images/aa013ed65d18e8448565471b85d3201f.png" alt="Blog post form" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25293" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/blogpostform/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform.gif" data-orig-size="600,1294" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="blogpostform" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform-139x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform-475x1024.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-25293" src="../Images/aa013ed65d18e8448565471b85d3201f.png" alt="Blog post form" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/blogpostform.gif"/></noscript>
<p>并将<code>textAlignVertical: 'top',</code>添加到<code>textInput</code>样式中，这将使文本保持在多行输入的顶部。</p>
<p>这将根据<code>numberOfLines</code>更新样式以增加我们输入的高度。</p>
<p>在我们运行并查看它的外观之前，让我们也添加我们的验证模式。</p>
<p>之前，我们使用了<code>.min()</code>来确保密码超过8个字符，我们将在这里使用同样的方法来确保帖子足够长(最少20个字符),并向用户显示关于剩余字符数的消息:</p>
<pre>// BlogForm.js
    const blogValidationSchema = yup.object().shape({
      title: yup
        .string()
        .required('Title is required'),
      post: yup
        .string()
        .min(20, ({ min, value }) =&gt; `${min - value.length} characters to go`)
        .required('Blog post is required'),
    })</pre>
<p>并将其传递给我们的Formik表单<code>validationSchema={blogValidationSchema}</code>。</p>
<p>让我们通过添加一个图像选择器并为其添加验证来结束这一部分。我们将使用<a href="https://github.com/react-native-community/react-native-image-picker" target="_blank" rel="noopener noreferrer"> react原生图像拾取器</a>进行媒体选择，查看<a href="https://github.com/react-native-community/react-native-image-picker" target="_blank" rel="noopener noreferrer">文档</a>了解更多关于设置和使用的详细信息:</p>
<pre>yarn add react-native-image-picker
npx pod-install</pre>
<p>使用图像拾取器设置，导入<code>ImagePicker</code>并添加一个按钮来选择图像并将它们传递到我们的Formik表单:</p>
<pre>// BlogForm.js
import ImagePicker from 'react-native-image-picker'

...

                &lt;Field
                  component={CustomInput}
                  name="post"
                  placeholder="Write post..."
                  multiline
                  numberOfLines={3}
                /&gt;
                &lt;TouchableOpacity
                  style={styles.photoButton}
                  onPress={() =&gt; {
                    ImagePicker.showImagePicker(
                      { title: 'Select Photo' }, (response) =&gt; {
                        if (response.uri) setFieldValue('photo', response)
                        setFieldTouched('photo', true)
                    })
                  }}
                &gt;
                  &lt;Text&gt;Add Image&lt;/Text&gt;
                &lt;/TouchableOpacity&gt;

                {values.photo &amp;&amp;
                  &lt;Text&gt;{`...${values.photo.fileName.substr(values.photo.fileName.length - 10)}`}&lt;/Text&gt;
                }

                {(errors.photo &amp;&amp; touched.photo) &amp;&amp;
                  &lt;Text style={{ color: 'red' }}&gt;{errors.photo}&lt;/Text&gt;
                }</pre>
<p><img data-attachment-id="25301" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/addimageform/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform.gif" data-orig-size="600,1287" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Addimageform" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform-140x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform-477x1024.gif" decoding="async" class="aligncenter size-full wp-image-25301 jetpack-lazy-image" src="../Images/02842d467c3d8b772a109b1ed1d87464.png" alt="Add image form" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="25301" data-permalink="https://blog.logrocket.com/react-native-form-validations-with-formik-and-yup/addimageform/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform.gif" data-orig-size="600,1287" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Addimageform" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform-140x300.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform-477x1024.gif" decoding="async" loading="lazy" class="aligncenter size-full wp-image-25301" src="../Images/02842d467c3d8b772a109b1ed1d87464.png" alt="Add image form" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/09/Addimageform.gif"/></noscript>
<p>由于这不是文本输入，我们需要手动设置触摸和值状态，所以记得从Formik props中析构<code>setFieldValue</code>、<code>setFieldTouched</code>、<code>errors</code>和<code>touched</code>。</p>
<p>我们将需要它来设置值和触摸状态，以及显示丢失照片的错误。</p>
<p>我们还需要更新我们的验证模式来检查照片对象，为此需要将<br/> <code>photo: yup.object().required('Photo is required'),</code>添加到验证模式中。</p>
<p>您可以进一步扩展yup对象验证，甚至检查对象的形状，以确保所有必填字段，如<code>fileName</code>、<code>path</code>、<code>type</code>等。</p>
<h2>结论</h2>
<p>Formik和Yup为React和React Native中的表单处理提供了一个简单、可理解和可扩展的解决方案，为我们提供了输入验证、错误检查、处理和显示、处理提交等解决方案。</p>
<p>使用这些强大的工具，你还可以做更多的事情，使你的表单更加直观和实用，这篇博客只是触及了表面。</p>
<p>你可以在我的GitHub上找到所有的代码。</p>
<p>一如既往，快乐编码。</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现React原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款React原生监控解决方案，可帮助您即时重现问题、确定bug的优先级并了解React原生应用的性能。</p><p>LogRocket还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的React原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>