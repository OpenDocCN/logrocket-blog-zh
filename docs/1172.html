<html>
<head>
<title>An intro to cURL: The basics of the transfer tool - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>cURL介绍:传输工具的基础</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/an-intro-to-curl-the-basics-of-the-transfer-tool/#0001-01-01">https://blog.logrocket.com/an-intro-to-curl-the-basics-of-the-transfer-tool/#0001-01-01</a></blockquote><div><article class="article-post">
<h2>介绍</h2>
<p>cURL是一种传输工具，用于从服务器传输数据或向服务器传输数据。它支持各种互联网传输协议，包括:</p>
<ul>
<li>词典</li>
<li>文件</li>
<li>FTPS FTP</li>
<li>囊地鼠</li>
<li>HTTP，HTTPS</li>
<li>IMAP，IMAPS</li>
<li>LDAP，LDAPS</li>
<li>POP3，POP3S</li>
<li>RTSP RTMP</li>
<li>SFTP SCP</li>
<li>SMBS中小企业</li>
<li>SMTP，SMTPS</li>
<li>TELNET和TFTP</li>
</ul>
<p>我们可以使用cURL执行一些有用的技巧，比如代理支持、用户认证、FTP上传、HTTP post、SSL连接、cookies、文件传输恢复、Metalink等等。</p>
<p><strong>重要提示</strong> : cURL由libcurl提供所有与传输相关的特性。</p>
<p>cURL是从命令行使用的。它通常用于在软件开发过程中快速测试API。当我想在Node.js服务器中测试所有API时，我个人会使用cURL。对于开发者来说，这是一个非常方便的工具。</p>
<blockquote><p>邮递员很酷，但是cURL超级酷。Chidume Nnamdi</p></blockquote>
<p>在本帖中，我们将介绍基本的cURL函数和选项。我们还将学习如何使用cURL在API端点上执行GET、POST请求。</p>
<h2>卷曲选项</h2>
<h3><code>--request</code>或<code>-X</code></h3>
<p><code>--request</code>和<code>-X</code>指定与HTTP服务器通信时可以使用的定制请求方法。将使用指定的请求方法，而不是其他使用的方法(默认为GET)。</p>
<p>要执行POST请求，请执行以下操作:</p>
<pre>curl --request POST</pre>
<p>要执行GET请求，请执行以下操作:</p>
<pre>curl --request GET</pre>
<p>如果我们不通过<code>--request</code>指定请求，它将默认为GET。</p>
<h3><code>--url&lt;/code</code></h3>
<p>这指定了我们将获取或传输数据的URL。</p>
<p>从cURL文档中:</p>
<p>指定要提取的URL。当您想要在配置文件中指定URL时，此选项非常方便。</p>
<p>如果给定的URL缺少一个方案名(如“<a href="http://&amp;#8221" rel="nofollow">http://&amp;# 8221</a>)；或者“<a href="ftp://&amp;#8221" rel="nofollow">FTP://&amp;# 8221</a>；等等)然后cURL会根据主机进行猜测。</p>
<p>如果最外面的子域名与DICT、FTP、IMAP、LDAP、POP3或SMTP匹配，那么将使用该协议。否则，将使用HTTP。</p>
<p>例如，如果您想在localhost:3000的本地服务器上执行一个GET请求，那么您需要将<code>--url</code>设置为<code>localhost:3000</code>:</p>
<pre>curl --request GET \
    --url http://localhost:3000</pre>
<p>要在相同的URL上执行发布:</p>
<pre>curl --request POST \
    --url http://localhost:3000</pre>
<p><strong>注意</strong>:反斜杠<code>\</code>用于在cURL中分隔选项。</p>
<p>对于一个外部API来说，还是一样的。</p>
<p>假设您想从<a href="https://moviesdb.com/movies/all" rel="nofollow">https://moviesdb.com/movies/all</a>获取一个电影列表。</p>
<pre>curl --request GET \
    --url https://moviesdb.com/movies/all</pre>
<p>将获取并打印<code>moviesdb</code>中所有电影的列表。</p>
<h2><code>--header</code>或<code>-H</code></h2>
<p>此选项用于设置请求的标题。</p>
<p>从cURL文档中:</p>
<blockquote><p>向服务器发送HTTP时包含在请求中的额外标头。您可以指定任意数量的额外标头。请注意，如果您添加了一个与curl使用的内部头文件同名的自定义头文件，那么将使用外部设置的<br/>头文件，而不是内部头文件。</p></blockquote>
<p>这反映了我们在普通编程中的做法，尤其是在使用<code>XMLHttpRequest</code>的JavaScript中:</p>
<pre>const xhttp = new XMLHttpRequest()

xhttp.setHeader("Content-Type", "application/json")</pre>
<p>标头用于向web服务器传达传入的数据类型或预期的数据类型。发送的数据类型应该与标头中指定的类型相同。</p>
<p>我们可以对CORS权限使用头，甚至对某些类型的请求方法使用头。我们可以用标题做很多事情。</p>
<p>所以在cURL中，我们可以使用<code>--header</code>选项来设置头:</p>
<pre>curl --request POST \
  --url http://localhost:5000/api/user \
  --header 'content-type: application/json'</pre>
<p>这里，我们向<a href="http://localhost:5000/api/user" rel="nofollow">http://localhost:5000/API/user</a>端点发出一个POST请求，并通过<code>--header</code> <code>content-type: application/json'</code>告诉服务器我们发送的数据是JSON数据类型。</p>
<h2><code>--data</code>或<code>-d</code></h2>
<p>此选项用于向HTTP服务器发送数据。这主要用于POST请求，因为我们将数据发送到我们想要添加到数据存储的服务器。所以在cURL中，我们可以通过设置<code>--data</code>选项来指定要发布的数据。</p>
<p>来自cURL手册:</p>
<blockquote><p>将POST请求中的指定数据发送到HTTP服务器，就像用户填写HTML表单并按下submit按钮时浏览器所做的一样。</p></blockquote>
<p>这里有一个例子:</p>
<pre>curl --request POST \
  --url http://localhost:5000 \
  --header 'content-type: application/json' \
  --data '{"name":"Arrow","description":"bad movie","rating":"7.0","image":"michaeljackson.png"}'</pre>
<p>在这里，我们对<a href="http://localhost:5000" rel="nofollow"> http://localhost:5000 </a>端点执行一个POST请求。</p>
<p>我们在<code>--data</code>选项中设置要发送给服务器的数据，也就是:<code>'{"name":"Arrow","description":"bad movie","rating":"7.0","image":"michaeljackson.png"}</code>。</p>
<p>这是一个我们想要添加到<a href="http://localhost:5000" rel="nofollow"> http://localhost:5000 </a>数据存储中的电影对象。</p>
<h2>在Node.js/Express.js中使用cURL</h2>
<p>让我们看看如何设置Node.js/Express.js服务器并使用cURL测试端点:</p>
<pre>// server.js

/** require dependencies */
const express = require("express")
const cors = require('cors')
const bodyParser = require('body-parser')
const helmet = require('helmet')

const app = express()

let port = 5000 || process.env.PORT

/** set up middlewares */
app.use(cors())
app.use(bodyParser.json({limit: '50mb'}))
app.use(helmet())

let users = []
let currId  Date.now()

app.get("api/user/:id", (req, res, next) =&gt; {
        const userId = req.params.id
        const users = users.filter(user =&gt; user.id === userId)
        if(users.length &gt; 0)
            res.send({ user: users[0] })
        else
            res.send({mesg: "No user found."})
        next()
})

app.get("api/users", (req, res, next) =&gt; {
    res.send({ users })
    next()
})

app.post("api/user", (req, res, next) =&gt; {
        let bdy = req.body
        bdy = { id: ++currId, ...bdy }
        users.push(bdy)
        res.send({ user: bdy })
        next()    
})

/** start server */
app.listen(port, () =&gt; {
    console.log(`Server started at port: ${port}`);
});</pre>
<p>我们这里有小的API端点:</p>
<ul>
<li><code>GEt api/users</code></li>
<li><code/><code>GET api/user/:id</code></li>
<li><code/><code>POST api/user</code></li>
</ul>
<p>它获取所有用户，通过其<code>id</code>获取特定用户，并可以添加新用户。</p>
<p>启动服务器:</p>
<pre>node server.js

Server started at port: 5000</pre>
<p>现在，为了在<code>api/user</code>执行POST请求，我们将把<code>--url</code>设置为<code><a href="http://localhost:5000/api/user" rel="nofollow">http://localhost:5000/api/user</a></code>，把<code>--request</code>设置为POST，把<code>--header</code>设置为<code>content-type: application/json</code>。</p>
<p>我们想添加用户:</p>
<pre>name: "Chidume",
age: 28</pre>
<p>所以数据会是<code>'{"name": "Chidume", "age": "28"}'</code>。</p>
<p>因此cURL命令将是:</p>
<pre>curl --request POST \
  --url http://localhost:5000/api/user \
  --header 'content-type: application/json' \
  --data '{"name": "Chidume", "age": "28"}'

{ id: 5122435464, name: "Chidume", age: 28 }</pre>
<p>我们看到来自服务器的结果:用户及其<code>id</code>被添加到数据存储中。</p>
<p>让我们添加另一个用户:</p>
<pre>curl --request POST \
  --url http://localhost:5000/api/user \
  --header 'content-type: application/json' \
  --data '{"name": "Nnamdi", "age": "21"}'

{ id: 5122435465, name: "Nnamdi", age: 21 }</pre>
<p>我们添加了另一个用户“Nnamdi”，我们可以看到来自服务器的结果及其<code>id</code>。</p>
<p>现在，让我们通过<code>api/user/:id</code>查询“Chidume”。在这里，<code>:id</code>将是<code>id</code> 5122435464。所以旋度会是:</p>
<pre>curl --request GET \
  --url http://localhost:5000/api/user/5122435464

{ user: { id: 5122435464, name: "Chidume", age: 28 } }</pre>
<p>来自服务器的结果向用户返回<code>id</code> 5122435464，即“Chidume”。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>要查询“Nnamdi”:</p>
<pre>curl --request GET \
  --url http://localhost:5000/api/user/5122435465

{ user: { id: 5122435465, name: "Nnamdi", age: 21 } }</pre>
<p>哒哒！！</p>
<p>现在让我们查询一个不存在的用户:</p>
<pre>curl --request GET \
  --url http://localhost:5000/api/user/2000000000


{ mesg: "No user found." }</pre>
<p>这是当我们点击一个不存在的用户时，服务器上返回的结果集。</p>
<p>现在，让我们查询所有用户:</p>
<pre>curl --request GET \
  --url http://localhost:5000/api/users


{ users: [ { id: 5122435465, name: "Nnamdi", age: 21 }, { id: 5122435464, name: "Chidume", age: 28 } ] }</pre>
<p>如您所见，返回了服务器中的所有用户。</p>
<h2>结论</h2>
<p>在本教程中，我们将不会讨论cURL的基本选项，并举例说明如何使用每一个选项，然后我们开发了一个具有三个端点的Node/Express服务器，以演示我们如何使用这里提到的cURL选项通过cURL向服务器执行GET/POST请求。</p>
<p>使用cURL有许多选项。我们在这里讨论的是可以用来快速测试API端点的基本选项。</p>
<p>如果你对此有任何问题，或者我应该添加、更正或删除的任何内容，请随时评论、发电子邮件或给我发短信。</p>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>