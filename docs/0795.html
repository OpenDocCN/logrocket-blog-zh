<html>
<head>
<title>Should you keep the faith with React Native? - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>你应该保持对当地人的信任吗？- LogRocket博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/should-you-keep-faith-react-native/#0001-01-01">https://blog.logrocket.com/should-you-keep-faith-react-native/#0001-01-01</a></blockquote><div><article class="article-post">
<blockquote><p>编者按:这篇文章于2021年11月30日更新，以反映React Native的更新。</p></blockquote>
<p>2015年初，脸书首次推出React Native，这是一个使用React库构建原生应用的框架。自首次发布以来，React Native已经成为许多开发人员最喜欢的可靠框架，被Pinterest、优步、Spotify和微软等科技巨头使用。另一方面，React Native一直受到一些质疑，例如，当Airbnb在2018年取消React Native的开发工作时，引发了React Native是否实际上已经死亡的问题。</p>
<p>在本文中，我们将回顾一下React Native的一些特性，这些特性平息了这个谣言。我们将回顾开发人员应该学习React Native的许多原因，包括它最近的一些新增功能和未来的计划。我们开始吧！</p>
<p>目录:</p>

<h2 id="whyshouldyouchoosereactnative">为什么要选择React Native？</h2>
<p>让我们来看看开发人员选择React Native来构建他们的下一个移动应用程序或在现有移动应用程序中添加新功能的主要原因。</p>
<h3 id="reactcross">React的跨平台组件</h3>
<p>如今，快节奏的发展并没有为科技公司提供实质性的优势，相反，它对公司的生存至关重要。巨大的竞争要求公司以更快的速度和更大的稳定性前进。</p>
<p>让我们想象一下，一家公司正在管理三个不同的前端团队，Android、iOS和web，致力于一个产品。这种方法不仅从金钱的角度来看成本很高，还会阻碍产品的发展。React Native允许团队在Android和iOS上共享高达95%的代码，这在敏捷开发时代是一个巨大的优势。</p>
<p>也有可能与web团队共享React原生代码库，我们将在下一节回顾这一点。</p>
<h3 id="reactdeclarartive">React的声明式用户界面</h3>
<p>毫无疑问，声明式UI和基于组件的架构彻底改变了前端开发。这些特性允许前端开发人员构建更具可预测性和更少bug的大规模应用程序。</p>
<p>从一开始，React的座右铭就是“学习一次，在任何地方写作”我们可以在开发移动应用程序时利用这些概念，使React Native成为React整体进步和发展的重要元素。</p>
<ol>
<li>移动应用程序中更可预测的用户界面，错误更少</li>
<li>如果开发人员已经熟悉React，他们可以为移动应用程序做出贡献</li>
<li>如果考虑到构建，<a href="https://buttercms.com/blog/react-best-practices-maintaining-large-scale-projects">代码可以跨React渲染器</a>重用，包括web、移动、桌面、Unity和VR</li>
</ol>
<h3 id="reactreliability">React的可靠性:大规模测试</h3>
<p>React和React Native都是开源的，这意味着它们首先会在脸书的生产应用程序中进行测试，这使得其他公司可以更容易地将其应用程序升级到新版本。</p>
<p>尽管对任何框架或构建工具的更新对于大规模的应用程序来说都不容易实现，但如果这种升级已经在脸书的规模上进行了测试，团队应该对在自己的应用程序中实现更改充满信心。</p>
<h3 id="adoption">被主要科技巨头采用</h3>
<p>除了在脸书被广泛使用之外，React Native还被几家科技巨头采用。这个列表包括微软，它使用React Native作为其各种产品，包括Greenfield和Brownfield。电子商务巨头沃尔玛和Shopify正在依赖React Native开发他们的移动应用程序。请务必在今天的产品中查看更多使用React Native 的<a href="https://reactnative.dev/showcase">应用。</a></p>
<h3 id="universal">通用:将应用部署到任何平台</h3>
<p>官方React Native项目主要针对Android和iOS移动平台。然而，React渲染器架构是灵活且可扩展的。例如，微软分叉了主要的React原生项目，并将其扩展用于<a href="https://microsoft.github.io/react-native-windows/"> Windows和macOS </a>桌面平台。此外，许多社区派生扩展了React Native for Linux。因此，您可以将React本地应用轻松移植到任何桌面平台。</p>
<p>正如我们所知，颤振是一个普遍的框架。由于这些社区分支，我们可以说React Native也是一个通用框架，这使得React Native与Flutter相比更具竞争力。</p>
<h2 id="reactnativesprogress">对本地人的进度做出反应</h2>
<p>让我们看看React Native的一些新特性，它们对React Native项目的性能、调试和管理产生了真正的影响。</p>
<h3 id="hermes">更好的JavaScript运行时:Hermes</h3>
<p>2019年年中，脸书发布了针对React Native 优化的JavaScript引擎<a href="https://github.com/facebook/hermes"> Hermes。赫尔墨斯带着</a><a href="https://github.com/facebook/react-native/releases/tag/v0.64.0"> v0.64 </a>版本来到iOS。在撰写本文时，React原生团队正计划将Hermes作为默认的JavaScript引擎，因为它的性能有所提高。</p>
<p>Hermes不仅帮助优化了React原生应用的性能，还提高了应用的可用性，减小了应用包的大小，并优化了电池的使用。</p>
<p>移动用户社区仍然使用低端和中端设备，Hermes通过提供更小的应用捆绑包和整体接近原生的性能来支持这些设备。Hermes提供了超前(AOT)编译，取代了以前的即时编译(JIT)，提高了应用程序的交互时间(TTI)因素。</p>
<p>对于React Native的性能，尤其是在低端Android设备上的性能，一直有很多批评。作为一个基于JavaScript的框架，React Native非常依赖JavaScript引擎。在早期版本中，React Native在Android上使用WebKit JSC，经过分析，发现这是启动性能的主要因素。</p>
<p>Hermes用AOT编译将JavaScript预编译成高效的字节码，而不是用JIT编译来编译JavaScript。反过来，使用Hermes，React本机应用程序的启动时间更快，这也最小化了APK大小并优化了运行时。</p>
<h3 id="debugging">快速刷新和翻转带来更好的调试体验</h3>
<p>虽然React以其出色的开发人员体验而闻名，但调试一直是React原生开发人员的一个痛点。尽管React Native最初包含了热模块替换和热重装，但在很多情况下，它都崩溃了。作为一个解决方案，Dan Abramov为React Native开发了<a href="https://reactnative.dev/blog/2019/09/18/version-0.61">快速刷新</a>，这在很大程度上减少了这个痛点。</p>
<p>Flipper是我个人最喜欢的功能之一，它改变了我们调试本地应用的方式。Flipper在快速刷新后立即发布了一个版本，即v0.62，该版本还支持React DevTools v4.x，这意味着我们也可以通过React Native利用它的强大功能。</p>
<h3 id="management">更好的管理:更轻、更易管理</h3>
<p>React原生核心团队启动了一个项目，旨在移除所有非必要元素，并将它们放在一个单独的repo中，例如WebView等UI组件和推送通知等原生模块。这些回购大多在<a href="https://github.com/react-native-community"> react-native-community </a>下。</p>
<p>移除这些组件和模块将允许核心团队更快地移动，使React Native core更轻便、更易于管理。</p>

<p>分析应用性能的一个重要方面是它对手势、滚动和动画的响应。React Native社区为处理这一点引入了很多强大的模块，包括<a href="https://github.com/software-mansion/react-native-reanimated"> react-native-reanimated </a>、<a href="https://github.com/software-mansion/react-native-screens"> react-native-screens </a>、<a href="https://github.com/software-mansion/react-native-gesture-handler">React-Native-gesture-handler</a>和<a href="https://github.com/Flipkart/recyclerlistview"> RecyclerListView </a>。此外，React Navigation和React Native Navigation正在努力改善开发人员的体验，并使应用程序中的导航更加流畅。</p>
<h2 id="whatsnextforreactnative">React Native的下一步是什么？</h2>
<p>在我们对React Native未来的评估中，最重要的因素是脸书对图书馆未来的计划。2020年，脸书为React Native规划了一个全新的架构，确定了它在未来几年的外观。</p>
<p>React Native团队正在一点一点地构建这个架构，其中一些已经在React Native的当前版本中可用，包括Hermes。此外，还有一些已经在脸书内部测试过了，很快就可以在社区中使用了。React本地核心团队将整个改造分为三个阶段:</p>
<ol>
<li>本机模块</li>
<li>新渲染器</li>
<li>更好的初始化</li>
</ol>
<p>我们将在下面简要讨论这些阶段。</p>
<h3 id="early">原生模块:2020年初</h3>
<p>从一开始，React Native就在应用启动时初始化所有本机模块。这可能包括本机模块，对于某些用户来说，这些模块有时可能不是必需的。例如，react-native-device-info模块可能只对一个很少使用的特性是必要的，但是我们无论如何都必须在开始时初始化这个模块，因此增加了我们的启动时间。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>Turbo模块允许我们在使用本机模块时加载它们。这将减少启动时的初始化开销，从而提高启动性能。它还跨JavaScript和本机代码增加了更好的类型安全。这已经在脸书的生产应用中测试过了。</p>
<h3 id="mid">新渲染器:2020年中期</h3>
<p>我们听说这被称为Fabric，是React Native的UI层的C++重写。由于新的渲染器是线程安全的，它不需要在专用线程中完成测量和布局效果。这将修复很多严重依赖measure API的组件的bug，包括<code>ScrollView</code>和<code>TextInput</code>。</p>
<p>新的渲染器还提供了改进的类型安全。此外，所有这些UI组件都是延迟初始化的，就像本机模块一样，从而加快了启动时间。脸书的应用程序也在测试中。</p>
<h3 id="late">初始化:2020年末</h3>
<p>今天，React Native基于一个桥:JavaScript和本机代码之间的所有通信都是通过桥完成的，所有这些都是异步的、批处理的和序列化的。这意味着所有这些通信都是通过回调或承诺来完成的，并且在序列化之后在它们之间传递值。这使得它是线程安全和可靠的，但是增加了很多开销。</p>
<p>新的建筑不依赖于桥梁；相反，它将使用新的JavaScript接口(JSI)。JSI是一个独立于引擎的API，允许JavaScript与C++交互。它创建JavaScript运行时，加载JavaScript包，并允许我们从JavaScript调用C++方法。</p>
<p>它还可以从C++访问和操作JavaScript内存。通过直接使用JSI而不依赖网桥，我们可以消除与网桥相关的所有开销。展望未来，所有本机模块和视图管理器都将依赖JSI，从而使它们变得非常快。</p>
<p>为执行JavaScript代码准备运行时的大部分初始化都将在C++中完成，因此JavaScript初始化也将更具性能和优化。</p>
<p>毫无疑问，这种新的架构将使RN在性能和行为方面更加接近本地框架。更重要的是，这将使RN应用对最终用户更好。这也将使RN受益于React的精彩特性，比如并发模式。</p>
<h2 id="architecture">新架构状态和版本</h2>
<p>在撰写本文时，新的架构更新已经在脸书的大部分生产应用中进行了测试。脸书的应用程序现在已经完全迁移到新的React本地架构上。正如我们所知，没有深入的测试，一个工程团队就不能发布一个大的特性，架构的改变，或者重构的代码。此外，由于正在进行的疫情，React Native的新架构实现已被推迟。</p>
<p>幸运的是，React原生团队正计划不久后发布新的架构变更。他们正与Expo和Callstack密切合作，验证集成新架构更新的可行性。此外，<a href="https://www.youtube.com/watch?v=M-Fl6_vKcWw&amp;t=2214s"> React本地团队正在准备针对新架构的文档</a>和教程。</p>
<p>虽然新的架构还没有在v0.67候选版本中提到，但是我们很快就能看到它了。然而，新的架构已经发布到GitHub，你可以用<a href="https://github.com/facebook/react-native/tree/main/packages/rn-tester"> RNTester </a>应用测试一个支持Fabric的体验。</p>
<h2 id="conclusion">结论</h2>
<p>我在Greenfield和Brownfield应用程序中使用React Native的体验非常棒。看看React Native中包含的令人敬畏的特性，现在是成为React Native开发人员的最佳时机。</p>
<p>我很乐意讨论你对澳洲人未来的看法。欢迎在下面的评论中分享。</p><div class="code-block code-block-18">
<div class="blog-plug inline-plug react-native-plug"><h2><a href="https://lp.logrocket.com/blg/react-native-signup"> LogRocket </a>:即时重现React原生应用中的问题。</h2><a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/110055665562c1e02069b3698e6cc671.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/110055665562c1e02069b3698e6cc671.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-native-plug_v2-2.png"/></noscript></a><p><a href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>是一款React原生监控解决方案，可帮助您即时重现问题、确定bug的优先级并了解React原生应用的性能。</p><p>LogRocket还可以向你展示用户是如何与你的应用程序互动的，从而帮助你提高转化率和产品使用率。LogRocket的产品分析功能揭示了用户不完成特定流程或不采用新功能的原因。</p><p>开始主动监控您的React原生应用— <a class="signup" href="https://lp.logrocket.com/blg/react-native-signup" target="_blank" rel="noopener noreferrer">免费试用LogRocket】。</a></p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>