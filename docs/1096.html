<html>
<head>
<title>Best practices for Vuex mapping  - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Vuex映射的最佳实践- LogRocket博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/best-practices-mapping-vuex/#0001-01-01">https://blog.logrocket.com/best-practices-mapping-vuex/#0001-01-01</a></blockquote><div><article class="article-post">
<p>编者按:这篇文章于2021年11月29日更新，以反映Vuex的升级。</p>
<p>Vuex是一把双刃剑。如果使用得当，它可以让您在使用Vue时轻松许多。如果你不小心的话，它也会把你的代码弄得一团糟。</p>
<p>在使用<a href="https://blog.logrocket.com/using-vuex-4-with-vue-3/"> Vuex之前，你应该理解四个主要概念:状态、getters、突变和动作</a>。一个简单的Vuex状态操作存储中这些概念内的数据。Vuex中的映射提供了一种很好的、干净的方式从它们中检索数据。</p>
<p>在本教程中，我们将演示如何映射来自Vuex商店的数据。如果你是熟悉Vuex基础知识的Vue开发人员，这些最佳实践将帮助你编写更干净、更易维护的代码。我们开始吧！</p>
<h3>目录</h3>

<h2 id="whatisvuexmapping">什么是Vuex映射？</h2>
<p>Vuex中的映射使您能够将状态的任何属性(如getters、mutations、actions或state)绑定到组件中的计算属性，并直接使用状态中的数据。</p>
<p>下面是一个简单的Vuex商店示例，测试数据处于以下状态:</p>
<pre>import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex)

const store = new Vuex.Store({
  state: {
    data: "test data"
  }
  }
})
</pre>
<p>如果您想从状态中访问<code>data</code>的值，请在Vue.js组件中添加以下内容:</p>
<pre>computed: {
        getData(){
          return this.$store.state.data
        }
    }
</pre>
<p>上面的代码工作正常，但是随着州内数据开始增长，代码很快就变得难看了。例如:</p>
<pre>import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex)

const store = new Vuex.Store({
  state: {
    user: {
        id:1,
        age:23,
        role:user
        data:{
          name:"user name",
          address:"user address"
        }
    },
    services: {},
    medical_requests: {},
    appointments: {},
    }
  }
})
</pre>
<p>要从处于以下状态的用户对象获取用户名:</p>
<pre>computed: {
        getUserName(){
          return this.$store.state.user.data.name
        }
    }
</pre>
<p>虽然我们可以用<code>this.$store.state.user.data.name</code>完成这项工作，但是我们可以使用地图助手将其简化为<code>this.event</code>。</p>
<h2 id="vuexmapstate">vuex〔t0〕</h2>
<p>为了映射组件中的状态，我们首先导入<code>mapState</code>并向组件添加一个计算属性:</p>
<pre>import { mapState } from 'vuex';

export default{
    computed: {
        ...mapState([
            'user',
        ])
    }
}
</pre>
<p>上面使用的三点语法是ES6语法，称为<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax">扩展</a>T5】语法。您现在可以访问组件中的整个<code>user</code>对象，因此，<code>user</code>成为一个计算组件。您可以做更多的事情，比如将对象从状态添加到<code>mapState</code>方法中:</p>
<pre>import { mapState } from 'vuex';

export default{
    computed: {
        ...mapState([
            'user',
            'services'
        ])
    }
}
</pre>
<p>如您所见，这段代码非常简洁。您可以通过以下方式轻松访问用户名:</p>
<pre>{{user.data.name}}
</pre>
<p>这同样适用于<code>services</code>对象和许多其他映射的值。你注意到我们是如何将一个数组传递给<code>mapState()</code>的吗？如果您需要给该值一个不同的名称，您可以改为传入一个对象，如下所示:</p>
<pre>import { mapGetters } from 'vuex';

export default{
    computed: {
        ...mapState({
            userDetails:'user',
            userServices:'services'
        })
    }
}
</pre>
<p>现在，您可以通过简单地调用<code>userDetails</code>来引用<code>user</code>。</p>
<h2 id="whenshouldyoumaptheentirevuexstate">何时应该映射整个Vuex状态？</h2>
<p>首先，您不应该映射Vuex状态。根据经验，只有当状态中有大量数据并且组件中需要这些数据时，才应该映射Vuex状态。</p>
<p>在上面的例子中，如果我们只需要一个值，例如<code>username</code>，那么映射整个用户对象就没有什么意义了。</p>
<p>当您映射状态时，整个对象被加载到内存中。您应该避免将不必要的数据加载到内存中，因为从长远来看，这将导致负面的性能影响。</p>
<h2 id="whatarevuexmapgetters">什么是Vuex <code>mapGetters</code>？</h2>
<p>Getters提供了一种从存储区获取派生计算状态的方法。映射getters在语法上类似于<code>mapState</code>函数:</p>
<pre>import { mapGetters } from 'vuex'

export default {
  computed: {
    ...mapGetters({
    first: ‘firstCount’,
    another: ‘anotherGetter’,
    })
  }
}
</pre>
<p>上面的代码类似于编写如下的计算机属性:</p>
<pre>export default {
  computed: {
    firstCount() {
      return this.$store.getters.firstCount
    },
    anotherGetter() {
      return this.$store.getters.anotherGetter
    },
  }
}
</pre>
<p>与映射状态一样，如果您想使用不同的名称，可以将一个对象传递给<code>mapGetters</code>函数:</p>
<pre>import { mapGetters } from 'vuex'

export default {
  computed: {
    ...mapGetters({
    first: ‘firstCount’,
    another: ‘anotherGetter’,
    })
  }
}
</pre>
<h2 id="vuexmapmutations">Vuex贴图突变</h2>
<p>突变是在Vuex存储中改变状态的一种方式。与在Vue的<code>computed property</code>中映射<code>mapState</code>和<code>mapGetters</code>以使状态上的数据与组件中的数据发生反应不同，<code>Mutations</code>在方法中被映射。</p>
<p>映射突变时，可以在Vue中使用以下语法提交突变:</p>
<pre>this.$store.commit('mutationName`)
</pre>
<p>例如:</p>
<pre>import { mapMutations } from 'vuex'

export default {
  methods: {
    ...mapMutations([
      'search', // map `this.search()` to `this.$store.commit('search')`

      // `mapMutations` also supports payloads:
      'searchBy' // map `this.searchBy(key)` to `this.$store.commit('searchBy', key)`
    ]),
  }
}
</pre>
<h2 id="mappingvuexactions">Vuex动作映射</h2>
<p>映射动作很像映射突变，因为它也在方法中执行。动作也被映射到<code>methods</code>属性，而不是<code>computed</code>属性。使用映射器将<code>this.$store.dispatch('actionName')</code>绑定到映射器数组中的名称或对象的键:</p>
<pre>import { mapActions } from 'vuex'

export default {
  methods: {
    ...mapActions([
      'search',
      // `mapActions` also supports payloads: searchBy(key)
      'searchBy'
    ]),
  }
}
</pre>
<p>请注意我们是如何使用数组来定义多个map操作的，这类似于编写计算机属性，如下所示:</p>
<pre>export default {
  methods: {
    search() {
      return this.$store.dispatch('search');
    },
    searchBy(key) {
      return this.$store.dispatch('searchBy', key);
    },
  }
}
</pre>
<h2 id="conclusion">结论</h2>
<p>现在，您应该对Vuex中的映射是如何工作的以及为什么应该使用它有了一个明确的理解。您应该能够映射Vuex存储中的所有组件，比如状态、getters、突变和动作。此外，您还了解了何时绘制商店地图，何时不应绘制。</p>
<p>映射您的动作、getters和突变的另一个优点是，它将使您的代码更小，并节省您的编写时间。</p>
<p>如果您决定在下一个项目中使用Vuex，这些最佳实践将会对您有极大的帮助。我希望你喜欢这个教程。</p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>