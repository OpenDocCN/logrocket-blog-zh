<html>
<head>
<title>Running a Flutter web app and API on Node.js - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在Node.js - LogRocket博客上运行Flutter web应用程序和API</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/flutter-web-app-node-js/#0001-01-01">https://blog.logrocket.com/flutter-web-app-node-js/#0001-01-01</a></blockquote><div><article class="article-post">
<p>有太多的跨平台应用程序开发框架允许你一次编写一个应用程序，并在多个平台上运行，如Android、iOS，甚至是桌面。你可能听说过像Ionic、<a href="https://blog.logrocket.com/flutter-vs-react-native-vs-xamarin/"> Xamarin和React Native </a>这样的流行框架。另一个相对较新的框架是Flutter。</p>
<p>在本文中，您将了解一些关于Flutter的知识，特别关注web支持，它最近成为1.9版本中的技术预览版。您将向现有的Flutter应用程序添加web支持，并在Node.js服务器上与一个简单的API一起运行它。</p>
<h2>匆匆一瞥</h2>
<p>Flutter是Google跨平台开发的解决方案之一。虽然它是一个相当新的领域，但它的特性集使它成为这个领域的一个竞争对手。</p>
<p>它将您的应用编译成运行在iOS或Android上的本机代码，从而带来令人难以置信的最终用户性能和帧速率。它支持开发期间的状态热重新加载，这意味着您可以对代码进行更改，并观察它们在您的仿真器或物理设备上的应用，而无需重新启动您的应用程序或丢失您的应用程序状态。</p>
<p>Flutter的主要关注点是iOS和Android。在1.9版本中，web支持作为技术预览版被添加进来。它仍处于早期阶段，可能还没有准备好投入生产，但它肯定是令人兴奋和有前途的。您很快就会看到，只需进行很少的更改，就可以将现有的Flutter应用程序编译成HTML、CSS和JS包。</p>
<h2>为什么要在Node.js上运行Flutter web app？</h2>
<p>Flutter web应用可以在任何web服务器上运行。那么，为什么要将Flutter web应用程序托管在Node.js服务器上呢？好吧，说实话，出于许多与您选择Node.js用于其他web应用程序和API相同的原因:它非常擅长处理大量简单请求，您可以用JavaScript编写前端和后端代码，等等。</p>
<p>您可能已经有了一个Node.js API来为您的Flutter iOS或Android应用程序提供数据。将Flutter应用程序编译为web应用程序，并将其托管在现有的Node.js服务器上，这可能是对当前解决方案的合理扩展，不需要增加额外的托管成本。</p>
<h2>示范</h2>
<p>是时候深入代码，看看Flutter web是如何工作的了。为了跟随示例，您将需要以下工具:</p>
<ul>
<li>Android Studio (Android SDK管理器和仿真器)</li>
<li>Visual Studio代码+ Flutter扩展(或Android Studio)</li>
<li>Node.js 12</li>
</ul>
<p>Flutter有很棒的开发者文档。如果这是您第一次开发Flutter应用程序，请遵循“<a href="https://flutter.dev/docs/get-started/install">入门</a>指南来设置您的所有工具。</p>
<p>您将有机会选择想要在哪个编辑器中开发。本文中的示例和说明基于Visual Studio代码，但是如果您选择使用Android Studio，您应该仍然能够理解。</p>
<p>需要Node.js 12服务器来运行web版本的Flutter weather应用程序以及后端天气API。</p>
<h3>步骤1:探索示例代码</h3>
<p>为了演示如何向现有的Flutter应用程序添加web支持，我们将从一个简单的天气应用程序开始，该应用程序已经在Android 10 (API级别29)上进行了测试。</p>
<p><img data-attachment-id="8540" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/flutter-weather-app-mobile/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png" data-orig-size="301,608" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter weather app on mobile" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile-149x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png" decoding="async" class="aligncenter size-full wp-image-8540 jetpack-lazy-image" src="../Images/d28ccec818eb3748086366938e4e01cf.png" alt="Flutter Weather App On Mobile" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png 301w, https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile-149x300.png 149w" data-lazy-sizes="(max-width: 301px) 100vw, 301px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8540" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/flutter-weather-app-mobile/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png" data-orig-size="301,608" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Flutter weather app on mobile" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile-149x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-8540" src="../Images/d28ccec818eb3748086366938e4e01cf.png" alt="Flutter Weather App On Mobile" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png 301w, https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile-149x300.png 149w" sizes="(max-width: 301px) 100vw, 301px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/flutter-weather-app-mobile.png"/></noscript>
<p>天气应用程序允许用户查看预定义城市列表的当前天气。天气数据是从Node.js上运行的后端服务器检索的。</p>
<p>从GitHub克隆天气应用程序和服务器的源代码:</p>

<blockquote><p><strong>提示:</strong><code>weather-app-nodejs-server</code>存储库有一个<code>flutter-web-support</code>分支，包含复制到启用了Flutter web支持的服务器的应用程序的完整版本。</p></blockquote>
<p>最好在同一个父文件夹中同时克隆两个存储库。将构建<code>weather_app_flutter</code>存储库的内容，并将其复制到<code>weather-app-nodejs-server</code>存储库中的一个文件夹中。</p>
<h4>探索颤振天气应用程序</h4>
<p>在编辑器中打开<code>weather_app_flutter</code>存储库。让我们仔细看看<code>main.dart</code>文件。它包含构成应用程序用户界面的支架和小部件。<code>Home</code>小部件类有一个<code>fetchWeatherData</code>函数，它调用后端天气API来检索数据并更新小部件的状态:</p>
<pre>  fetchWeatherData({String location}) async {
    var url = WEATHER_API_URL + location;
    final response = await http.get(url);
    if (response.statusCode == 200) {
      var jsonResponse = convert.jsonDecode(response.body);
      setState(() {
        this._weatherData = WeatherData(
          jsonResponse\['weather'\]['location'],
          jsonResponse\['weather'\]['temperature'],
          jsonResponse\['weather'\]['weatherDescription'],
        );
        this._apiError = null;
      });
    } else {
      setState(() {
        this._apiError =
            'Unable to retrieve weather data from API (HTTP ${response.statusCode})';
      });
    }
  }</pre>
<p><code>fetchWeatherData</code>函数使用Dart的<code>http</code>包通过HTTP连接到服务器。你也可以使用其他的Dart包，但是如果你打算给你的Flutter应用程序添加web支持，这是官方推荐的包。</p>
<p>还要注意<code>WEATHER_API_URL</code>常数。在运行应用程序之前更新此常量的值，以便它可以连接到本地Node.js服务器上运行的API。URL必须包含您的计算机的主机名。Android模拟器或物理设备将无法访问<code>localhost</code> URL。</p>
<h4>探索Node.js服务器和天气API</h4>
<p>在编辑器中打开<code>weather-app-nodejs-server</code>存储库。</p>
<p><img data-attachment-id="8541" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/weather-app-nodejs-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png" data-orig-size="203,336" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="weather-app-nodejs-server repository in our editor" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server-181x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png" decoding="async" class="aligncenter size-full wp-image-8541 jetpack-lazy-image" src="../Images/6186b3d8a9a3adf5a604737ec0893c4e.png" alt="Node.js Server Repository In Our Code Editor" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png 203w, https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server-181x300.png 181w" data-lazy-sizes="(max-width: 203px) 100vw, 203px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8541" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/weather-app-nodejs-server/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png" data-orig-size="203,336" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="weather-app-nodejs-server repository in our editor" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server-181x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-8541" src="../Images/6186b3d8a9a3adf5a604737ec0893c4e.png" alt="Node.js Server Repository In Our Code Editor" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png 203w, https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server-181x300.png 181w" sizes="(max-width: 203px) 100vw, 203px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/weather-app-nodejs-server.png"/></noscript>
<p>有几个重要的文件和文件夹需要查看:</p>
<ul>
<li><code>public/api-test.html</code>文件可用于快速测试您的服务器在启动后是否按预期工作(例如<code><a href="http://localhost:3000/api-test.html" rel="nofollow">http://localhost:3000/api-test.html</a></code>)</li>
<li><code>routes/weather.js</code>文件包含一个简单的GET API，它接受一个路径参数并返回天气数据(例如，<code><a href="http://localhost:3000/api/weather/londonon" rel="nofollow">http://localhost:3000/api/weather/londonon</a></code>)</li>
<li>在<code>public-flutter</code>文件夹中，您将复制编译好的网页版天气应用程序。Node.js服务器被设置为从这个目录向根上下文(例如，<code><a href="http://localhost:3000" rel="nofollow">http://localhost:3000</a></code>)提供文件</li>
</ul>
<h3>步骤2:为Flutter应用程序添加web支持</h3>
<p>由于web支持仍然是一个技术预览，您需要最新的开发中版本的Flutter，也称为主通道。在<code>weather_app_flutter</code>存储库的根文件夹中，运行以下命令:</p>
<pre>flutter channel master
flutter upgrade</pre>
<blockquote><p><strong>提示</strong>:你可能会遇到一个“未知操作系统”。无法安装Dart SDK。在Visual Studio代码中的bash shell中运行Flutter命令时，Windows上出现错误。尝试在普通的Windows命令shell中运行这些命令。</p></blockquote>
<p>升级过程可能需要几分钟时间。接下来，您需要在您的Flutter安装中启用web支持，以便它可用于您在此工作站上开发的这个和其他应用程序:</p>
<pre>flutter config --enable-web
flutter devices</pre>
<p>一旦启用了网络支持，你会在设备列表中看到一个新的Chrome设备。如果在列表中没有看到Chrome，请在运行这些命令后重新启动Visual Studio代码来刷新设备列表菜单。</p>
<p>要向weather应用程序添加web支持，您需要在<code>weather_flutter_app</code>存储库的顶层文件夹中运行这个命令:</p>
<pre>flutter create .</pre>
<p><code>create</code>命令将对应用程序做一些修改，你可以在<a href="https://github.com/briandesousa/weather_app_flutter/commit/7639c7041614d99a945709be269a7d76b991912a">这个提交</a>中看到。最显著的变化是添加了一个包含<code>index.html</code>的<code>web</code>子文件夹:</p>
<p><img data-attachment-id="8542" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/index-html-file/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png" data-orig-size="730,201" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="index.html file in our code editor" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png" decoding="async" class="aligncenter size-full wp-image-8542 jetpack-lazy-image" src="../Images/d86ef364933c6e7c077dd495761b98c6.png" alt="Index.html File In Our Code Editor" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png 730w, https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file-300x83.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8542" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/index-html-file/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png" data-orig-size="730,201" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="index.html file in our code editor" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file-300x83.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-8542" src="../Images/d86ef364933c6e7c077dd495761b98c6.png" alt="Index.html File In Our Code Editor" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png 730w, https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file-300x83.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/index.html-file.png"/></noscript>
<p>通过在<code>weather-app-nodejs-server</code>存储库的根目录下运行以下命令来启动Node.js服务器:</p>
<pre>npm start</pre>
<p>在Visual Studio代码中从设备列表中选择Chrome，然后开始调试。或者，您可以运行以下颤振命令:</p>
<pre>flutter run -d chrome</pre>
<p>第一次在Chrome中启动该应用程序可能需要较长时间，而Flutter会动态下载额外的依赖项。Chrome最终会打开，你会看到天气应用在浏览器中运行。有些样式会与您在模拟器或物理设备上看到的略有不同。</p>
<p><img data-attachment-id="8543" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/app-preview-chrome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png" data-orig-size="730,413" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="App preview in Chrome" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome-300x170.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png" decoding="async" class="aligncenter size-full wp-image-8543 jetpack-lazy-image" src="../Images/c352667af0b38ff54b7ead403cc314bb.png" alt="App Preview In Chrome" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png 730w, https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome-300x170.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8543" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/app-preview-chrome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png" data-orig-size="730,413" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="App preview in Chrome" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome-300x170.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-8543" src="../Images/c352667af0b38ff54b7ead403cc314bb.png" alt="App Preview In Chrome" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png 730w, https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome-300x170.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/app-preview-chrome.png"/></noscript>
<p>此时，您会注意到应用程序没有显示任何来自天气API的数据。如果你打开Chrome DevTools，你会看到一个<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">跨源资源共享</a>错误。</p>
<p>浏览器不允许从Flutter web服务器向Node.js服务器发出请求，因为它们运行在不同的端口上。你可以通过在服务器上启用跨源资源共享或者安装一个Chrome插件来禁用CORS来解决这个问题。</p>
<p>我们现在将忽略这个错误，因为在下一步中，我们将直接在Node.js服务器上运行预编译的Flutter web代码，从而完全消除跨源请求。</p>
<p>试着修改一下<code>main.dart</code>文件中的一些代码，让Flutter重新编译你的应用。您会注意到您的更改不会立即出现在浏览器中。这是因为Flutter web还不支持热状态重载。希望对这一令人敬畏的功能的支持将很快到来。</p>
<blockquote><p><strong>提示:</strong>在<a href="https://flutter.dev/docs/get-started/web"> flutter.dev </a>上可以找到本节中每个颤振命令的详细解释。</p></blockquote>
<h3>步骤3:在Node.js上运行Flutter web应用程序</h3>
<p>现在，您可以使用Flutter在浏览器中运行天气应用程序，下一步是构建它并将其复制到Node.js服务器，以便与API一起运行。</p>
<p>要构建Flutter web应用程序包，请运行以下命令:</p>
<pre>flutter build web</pre>
<p>build命令将生成包含构成天气应用程序的所有静态文件的<code>build/web</code>文件夹。</p>
<p><img data-attachment-id="8545" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/buildweb-folder/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png" data-orig-size="212,426" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Contents of the build/web folder" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder-149x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png" decoding="async" class="aligncenter size-full wp-image-8545 jetpack-lazy-image" src="../Images/fe5438705ba3e785385fcb3ee2c56474.png" alt="Contents Of The build/web Folder In Our Editor" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png 212w, https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder-149x300.png 149w" data-lazy-sizes="(max-width: 212px) 100vw, 212px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8545" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/buildweb-folder/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png" data-orig-size="212,426" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Contents of the build/web folder" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder-149x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-8545" src="../Images/fe5438705ba3e785385fcb3ee2c56474.png" alt="Contents Of The build/web Folder In Our Editor" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png 212w, https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder-149x300.png 149w" sizes="(max-width: 212px) 100vw, 212px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/buildweb-folder.png"/></noscript>
<p>将<code>weather_app_flutter/build/web</code>的内容复制到<code>weather-app-nodejs-server/public-flutter</code>中。如果中的Node.js服务器仍在运行，请停止并重新启动它以获取新文件。</p>
<p>在<code><a href="http://localhost:3000" rel="nofollow">http://localhost:3000</a></code>访问浏览器中的Node.js服务器，查看在Node.js上运行的应用程序。这一次，您的应用程序将显示从weather API检索的天气数据，而不会出现跨原点资源共享错误。</p>
<p><img data-attachment-id="8546" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/app-running-chrome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png" data-orig-size="730,528" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Final app running in the browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome-300x217.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png" decoding="async" class="aligncenter size-full wp-image-8546 jetpack-lazy-image" src="../Images/39d88f908df471eea8b267b2d076e401.png" alt="Final App Running In The Browser" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png 730w, https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome-300x217.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="8546" data-permalink="https://blog.logrocket.com/flutter-web-app-node-js/app-running-chrome/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png" data-orig-size="730,528" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Final app running in the browser" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome-300x217.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-8546" src="../Images/39d88f908df471eea8b267b2d076e401.png" alt="Final App Running In The Browser" srcset="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png 730w, https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome-300x217.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/app-running-chrome.png"/></noscript>
<h2>最后的想法</h2>
<p>令人难以置信的是，将一个现有的Flutter应用程序编译成一个可以部署到web服务器上的web应用程序是多么简单。浏览器中呈现的用户界面看起来与Android中的用户界面几乎相同。</p>
<p>如果你仅仅因为Flutter的web支持而考虑将它作为跨平台应用框架，请小心行事。Flutter团队非常清楚web支持缺少特性，有已知的性能问题，并且还没有为生产做好准备。</p>
<p>有一件事是肯定的:web的Flutter前景看好。你可以在这里阅读更多关于Flutter web support和Project Hummingbird <a href="https://medium.com/flutter/hummingbird-building-flutter-for-the-web-e687c2a023a8">的信息。</a></p><div class="code-block code-block-23">
<div class="blog-plug inline-plug node-plug"><h2>200只<img src="../Images/61167b9d027ca73ed5aaf59a9ec31267.png" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png"/> <noscript> <img data-lazy-fallback="1" src="../Images/61167b9d027ca73ed5aaf59a9ec31267.png" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/10/green-check.png"/> </noscript>显示器出现故障，生产中网络请求缓慢</h2><p>部署基于节点的web应用程序或网站是容易的部分。确保您的节点实例继续为您的应用程序提供资源是事情变得更加困难的地方。如果您对确保对后端或第三方服务的请求成功感兴趣，</p><a href="https://lp.logrocket.com/blg/node-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer"><img src="../Images/cae72fd2a54c5f02a6398c4867894844.png" alt="LogRocket Network Request Monitoring" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png"/><noscript><img data-lazy-fallback="1" src="../Images/cae72fd2a54c5f02a6398c4867894844.png" alt="LogRocket Network Request Monitoring" data-original-src="https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png"/></noscript></a><a href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录下用户与你的应用程序交互时发生的一切。您可以汇总并报告有问题的网络请求，以快速了解根本原因，而不是猜测问题发生的原因。</p><p>LogRocket检测您的应用程序以记录基线性能计时，如页面加载时间、到达第一个字节的时间、慢速网络请求，还记录Redux、NgRx和Vuex操作/状态。</p><a class="signup" href="https://lp.logrocket.com/blg/node-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a><p>. </p></div>
</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>