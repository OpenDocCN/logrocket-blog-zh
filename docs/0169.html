<html>
<head>
<title>Building server-rendered apps in Vue using Nuxt.js - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用Nuxt.js - LogRocket博客在Vue中构建服务器渲染的应用程序</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/building-server-rendered-apps-in-vue-using-nuxt-js-c12c6c253274/#0001-01-01">https://blog.logrocket.com/building-server-rendered-apps-in-vue-using-nuxt-js-c12c6c253274/#0001-01-01</a></blockquote><div><article class="article-post">
<p>这篇文章将带你了解在<a href="https://vuejs.org/" target="_blank" rel="noopener noreferrer"> Vue </a>中构建服务器渲染网页的过程，这是一个渐进的JavaScript框架，使用起来很简单。我还将讨论<a href="https://nuxtjs.org" target="_blank" rel="noopener noreferrer"> Nuxt </a>，一个使服务器渲染过程无缝的工具。最后，作为一个实际的例子，我们将构建一个应用程序，根据狗的品种显示狗的图片。</p>
<p>我们将构建一个服务器渲染的Vue应用程序，它加载速度非常快，甚至在JavaScript加载之前，并且可以被搜索引擎发现。</p>
<p>为了更好地理解这个问题，打开一个用任何框架构建的SPA，尝试检查这个页面。这是我的一个Vue演示项目的例子:</p>
<figure><img decoding="async" src="../Images/6a81c36ca78d3c3fa0a2ef583d76b86a.png" data-height="1776" data-width="2322" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*8yHeTENxc9QRgTExkpxXRA.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://storage.googleapis.com/blog-images-backup/1*8yHeTENxc9QRgTExkpxXRA.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/6a81c36ca78d3c3fa0a2ef583d76b86a.png" data-height="1776" data-width="2322" data-original-src="https://storage.googleapis.com/blog-images-backup/1*8yHeTENxc9QRgTExkpxXRA.png"/></noscript></figure>
<p>无论项目的规模、相关性或美观程度如何，这都是您最终得到的结果:</p>
<figure><img decoding="async" src="../Images/69ace878c8d9c997d60d3e33ee5fdef2.png" data-height="1776" data-width="2322" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*5oXQgxV8wemd6SDUyMkiVQ.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://storage.googleapis.com/blog-images-backup/1*5oXQgxV8wemd6SDUyMkiVQ.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/69ace878c8d9c997d60d3e33ee5fdef2.png" data-height="1776" data-width="2322" data-original-src="https://storage.googleapis.com/blog-images-backup/1*5oXQgxV8wemd6SDUyMkiVQ.png"/></noscript></figure>
<p>您在页面源中看到的内容是服务器响应。请注意，只显示了<code>div#id</code>标签，而其他所有内容，包括那些漂亮的图片，都不见了。</p>
<p>这是个问题。</p>
<p>事实上，我们可以讨论很多潜在的问题。</p>
<p>让我们来关注一下最引人注目的——网络爬行。搜索引擎和其他网络爬虫对你的网站渲染后的视觉效果了解不多。他们只关心作为响应从你的服务器发送的难看的HTML。在这里，当一个爬虫访问我们的网站时，除了div标签和head标签中的一些内容之外，它什么也没有带回家。</p>
<p>来个更微妙的问题怎么样？毫不奇怪，JavaScript框架(在我们的例子中是Vue)严重依赖JavaScript。事实上，它们在单页应用程序(spa)中的视图是用JavaScript生成和控制的。当JS加载出错时，您的用户会遇到一个空白屏幕。</p>
<h3><span>为什么是Nuxt.js </span></h3>
<figure/>
<p>有一个Vue库，您可以在您的Vue项目中使用它来提供服务器上的内容。这个库被称为<code>vue-server-renderer</code>，可以通过npm安装。它也有很好的文件。</p>
<p>与刚开始使用Vue相比，走这条路要困难一些。尽管文档尽最大努力简化事情，但SSR通常是一个棘手的概念。</p>
<p>当<code>vue-server-render</code>很难上手时，<a href="https://github.com/chrisvfritz/prerender-spa-plugin" target="_blank" rel="noopener noreferrer"> Webpack的Prerender </a> SPA插件可能是一个选择。不幸的是，它只适用于简单的SEO营销页面(例如，“关于”或“联系我们”)。当你在处理大量的路线/动态路线时，插件会依赖你。</p>
<p>Nuxt着眼于所有这些问题，并为您提供一个平台来构建由服务器渲染且易于设置的SPA项目。放入命令行指令，您就可以开始了。它的灵感来自React的<a href="https://github.com/zeit/next.js/" target="_blank" rel="noopener noreferrer"> Next </a>，这是React开发者实现服务器端渲染(SSR)的替代方案。</p>
<p>说够了。让我们走吧。</p>
<h3>设置一个Nuxt项目</h3>
<p>前面我提到过，要让Nuxt项目运行起来，只需要一条命令行指令。让我们看看这有多真实:</p>
<pre>vue init nuxt/starter know-your-dogs</pre>
<p>该命令依赖于Vue CLI。如果没有安装，请运行:</p>
<pre>npm install -g vue-cli</pre>
<p>这将生成一个巨大的项目文件夹结构。别担心。随着时间的推移，你会知道你需要什么文件夹，什么放在哪里。</p>
<h3>布局和路线页面</h3>
<p>运行生成的样板文件，您会看到:</p>
<figure><img decoding="async" src="../Images/bef75d44dbfe75853a8ccfde75afb605.png" data-height="1678" data-width="2392" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*EiPa5Fa36eIaz6VbxCMZpw.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://storage.googleapis.com/blog-images-backup/1*EiPa5Fa36eIaz6VbxCMZpw.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/bef75d44dbfe75853a8ccfde75afb605.png" data-height="1678" data-width="2392" data-original-src="https://storage.googleapis.com/blog-images-backup/1*EiPa5Fa36eIaz6VbxCMZpw.png"/></noscript></figure>
<h4>布局</h4>
<p>现在导航到<code>./layouts/default.vue</code>，用以下内容更新模板:</p>
<pre>&lt;template&gt;
  &lt;div class="layout"&gt;
    &lt;h1&gt;Know Your Dog!&lt;/h1&gt;
    &lt;nuxt/&gt;
  &lt;/div&gt;
&lt;/template&gt;</pre>
<p>的一些更新</p>
<pre>[styles]()</pre>
<p>，您应该会看到视图更改为:</p>
<figure><img decoding="async" src="../Images/5f0abd03baf47835cbcbae00be4d521d.png" data-height="1678" data-width="2392" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*FBUbRm68wcPFt6m5iqVpRA.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://storage.googleapis.com/blog-images-backup/1*FBUbRm68wcPFt6m5iqVpRA.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/5f0abd03baf47835cbcbae00be4d521d.png" data-height="1678" data-width="2392" data-original-src="https://storage.googleapis.com/blog-images-backup/1*FBUbRm68wcPFt6m5iqVpRA.png"/></noscript></figure>
<p>注意“了解你的狗！”添加到布局中的文本包含在应用程序根URL呈现的页面中。这是因为<code>default.vue</code>文件是一个布局文件。它包装其他页面，并提供在一组页面之间共享的通用信息。运行时，<code>default.vue</code>中的<code>&lt;nuxt/&gt;</code>标签将被页面替换。</p>
<h4>按指定路线发送</h4>
<p>与您通常的Vue项目不同，您不必在Nuxt中配置路由。在页面目录中找到的任何组件都会根据其名称自动映射到一个路由。页面<code>index.vue</code>被映射到根URL <code>/</code>，但是如果我们有一个叫做<code>dogs.vue</code>的页面，它将被映射到<code>/dogs</code>。</p>
<p>当我们开始充实我们的应用程序时，我们会看到更多关于路由的内容。现在，让我们从<a href="https://dog.ceo/dog-api/" target="_blank" rel="noopener noreferrer"> dog.ceo API </a>中获取一个狗的列表。</p>
<h3>加载异步数据</h3>
<p>在Vue中，您通常会从<code>created</code>生命周期方法中获取异步数据。Nuxt不是这样的，因为这些数据也需要在服务器上呈现。出于这个原因，存在另一个名为<code>asyncData</code>的方法，它在服务器和客户机上呈现获取的数据。</p>
<p>安装<a href="https://github.com/mzabriskie/axios" target="_blank" rel="noopener noreferrer">Axios</a>——一个用于发出HTTP请求的流行库:</p>
<pre>yarn add axios</pre>
<p>在<code>pages/index.vue</code>中，在组件对象中添加以下方法:</p>
<pre>import axios from 'axios'

export default {
  async asyncData () {
    const { data } = await axios.get('<a href="https://dog.ceo/api/breeds/list%60" target="_blank" rel="noopener noreferrer">https://dog.ceo/api/breeds/list</a>')
    return { breeds: data.message }
  },
}</pre>
<p>我们正在利用<code>async/await</code>功能的力量。当返回响应时，我们通过返回包含响应的对象将值绑定到视图。</p>
<p>如果你觉得最舒服的话，你仍然可以坚持复试:</p>
<pre>export default {
  asyncData ({ params }, callback) {
    axios.get('<a href="https://dog.ceo/api/breeds/list%60" target="_blank" rel="noopener noreferrer">https://dog.ceo/api/breeds/list</a>')
    .then((res) =&gt; {
      callback(null, { breeds: res.data.message })
    })
  }
}</pre>
<p>现在，您可以使用组件的模板呈现返回的响应数据:</p>
<pre>&lt;template&gt;
  &lt;section class="container"&gt;
    &lt;div&gt;
      &lt;a v-for="breed in breeds" :key="breed" class="breed"&gt;
        {{breed}}
      &lt;/a&gt;
    &lt;/div&gt;
  &lt;/section&gt;
&lt;/template&gt;</pre>
<p>这是新的外观:</p>
<figure><img decoding="async" src="../Images/88909b9092417a2921e15bfcc6ef684c.png" data-height="1678" data-width="2392" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*O3gSjIpn7r63EMtuvjChbQ.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://storage.googleapis.com/blog-images-backup/1*O3gSjIpn7r63EMtuvjChbQ.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/88909b9092417a2921e15bfcc6ef684c.png" data-height="1678" data-width="2392" data-original-src="https://storage.googleapis.com/blog-images-backup/1*O3gSjIpn7r63EMtuvjChbQ.png"/></noscript></figure>
<p>现在查看页面源代码，注意内容是如何呈现给服务器的:</p>
<figure><img decoding="async" src="../Images/029d108cf5cc673ba177b614549219e8.png" data-height="1678" data-width="2392" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*npMSmR25vt6kc08udhvcag.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://storage.googleapis.com/blog-images-backup/1*npMSmR25vt6kc08udhvcag.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/029d108cf5cc673ba177b614549219e8.png" data-height="1678" data-width="2392" data-original-src="https://storage.googleapis.com/blog-images-backup/1*npMSmR25vt6kc08udhvcag.png"/></noscript></figure>
<h3>动态路线</h3>
<p>我们需要实现当任何品种被点击时会发生什么。我们想要做的是导航到<code>dogs/:id</code>并显示所选品种的随机图像。</p>
<p>在“pages”中创建一个名为<code>dogs</code>的文件夹，并在文件夹中添加一个带有<code>_breed.vue</code>的文件。</p>
<p>在脚本标记中，根据一个参数从API中获取一张狗的随机图像:</p>
<pre>import axios from 'axios'

export default {
  async asyncData ({params}) {
    const { data } = await axios.get(`<a href="https://dog.ceo/api/breed/%24%7Bparams.breed%7D/images/random%60" target="_blank" rel="noopener noreferrer">https://dog.ceo/api/breed/${params.breed}/images/random`</a>)
    return { breed: data.message, name: params.breed }
  }
}</pre>
<p><code>asyncData</code>接收一个对象，其中<code>params</code>是一个属性。<code>params</code>属性也是一个包含传递给页面的所有参数的对象(在我们的例子中是<code>breed</code>)。该页被配置为通过在文件名前加下划线(_)来接收参数。我们使用这个参数获取一个随机图像，并将图像和品种名称设置到视图中。</p>
<p>让我们显示这个图像和名称:</p>
<pre>&lt;div&gt;
  &lt;img :src="breed" alt=""&gt;
  &lt;h4&gt;{{name.toUpperCase()}}&lt;/h4&gt;
&lt;/div&gt;</pre>
<p>现在你可以看到你选择的品种的一些细节:</p>
<figure><img decoding="async" src="../Images/d850f1a213f4c7c382bf863437d60cf5.png" data-height="1678" data-width="2392" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*ldZQ29JvosNcaPjJIeAt9w.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://storage.googleapis.com/blog-images-backup/1*ldZQ29JvosNcaPjJIeAt9w.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/d850f1a213f4c7c382bf863437d60cf5.png" data-height="1678" data-width="2392" data-original-src="https://storage.googleapis.com/blog-images-backup/1*ldZQ29JvosNcaPjJIeAt9w.png"/></noscript></figure>
<p>当您查看页面源代码时，您仍然可以在服务器上看到您的标记:</p>
<figure><img decoding="async" src="../Images/121e7ba0ecbcf3b7213fc6a7b4939b19.png" data-height="1678" data-width="2392" data-lazy-src="https://storage.googleapis.com/blog-images-backup/1*-Bh7GrYFJzOcecf0T8laYg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://storage.googleapis.com/blog-images-backup/1*-Bh7GrYFJzOcecf0T8laYg.png"/><noscript><img data-lazy-fallback="1" decoding="async" src="../Images/121e7ba0ecbcf3b7213fc6a7b4939b19.png" data-height="1678" data-width="2392" data-original-src="https://storage.googleapis.com/blog-images-backup/1*-Bh7GrYFJzOcecf0T8laYg.png"/></noscript></figure>
<h3>最后的话</h3>
<p>您可能不总是需要Nuxt，但是当您需要时，您在本文中学到的知识足以让您开始使用。但是总有更多的东西要学。为此，前往<a href="https://nuxtjs.org" target="_blank" rel="noopener noreferrer"> Nuxt </a>网站了解更多的功能，如p <a href="https://nuxtjs.org/guide/plugins" target="_blank" rel="noopener noreferrer">卢金斯</a>，s <a href="https://nuxtjs.org/guide/vuex-store" target="_blank" rel="noopener noreferrer">托雷</a>等。如果有兴趣的话，我们会在以后的文章中介绍更多的评论。</p>

<p> </p><div class="code-block code-block-20">
<div class="blog-plug inline-plug vue-inline"><h2>像用户一样体验您的Vue应用</h2><p>调试Vue.js应用程序可能会很困难，尤其是当用户会话期间有几十个(如果不是几百个)突变时。如果您对监视和跟踪生产中所有用户的Vue突变感兴趣，</p><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank">try LogRocket</a><p>. </p><a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/0d269845910c723dd7df26adab9289cb.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://files.readme.io/00591d0-687474703a2f2f692e696d6775722e636f6d2f6a3049327856572e706e67.png"/></noscript></a><a href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用程序的DVR，记录你的Vue应用程序中发生的一切，包括网络请求、JavaScript错误、性能问题等等。您可以汇总并报告问题发生时应用程序的状态，而不是猜测问题发生的原因。</p><p>LogRocket Vuex插件将Vuex突变记录到LogRocket控制台，为您提供导致错误的环境，以及出现问题时应用程序的状态。</p><p>现代化您调试Vue应用的方式- <a class="signup" href="https://lp.logrocket.com/blg/vue-signup" target="_blank" rel="noopener noreferrer">开始免费监控</a>。</p></div>


</div>
<hr/>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>