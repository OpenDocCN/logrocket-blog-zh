<html>
<head>
<title>Guess.js and Gatsby site optimization - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Guess.js和Gatsby站点优化- LogRocket博客</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/guess-js-gatsby-site-optimization/#0001-01-01">https://blog.logrocket.com/guess-js-gatsby-site-optimization/#0001-01-01</a></blockquote><div><article class="article-post">
<p><a href="https://guess-js.github.io/"> Guess.js </a>是一个库和工具的集合，使用预测分析来增强用户体验。</p>
<p>虽然<a href="https://blog.logrocket.com/is-gatsby-really-that-great-e7b19c4c1c05/"> Gatsby.js开箱即可提供出色的性能优化</a>，但本文将解释如何将Guess.js集成到Gatsby站点中，以提高站点效率和UX。</p>
<h2 id="introduction">介绍</h2>
<p>Gatsby.js是一个现代的基于React的静态站点生成器(SSG)。静态站点生成器是用于创建静态站点的发布工具。这些站点主要由包含部署到服务器的HTML文件和资源的文件夹组成。</p>
<p>尽管传统的web开发栈也从数据、内容和模板生成页面，但是这个过程只在用户请求页面时才开始——在请求时。每当客户请求一个页面时，就要重复构建页面，因此，随着您的站点越来越受欢迎，页面访问量越来越大，构建页面所用的时间也会增加。这对网站的性能有负面影响。</p>
<p>另一方面，使用SSGs，页面构建过程在构建时完成。</p>
<p>通过在构建时开始页面构建，SSG体系结构防止了页面构建随着站点页面视图的增加而持续增加(在请求时)。由于所有页面都是在构建时构建的，因此服务器在响应用户的页面请求时只需发送一个文件。使用这种方法，页面浏览量的增加不会影响你的网站的性能，最终改善用户体验。</p>
<p>有不同的SSG，每种都有不同的实现方式。然而，我们上面讨论的基本原则对每一个都适用。</p>
<p>在本文中，我们将关注Gatsby.js，这是一个基于React的SSG，以其<a href="https://blog.logrocket.com/faster-page-load-times-with-link-prefetching/">速度</a>、插件和直白而闻名。</p>
<h2 id="howgatsbyjsworks">Gatsby.js如何工作</h2>
<h3 id="gatsbydevelopvsgatsbybuild"><code>gatsby develop</code>对<code>gatsby build</code></h3>
<p>Gatsby.js有两个编译站点的命令，每个命令都有不同的用例。这些命令是:</p>
<ol>
<li><code>gatsby develop</code></li>
<li><code>gatsby build</code></li>
</ol>
<p><code>gatsby develop</code>命令用于启动开发服务器，该服务器支持实时重载和<a href="https://www.gatsbyjs.com/docs/running-queries-with-graphiql/"> Gatsby GraphiQL Explorer </a>等功能。Gatsby Explorer允许开发人员在运行时与Gatsby站点和数据浏览器进行交互。</p>
<p>另一方面,<code>gatsby build</code>命令应该在你完成站点开发后运行。它创建了一个具有生产就绪优化的站点版本。当运行<code>gatsby build</code>命令时，它打包您站点的配置、数据和代码。它还创建你站点的所有静态HTML页面，然后将<a href="https://www.gatsbyjs.com/docs/glossary/#hydration">再水合</a>到React应用程序中。</p>
<p>当您运行<code>gatsby build</code>命令时，Node.js服务器在幕后驱动整个构建过程。</p>
<p>在构建时，Gatsby产生优化的静态内容(HTML、CSS、JavaScript、图像等。)通过调用服务器端API。</p>
<h3 id="serversiderenderingssr">服务器端呈现(SSR)</h3>
<p>Gatsby使用Node.js服务器从JavaScript模块生成静态HTML页面的过程被称为<a href="https://blog.logrocket.com/prefetching-dynamic-routing-next-js/">服务器端呈现</a>，或SSR。Gatsby生成我们站点的所有静态内容(HTML页面、图像等)。)并将该内容部署到服务器，然后可以在浏览器中请求和呈现该内容。</p>
<p>通过在构建时执行SSR，Gatsby能够提前构建您的整个站点(使用优化的数据和页面)。这极大地影响了站点的性能，因为服务器可以立即响应用户请求，而不需要在每次用户请求页面时都重复构建。</p>
<p>下图对此进行了详细说明:</p>
<p><img data-attachment-id="31298" data-permalink="https://blog.logrocket.com/guess-js-gatsby-site-optimization/gatsby-build-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png" data-orig-size="730,487" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Gatsby build time" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png" decoding="async" class="aligncenter size-full wp-image-31298 jetpack-lazy-image" src="../Images/1b1793f51bfe69fc093ae77c4ddfe91a.png" alt="Gatsby build time" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1-300x200.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31298" data-permalink="https://blog.logrocket.com/guess-js-gatsby-site-optimization/gatsby-build-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png" data-orig-size="730,487" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Gatsby build time" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1-300x200.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31298" src="../Images/1b1793f51bfe69fc093ae77c4ddfe91a.png" alt="Gatsby build time" srcset="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1-300x200.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/12/gatsby-build-1.png"/></noscript>
<p>Gatsby站点可以即时加载，因为服务器可以通过SSR支持的预建页面立即响应用户请求。在下一节中，我们将看看Gatsby站点如何通过使用Guess.js实现额外的性能优化。</p>
<h2 id="performanceoptimizationwithguessjs">使用Guess.js进行性能优化</h2>
<h3 id="whatisguessjs">Guess.js是什么？</h3>
<p>Guess.js是一组与框架无关的工具和库，使用智能预取增强用户体验。</p>
<p>Guess.js使用一种称为<a href="https://blog.logrocket.com/using-resource-hints-to-optimize-performance/">预测预取</a>的技术进行智能预取。它从谷歌分析(Google Analytics)等来源获取分析数据，并使用这些数据智能地预取用户最有可能请求的资源。</p>
<p>假设一个站点有以下页面:主页、关于、联系我们和新闻。我们可以使用谷歌分析来确定用户从主页访问这些页面的可能性。例如，GA可能会告诉我们，用户有96%的机会从主页访问新闻页面，但只有4%的机会访问联系我们页面。</p>
<p>在这种情况下，我们的应用程序会在用户仍在主页时预取新闻页面数据，因为用户很有可能会导航到下一个页面。另一方面，预取联系我们页面没有什么明智的理由，因为只有4%的用户会走这条路。</p>
<p>当我们将Guess.js集成到Gatsby应用程序中时，它允许我们的Gatsby应用程序下载Google Analytics数据，然后使用这些数据来形成预取哪些资源的模型。</p>
<p>在下一节中，我们将探索如何将Guess.js集成到Gatsby站点中。</p>
<h2 id="usingguessjswithgatsbyjs">将Guess.js与Gatsby.js一起使用</h2>
<p>如前所述，《盖茨比》以其直白和外挂而闻名。一如既往，将Guess.js集成到Gatsby应用程序中非常简单，只需要安装和配置另一个Gatsby <a href="https://www.gatsbyjs.com/plugins/gatsby-plugin-guess-js/">插件</a>—Gatsby-plugin-guess-js——不需要复杂的代码逻辑或webpack配置。</p>
<p>要将Guess.js添加到您的Gatsby站点，请按照以下步骤操作:</p>
<p>首先，通过运行以下命令安装gatsby-plugin-guess-js插件:</p>
<pre>npm install gatsby-plugin-guess-js</pre>
<p>或者:</p>
<pre>yarn add gatsby-plugin-guess-js</pre>
<p>然后，在您的<code>gatsby-config.js</code>中，添加插件配置，如下所示:</p>
<pre>    module.exports = { 
      plugins: [
        ...
        { 
          resolve: "gatsby-plugin-guess-js", 
          options: { 
              // Find the view id in the Goggle Analytics &gt; Admin &gt; view settings
              GAViewID: `VIEW_ID`,
          }, 
        }
        ...
      ], 
    }

</pre>
<p>(如果您愿意，您可以在这里获得更高级的配置<a href="https://www.gatsbyjs.com/plugins/gatsby-plugin-guess-js/#how-to-use">。)</a></p>
<p>接下来，通过重新启动服务器来重建应用程序:</p>
<pre>gatsby develop</pre>
<p>或者，通过构建应用程序:</p>
<pre>gatsby build</pre>
<p>最后，如果在重建期间配置成功，将要求Guess.js使用您的Google帐户授权Guess.js，以便访问构建预测预取模型所需的Google Analytics数据。</p>
<p>当Guess.js成功集成到Gatsby网站中时，<a href="https://www.gatsbyjs.com/plugins/gatsby-plugin-guess-js/"> gatsby-plugin-guess-js </a>插件下载谷歌分析数据，以创建预测预取的模型。有了这些数据，插件会在用户最有可能访问的页面上添加<code>&lt;link prefetch&gt;</code>,因为网站的HTML页面正在生成。</p>
<p>当用户使用你的网站或应用程序时，插件将继续预测和预取用户最有可能访问的页面资源，从而提高你的网站性能和用户体验。</p>
<h2 id="conclusion">结论</h2>
<p>Guess.js是一个革命性的、与框架无关的性能优化工具。它通过机器学习和用户行为分析，为Gatsby网站带来了预测性预取。通过更好地理解用户的旅程，Guess.js可以帮助你提高网站的速度和用户的整体体验。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>