<html>
<head>
<title>Handling images with Cloudinary in React - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在React - LogRocket博客中用Cloudinary处理图像</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/#0001-01-01">https://blog.logrocket.com/handling-images-with-cloudinary-in-react/#0001-01-01</a></blockquote><div><article class="article-post">
<h2>介绍</h2>
<p>有时，在处理需要使用图像的应用程序时，将图像上传到服务器这样的简单过程会变得很困难。有了Cloudinary，我们可以直接从前端上传和管理我们的图像。在这篇博文中，我们将看看如何使用Cloudinary在React应用程序中处理图像。</p>
<h2>先决条件</h2>
<ul>
<li>JavaScript的基础知识</li>
<li>React的基础知识</li>
<li>您机器上安装的最新版本<a href="https://nodejs.org/en/" target="_blank" rel="noopener noreferrer"> Node.js </a></li>
<li>一个终端比如<a href="https://iterm2.com/" target="_blank" rel="noopener noreferrer">iterm 2</a>(Mac OS)<a href="https://git-scm.com/downloads" target="_blank" rel="noopener noreferrer">Git bash</a>(Windows)</li>
<li>一笔不清不楚的帐</li>
</ul>
<h2>创建云账户</h2>
<p>Cloudinary是一个基于云的图像和视频管理平台，工程团队和开发人员都使用它来管理应用程序中的媒体资产(图像、视频)。在我们继续之前，如果您还没有Cloudinary帐户，请花一分钟时间在此处创建您的cloud inary帐户。我们将使用Cloudinary来存储和检索我们上传的图像。</p>
<h2>设置React</h2>
<p>在这个项目中，我们将建立一个小型React应用程序来演示如何使用Cloudinary处理React中的图像。</p>
<p>运行以下命令，使用您选择的终端在几秒钟内创建您的React应用程序:</p>
<pre>npx create-react-app react-image-app</pre>
<p>当这个操作完成后，你应该会在你的终端中得到类似如下的结果:<img data-attachment-id="18111" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/resultfromterminalwindow/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png" data-orig-size="730,456" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="resultfromterminalwindow" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow-300x187.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png" decoding="async" class="aligncenter size-full wp-image-18111 jetpack-lazy-image" src="../Images/0b86dbd13d174adeef75b6e264467ab8.png" alt="Result from terminal window on a successful app creation" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow-300x187.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18111" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/resultfromterminalwindow/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png" data-orig-size="730,456" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="resultfromterminalwindow" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow-300x187.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18111" src="../Images/0b86dbd13d174adeef75b6e264467ab8.png" alt="Result from terminal window on a successful app creation" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow-300x187.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/resultfromterminalwindow.png"/></noscript> Run this command to change the current directory to your newly created React app and start it up:
<pre>cd react-image-app &amp;&amp; npm start</pre>
<p>您应该会在默认浏览器上看到这个屏幕:</p>
<p><img data-attachment-id="18113" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/homepage/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png" data-orig-size="730,436" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="homepage" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage-300x179.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png" decoding="async" class="aligncenter size-full wp-image-18113 jetpack-lazy-image" src="../Images/4cfd5a341c46f9dd05f814e18204f152.png" alt="home page" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/homepage-300x179.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18113" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/homepage/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png" data-orig-size="730,436" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="homepage" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage-300x179.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18113" src="../Images/4cfd5a341c46f9dd05f814e18204f152.png" alt="home page" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/homepage-300x179.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/homepage.png"/></noscript>
<p>现在我们已经启动并运行了React应用程序，让我们编辑它以包含一个输入字段和一个显示图像的位置。</p>
<p>打开您喜欢的编辑器，用以下内容替换<code>/src/App.js</code>的内容:</p>
<pre>import React from 'react';
import './App.css';

class App extends React.Component{
  state = {
    imageUrl: null,
    imageAlt: null,
  }

  render() {
    const { imageUrl, imageAlt } = this.state;

    return (
      &lt;main className="App"&gt;
        &lt;section className="left-side"&gt;
          &lt;form&gt;
            &lt;div className="form-group"&gt;
              &lt;input type="file"/&gt;
            &lt;/div&gt;

            &lt;button type="button" className="btn" onClick={this.handleImageUpload}&gt;Submit&lt;/button&gt;
            &lt;button type="button" className="btn widget-btn"&gt;Upload Via Widget&lt;/button&gt;
          &lt;/form&gt;
        &lt;/section&gt;
        &lt;section className="right-side"&gt;
          &lt;p&gt;The resulting image will be displayed here&lt;/p&gt;
          {imageUrl &amp;&amp; (
            &lt;img src={imageUrl} alt={imageAlt} className="displayed-image"/&gt;
          )}
        &lt;/section&gt;
      &lt;/main&gt;
    );
  }
}

export default App;</pre>
<p>上面这段代码在React中返回一个类组件。该组件呈现一个界面，我们可以上传图像。</p>
<p>在第5行，我们将图像的URL和替代消息设置为<code>null</code>，因为我们没有这些图像属性的任何默认值。在第26行，我们使用<code>&amp;&amp;</code>操作符编写了一个条件渲染。这类似于内联if else语句，不同之处在于，如果表达式解析为false，则不会向接口呈现任何内容。在这种情况下，如果没有图像的URL，将不会呈现图像标记。</p>
<p>从第15-24行，我们看到界面的左侧有一个<code>file</code>类型的输入字段，用于从您的设备上传文件类型，如Pdf、图像、音频、视频等。我们还为名为<code>handleImageUpload</code>的按钮定义了一个<code>onClick</code>函数，该按钮目前不做任何事情。</p>
<p>目前的结果如下所示:</p>
<p><img data-attachment-id="18118" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/onclickresult/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png" data-orig-size="730,433" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="onclickresult" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png" decoding="async" class="aligncenter size-full wp-image-18118 jetpack-lazy-image" src="../Images/2189820178ba5b06e9bd2320298f4178.png" alt="" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18118" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/onclickresult/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png" data-orig-size="730,433" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="onclickresult" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18118" src="../Images/2189820178ba5b06e9bd2320298f4178.png" alt="" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/onclickresult.png"/></noscript>
<p>这目前看起来并不美观，所以让我们用CSS添加一些样式。继续将<code>/src/App.css</code>的内容替换为:</p>
<pre>.App {
  text-align: center;
  max-width: 100vw;
  min-height: 100vh;
  max-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

.App .left-side {
  display: flex;
  justify-content: center;
  align-items: center;
  border-right: .5px solid grey;
}

.App .right-side {
  border-left: .5px solid grey;
}

.App .left-side,
.App .right-side {
  height: 300px;
  width: 100%;
}

.App .left-side form {
  height: fit-content;
  background: white;
  border: 1px solid grey;
  border-radius: 4px;
  width: 300px;
  padding: 40px 10px;
}

.App .left-side form input {
  margin: 0 0 30px;
  width: 200px;
}

.App .left-side form .btn {
  height: 40px;
  width: 200px;
  background: white;
  border: 1px solid grey;
  cursor: pointer;
  border-radius: 4px;
}

.App .left-side form .btn:hover {
  color: white;
  background: grey;
}

.App .left-side form .btn:focus {
  box-shadow: none;
  outline: none;
}

.App .left-side form .btn.widget-btn {
  margin-top: 15px;
  background: #800080;
  border: 1px solid #800080;
  color: #FFFFFF;
}

.App .left-side form .btn.widget-btn:hover {
  margin-top: 15px;
  background: #4B0082;
  border: 1px solid #4B0082;
  color: #FFFFFF;
}

.App .right-side .displayed-image {
  height: 300px;
  width: 300px;
}</pre>
<p>这里我们使用CSS <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox" target="_blank" rel="noopener noreferrer"> Flexbox </a>，在屏幕上正确排列元素。我们还为按钮添加了背景颜色和悬停效果。现在，您在<code><a href="http://localhost:3000/" target="_blank" rel="noopener noreferrer">http://localhost:3000/</a></code>上的应用程序应该如下所示:</p>
<p><img data-attachment-id="18123" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/visual-output-of-setup/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Visual Output of setup" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png" decoding="async" class="aligncenter size-full wp-image-18123 jetpack-lazy-image" src="../Images/5c31b6d784bbd867b655c5d034a7e41e.png" alt="Visual Output of setup" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18123" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/visual-output-of-setup/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Visual Output of setup" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18123" src="../Images/5c31b6d784bbd867b655c5d034a7e41e.png" alt="Visual Output of setup" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/Visual-Output-of-setup.png"/></noscript>
<p>现在我们有了界面设置，让我们来谈谈如何通过Cloudinary处理图像。</p>
<h2>通过Cloudinary端点处理图像</h2>
<p>在这个方法中，我们将通过向Cloudinary端点发送POST请求来将图像上传到Cloudinary。这将上传图像并返回一个响应对象给我们。让我们来看看。</p>
<p>首先，我们将编写一些JavaScript代码来从我们的设备中获取选定的图像。如果你看一下第17行的<code>/src/App.js</code>，你会注意到我们调用了一个名为<code>handleImageUpload()</code>的函数。这个函数将处理通过端点上传到Cloudinary的图像。</p>
<p><strong>步骤1 </strong>:在App函数中的return语句之前添加这段代码:</p>
<pre>handleImageUpload = () =&gt; {
  const { files } = document.querySelector('input[type="file"]')
  console.log('Image file', files[0])
}</pre>
<p>该函数查询文档以获取第一个具有文件类型的输入元素，然后从结果对象中解结构files数组，最后将数组的第一个元素记录到控制台的结果中。这段代码可以扩展成类似这样:</p>
<pre>handleImageUpload = () =&gt; {
  // get the first input element with the type of file,
  const imageFile = document.querySelector('input[type="file"]')
  // destructure the files array from the resulting object
  const files = imageFile.files
  // log the result to the console
  console.log('Image file', files[0])
}</pre>
<p><a href="https://exploringjs.com/es6/ch_destructuring.html" target="_blank" rel="noopener noreferrer">析构</a>是一种从存储在(可能是嵌套的)对象和数组中的数据提取多个值的便捷方式。</p>
<p>如果我们打开浏览器，选择图像文件，然后单击上传按钮，我们应该会看到类似这样的内容:</p>
<p><img data-attachment-id="18127" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/uploadbutton/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uploadbutton" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png" decoding="async" class="aligncenter size-full wp-image-18127 jetpack-lazy-image" src="../Images/fc792250d6080ed5d9869f6892c7bdc6.png" alt="upload button in browser" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18127" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/uploadbutton/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uploadbutton" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18127" src="../Images/fc792250d6080ed5d9869f6892c7bdc6.png" alt="upload button in browser" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadbutton.png"/></noscript>
<p>我们可以看到<code>file</code>对象被记录到我们的控制台。该对象包含各种数据，如文件名、文件大小、文件类型等。</p>
<p><strong>步骤2 </strong>:我们将向Cloudinary端点发送一个post请求，其中包含从上面的函数中获得的file对象。</p>
<p>基本云二进制API端点如下所示:</p>
<p><code><a href="https://api.Cloudinary.com/v1_1/:cloud_name/:action" rel="nofollow">https://api.Cloudinary.com/v1_1/:cloud_name/:action</a></code></p>
<p><code>:cloud_name</code>可从您的Cloudinary仪表盘获得:</p>
<p><img data-attachment-id="18132" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/cloudinary-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary.png" data-orig-size="1282,662" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cloudinary" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-300x155.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-1024x529.png" decoding="async" class="aligncenter size-full wp-image-18132 jetpack-lazy-image" src="../Images/5ba0c04f28c3ba415778a0ec529b9727.png" alt="" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary.png 1282w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-300x155.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-1024x529.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-768x397.png 768w" data-lazy-sizes="(max-width: 1282px) 100vw, 1282px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18132" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/cloudinary-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary.png" data-orig-size="1282,662" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cloudinary" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-300x155.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-1024x529.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18132" src="../Images/5ba0c04f28c3ba415778a0ec529b9727.png" alt="" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary.png 1282w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-300x155.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-1024x529.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary-768x397.png 768w" sizes="(max-width: 1282px) 100vw, 1282px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinary.png"/></noscript>
<p>而URL中的<code>:action</code>参数表示您想要执行的任何操作，例如上传图像的<code>/image/upload</code>。API URL示例如下所示:</p>
<p><code><a href="https://api.Cloudinary.com/v1_1/john1234/image/upload" rel="nofollow">https://api.Cloudinary.com/v1_1/john1234/image/upload</a></code></p>
<p>其中<code>:cloud_name</code>是<code>john1234</code>，<code>:action</code>是<code>/image/upload</code>。</p>
<p>我们现在需要设置的最后一件事是上传预置。上传预设允许您定义上传的默认行为。您可以通过在Cloudinary仪表板中导航到“设置”,然后导航到“上传”来添加上传预设。完成后，您应该会看到这样的内容:</p>
<p><img data-attachment-id="18135" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/uploadpreset/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uploadpreset" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png" decoding="async" class="aligncenter size-full wp-image-18135 jetpack-lazy-image" src="../Images/3be42ba161c4c0d87b58c5a09b8c662e.png" alt="upload preset" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18135" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/uploadpreset/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uploadpreset" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18135" src="../Images/3be42ba161c4c0d87b58c5a09b8c662e.png" alt="upload preset" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadpreset.png"/></noscript>
<p>现在是时候编写代码，用所有必要的数据将POST请求发送到我们的端点。</p>
<p>用以下代码替换您的<code>handleImageUpload()</code>函数中的代码:</p>
<pre>const { files } = document.querySelector('input[type="file"]')
const formData = new FormData();
formData.append('file', files[0]);
// replace this with your upload preset name
formData.append('upload_preset', 'qv5rfbwg');
const options = {
  method: 'POST',
  body: formData,
};

// replace cloudname with your Cloudinary cloud_name
return fetch('https://api.Cloudinary.com/v1_1/:cloud_name/image/upload', options)
  .then(res =&gt; res.json())
  .then(res =&gt; console.log(res))
  .catch(err =&gt; console.log(err));</pre>
<p>将第12行的cloud_name替换为您自己的Cloudinary cloud_name。这可以从您的Cloudinary仪表盘获得:</p>
<p><img data-attachment-id="18138" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/cloudinarydashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard.png" data-orig-size="1282,662" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cloudinarydashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-300x155.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-1024x529.png" decoding="async" class="aligncenter size-full wp-image-18138 jetpack-lazy-image" src="../Images/24d2417f9d4470e334bf84fb527a6773.png" alt="cloudinary dashboard" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard.png 1282w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-300x155.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-1024x529.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-768x397.png 768w" data-lazy-sizes="(max-width: 1282px) 100vw, 1282px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18138" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/cloudinarydashboard/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard.png" data-orig-size="1282,662" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cloudinarydashboard" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-300x155.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-1024x529.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18138" src="../Images/24d2417f9d4470e334bf84fb527a6773.png" alt="cloudinary dashboard" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard.png 1282w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-300x155.png 300w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-1024x529.png 1024w, https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard-768x397.png 768w" sizes="(max-width: 1282px) 100vw, 1282px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/cloudinarydashboard.png"/></noscript>
<p>替换您在步骤2结束时设置的上传预设。用您的上传预设名称替换上面第4行中的虚拟预设。这可以在您的Cloudinary控制面板的“设置”的“上传”部分找到，要到达那里，请单击您的Cloudinary控制面板右上角的齿轮图标:</p>
<p><img data-attachment-id="18140" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/step2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png" data-orig-size="730,109" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="step2" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/step2-300x45.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png" decoding="async" class="aligncenter size-full wp-image-18140 jetpack-lazy-image" src="../Images/fbf250cdaa25c6b6327cbff200d56598.png" alt="" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/step2-300x45.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18140" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/step2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png" data-orig-size="730,109" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="step2" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/step2-300x45.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18140" src="../Images/fbf250cdaa25c6b6327cbff200d56598.png" alt="" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/step2-300x45.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/step2.png"/></noscript>
<p>然后点击设置页面上的<code>Upload</code>选项卡:</p>
<p><img data-attachment-id="18141" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/uploadtab/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png" data-orig-size="730,255" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uploadtab" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab-300x105.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png" decoding="async" class="aligncenter size-full wp-image-18141 jetpack-lazy-image" src="../Images/b96928a63649bce6d23e24df8daede8c.png" alt="upload tab on settings page" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab-300x105.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18141" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/uploadtab/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png" data-orig-size="730,255" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uploadtab" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab-300x105.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18141" src="../Images/b96928a63649bce6d23e24df8daede8c.png" alt="upload tab on settings page" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab-300x105.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadtab.png"/></noscript>
<p>向下滚动到页面底部有上传预设的地方，您应该会看到您的上传预设，或者如果您没有任何预设，可以选择添加新的预设。</p>
<p>我们可以在浏览器中打开React应用程序，上传一张图片，我们应该会看到类似这样的内容:</p>
<p><img data-attachment-id="18143" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/uploadresult/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uploadresult" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png" decoding="async" class="aligncenter size-full wp-image-18143 jetpack-lazy-image" src="../Images/26d9757498d7027046c35a18de361903.png" alt="upload result" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18143" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/uploadresult/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uploadresult" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18143" src="../Images/26d9757498d7027046c35a18de361903.png" alt="upload result" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/uploadresult.png"/></noscript>
<p>在这里，我们可以看到我们的图像已经成功上传，并且已经向我们返回了响应。要确认图像已上传，您可以继续复制<code>secure_url</code>的值，并将其粘贴到新选项卡的地址栏中，您将看到您上传的图像。</p>
<p><strong>步骤3 </strong>:这里我们将在React应用程序的右侧显示我们上传的结果。为此，我们将用以下代码块替换将上传图像的结果记录到控制台的代码:</p>
<pre>// Replace
.then(res =&gt; console.log(res))

// with this
.then(res =&gt; {
    this.setState({
      imageUrl: res.secure_url,
      imageAlt: `An image of ${res.original_filename}`
    })
  })</pre>
<p>上传另一张图片，你的结果应该是这样的:<br/> <img data-attachment-id="18146" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/upload2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="upload2" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png" decoding="async" class="aligncenter size-full wp-image-18146 jetpack-lazy-image" src="../Images/f45d3a7c367eeb2a5295edd350a814a8.png" alt="second image uploaded " data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/upload2-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18146" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/upload2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="upload2" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18146" src="../Images/f45d3a7c367eeb2a5295edd350a814a8.png" alt="second image uploaded " srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/upload2-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/upload2.png"/></noscript>To confirm this you can go to your Cloudinary media library from your Cloudinary dashboard and see all your uploads.
<h2>通过Cloudinary小工具处理图像</h2>
<p>在这个方法中，我们将调用一个名为<em> Upload Widget </em>的Cloudinary widget，并让它为我们处理图像。有了这个Cloudinary小工具，我们几乎可以从各个地方上传图片，比如Dropbox、脸书、Instagram，我们甚至可以用它拍照。听起来很有趣？让我们开始吧。</p>
<p>步骤1:这里我们将把小部件的远程JavaScript文件包含在位于<code>public/index.html</code>的索引HTML文件中。我们将使用位于结束的<code>body</code>标签上方的<code>script</code>标签来包含该文件:</p>
<pre>&lt;script
  src="https://widget.Cloudinary.com/v2.0/global/all.js"
  type="text/javascript"
&gt;&lt;/script&gt;</pre>
<p><strong>第二步</strong>:我们将创建一个小部件，点击后打开它。这两个动作将被包装在一个函数中。</p>
<pre>// ...
openWidget = () =&gt; {
  // create the widget
  window.Cloudinary.createUploadWidget(
    {
      cloudName: 'john',
      uploadPreset: 'qv5rfbwg',
    },
    (error, result) =&gt; {
      this.setState({
        imageUrl: result.info.secure_url,
        imageAlt: `An image of ${result.info.original_filename}`
      })
    },
  ).open(); // open up the widget after creation
};

//...</pre>
<p>这段代码应该放在渲染函数的上面。我们还使用了之前方法中的相同信息，如<code>cloud_name</code>和<code>uploadPreset</code>。打开小工具的功能被添加到<code>createUploadWidget()</code>中。或者，您可以这样编写这个函数:</p>
<pre>// ...
openWidget = () =&gt; {
  // create the widget
  const widget = window.Cloudinary.createUploadWidget(
    {
      cloudName: 'john',
      uploadPreset: 'qv5rfbwg',
    },
    (error, result) =&gt; {
      if (result.event === 'success') {
        this.setState({
          imageUrl: result.info.secure_url,
          imageAlt: `An image of ${result.info.original_filename}`
        })
      }
    },
  );
  widget.open(); // open up the widget after creation
};

//...</pre>
<p>无论哪种方式，小部件都将在创建后立即创建并打开。</p>
<p>当紫色按钮被点击时，我们将调用这个函数。用<code>widget-btn</code>代码的类更新你的按钮，如下所示:</p>
<pre>&lt;button type="button" className="btn widget-btn" onClick={this.openWidget}&gt;Upload Via Widget&lt;/button&gt;</pre>
<p>现在，当您在浏览器中单击React应用程序上的小部件按钮时，您应该会看到类似如下的内容:</p>
<p><img data-attachment-id="18151" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/an-open-cloudinary-upload-widget/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="An open Cloudinary upload widget" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png" decoding="async" class="aligncenter size-full wp-image-18151 jetpack-lazy-image" src="../Images/89e809092ea7da2d4eccb036dd607aff.png" alt="An open Cloudinary upload widget" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18151" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/an-open-cloudinary-upload-widget/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="An open Cloudinary upload widget" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18151" src="../Images/89e809092ea7da2d4eccb036dd607aff.png" alt="An open Cloudinary upload widget" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/An-open-Cloudinary-upload-widget.png"/></noscript>
<p>它的美妙之处在于，您可以定制您的小部件来满足您的需求。要做到这一点，请访问此<a href="https://cloudinary.com/documentation/upload_widget#look_and_feel_customization" target="_blank" rel="noopener noreferrer">页面</a>了解更多关于小部件定制的详细信息。</p>
<p>您可以上传您的图像，并观看它显示在React应用程序的右侧:</p>
<p><img data-attachment-id="18153" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/finaldisplay/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="finaldisplay" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png" decoding="async" class="aligncenter size-full wp-image-18153 jetpack-lazy-image" src="../Images/cc8822ab906a389b0ebf0f7601bafe25.png" alt="final display" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay-300x178.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="18153" data-permalink="https://blog.logrocket.com/handling-images-with-cloudinary-in-react/finaldisplay/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png" data-orig-size="730,434" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="finaldisplay" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay-300x178.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-18153" src="../Images/cc8822ab906a389b0ebf0f7601bafe25.png" alt="final display" srcset="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay-300x178.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/05/finaldisplay.png"/></noscript>
<h2>结论</h2>
<p>Cloudinary使我们处理图像变得非常容易，尤其是使用Cloudinary小部件。这个项目的代码也可以在这个<a href="https://github.com/NedyUdombat/react-image-app" target="_blank" rel="noopener noreferrer">资源库</a>中找到，供你参考。</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
 </a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>