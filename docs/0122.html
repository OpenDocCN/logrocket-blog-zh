<html>
<head>
<title>Getting started with D3.js and React - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>D3.js和React - LogRocket博客入门</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/getting-started-d3-js-react/#0001-01-01">https://blog.logrocket.com/getting-started-d3-js-react/#0001-01-01</a></blockquote><div><article class="article-post">
<p><strong> <em>编者按:</em> </strong> <em>本文最后更新于2022年12月14日，以反映D3.js v7中的更改。</em></p>
<p>React和D3.js都是JavaScript库，使开发人员能够创建引人入胜、可重用的数据可视化，如面积图、折线图、气泡图等。</p>
<p>尽管React和D3在前端开发人员中是非常受欢迎的一对，但这两个库在一起使用可能会很有挑战性。在本文中，我们将介绍如何在React中使用D3，讨论为什么应该使用D3，并演示如何在React中用D3创建图表。</p>
<p>我们将详细介绍以下内容:</p>

<h2 id="what-d3-js-react">D3.js和React是什么？</h2>
<p><a href="https://d3js.org/"> D3.js </a>是一个JavaScript库，用于使用HTML、CSS和SVG创建<a href="https://blog.logrocket.com/data-visualization-angular-d3-js/">动态、交互式数据可视化</a>。D3将数据绑定到DOM及其元素，使您能够通过更改数据来操作可视化。在撰写本文时，最新的版本是<a href="https://github.com/d3/d3/releases/tag/v7.7.0"> D3.js v7.7 </a>。</p>
<p>虽然D3对web标准的关注使您能够利用现代浏览器的全部功能，而不会将自己限制在专有框架中，但D3.js和React通常一起使用，以实现动态数据可视化。</p>
<p>React是一个开源的前端JavaScript库，用于构建复杂的用户界面和UI组件。它是一个声明性的、高效的、灵活的框架，允许您构建由简单的、可重用的组件组成的复杂ui。这些组件能够自己保持它们的状态。</p>
<p>要获得帮助您开始使用React和D3.js的可视化指南，请查看下面的视频教程:</p>
<p><span class="embed-youtube"> <iframe loading="lazy" class="youtube-player" src="https://www.youtube.com/embed/YKDIsXA4OAc?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation">视频</iframe> </span></p>
<h2 id="why-use-d3-js">为什么要用D3.js？</h2>
<p>数据可视化有助于您使用形状、线条和颜色清晰高效地交流信息。web上有许多数据可视化工具，但D3.js赢得了无数前端开发人员的信任，使其成为JavaScript中数据可视化的事实上的选择。</p>
<p><a href="https://blog.logrocket.com/creating-visualizations-d3-typescript/"> D3.js速度极快，支持大型数据集</a>和动态行为，使您能够使用动画和其他引人注目的功能来促进用户交互。</p>
<h2 id="how-use-d3-js-react">如何在React中使用D3.js</h2>
<p>D3.js和React一起使用可能很有挑战性，因为两个库都想处理DOM。它们都控制UI元素，并且以不同的方式控制。</p>
<p>在本文中，我们将学习如何通过使用两个库构建一个简单的条形图来充分利用React和D3的独特优势。首先，我们需要安装React和D3。你可以在GitHub 上找到<a href="https://github.com/rosdec/react-d3">完成的应用的完整代码。</a></p>
<h3 id="setting-up-react">设置React</h3>
<p>为了设置React，我们将使用<a href="https://create-react-app.dev/"> Create React App </a>样板文件。运行以下代码，将其全局安装到本地计算机上，以便可以重用:</p>
<pre>npm install -g create-react-app
</pre>
<p>接下来，我们将使用<code>create-react-app</code>模板创建一个新的应用程序。务必使用React的<a href="https://blog.logrocket.com/using-strict-mode-react-18-guide-new-behaviors/">最新版本，在撰写本文时是版本18 </a>。请随意将<code>react-d3</code>更改为项目目录的不同名称:</p>
<pre>create-react-app react-d3
</pre>
<p>在新创建的项目中更改目录:</p>
<pre>cd react-d3
</pre>
<h3 id="setting-up-d3-js">设置D3.js</h3>
<p>您可以使用CDN或通过npm安装将D3.js库添加到您的应用程序中，如下所示。正如所料，这将安装D3.js的最新稳定版本，在撰写本文时为v7.7:</p>
<pre>npm install d3
</pre>
<p>现在，我们可以开始使用D3在React中创建数据可视化。要在默认浏览器上预览刚刚创建的应用程序，请运行以下代码:</p>
<pre>npm start
</pre>
<p>上面的命令还将启用web应用程序的热重新加载，这在修改代码时非常有用。</p>
<h2 id="make-chart-react-d3-js">如何在React中用D3.js制作图表</h2>
<p>用您喜欢的文本编辑器打开新创建的项目，并导航到<code>src/App.js</code>，这是当前在浏览器中呈现的组件。我们需要删除由<code>App()</code>方法返回的内容，这是您的web应用程序的主要入口点，以便我们可以用自己的内容替换它。</p>
<p>现在，让我们添加以下代码:</p>
<pre>import BarChart from './BarChart'

const App = () =&gt; {
    return ( &lt;BarChart /&gt; )
}
export default App;
</pre>
<p><code>&lt;BarChart&gt;</code>标签是收集条形图的组件，而<code>BartChart.js</code>是呈现条形图的地方。在<code>src</code>文件夹中，创建一个名为<code>BarChart.js</code>的新JavaScript文件。</p>
<h2 id="setting-up-bar-chart-d3-js-react">用D3.js和React建立条形图</h2>
<p>首先，将以下代码添加到<code>BarChart.js</code>文件中:</p>
<pre>import React, {Component} from 'react';
import * as d3 from "d3";

class BarChart extends Component {

}

export default BarChart;
</pre>
<p>为了在DOM中挂载了<code>BarChart</code>组件时显示条形图，我们将使用<a href="https://reactjs.org/docs/react-component.html"> <code>ComponentDidMount</code>生命周期方法</a>。</p>
<p>接下来，将以下代码添加到<code>BarChart</code>组件中:</p>
<pre>class BarChart extends Component {

  componentDidMount() {
    this.drawChart();
  }
}
</pre>
<p>是我们将执行所有D3.js魔术的方法。通常，在不使用React的情况下使用D3.js时，您不必将D3.js代码放在方法中，但是在React中，这一步很重要，可以确保只有当组件已经安装在DOM上时，图表才会显示。</p>
<p>接下来，我们将如下创建<code>drawChart</code>方法:</p>
<pre>drawChart() {

  const data = [12, 5, 6, 6, 9, 10];

  const svg = d3.select("body").append("svg").attr("width", 700).attr("height", 300);

}
</pre>
<p>首先，我们定义了<code>data</code>变量，它包含了我们想要可视化的数据。接下来，我们使用D3.js方法定义一个SVG。我们使用<a href="https://blog.logrocket.com/how-to-use-svgs-in-react/"> SVG是因为它是可扩展的</a>，这意味着无论屏幕有多大，或者你放大多少来查看数据，它都不会出现像素化。</p>
<p>我们使用<code>d3.select()</code>从文档中选择一个HTML元素。它选择与传递的参数匹配的第一个元素，并为其创建一个节点。在本例中，我们传递了<code>body</code>元素，稍后我们将对其进行更改，以使组件更加可重用。</p>
<p><code>append()</code>方法将一个HTML节点附加到选中的项目上，并返回该节点的句柄。我们使用<code>attr</code>方法向元素添加属性，这些属性可以是通常添加到HTML元素的任何属性，比如<code>class</code>、<code>height</code>、<code>width</code>或<code>fill</code>。</p>
<p>然后，我们用<code>width: 700</code>和<code>height: 300</code>将一个SVG元素附加到<code>body</code>元素上。在我们创建的SVG变量下，添加以下代码:</p>
<pre>svg.selectAll("rect").data(data).enter().append("rect")
</pre>
<p>就像<code>select</code>方法一样，<code>selectAll()</code>选择与传递给它的参数相匹配的元素。因此，匹配参数的所有元素都会被选中，而不仅仅是第一个元素。</p>
<p>接下来，我们使用<code>data()</code>方法将作为参数传递的数据附加到所选的HTML元素。通常，这些元素是找不到的，因为大多数可视化处理的是动态数据，而且几乎不可能估计将要表示的数据量。</p>
<p><code>enter()</code>方法将我们从瓶颈中解救出来，因为它与<code>append</code>方法一起使用来创建丢失的节点，并且仍然可视化数据。</p>
<h3 id="visualizing-data">可视化数据</h3>
<p>到目前为止，我们已经为数组中的每个数据点创建了节点。剩下的就是让它可见。为此，我们需要为数据数组中的每个点创建一个条形，设置宽度，并动态更新每个条形的高度。</p>
<p><code>attr</code>方法允许我们使用回调函数来处理动态数据:</p>
<pre>selection.attr("property", (d, i) =&gt; {})
</pre>
<p>在上一行中，<code>d</code>代表数据点值，<code>i</code>是数组的数据点索引。</p>
<p>首先，我们需要在条形图的x轴和y轴上的特定点设置每个数据点。我们使用<code>x</code>和<code>y</code>属性来实现这一点，其中<code>x</code>表示横条沿x轴的位置，而<code>y</code>表示横条沿y轴的位置。</p><div class="code-block code-block-54">
<hr/>
<h3>更多来自LogRocket的精彩文章:</h3>

<hr/></div>
<p>我们还需要设置每个数据点的宽度和高度。每个数据点的宽度是恒定的，因为条形的宽度相同。另一方面，高度取决于每个数据点的值。要让条形图显示每个数据点的值，我们必须使用回调函数。</p>
<p>我们将修改我们的SVG变量如下:</p>
<pre>svg.selectAll("rect")
  .data(data)
  .enter()
  .append("rect")
  .attr("x", (d, i) =&gt; i * 70)
  .attr("y", 0)
  .attr("width", 65)
  .attr("height", (d, i) =&gt; d)
  .attr("fill", "green");
</pre>
<p>对于<code>x</code>，数组中数据点的每个索引都乘以一个常量整数<code>70</code>，以将每个条形的位置移动70°，而<code>y</code>有一个常量值，我们稍后会更改。</p>
<p>宽度也有一个常量值65，它小于图表上每个元素的位置，在每个元素之间创建一个空间。条形的高度取决于数据集中每个条目的值。</p>
<h3 id="manipulating-data-d3-js-react">用D3.js和React操作数据</h3>
<p>现在，我们已经创建了一个条形图。然而，我们有两个问题。首先，图表中的条形很小，图表也是倒置的。</p>
<p>为了解决这些问题，我们将每个数据乘以一个常量值，比如说10，以在不影响数据的情况下增加每个条形的大小:</p>
<pre>.attr("height", (d, i) =&gt; d * 10)
</pre>
<figure id="attachment_152764" aria-describedby="caption-attachment-152764" class="wp-caption aligncenter"><img data-attachment-id="152764" data-permalink="https://blog.logrocket.com/d3-react-bar-chart-magnified-inverted/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png" data-orig-size="720,296" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="d3-react-bar-chart-magnified-inverted" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted-300x123.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png" decoding="async" class="wp-image-152764 size-full jetpack-lazy-image" src="../Images/3724506bd5843fb5f712f997659100b9.png" alt="D3 React Bar Chart Magnified Inverted" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png 720w, https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted-300x123.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="152764" data-permalink="https://blog.logrocket.com/d3-react-bar-chart-magnified-inverted/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png" data-orig-size="720,296" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="d3-react-bar-chart-magnified-inverted" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted-300x123.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png" decoding="async" loading="lazy" class="wp-image-152764 size-full" src="../Images/3724506bd5843fb5f712f997659100b9.png" alt="D3 React Bar Chart Magnified Inverted" srcset="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png 720w, https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted-300x123.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-magnified-inverted.png"/></noscript><figcaption id="caption-attachment-152764" class="wp-caption-text">D3.js and React bar chart magnified and inverted</figcaption></figure>
<p>接下来，我们需要解决酒吧被倒置的问题。但在此之前，我们先来了解一下为什么图表是倒置的。</p>
<p>SVG的位置是从上到下的，所以使用<code>0</code>的<code>y</code>属性将每个条放在SVG元素的顶部边缘。</p>
<p>要解决这个问题，从SVG元素的高度中减去每个条的高度。请注意<code>10 * d</code>是我们之前计算得到的高度:</p>
<pre>.attr("y", (d, i) =&gt; 300 - 10 * d)
</pre>
<p>将所有这些放在一起，<code>BarChart</code>组件如下所示:</p>
<pre>import React, { Component } from 'react'
import * as d3 from 'd3'

class BarChart extends Component {
    componentDidMount() {
        this.drawChart();
    }
    drawChart() {
        const data = [12, 5, 6, 6, 9, 10];

        const svg = d3.select("body")
                    .append("svg")
                    .attr("width", 700)
                    .attr("height", 300);

        svg.selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("x", (d, i) =&gt; i * 70)
            .attr("y", (d, i) =&gt; 300 - 10 * d)
            .attr("width", 65)
            .attr("height", (d, i) =&gt; d * 10)
            .attr("fill", "green");
    }
    render() {
        return &lt;div id={"#" + this.props.id}&gt;&lt;/div&gt;
    }
}
export default BarChart;
</pre>
<figure id="attachment_152766" aria-describedby="caption-attachment-152766" class="wp-caption aligncenter"><img data-attachment-id="152766" data-permalink="https://blog.logrocket.com/d3-react-bar-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png" data-orig-size="720,443" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="d3-react-bar-chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-300x185.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png" decoding="async" class="wp-image-152766 size-full jetpack-lazy-image" src="../Images/9cfbdd8ee34ebf688b429341645911a4.png" alt="D3 React Bar Chart" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png 720w, https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-300x185.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="152766" data-permalink="https://blog.logrocket.com/d3-react-bar-chart/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png" data-orig-size="720,443" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="d3-react-bar-chart" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-300x185.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png" decoding="async" loading="lazy" class="wp-image-152766 size-full" src="../Images/9cfbdd8ee34ebf688b429341645911a4.png" alt="D3 React Bar Chart" srcset="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png 720w, https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-300x185.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart.png"/></noscript><figcaption id="caption-attachment-152766" class="wp-caption-text">D3.js and React bar chart</figcaption></figure>
<p>现在，我们有了一个基本的条形图。让我们更进一步，添加一些标签。</p>
<h3 id="adding-labels-bar-chart">向条形图添加标签</h3>
<p>要添加标签，请将以下代码添加到<code>drawChart</code>函数中:</p>
<pre>        svg.selectAll("text")
            .data(data)
            .enter()
            .append("text")
            .text((d) =&gt; d)
            .attr("x", (d, i) =&gt; i * 70)
            .attr("y", (d, i) =&gt; 300 - (10 * d) - 3)
</pre>
<p>这类似于我们对条形所做的，但是这一次，<code>text</code>被追加。条形图现在应该如下所示:</p>
<figure id="attachment_152768" aria-describedby="caption-attachment-152768" class="wp-caption aligncenter"><img data-attachment-id="152768" data-permalink="https://blog.logrocket.com/d3-react-bar-chart-labels/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png" data-orig-size="720,452" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="d3-react-bar-chart-labels" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png" decoding="async" class="wp-image-152768 size-full jetpack-lazy-image" src="../Images/c50abae1fa43210346bcb9603fa53fc0.png" alt="D3 React Bar Chart Labels" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png 720w, https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels-300x188.png 300w" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="152768" data-permalink="https://blog.logrocket.com/d3-react-bar-chart-labels/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png" data-orig-size="720,452" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="d3-react-bar-chart-labels" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels-300x188.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png" decoding="async" loading="lazy" class="wp-image-152768 size-full" src="../Images/c50abae1fa43210346bcb9603fa53fc0.png" alt="D3 React Bar Chart Labels" srcset="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png 720w, https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels-300x188.png 300w" sizes="(max-width: 720px) 100vw, 720px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2022/12/d3-react-bar-chart-labels.png"/></noscript><figcaption id="caption-attachment-152768" class="wp-caption-text">D3.js and React bar chart with labels</figcaption></figure>
<h2 id="make-chart-reusable-react-d3-js">如何使图表在React和D3.js中可重用</h2>
<p>React最重要的原则之一是制造可重用的组件。为此，我们需要使<code>BarChart</code>组件独立于数据，并使其成为一个参数。在这样做的时候，我们也将摆脱所有对常数的依赖，比如图形的高度和宽度。为此，我们将使用<code>props</code>机制。</p>
<p>现在，我们将修改<code>App.js</code>以将参数传递给<code>BarChart</code>组件:</p>
<pre>import BarChart from './BarChart'

const App = () =&gt; {
    return (&lt;BarChart 
        data={[12, 5, 6, 6, 9, 10]}
        width={700}
        height={300}/&gt;)
}
export default App;
</pre>
<p>连贯地，我们修改了<code>BarChart</code>组件使用它们的方式。它们将在<code>BarChart.js</code>源文件的<code>props</code>对象中可用:</p>
<pre>const data = this.props.data;
</pre>
<p>下面代码块的宽度和高度属性分别更改为:</p>
<pre>const svg = d3.select("body").append("svg").attr("width", 700).attr("height", 300);


const svg = d3.select("body").append("svg")
  .attr("width", this.props.width)
  .attr("height", this.props.height);
</pre>
<p>这样，我们可以在React应用程序中的任何地方重用条形图。</p>
<h2 id="conclusion">结论</h2>
<p>在本文中，我们探索了使用D3.js和React创建一个简单的条形图。然后，我们进一步定制了带标签的条形图。我们学习了如何解决在配对D3.js和React时可能出现的一些问题，比如间距问题和图表反转。</p>
<p>尽管D3.js和React都是流行的库，可以很好地协同工作，但是将它们配对可能会很棘手。希望这篇文章可以作为帮助你开始的指南。我希望你喜欢这篇文章，如果你有任何问题，一定要留下评论。编码快乐！</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">使用LogRocket消除传统反应错误报告的噪音</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>是一款React analytics解决方案，可保护您免受数百个误报错误警报的影响，只针对少数真正重要的项目。LogRocket告诉您React应用程序中实际影响用户的最具影响力的bug和UX问题。</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>自动聚合客户端错误、反应错误边界、还原状态、缓慢的组件加载时间、JS异常、前端性能指标和用户交互。然后，LogRocket使用机器学习来通知您影响大多数用户的最具影响力的问题，并提供您修复它所需的上下文。</p><p vwo-el-id="28675661060">关注重要的React bug—<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">今天就试试LogRocket】。</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>