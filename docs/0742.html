<html>
<head>
<title>GraphQL variables in simple terms - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>简单的GraphQL变量</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/graphql-variables-in-simple-terms/#0001-01-01">https://blog.logrocket.com/graphql-variables-in-simple-terms/#0001-01-01</a></blockquote><div><article class="article-post">
<p>GraphQL最近获得了几家公司的关注。它本质上是一种用于API的查询语言，提供了很好的开发体验。</p>
<p>在之前的博客文章中，我们学习了使用GitHub API explorer编写GraphQL <a href="https://blog.logrocket.com/graphql-queries-in-simple-terms/" target="_blank" rel="noopener noreferrer">查询</a>。如果您不确定什么是GraphQL查询，我建议您在开始使用GraphQL变量之前先阅读<a href="https://blog.logrocket.com/graphql-queries-in-simple-terms/" target="_blank" rel="noopener noreferrer">这篇文章</a>。</p>
<p>GraphQL模式可以不仅仅包含标量类型。最常用的两种类型是<a href="https://graphql.org/learn/schema/#the-query-and-mutation-types" target="_blank" rel="noopener noreferrer">查询和变异类型</a>。要了解更多关于在GraphQL模式中定义类型的信息，你可以在这里阅读我们之前的文章<a href="https://blog.logrocket.com/defining-types-for-your-graphql-api/" target="_blank" rel="noopener noreferrer"/>。</p>
<h2>开始使用GitHub的公共API</h2>
<p>为了演示和学习GraphQL变量，我将使用公众可用的<a href="https://developer.github.com/v4/" target="_blank" rel="noopener noreferrer"> GitHub API </a>。你可以跟着打开https://developer.github.com/v4/explorer/的<a href="https://developer.github.com/v4/explorer/" target="_blank" rel="noopener noreferrer"/>。确保您已登录GitHub帐户来运行查询。</p>
<p>GitHub explorer是针对API编写和测试查询的好方法。在浏览器的左侧，您可以定义您的查询，右侧显示从服务器返回的JSON输出。最棒的是右边的文档浏览器。GraphQL是自文档化的，您可以在这里浏览完整的GraphQL模式。</p>
<p><img data-attachment-id="15616" data-permalink="https://blog.logrocket.com/graphql-variables-in-simple-terms/githubapi-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png" data-orig-size="752,334" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="githubapi" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi-300x133.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png" decoding="async" class="aligncenter wp-image-15616 size-full jetpack-lazy-image" src="../Images/8ea653e7371b368b39e7ba52cbf0ff87.png" alt="" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png 752w, https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi-300x133.png 300w" data-lazy-sizes="(max-width: 752px) 100vw, 752px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="15616" data-permalink="https://blog.logrocket.com/graphql-variables-in-simple-terms/githubapi-2/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png" data-orig-size="752,334" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="githubapi" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi-300x133.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png" decoding="async" loading="lazy" class="aligncenter wp-image-15616 size-full" src="../Images/8ea653e7371b368b39e7ba52cbf0ff87.png" alt="" srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png 752w, https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi-300x133.png 300w" sizes="(max-width: 752px) 100vw, 752px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/githubapi.png"/></noscript>
<h2>变量</h2>
<p>在GraphQL中，您可以使用变量来重用客户端编写的带有不同参数的相同查询/变异。</p>
<p>首先，让我们看一个接受一些参数作为参数的查询。在这个查询中，我们将查询存储库名称和所有者id。这个查询需要我们正在查询的存储库的名称和所有者<strong>的名称</strong>。</p>
<h2>没有变量的查询</h2>
<pre>query {
  repository(name: "React", owner: "facebook") {
    name
    owner {
      id
    }
  }
}</pre>
<h2>使用变量的相同查询</h2>
<p>现在，可以使用GraphQL中的变量概念编写上面的相同查询来接受动态值。客户端可以重用同一个查询来传递不同的参数(名称和所有者)。让我们看看如何使用变量来重写它。</p>
<p>当您开始在查询或变异中使用<a href="https://graphql.org/learn/queries/" target="_blank" rel="noopener noreferrer">变量</a>时，需要完成三个步骤:</p>
<ol>
<li>用<strong> $variableName </strong>替换查询中的静态值</li>
<li>将<strong> $variableName </strong>声明为查询接受的变量之一</li>
<li>在单独的、特定于传输的(通常是JSON)变量字典中传递<strong> variableName: value </strong></li>
</ol>
<p>在GraphQL explorer中，左下方是查询变量部分:</p>
<pre> query ($name: String!, $owner: String!) {
  repository(name: $name, owner: $owner) {
    name
    owner {
      id
    }
  }
}</pre>
<h2>定义查询变量</h2>
<p>在客户端代码中，您现在可以将不同的值作为参数传入，而不用重新构建新的查询。在GraphQL explorer中，您可以在标题为<code>Query Variables</code>的屏幕左下方键入查询变量:</p>
<pre>{
    "name": "React",
    "owner": "facebook"
}</pre>
<h2>JSON响应</h2>
<p>在定义了查询变量之后，现在可以运行查询来查看JSON的预期响应:</p>
<pre>{
  "data": {
    "repository": {
      "name": "react",
      "owner": {
        "id": "MDEyOk9yZ2FuaXphdGlvbjY5NjMx"
      }
    }
  }
}</pre>
<h2>变量突变</h2>
<p>到目前为止，我们学习了如何使用变量编写动态查询。同样的概念也适用于编写突变。让我们针对GitHub API编写一个变异，并使用变量值传递给变异。</p>
<p>我将编写一个简单的变种，来更新我在GitHub上的用户状态。您可以从documentation explorer中研究这种变异的文档。</p>
<p><img data-attachment-id="15625" data-permalink="https://blog.logrocket.com/graphql-variables-in-simple-terms/changeuserstatus-mutation-documentation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation.png" data-orig-size="726,1086" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="changeUserStatus Mutation Documentation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation-201x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation-685x1024.png" decoding="async" class="aligncenter wp-image-15625 size-full jetpack-lazy-image" src="../Images/550d7e218efa5384fd21b8859879febb.png" alt="changeUserStatus Mutation Documentation" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation.png 726w, https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation-201x300.png 201w, https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation-685x1024.png 685w" data-lazy-sizes="(max-width: 726px) 100vw, 726px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="15625" data-permalink="https://blog.logrocket.com/graphql-variables-in-simple-terms/changeuserstatus-mutation-documentation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation.png" data-orig-size="726,1086" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="changeUserStatus Mutation Documentation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation-201x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation-685x1024.png" decoding="async" loading="lazy" class="aligncenter wp-image-15625 size-full" src="../Images/550d7e218efa5384fd21b8859879febb.png" alt="changeUserStatus Mutation Documentation" srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation.png 726w, https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation-201x300.png 201w, https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation-685x1024.png 685w" sizes="(max-width: 726px) 100vw, 726px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/changeUserStatus-Mutation-Documentation.png"/></noscript>
<p>我们将通过将参数作为变量传递来编写我们的突变。在我们的例子中，我将把<code>ChangeUserStatusInput</code>类型作为变量输入传递给变异:</p>
<pre>mutation updateMyStatus($input: ChangeUserStatusInput!) {
  changeUserStatus(input: $input) {
    clientMutationId
  }
}</pre>
<h2>定义查询变量</h2>
<p><code>ChangeUserStatusInput</code>类型接受一个<code>message</code>参数和一个<code>clientMutationId</code>。该ID可以是任何唯一的数字:</p>
<pre>{
  "input": {
    "message": "Writing a blog post",
    "clientMutationId": "101010101"
  }
}</pre>
<h2>JSON响应</h2>
<p>该响应表明突变是针对<code>clientMutationId</code>执行的:</p>
<pre>{
  "data": {
    "changeUserStatus": {
      "clientMutationId": "101010101"
    }
  }
}</pre>
<h2>验证发生了突变</h2>
<p>验证突变成功发生的最好方法是查询该数据，并确保它已经在GraphQL服务器上更新。为了验证用户状态是否用我们编写的突变进行了更新，让我们编写一个针对服务器的查询:</p>
<pre>query myStatus {
  viewer {
    status {
      message
    }
  }
}</pre>
<h2>JSON响应</h2>
<p>这就对了。我们可以看到用户的更新状态消息。</p>
<pre>{
  "data": {
    "viewer": {
      "status": {
        "message": "Writing a blog post"
      }
    }
  }
}</pre>
<p><img data-attachment-id="15629" data-permalink="https://blog.logrocket.com/graphql-variables-in-simple-terms/examplewriting/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png" data-orig-size="730,827" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="examplewriting" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting-265x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png" decoding="async" class="aligncenter wp-image-15629 size-full jetpack-lazy-image" src="../Images/c0aaa3c8220610c5416b4385efaace6a.png" alt="example ui" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting-265x300.png 265w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="15629" data-permalink="https://blog.logrocket.com/graphql-variables-in-simple-terms/examplewriting/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png" data-orig-size="730,827" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="examplewriting" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting-265x300.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png" decoding="async" loading="lazy" class="aligncenter wp-image-15629 size-full" src="../Images/c0aaa3c8220610c5416b4385efaace6a.png" alt="example ui" srcset="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png 730w, https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting-265x300.png 265w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/03/examplewriting.png"/></noscript>
<p>或者，我们可以通过查看我在GitHub上的个人资料来验证这种突变是否真的发生了。由于这些查询和变化是针对真实的生产数据编写的，我们可以通过登录GitHub进行验证。</p>
<p>你可以注意到我的状态已经更新为<em>“写博客”</em> <strong>。</strong>您可以尝试其他变化，也可以从实时数据中获得乐趣。</p>
<h2>默认变量</h2>
<p>GraphQL还为我们提供了一种为变量分配默认值的方法。当没有显式定义变量值时，使用默认值。这就像一个函数在编程语言中使用默认值作为参数一样。</p>
<h2>默认变量示例</h2>
<p>让我们看一下我们的查询示例，从这篇博文的开头开始，通过名称<em>和所有者<em>来搜索存储库。我们现在用默认变量作为查询参数重写了它。</em></em></p>
<pre>query repositorySearch($name: String="react", $owner: String="facebook") {
  repository(name: $name, owner: $owner) {
    name
    owner {
      id
    }
  }
}</pre>
<p>当为所有变量提供默认值时，可以调用查询而不传递任何变量。如果任何变量作为变量字典的一部分被传递，它们将覆盖缺省值。</p>
<h2>GraphQL中变量的好处</h2>
<p><strong>重用:</strong>graph QL中存在变量的原因是为了允许对不同的参数和值集重用相同的查询和变化。客户端可以只传递一组不同的变量，而不是构造一个新的查询或变异</p>
<p><strong>动态查询:</strong>通过使用变量，GraphQL支持可以根据传递给它的变量而变化的动态查询</p>
<p><strong>灵活性:</strong>这也为开发人员提供了查询数据时所需的灵活性</p>
<h2>结论</h2>
<p>我希望您喜欢在本文中学习GraphQL变量。如果你有兴趣进一步了解GraphQL，并对GraphQL有一个全面的了解，你可以在Pluralsight上查看我的课程<a href="https://app.pluralsight.com/library/courses/graphql-big-picture/table-of-contents" target="_blank" rel="noopener noreferrer"> GraphQL: The Big Picture </a>。</p>
<p>其他GraphQL文章:<br/><a href="https://blog.logrocket.com/defining-types-for-your-graphql-api/" target="_blank" rel="noopener noreferrer">https://blog . log rocket . com/defining-types-for-your-graph QL-API/</a><br/>【https://blog.logrocket.com/graphql-fragments-explained/】<br/><a href="https://blog.logrocket.com/graphql-queries-in-simple-terms/" target="_blank" rel="noopener noreferrer">https://blog.logrocket.com/graphql-queries-in-simple-terms/</a></p>
<p>其他资源:<br/><a href="https://graphql.org/" target="_blank" rel="noopener noreferrer">https://graphql.org/</a><br/><a href="https://graphql.org/learn/" target="_blank" rel="noopener noreferrer">https://graphql.org/learn/</a><br/><a href="https://www.graphql.com/" target="_blank" rel="noopener noreferrer">https://www.graphql.com/</a></p>
<p>请在下面发表您的评论，并与您的团队和朋友分享这篇文章。稍后我会在另一篇文章中看到你。你可以在twitter上关注我<a href="https://twitter.com/AdhithiRavi" target="_blank" rel="noopener noreferrer"> @AdhithiRavi </a>了解更多更新。</p><div class="code-block code-block-24">
<div class="blog-plug inline-plug graphql-plug"><h2>监控生产中失败和缓慢的GraphQL请求</h2><p>虽然GraphQL有一些调试请求和响应的特性，但确保GraphQL可靠地为您的生产应用程序提供资源是一件比较困难的事情。如果您对确保对后端或第三方服务的网络请求成功感兴趣，</p><a href="https://lp.logrocket.com/blg/graphql-signup" target="_blank">try LogRocket</a><p>.</p><a class="signup" href="https://lp.logrocket.com/blg/graphql-signup" target="_blank" rel="noopener noreferrer"><img src="../Images/432a3823c85b3fb72a206e6236a29f48.png" data-lazy-src="https://files.readme.io/69aa835-Image_2019-11-09_at_1.28.05_PM.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image" data-original-src="https://files.readme.io/69aa835-Image_2019-11-09_at_1.28.05_PM.png"/><noscript><img data-lazy-fallback="1" src="../Images/432a3823c85b3fb72a206e6236a29f48.png" data-original-src="https://files.readme.io/69aa835-Image_2019-11-09_at_1.28.05_PM.png"/></noscript><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a><a href="https://lp.logrocket.com/blg/graphql-signup" target="_blank" rel="noopener noreferrer">https://logrocket.com/signup/</a><p>LogRocket 就像是网络和移动应用的DVR，记录下你网站上发生的每一件事。您可以汇总并报告有问题的GraphQL请求，以快速了解根本原因，而不是猜测问题发生的原因。此外，您可以跟踪Apollo客户机状态并检查GraphQL查询的键值对。</p><p>LogRocket检测您的应用程序以记录基线性能计时，如页面加载时间、到达第一个字节的时间、慢速网络请求，还记录Redux、NgRx和Vuex操作/状态。</p><a class="signup" href="https://lp.logrocket.com/blg/graphql-signup" target="_blank" rel="noopener noreferrer">Start monitoring for free</a><p>.</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>