<html>
<head>
<title>How to dynamically create JavaScript elements with event handlers - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何用事件处理程序动态创建JavaScript元素</h1>
<blockquote>原文：<a href="https://blog.logrocket.com/how-to-dynamically-create-javascript-elements-with-event-handlers/#0001-01-01">https://blog.logrocket.com/how-to-dynamically-create-javascript-elements-with-event-handlers/#0001-01-01</a></blockquote><div><article class="article-post">
<p>在本文中，我们将研究如何动态创建JavaScript元素，以及如何将事件处理程序附加到动态创建的JavaScript元素上。</p>
<h3>介绍</h3>
<p>在我们深入研究如何将事件处理程序附加到动态创建的JavaScript元素之前，理解JavaScript事件及其工作原理很重要。</p>
<p>根据<a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Event" target="_blank" rel="noopener noreferrer"> MDN </a> web docs，事件是在你正在编程的系统中发生的动作或事件，系统会告诉你，如果你想的话，你可以以某种方式响应它们。</p>
<p>它可以以不同的方式发生。例如:当用户点击提交按钮提交表单时，当用户播放或暂停视频时，当用户按下键盘上的特定键时，或者当用户从网页上复制内容时。</p>
<p>在JavaScript中，在尚未创建或页面上不存在的元素上附加事件处理程序将引发错误。因此，事件处理程序代码将不起作用。</p>
<p>例如:</p>

<p>在上面的例子中，<code>btn</code>类在我们的<code>index.html</code>页面中不存在。因此，这将抛出一个null的<code>addEventListener</code>错误。</p>

<p>我们可以在JavaScript中动态创建一个元素，并用这两种方法附加事件处理程序:</p>
<p><code>document.createElement()</code>方法</p>
<p>这个方法允许我们通过标签名来创建HTML元素，比如<code>&lt;div&gt;</code>、<code>&lt;p&gt;</code>、<code>&lt;img&gt;</code>和<code>&lt;h1&gt;</code>。</p>
<h3>当我们用<code>document.createElement</code>创建一个元素时，它不会立即出现在页面上。它将存储在JavaScript内存中，直到被注入到DOM中。</h3>
<p>在这篇文章中，我们将创建一个简单的狗的个人资料。</p>
<p>我们将动态创建我们的元素，将其注入DOM，并附加事件处理程序。</p>
<p><a href="https://codepen.io/amycruz/pen/MWyxaZd" target="_blank" rel="noopener noreferrer">code pen现场演示</a>。</p>
<p><span>这是我们的<code>index.html</code>，它的主体中没有任何元素。我们将从JavaScript动态创建元素，将其注入DOM，并为动态创建的元素附加事件处理程序。</span></p>
<p>在我们的index.js中，我们使用<code>document.createElement()</code>来动态创建一个新的<code>div</code>。然后，我们给之前创建的<code>div</code>添加了一个狗类。</p>

<p>属性用于添加、移除和切换元素上的CSS类。</p>

<p>接下来，我们创建了一个带有<code>src</code>和<code>alt</code>属性的图像标签。</p>
<p>我们还创建了<code>h2</code>标签，并在其中添加了文本内容。此外，我们添加了一个新的<code>p</code>元素和一个包含更多关于狗的信息的<code>info</code>类。</p>
<p>接下来，我们将动态创建一个带有类<code>btn</code>的按钮。我们将添加文本<code>click here to read more</code>。</p>
<p>如果您检查您的浏览器，您不会看到我们创建的带有类<code>dog</code>的<code>div</code>，因为我们还没有将它附加到DOM中。</p>
<p>现在，我们已经动态创建了一个元素。问题是:我们如何将它注入页面？</p>
<p>为了将它注入DOM，我们将使用<code>.appendChild()</code>方法添加动态创建的元素。</p>
<p>更多来自LogRocket的精彩文章:</p>
<p>如果您检查您的控制台，您会看到动态创建的元素被注入到您的DOM中。</p><div class="code-block code-block-54">
<hr/>
<h3>现在我们可以添加事件处理程序。</h3>

<hr/></div>
<p>要将事件处理程序附加到动态创建的按钮上，我们需要选择一个类为<code>btn</code>的按钮，并添加一个事件监听器<code>click</code>。</p>
<p>我们说的是按钮的<code>onclick</code>，带有<code>moreInfo</code>类的<code>p</code>标签应该显示<code>block</code>。</p>
<p> </p>
<p>下面是为狗设定样式的CSS代码。</p>

<p>使用JavaScript反勾号字符串创建元素</p>
<p>JavaScript反勾号字符串也称为模板文字。</p>
<h2>根据<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" target="_blank" rel="noopener noreferrer"> MDN </a>，模板文字是允许嵌入表达式的字符串文字。您可以使用多行字符串和字符串插值功能。</h2>
<p>我们将使用JavaScript模板文本动态创建一个元素，将它们注入DOM，并附加事件处理程序。</p>
<p>在codepen 查看这个<a href="https://codepen.io/amycruz/pen/KKzErrr" target="_blank" rel="noopener noreferrer">现场演示</a></p>
<p>这里，我们仍然要创建之前创建的狗配置文件，不同之处在于JavaScript文件。所以，我们的HTML和CSS保持不变。</p>
<p><strong> template literals.js </strong></p>
<p>在模板<code>literals.js</code>文件中，我们声明了<code>newDog</code>，并使用模板文字在其中创建多个元素。如果你<code>console.log(newDog)</code>，你会在控制台中看到像字符串一样创建的元素。</p>
<p>或者如果你<code>console.log(typeof newDog)</code>，它将返回一个字符串，表明它还不是一个DOM元素。</p>

<p>接下来，我们要用<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/createRange" target="_blank" rel="noopener noreferrer"> <code>document.createRange()</code> </a>把字符串变成一个DOM元素。</p>
<p>然后我们把<a href="https://developer.mozilla.org/en-US/docs/Web/API/Range/createContextualFragment" target="_blank" rel="noopener noreferrer"> <code>createContextualFragment()</code> </a>)法叶放在靶场上。当您<code>console.log myFragment</code>时，您将看到一系列对象(元素的集合，或者我们可以使用的HTML的一部分)。</p>
<p>然后，我们将<code>myFragment</code>追加到页面的主体。</p>
<p><strong>注意</strong>:如果你确实需要添加事件监听器或更改类，我们应该首先用一个<code>createcontextual</code>片段把它放在DOM中，然后把它放在正文或页面的任何地方。</p>
<p>接下来，我们选择带有<code>.btn</code>类的按钮，用户单击它可以阅读更多关于狗的信息。</p>
<p>如果你<code>console.log(btn)</code>，你会发现它在DOM中，因为我们已经通过<code>createContextual</code>片段将它注入到DOM中。</p>
<p>添加事件处理程序</p>
<p>我们添加了一个<code>click</code>的事件监听器，并调用了一个<code>showMore</code>函数。</p>
<h3>在<code>showMore</code>函数中，我们选择了类<code>moreInfo</code>。如果你检查我们的<code>css</code>，你会发现文本被设置为无显示。所以现在我们说按钮的<code>onclick</code>，让显示<code>none</code>改成显示<code>block</code>。</h3>
<p>我们已经创建了一个狗的个人资料。所有的元素都是动态创建的，事件处理程序<code>onclick</code>被添加到动态创建的元素中。</p>
<p>结论</p>
<p>恭喜你。您刚刚学习了如何使用<code>document.createElement</code>动态创建JavaScript元素，以及如何使用模板文字。</p>
<h2>您还学习了如何将事件处理程序附加到动态创建的元素上。</h2>
<p>通过理解上下文，更容易地调试JavaScript错误</p>
<p>调试代码总是一项单调乏味的任务。但是你越了解自己的错误，就越容易改正。</p><div class="code-block code-block-27">
<div class="blog-plug inline-plug vanilla-javascript-cta"><h2>LogRocket 让你以新的独特的方式理解这些错误。我们的前端监控解决方案跟踪用户与您的JavaScript前端的互动，让您能够准确找出导致错误的用户行为。</h2>
<p>LogRocket记录控制台日志、页面加载时间、堆栈跟踪、慢速网络请求/响应(带有标题+正文)、浏览器元数据和自定义日志。理解您的JavaScript代码的影响从来没有这么简单过！</p>
<p>.</p>
<a href="https://lp.logrocket.com/blg/javascript-signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/cbfed9be3defcb505e662574769a7636.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/cbfed9be3defcb505e662574769a7636.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2020/06/reproduce-javascript-errors.gif"/></noscript></a>
<p>LogRocket records console logs, page load times, stacktraces, slow network requests/responses with headers + bodies, browser metadata, and custom logs. Understanding the impact of your JavaScript code will never be easier!</p>
<a class="signup" href="https://lp.logrocket.com/blg/javascript-signup" target="_blank" rel="noopener noreferrer">Try it for free</a><p>.</p></div>


</div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>